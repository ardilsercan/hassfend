/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
export const id = "src_components_chart_state-history-charts_ts";
export const ids = ["src_components_chart_state-history-charts_ts"];
export const modules = {

/***/ "./src/common/decorators/restore-scroll.ts":
/*!*************************************************!*\
  !*** ./src/common/decorators/restore-scroll.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   restoreScroll: () => (/* binding */ restoreScroll)\n/* harmony export */ });\n/* harmony import */ var _util_throttle__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/throttle */ \"./src/common/util/throttle.ts\");\n\nconst throttleReplaceState = (0,_util_throttle__WEBPACK_IMPORTED_MODULE_0__.throttle)(value => {\n  history.replaceState({\n    scrollPosition: value\n  }, \"\");\n}, 300);\nconst restoreScroll = selector => element => ({\n  kind: \"method\",\n  placement: \"prototype\",\n  key: element.key,\n  descriptor: {\n    set(value) {\n      throttleReplaceState(value);\n      this[`__${String(element.key)}`] = value;\n    },\n    get() {\n      var _history$state;\n      return this[`__${String(element.key)}`] || ((_history$state = history.state) === null || _history$state === void 0 ? void 0 : _history$state.scrollPosition);\n    },\n    enumerable: true,\n    configurable: true\n  },\n  finisher(cls) {\n    const connectedCallback = cls.prototype.connectedCallback;\n    cls.prototype.connectedCallback = function () {\n      connectedCallback.call(this);\n      const scrollPos = this[element.key];\n      if (scrollPos) {\n        this.updateComplete.then(() => {\n          const target = this.renderRoot.querySelector(selector);\n          if (!target) {\n            return;\n          }\n          setTimeout(() => {\n            target.scrollTop = scrollPos;\n          }, 0);\n        });\n      }\n    };\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tbW9uL2RlY29yYXRvcnMvcmVzdG9yZS1zY3JvbGwudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaG9tZS1hc3Npc3RhbnQtZnJvbnRlbmQvLi9zcmMvY29tbW9uL2RlY29yYXRvcnMvcmVzdG9yZS1zY3JvbGwudHM/YjY3YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IExpdEVsZW1lbnQgfSBmcm9tIFwibGl0XCI7XG5pbXBvcnQgdHlwZSB7IENsYXNzRWxlbWVudCB9IGZyb20gXCIuLi8uLi90eXBlc1wiO1xuaW1wb3J0IHsgdGhyb3R0bGUgfSBmcm9tIFwiLi4vdXRpbC90aHJvdHRsZVwiO1xuXG5jb25zdCB0aHJvdHRsZVJlcGxhY2VTdGF0ZSA9IHRocm90dGxlKCh2YWx1ZSkgPT4ge1xuICBoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7IHNjcm9sbFBvc2l0aW9uOiB2YWx1ZSB9LCBcIlwiKTtcbn0sIDMwMCk7XG5cbmV4cG9ydCBjb25zdCByZXN0b3JlU2Nyb2xsID1cbiAgKHNlbGVjdG9yOiBzdHJpbmcpOiBhbnkgPT5cbiAgKGVsZW1lbnQ6IENsYXNzRWxlbWVudCkgPT4gKHtcbiAgICBraW5kOiBcIm1ldGhvZFwiLFxuICAgIHBsYWNlbWVudDogXCJwcm90b3R5cGVcIixcbiAgICBrZXk6IGVsZW1lbnQua2V5LFxuICAgIGRlc2NyaXB0b3I6IHtcbiAgICAgIHNldCh0aGlzOiBMaXRFbGVtZW50LCB2YWx1ZTogbnVtYmVyKSB7XG4gICAgICAgIHRocm90dGxlUmVwbGFjZVN0YXRlKHZhbHVlKTtcbiAgICAgICAgdGhpc1tgX18ke1N0cmluZyhlbGVtZW50LmtleSl9YF0gPSB2YWx1ZTtcbiAgICAgIH0sXG4gICAgICBnZXQodGhpczogTGl0RWxlbWVudCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIHRoaXNbYF9fJHtTdHJpbmcoZWxlbWVudC5rZXkpfWBdIHx8IGhpc3Rvcnkuc3RhdGU/LnNjcm9sbFBvc2l0aW9uXG4gICAgICAgICk7XG4gICAgICB9LFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICB9LFxuICAgIGZpbmlzaGVyKGNsczogdHlwZW9mIExpdEVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IGNvbm5lY3RlZENhbGxiYWNrID0gY2xzLnByb3RvdHlwZS5jb25uZWN0ZWRDYWxsYmFjaztcbiAgICAgIGNscy5wcm90b3R5cGUuY29ubmVjdGVkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbm5lY3RlZENhbGxiYWNrLmNhbGwodGhpcyk7XG4gICAgICAgIGNvbnN0IHNjcm9sbFBvcyA9IHRoaXNbZWxlbWVudC5rZXldO1xuICAgICAgICBpZiAoc2Nyb2xsUG9zKSB7XG4gICAgICAgICAgdGhpcy51cGRhdGVDb21wbGV0ZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMucmVuZGVyUm9vdC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICB0YXJnZXQuc2Nyb2xsVG9wID0gc2Nyb2xsUG9zO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgfSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/common/decorators/restore-scroll.ts\n");

/***/ }),

/***/ "./src/components/chart/state-history-chart-line.ts":
/*!**********************************************************!*\
  !*** ./src/components/chart/state-history-chart-line.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StateHistoryChartLine: () => (/* binding */ StateHistoryChartLine)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/decorate */ \"./node_modules/@babel/runtime/helpers/esm/decorate.js\");\n/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit */ \"./node_modules/lit/index.js\");\n/* harmony import */ var lit_decorators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit/decorators */ \"./node_modules/lit/decorators.js\");\n/* harmony import */ var _common_color_colors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/color/colors */ \"./src/common/color/colors.ts\");\n/* harmony import */ var _common_dom_fire_event__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/dom/fire_event */ \"./src/common/dom/fire_event.ts\");\n/* harmony import */ var _common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/util/compute_rtl */ \"./src/common/util/compute_rtl.ts\");\n/* harmony import */ var _common_number_format_number__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/number/format_number */ \"./src/common/number/format_number.ts\");\n/* harmony import */ var _ha_chart_base__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ha-chart-base */ \"./src/components/chart/ha-chart-base.ts\");\n\n\n\n\n\n\n\n\nconst safeParseFloat = value => {\n  const parsed = parseFloat(value);\n  return isFinite(parsed) ? parsed : null;\n};\nlet StateHistoryChartLine = (0,_babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(null, function (_initialize, _LitElement) {\n  class StateHistoryChartLine extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: StateHistoryChartLine,\n    d: [{\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"data\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"names\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)()],\n      key: \"unit\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)()],\n      key: \"identifier\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"showNames\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"clickForMoreInfo\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"startTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"endTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Number\n      })],\n      key: \"paddingYAxis\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Number\n      })],\n      key: \"chartIndex\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"logarithmicScale\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Number\n      })],\n      key: \"minYAxis\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Number\n      })],\n      key: \"maxYAxis\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"fitYData\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_chartData\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_entityIds\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      key: \"_datasetToDataIndex\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_chartOptions\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_yWidth\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_chartTime\",\n      value() {\n        return new Date();\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.query)(\"ha-chart-base\")],\n      key: \"_chart\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"resize\",\n      value() {\n        return options => {\n          var _this$_chart;\n          (_this$_chart = this._chart) === null || _this$_chart === void 0 || _this$_chart.resize(options);\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`\n      <ha-chart-base\n        .hass=${this.hass}\n        .data=${this._chartData}\n        .options=${this._chartOptions}\n        .paddingYAxis=${this.paddingYAxis - this._yWidth}\n        chart-type=\"line\"\n      ></ha-chart-base>\n    `;\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        if (!this.hasUpdated || changedProps.has(\"showNames\") || changedProps.has(\"startTime\") || changedProps.has(\"endTime\") || changedProps.has(\"unit\") || changedProps.has(\"logarithmicScale\") || changedProps.has(\"minYAxis\") || changedProps.has(\"maxYAxis\") || changedProps.has(\"fitYData\")) {\n          this._chartOptions = {\n            parsing: false,\n            animation: false,\n            interaction: {\n              mode: \"nearest\",\n              axis: \"xy\"\n            },\n            scales: {\n              x: {\n                type: \"time\",\n                adapters: {\n                  date: {\n                    locale: this.hass.locale,\n                    config: this.hass.config\n                  }\n                },\n                suggestedMin: this.startTime,\n                suggestedMax: this.endTime,\n                ticks: {\n                  maxRotation: 0,\n                  sampleSize: 5,\n                  autoSkipPadding: 20,\n                  major: {\n                    enabled: true\n                  },\n                  font: context => context.tick && context.tick.major ? {\n                    weight: \"bold\"\n                  } : {}\n                },\n                time: {\n                  tooltipFormat: \"datetimeseconds\"\n                }\n              },\n              y: {\n                suggestedMin: this.fitYData ? this.minYAxis : null,\n                suggestedMax: this.fitYData ? this.maxYAxis : null,\n                min: this.fitYData ? null : this.minYAxis,\n                max: this.fitYData ? null : this.maxYAxis,\n                ticks: {\n                  maxTicksLimit: 7\n                },\n                title: {\n                  display: true,\n                  text: this.unit\n                },\n                afterUpdate: y => {\n                  if (this._yWidth !== Math.floor(y.width)) {\n                    this._yWidth = Math.floor(y.width);\n                    (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_4__.fireEvent)(this, \"y-width-changed\", {\n                      value: this._yWidth,\n                      chartIndex: this.chartIndex\n                    });\n                  }\n                },\n                position: (0,_common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_5__.computeRTL)(this.hass) ? \"right\" : \"left\",\n                type: this.logarithmicScale ? \"logarithmic\" : \"linear\"\n              }\n            },\n            plugins: {\n              tooltip: {\n                callbacks: {\n                  label: context => {\n                    let label = `${context.dataset.label}: ${(0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_6__.formatNumber)(context.parsed.y, this.hass.locale, (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_6__.getNumberFormatOptions)(undefined, this.hass.entities[this._entityIds[context.datasetIndex]]))} ${this.unit}`;\n                    const dataIndex = this._datasetToDataIndex[context.datasetIndex];\n                    const data = this.data[dataIndex];\n                    if (data.statistics && data.statistics.length > 0) {\n                      const source = data.states.length === 0 || context.parsed.x < data.states[0].last_changed ? `\\n${this.hass.localize(\"ui.components.history_charts.source_stats\")}` : `\\n${this.hass.localize(\"ui.components.history_charts.source_history\")}`;\n                      label += source;\n                    }\n                    return label;\n                  }\n                }\n              },\n              filler: {\n                propagate: true\n              },\n              legend: {\n                display: this.showNames,\n                labels: {\n                  usePointStyle: true\n                }\n              }\n            },\n            elements: {\n              line: {\n                tension: 0.1,\n                borderWidth: 1.5\n              },\n              point: {\n                hitRadius: 50\n              }\n            },\n            segment: {\n              borderColor: context => {\n                // render stat data with a slightly transparent line\n                const dataIndex = this._datasetToDataIndex[context.datasetIndex];\n                const data = this.data[dataIndex];\n                return data.statistics && data.statistics.length > 0 && (data.states.length === 0 || context.p0.parsed.x < data.states[0].last_changed) ? this._chartData.datasets[dataIndex].borderColor + \"7F\" : undefined;\n              }\n            },\n            // @ts-expect-error\n            locale: (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_6__.numberFormatToLocale)(this.hass.locale),\n            onClick: e => {\n              if (!this.clickForMoreInfo || !(e.native instanceof MouseEvent) || e.native instanceof PointerEvent && e.native.pointerType !== \"mouse\") {\n                return;\n              }\n              const chart = e.chart;\n              const points = chart.getElementsAtEventForMode(e, \"nearest\", {\n                intersect: true\n              }, true);\n              if (points.length) {\n                const firstPoint = points[0];\n                (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_4__.fireEvent)(this, \"hass-more-info\", {\n                  entityId: this._entityIds[firstPoint.datasetIndex]\n                });\n                chart.canvas.dispatchEvent(new Event(\"mouseout\")); // to hide tooltip\n              }\n            }\n          };\n        }\n        if (changedProps.has(\"data\") || changedProps.has(\"startTime\") || changedProps.has(\"endTime\") || this._chartTime < new Date(this.endTime.getTime() - _ha_chart_base__WEBPACK_IMPORTED_MODULE_7__.MIN_TIME_BETWEEN_UPDATES)) {\n          // If the line is more than 5 minutes old, re-gen it\n          // so the X axis grows even if there is no new data\n          this._generateData();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_generateData\",\n      value: function _generateData() {\n        let colorIndex = 0;\n        const computedStyles = getComputedStyle(this);\n        const entityStates = this.data;\n        const datasets = [];\n        const entityIds = [];\n        const datasetToDataIndex = [];\n        if (entityStates.length === 0) {\n          return;\n        }\n        this._chartTime = new Date();\n        const endTime = this.endTime;\n        const names = this.names || {};\n        entityStates.forEach((states, dataIdx) => {\n          const domain = states.domain;\n          const name = names[states.entity_id] || states.name;\n          // array containing [value1, value2, etc]\n          let prevValues = null;\n          const data = [];\n          const pushData = (timestamp, datavalues) => {\n            if (!datavalues) return;\n            if (timestamp > endTime) {\n              // Drop data points that are after the requested endTime. This could happen if\n              // endTime is \"now\" and client time is not in sync with server time.\n              return;\n            }\n            data.forEach((d, i) => {\n              if (datavalues[i] === null && prevValues && prevValues[i] !== null) {\n                // null data values show up as gaps in the chart.\n                // If the current value for the dataset is null and the previous\n                // value of the data set is not null, then add an 'end' point\n                // to the chart for the previous value. Otherwise the gap will\n                // be too big. It will go from the start of the previous data\n                // value until the start of the next data value.\n                d.data.push({\n                  x: timestamp.getTime(),\n                  y: prevValues[i]\n                });\n              }\n              d.data.push({\n                x: timestamp.getTime(),\n                y: datavalues[i]\n              });\n            });\n            prevValues = datavalues;\n          };\n          const addDataSet = (nameY, fill = false, color) => {\n            if (!color) {\n              color = (0,_common_color_colors__WEBPACK_IMPORTED_MODULE_3__.getGraphColorByIndex)(colorIndex, computedStyles);\n              colorIndex++;\n            }\n            data.push({\n              label: nameY,\n              fill: fill ? \"origin\" : false,\n              borderColor: color,\n              backgroundColor: color + \"7F\",\n              stepped: \"before\",\n              pointRadius: 0,\n              data: []\n            });\n            entityIds.push(states.entity_id);\n            datasetToDataIndex.push(dataIdx);\n          };\n          if (domain === \"thermostat\" || domain === \"climate\" || domain === \"water_heater\") {\n            const hasHvacAction = states.states.some(entityState => {\n              var _entityState$attribut;\n              return (_entityState$attribut = entityState.attributes) === null || _entityState$attribut === void 0 ? void 0 : _entityState$attribut.hvac_action;\n            });\n            const isHeating = domain === \"climate\" && hasHvacAction ? entityState => {\n              var _entityState$attribut2;\n              return ((_entityState$attribut2 = entityState.attributes) === null || _entityState$attribut2 === void 0 ? void 0 : _entityState$attribut2.hvac_action) === \"heating\";\n            } : entityState => entityState.state === \"heat\";\n            const isCooling = domain === \"climate\" && hasHvacAction ? entityState => {\n              var _entityState$attribut3;\n              return ((_entityState$attribut3 = entityState.attributes) === null || _entityState$attribut3 === void 0 ? void 0 : _entityState$attribut3.hvac_action) === \"cooling\";\n            } : entityState => entityState.state === \"cool\";\n            const hasHeat = states.states.some(isHeating);\n            const hasCool = states.states.some(isCooling);\n            // We differentiate between thermostats that have a target temperature\n            // range versus ones that have just a target temperature\n\n            // Using step chart by step-before so manually interpolation not needed.\n            const hasTargetRange = states.states.some(entityState => entityState.attributes && entityState.attributes.target_temp_high !== entityState.attributes.target_temp_low);\n            addDataSet(`${this.hass.localize(\"ui.card.climate.current_temperature\", {\n              name: name\n            })}`);\n            if (hasHeat) {\n              addDataSet(`${this.hass.localize(\"ui.card.climate.heating\", {\n                name: name\n              })}`, true, computedStyles.getPropertyValue(\"--state-climate-heat-color\"));\n              // The \"heating\" series uses steppedArea to shade the area below the current\n              // temperature when the thermostat is calling for heat.\n            }\n            if (hasCool) {\n              addDataSet(`${this.hass.localize(\"ui.card.climate.cooling\", {\n                name: name\n              })}`, true, computedStyles.getPropertyValue(\"--state-climate-cool-color\"));\n              // The \"cooling\" series uses steppedArea to shade the area below the current\n              // temperature when the thermostat is calling for heat.\n            }\n            if (hasTargetRange) {\n              addDataSet(`${this.hass.localize(\"ui.card.climate.target_temperature_mode\", {\n                name: name,\n                mode: this.hass.localize(\"ui.card.climate.high\")\n              })}`);\n              addDataSet(`${this.hass.localize(\"ui.card.climate.target_temperature_mode\", {\n                name: name,\n                mode: this.hass.localize(\"ui.card.climate.low\")\n              })}`);\n            } else {\n              addDataSet(`${this.hass.localize(\"ui.card.climate.target_temperature_entity\", {\n                name: name\n              })}`);\n            }\n            states.states.forEach(entityState => {\n              if (!entityState.attributes) return;\n              const curTemp = safeParseFloat(entityState.attributes.current_temperature);\n              const series = [curTemp];\n              if (hasHeat) {\n                series.push(isHeating(entityState) ? curTemp : null);\n              }\n              if (hasCool) {\n                series.push(isCooling(entityState) ? curTemp : null);\n              }\n              if (hasTargetRange) {\n                const targetHigh = safeParseFloat(entityState.attributes.target_temp_high);\n                const targetLow = safeParseFloat(entityState.attributes.target_temp_low);\n                series.push(targetHigh, targetLow);\n                pushData(new Date(entityState.last_changed), series);\n              } else {\n                const target = safeParseFloat(entityState.attributes.temperature);\n                series.push(target);\n                pushData(new Date(entityState.last_changed), series);\n              }\n            });\n          } else if (domain === \"humidifier\") {\n            const hasAction = states.states.some(entityState => {\n              var _entityState$attribut4;\n              return (_entityState$attribut4 = entityState.attributes) === null || _entityState$attribut4 === void 0 ? void 0 : _entityState$attribut4.action;\n            });\n            const hasCurrent = states.states.some(entityState => {\n              var _entityState$attribut5;\n              return (_entityState$attribut5 = entityState.attributes) === null || _entityState$attribut5 === void 0 ? void 0 : _entityState$attribut5.current_humidity;\n            });\n            const hasHumidifying = hasAction && states.states.some(entityState => {\n              var _entityState$attribut6;\n              return ((_entityState$attribut6 = entityState.attributes) === null || _entityState$attribut6 === void 0 ? void 0 : _entityState$attribut6.action) === \"humidifying\";\n            });\n            const hasDrying = hasAction && states.states.some(entityState => {\n              var _entityState$attribut7;\n              return ((_entityState$attribut7 = entityState.attributes) === null || _entityState$attribut7 === void 0 ? void 0 : _entityState$attribut7.action) === \"drying\";\n            });\n            addDataSet(`${this.hass.localize(\"ui.card.humidifier.target_humidity_entity\", {\n              name: name\n            })}`);\n            if (hasCurrent) {\n              addDataSet(`${this.hass.localize(\"ui.card.humidifier.current_humidity_entity\", {\n                name: name\n              })}`);\n            }\n\n            // If action attribute is available, we used it to shade the area below the humidity.\n            // If action attribute is not available, we shade the area when the device is on\n            if (hasHumidifying) {\n              addDataSet(`${this.hass.localize(\"ui.card.humidifier.humidifying\", {\n                name: name\n              })}`, true, computedStyles.getPropertyValue(\"--state-humidifier-on-color\"));\n            } else if (hasDrying) {\n              addDataSet(`${this.hass.localize(\"ui.card.humidifier.drying\", {\n                name: name\n              })}`, true, computedStyles.getPropertyValue(\"--state-humidifier-on-color\"));\n            } else {\n              addDataSet(`${this.hass.localize(\"ui.card.humidifier.on_entity\", {\n                name: name\n              })}`, true);\n            }\n            states.states.forEach(entityState => {\n              var _entityState$attribut8;\n              if (!entityState.attributes) return;\n              const target = safeParseFloat(entityState.attributes.humidity);\n              // If the current humidity is not available, then we fill up to the target humidity\n              const current = hasCurrent ? safeParseFloat((_entityState$attribut8 = entityState.attributes) === null || _entityState$attribut8 === void 0 ? void 0 : _entityState$attribut8.current_humidity) : target;\n              const series = [target];\n              if (hasCurrent) {\n                series.push(current);\n              }\n              if (hasHumidifying) {\n                var _entityState$attribut9;\n                series.push(((_entityState$attribut9 = entityState.attributes) === null || _entityState$attribut9 === void 0 ? void 0 : _entityState$attribut9.action) === \"humidifying\" ? current : null);\n              } else if (hasDrying) {\n                var _entityState$attribut10;\n                series.push(((_entityState$attribut10 = entityState.attributes) === null || _entityState$attribut10 === void 0 ? void 0 : _entityState$attribut10.action) === \"drying\" ? current : null);\n              } else {\n                series.push(entityState.state === \"on\" ? current : null);\n              }\n              pushData(new Date(entityState.last_changed), series);\n            });\n          } else {\n            addDataSet(name);\n            let lastValue;\n            let lastDate;\n            let lastNullDate = null;\n\n            // Process chart data.\n            // When state is `unknown`, calculate the value and break the line.\n            const processData = entityState => {\n              const value = safeParseFloat(entityState.state);\n              const date = new Date(entityState.last_changed);\n              if (value !== null && lastNullDate) {\n                var _lastDate;\n                const dateTime = date.getTime();\n                const lastNullDateTime = lastNullDate.getTime();\n                const lastDateTime = (_lastDate = lastDate) === null || _lastDate === void 0 ? void 0 : _lastDate.getTime();\n                const tmpValue = (value - lastValue) * ((lastNullDateTime - lastDateTime) / (dateTime - lastDateTime)) + lastValue;\n                pushData(lastNullDate, [tmpValue]);\n                pushData(new Date(lastNullDateTime + 1), [null]);\n                pushData(date, [value]);\n                lastDate = date;\n                lastValue = value;\n                lastNullDate = null;\n              } else if (value !== null && lastNullDate === null) {\n                pushData(date, [value]);\n                lastDate = date;\n                lastValue = value;\n              } else if (value === null && lastNullDate === null && lastValue !== undefined) {\n                lastNullDate = date;\n              }\n            };\n            if (states.statistics) {\n              const stopTime = !states.states || states.states.length === 0 ? 0 : states.states[0].last_changed;\n              for (let i = 0; i < states.statistics.length; i++) {\n                if (stopTime && states.statistics[i].last_changed >= stopTime) {\n                  break;\n                }\n                processData(states.statistics[i]);\n              }\n            }\n            states.states.forEach(entityState => {\n              processData(entityState);\n            });\n            if (lastNullDate !== null) {\n              pushData(lastNullDate, [null]);\n            }\n          }\n\n          // Add an entry for final values\n          pushData(endTime, prevValues);\n\n          // Concat two arrays\n          Array.prototype.push.apply(datasets, data);\n        });\n        this._chartData = {\n          datasets\n        };\n        this._entityIds = entityIds;\n        this._datasetToDataIndex = datasetToDataIndex;\n      }\n    }]\n  };\n}, lit__WEBPACK_IMPORTED_MODULE_1__.LitElement);\ncustomElements.define(\"state-history-chart-line\", StateHistoryChartLine);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50cy9jaGFydC9zdGF0ZS1oaXN0b3J5LWNoYXJ0LWxpbmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUF5akJBO0FBQUE7QUFBQTtBQXpqQkE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVFBO0FBRUE7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBS0E7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUVBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQU1BO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFHQTtBQUFBO0FBQ0E7QUFFQTtBQUdBO0FBQUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFJQTtBQUNBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFHQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ob21lLWFzc2lzdGFudC1mcm9udGVuZC8uL3NyYy9jb21wb25lbnRzL2NoYXJ0L3N0YXRlLWhpc3RvcnktY2hhcnQtbGluZS50cz8zZTBiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQ2hhcnREYXRhLCBDaGFydERhdGFzZXQsIENoYXJ0T3B0aW9ucyB9IGZyb20gXCJjaGFydC5qc1wiO1xuaW1wb3J0IHsgaHRtbCwgTGl0RWxlbWVudCwgUHJvcGVydHlWYWx1ZXMgfSBmcm9tIFwibGl0XCI7XG5pbXBvcnQgeyBwcm9wZXJ0eSwgcXVlcnksIHN0YXRlIH0gZnJvbSBcImxpdC9kZWNvcmF0b3JzXCI7XG5pbXBvcnQgeyBnZXRHcmFwaENvbG9yQnlJbmRleCB9IGZyb20gXCIuLi8uLi9jb21tb24vY29sb3IvY29sb3JzXCI7XG5pbXBvcnQgeyBmaXJlRXZlbnQgfSBmcm9tIFwiLi4vLi4vY29tbW9uL2RvbS9maXJlX2V2ZW50XCI7XG5pbXBvcnQgeyBjb21wdXRlUlRMIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi91dGlsL2NvbXB1dGVfcnRsXCI7XG5pbXBvcnQge1xuICBmb3JtYXROdW1iZXIsXG4gIG51bWJlckZvcm1hdFRvTG9jYWxlLFxuICBnZXROdW1iZXJGb3JtYXRPcHRpb25zLFxufSBmcm9tIFwiLi4vLi4vY29tbW9uL251bWJlci9mb3JtYXRfbnVtYmVyXCI7XG5pbXBvcnQgeyBMaW5lQ2hhcnRFbnRpdHksIExpbmVDaGFydFN0YXRlIH0gZnJvbSBcIi4uLy4uL2RhdGEvaGlzdG9yeVwiO1xuaW1wb3J0IHsgSG9tZUFzc2lzdGFudCB9IGZyb20gXCIuLi8uLi90eXBlc1wiO1xuaW1wb3J0IHtcbiAgQ2hhcnRSZXNpemVPcHRpb25zLFxuICBIYUNoYXJ0QmFzZSxcbiAgTUlOX1RJTUVfQkVUV0VFTl9VUERBVEVTLFxufSBmcm9tIFwiLi9oYS1jaGFydC1iYXNlXCI7XG5cbmNvbnN0IHNhZmVQYXJzZUZsb2F0ID0gKHZhbHVlKSA9PiB7XG4gIGNvbnN0IHBhcnNlZCA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICByZXR1cm4gaXNGaW5pdGUocGFyc2VkKSA/IHBhcnNlZCA6IG51bGw7XG59O1xuXG5leHBvcnQgY2xhc3MgU3RhdGVIaXN0b3J5Q2hhcnRMaW5lIGV4dGVuZHMgTGl0RWxlbWVudCB7XG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIGhhc3MhOiBIb21lQXNzaXN0YW50O1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIGRhdGE6IExpbmVDaGFydEVudGl0eVtdID0gW107XG5cbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiBmYWxzZSB9KSBwdWJsaWMgbmFtZXM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXG4gIEBwcm9wZXJ0eSgpIHB1YmxpYyB1bml0Pzogc3RyaW5nO1xuXG4gIEBwcm9wZXJ0eSgpIHB1YmxpYyBpZGVudGlmaWVyPzogc3RyaW5nO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIHNob3dOYW1lcyA9IHRydWU7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiB9KSBwdWJsaWMgY2xpY2tGb3JNb3JlSW5mbyA9IHRydWU7XG5cbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiBmYWxzZSB9KSBwdWJsaWMgc3RhcnRUaW1lITogRGF0ZTtcblxuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBlbmRUaW1lITogRGF0ZTtcblxuICBAcHJvcGVydHkoeyB0eXBlOiBOdW1iZXIgfSkgcHVibGljIHBhZGRpbmdZQXhpcyA9IDA7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogTnVtYmVyIH0pIHB1YmxpYyBjaGFydEluZGV4PztcblxuICBAcHJvcGVydHkoeyB0eXBlOiBCb29sZWFuIH0pIHB1YmxpYyBsb2dhcml0aG1pY1NjYWxlID0gZmFsc2U7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogTnVtYmVyIH0pIHB1YmxpYyBtaW5ZQXhpcz86IG51bWJlcjtcblxuICBAcHJvcGVydHkoeyB0eXBlOiBOdW1iZXIgfSkgcHVibGljIG1heFlBeGlzPzogbnVtYmVyO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIGZpdFlEYXRhID0gZmFsc2U7XG5cbiAgQHN0YXRlKCkgcHJpdmF0ZSBfY2hhcnREYXRhPzogQ2hhcnREYXRhPFwibGluZVwiPjtcblxuICBAc3RhdGUoKSBwcml2YXRlIF9lbnRpdHlJZHM6IHN0cmluZ1tdID0gW107XG5cbiAgcHJpdmF0ZSBfZGF0YXNldFRvRGF0YUluZGV4OiBudW1iZXJbXSA9IFtdO1xuXG4gIEBzdGF0ZSgpIHByaXZhdGUgX2NoYXJ0T3B0aW9ucz86IENoYXJ0T3B0aW9ucztcblxuICBAc3RhdGUoKSBwcml2YXRlIF95V2lkdGggPSAwO1xuXG4gIHByaXZhdGUgX2NoYXJ0VGltZTogRGF0ZSA9IG5ldyBEYXRlKCk7XG5cbiAgQHF1ZXJ5KFwiaGEtY2hhcnQtYmFzZVwiKSBwcml2YXRlIF9jaGFydD86IEhhQ2hhcnRCYXNlO1xuXG4gIHB1YmxpYyByZXNpemUgPSAob3B0aW9ucz86IENoYXJ0UmVzaXplT3B0aW9ucyk6IHZvaWQgPT4ge1xuICAgIHRoaXMuX2NoYXJ0Py5yZXNpemUob3B0aW9ucyk7XG4gIH07XG5cbiAgcHJvdGVjdGVkIHJlbmRlcigpIHtcbiAgICByZXR1cm4gaHRtbGBcbiAgICAgIDxoYS1jaGFydC1iYXNlXG4gICAgICAgIC5oYXNzPSR7dGhpcy5oYXNzfVxuICAgICAgICAuZGF0YT0ke3RoaXMuX2NoYXJ0RGF0YX1cbiAgICAgICAgLm9wdGlvbnM9JHt0aGlzLl9jaGFydE9wdGlvbnN9XG4gICAgICAgIC5wYWRkaW5nWUF4aXM9JHt0aGlzLnBhZGRpbmdZQXhpcyAtIHRoaXMuX3lXaWR0aH1cbiAgICAgICAgY2hhcnQtdHlwZT1cImxpbmVcIlxuICAgICAgPjwvaGEtY2hhcnQtYmFzZT5cbiAgICBgO1xuICB9XG5cbiAgcHVibGljIHdpbGxVcGRhdGUoY2hhbmdlZFByb3BzOiBQcm9wZXJ0eVZhbHVlcykge1xuICAgIGlmIChcbiAgICAgICF0aGlzLmhhc1VwZGF0ZWQgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJzaG93TmFtZXNcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJzdGFydFRpbWVcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJlbmRUaW1lXCIpIHx8XG4gICAgICBjaGFuZ2VkUHJvcHMuaGFzKFwidW5pdFwiKSB8fFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcImxvZ2FyaXRobWljU2NhbGVcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJtaW5ZQXhpc1wiKSB8fFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcIm1heFlBeGlzXCIpIHx8XG4gICAgICBjaGFuZ2VkUHJvcHMuaGFzKFwiZml0WURhdGFcIilcbiAgICApIHtcbiAgICAgIHRoaXMuX2NoYXJ0T3B0aW9ucyA9IHtcbiAgICAgICAgcGFyc2luZzogZmFsc2UsXG4gICAgICAgIGFuaW1hdGlvbjogZmFsc2UsXG4gICAgICAgIGludGVyYWN0aW9uOiB7XG4gICAgICAgICAgbW9kZTogXCJuZWFyZXN0XCIsXG4gICAgICAgICAgYXhpczogXCJ4eVwiLFxuICAgICAgICB9LFxuICAgICAgICBzY2FsZXM6IHtcbiAgICAgICAgICB4OiB7XG4gICAgICAgICAgICB0eXBlOiBcInRpbWVcIixcbiAgICAgICAgICAgIGFkYXB0ZXJzOiB7XG4gICAgICAgICAgICAgIGRhdGU6IHtcbiAgICAgICAgICAgICAgICBsb2NhbGU6IHRoaXMuaGFzcy5sb2NhbGUsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB0aGlzLmhhc3MuY29uZmlnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Z2dlc3RlZE1pbjogdGhpcy5zdGFydFRpbWUsXG4gICAgICAgICAgICBzdWdnZXN0ZWRNYXg6IHRoaXMuZW5kVGltZSxcbiAgICAgICAgICAgIHRpY2tzOiB7XG4gICAgICAgICAgICAgIG1heFJvdGF0aW9uOiAwLFxuICAgICAgICAgICAgICBzYW1wbGVTaXplOiA1LFxuICAgICAgICAgICAgICBhdXRvU2tpcFBhZGRpbmc6IDIwLFxuICAgICAgICAgICAgICBtYWpvcjoge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGZvbnQ6IChjb250ZXh0KSA9PlxuICAgICAgICAgICAgICAgIGNvbnRleHQudGljayAmJiBjb250ZXh0LnRpY2subWFqb3JcbiAgICAgICAgICAgICAgICAgID8gKHsgd2VpZ2h0OiBcImJvbGRcIiB9IGFzIGFueSlcbiAgICAgICAgICAgICAgICAgIDoge30sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGltZToge1xuICAgICAgICAgICAgICB0b29sdGlwRm9ybWF0OiBcImRhdGV0aW1lc2Vjb25kc1wiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHk6IHtcbiAgICAgICAgICAgIHN1Z2dlc3RlZE1pbjogdGhpcy5maXRZRGF0YSA/IHRoaXMubWluWUF4aXMgOiBudWxsLFxuICAgICAgICAgICAgc3VnZ2VzdGVkTWF4OiB0aGlzLmZpdFlEYXRhID8gdGhpcy5tYXhZQXhpcyA6IG51bGwsXG4gICAgICAgICAgICBtaW46IHRoaXMuZml0WURhdGEgPyBudWxsIDogdGhpcy5taW5ZQXhpcyxcbiAgICAgICAgICAgIG1heDogdGhpcy5maXRZRGF0YSA/IG51bGwgOiB0aGlzLm1heFlBeGlzLFxuICAgICAgICAgICAgdGlja3M6IHtcbiAgICAgICAgICAgICAgbWF4VGlja3NMaW1pdDogNyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aXRsZToge1xuICAgICAgICAgICAgICBkaXNwbGF5OiB0cnVlLFxuICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnVuaXQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYWZ0ZXJVcGRhdGU6ICh5KSA9PiB7XG4gICAgICAgICAgICAgIGlmICh0aGlzLl95V2lkdGggIT09IE1hdGguZmxvb3IoeS53aWR0aCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl95V2lkdGggPSBNYXRoLmZsb29yKHkud2lkdGgpO1xuICAgICAgICAgICAgICAgIGZpcmVFdmVudCh0aGlzLCBcInktd2lkdGgtY2hhbmdlZFwiLCB7XG4gICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5feVdpZHRoLFxuICAgICAgICAgICAgICAgICAgY2hhcnRJbmRleDogdGhpcy5jaGFydEluZGV4LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcG9zaXRpb246IGNvbXB1dGVSVEwodGhpcy5oYXNzKSA/IFwicmlnaHRcIiA6IFwibGVmdFwiLFxuICAgICAgICAgICAgdHlwZTogdGhpcy5sb2dhcml0aG1pY1NjYWxlID8gXCJsb2dhcml0aG1pY1wiIDogXCJsaW5lYXJcIixcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBwbHVnaW5zOiB7XG4gICAgICAgICAgdG9vbHRpcDoge1xuICAgICAgICAgICAgY2FsbGJhY2tzOiB7XG4gICAgICAgICAgICAgIGxhYmVsOiAoY29udGV4dCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBsYWJlbCA9IGAke2NvbnRleHQuZGF0YXNldC5sYWJlbH06ICR7Zm9ybWF0TnVtYmVyKFxuICAgICAgICAgICAgICAgICAgY29udGV4dC5wYXJzZWQueSxcbiAgICAgICAgICAgICAgICAgIHRoaXMuaGFzcy5sb2NhbGUsXG4gICAgICAgICAgICAgICAgICBnZXROdW1iZXJGb3JtYXRPcHRpb25zKFxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzcy5lbnRpdGllc1t0aGlzLl9lbnRpdHlJZHNbY29udGV4dC5kYXRhc2V0SW5kZXhdXVxuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICl9ICR7dGhpcy51bml0fWA7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YUluZGV4ID1cbiAgICAgICAgICAgICAgICAgIHRoaXMuX2RhdGFzZXRUb0RhdGFJbmRleFtjb250ZXh0LmRhdGFzZXRJbmRleF07XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YVtkYXRhSW5kZXhdO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXRpc3RpY3MgJiYgZGF0YS5zdGF0aXN0aWNzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZSA9XG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdGVzLmxlbmd0aCA9PT0gMCB8fFxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnBhcnNlZC54IDwgZGF0YS5zdGF0ZXNbMF0ubGFzdF9jaGFuZ2VkXG4gICAgICAgICAgICAgICAgICAgICAgPyBgXFxuJHt0aGlzLmhhc3MubG9jYWxpemUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwidWkuY29tcG9uZW50cy5oaXN0b3J5X2NoYXJ0cy5zb3VyY2Vfc3RhdHNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1gXG4gICAgICAgICAgICAgICAgICAgICAgOiBgXFxuJHt0aGlzLmhhc3MubG9jYWxpemUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwidWkuY29tcG9uZW50cy5oaXN0b3J5X2NoYXJ0cy5zb3VyY2VfaGlzdG9yeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICApfWA7XG4gICAgICAgICAgICAgICAgICBsYWJlbCArPSBzb3VyY2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBmaWxsZXI6IHtcbiAgICAgICAgICAgIHByb3BhZ2F0ZTogdHJ1ZSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGxlZ2VuZDoge1xuICAgICAgICAgICAgZGlzcGxheTogdGhpcy5zaG93TmFtZXMsXG4gICAgICAgICAgICBsYWJlbHM6IHtcbiAgICAgICAgICAgICAgdXNlUG9pbnRTdHlsZTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgZWxlbWVudHM6IHtcbiAgICAgICAgICBsaW5lOiB7XG4gICAgICAgICAgICB0ZW5zaW9uOiAwLjEsXG4gICAgICAgICAgICBib3JkZXJXaWR0aDogMS41LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcG9pbnQ6IHtcbiAgICAgICAgICAgIGhpdFJhZGl1czogNTAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgc2VnbWVudDoge1xuICAgICAgICAgIGJvcmRlckNvbG9yOiAoY29udGV4dCkgPT4ge1xuICAgICAgICAgICAgLy8gcmVuZGVyIHN0YXQgZGF0YSB3aXRoIGEgc2xpZ2h0bHkgdHJhbnNwYXJlbnQgbGluZVxuICAgICAgICAgICAgY29uc3QgZGF0YUluZGV4ID0gdGhpcy5fZGF0YXNldFRvRGF0YUluZGV4W2NvbnRleHQuZGF0YXNldEluZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGFbZGF0YUluZGV4XTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLnN0YXRpc3RpY3MgJiZcbiAgICAgICAgICAgICAgZGF0YS5zdGF0aXN0aWNzLmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICAgICAgKGRhdGEuc3RhdGVzLmxlbmd0aCA9PT0gMCB8fFxuICAgICAgICAgICAgICAgIGNvbnRleHQucDAucGFyc2VkLnggPCBkYXRhLnN0YXRlc1swXS5sYXN0X2NoYW5nZWQpXG4gICAgICAgICAgICAgID8gdGhpcy5fY2hhcnREYXRhIS5kYXRhc2V0c1tkYXRhSW5kZXhdLmJvcmRlckNvbG9yICsgXCI3RlwiXG4gICAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgICAgICAgbG9jYWxlOiBudW1iZXJGb3JtYXRUb0xvY2FsZSh0aGlzLmhhc3MubG9jYWxlKSxcbiAgICAgICAgb25DbGljazogKGU6IGFueSkgPT4ge1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICF0aGlzLmNsaWNrRm9yTW9yZUluZm8gfHxcbiAgICAgICAgICAgICEoZS5uYXRpdmUgaW5zdGFuY2VvZiBNb3VzZUV2ZW50KSB8fFxuICAgICAgICAgICAgKGUubmF0aXZlIGluc3RhbmNlb2YgUG9pbnRlckV2ZW50ICYmXG4gICAgICAgICAgICAgIGUubmF0aXZlLnBvaW50ZXJUeXBlICE9PSBcIm1vdXNlXCIpXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgY2hhcnQgPSBlLmNoYXJ0O1xuXG4gICAgICAgICAgY29uc3QgcG9pbnRzID0gY2hhcnQuZ2V0RWxlbWVudHNBdEV2ZW50Rm9yTW9kZShcbiAgICAgICAgICAgIGUsXG4gICAgICAgICAgICBcIm5lYXJlc3RcIixcbiAgICAgICAgICAgIHsgaW50ZXJzZWN0OiB0cnVlIH0sXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIGlmIChwb2ludHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBmaXJzdFBvaW50ID0gcG9pbnRzWzBdO1xuICAgICAgICAgICAgZmlyZUV2ZW50KHRoaXMsIFwiaGFzcy1tb3JlLWluZm9cIiwge1xuICAgICAgICAgICAgICBlbnRpdHlJZDogdGhpcy5fZW50aXR5SWRzW2ZpcnN0UG9pbnQuZGF0YXNldEluZGV4XSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2hhcnQuY2FudmFzLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwibW91c2VvdXRcIikpOyAvLyB0byBoaWRlIHRvb2x0aXBcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAoXG4gICAgICBjaGFuZ2VkUHJvcHMuaGFzKFwiZGF0YVwiKSB8fFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcInN0YXJ0VGltZVwiKSB8fFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcImVuZFRpbWVcIikgfHxcbiAgICAgIHRoaXMuX2NoYXJ0VGltZSA8XG4gICAgICAgIG5ldyBEYXRlKHRoaXMuZW5kVGltZS5nZXRUaW1lKCkgLSBNSU5fVElNRV9CRVRXRUVOX1VQREFURVMpXG4gICAgKSB7XG4gICAgICAvLyBJZiB0aGUgbGluZSBpcyBtb3JlIHRoYW4gNSBtaW51dGVzIG9sZCwgcmUtZ2VuIGl0XG4gICAgICAvLyBzbyB0aGUgWCBheGlzIGdyb3dzIGV2ZW4gaWYgdGhlcmUgaXMgbm8gbmV3IGRhdGFcbiAgICAgIHRoaXMuX2dlbmVyYXRlRGF0YSgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX2dlbmVyYXRlRGF0YSgpIHtcbiAgICBsZXQgY29sb3JJbmRleCA9IDA7XG4gICAgY29uc3QgY29tcHV0ZWRTdHlsZXMgPSBnZXRDb21wdXRlZFN0eWxlKHRoaXMpO1xuICAgIGNvbnN0IGVudGl0eVN0YXRlcyA9IHRoaXMuZGF0YTtcbiAgICBjb25zdCBkYXRhc2V0czogQ2hhcnREYXRhc2V0PFwibGluZVwiPltdID0gW107XG4gICAgY29uc3QgZW50aXR5SWRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IGRhdGFzZXRUb0RhdGFJbmRleDogbnVtYmVyW10gPSBbXTtcbiAgICBpZiAoZW50aXR5U3RhdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX2NoYXJ0VGltZSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgZW5kVGltZSA9IHRoaXMuZW5kVGltZTtcbiAgICBjb25zdCBuYW1lcyA9IHRoaXMubmFtZXMgfHwge307XG4gICAgZW50aXR5U3RhdGVzLmZvckVhY2goKHN0YXRlcywgZGF0YUlkeCkgPT4ge1xuICAgICAgY29uc3QgZG9tYWluID0gc3RhdGVzLmRvbWFpbjtcbiAgICAgIGNvbnN0IG5hbWUgPSBuYW1lc1tzdGF0ZXMuZW50aXR5X2lkXSB8fCBzdGF0ZXMubmFtZTtcbiAgICAgIC8vIGFycmF5IGNvbnRhaW5pbmcgW3ZhbHVlMSwgdmFsdWUyLCBldGNdXG4gICAgICBsZXQgcHJldlZhbHVlczogYW55W10gfCBudWxsID0gbnVsbDtcblxuICAgICAgY29uc3QgZGF0YTogQ2hhcnREYXRhc2V0PFwibGluZVwiPltdID0gW107XG5cbiAgICAgIGNvbnN0IHB1c2hEYXRhID0gKHRpbWVzdGFtcDogRGF0ZSwgZGF0YXZhbHVlczogYW55W10gfCBudWxsKSA9PiB7XG4gICAgICAgIGlmICghZGF0YXZhbHVlcykgcmV0dXJuO1xuICAgICAgICBpZiAodGltZXN0YW1wID4gZW5kVGltZSkge1xuICAgICAgICAgIC8vIERyb3AgZGF0YSBwb2ludHMgdGhhdCBhcmUgYWZ0ZXIgdGhlIHJlcXVlc3RlZCBlbmRUaW1lLiBUaGlzIGNvdWxkIGhhcHBlbiBpZlxuICAgICAgICAgIC8vIGVuZFRpbWUgaXMgXCJub3dcIiBhbmQgY2xpZW50IHRpbWUgaXMgbm90IGluIHN5bmMgd2l0aCBzZXJ2ZXIgdGltZS5cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZGF0YS5mb3JFYWNoKChkLCBpKSA9PiB7XG4gICAgICAgICAgaWYgKGRhdGF2YWx1ZXNbaV0gPT09IG51bGwgJiYgcHJldlZhbHVlcyAmJiBwcmV2VmFsdWVzW2ldICE9PSBudWxsKSB7XG4gICAgICAgICAgICAvLyBudWxsIGRhdGEgdmFsdWVzIHNob3cgdXAgYXMgZ2FwcyBpbiB0aGUgY2hhcnQuXG4gICAgICAgICAgICAvLyBJZiB0aGUgY3VycmVudCB2YWx1ZSBmb3IgdGhlIGRhdGFzZXQgaXMgbnVsbCBhbmQgdGhlIHByZXZpb3VzXG4gICAgICAgICAgICAvLyB2YWx1ZSBvZiB0aGUgZGF0YSBzZXQgaXMgbm90IG51bGwsIHRoZW4gYWRkIGFuICdlbmQnIHBvaW50XG4gICAgICAgICAgICAvLyB0byB0aGUgY2hhcnQgZm9yIHRoZSBwcmV2aW91cyB2YWx1ZS4gT3RoZXJ3aXNlIHRoZSBnYXAgd2lsbFxuICAgICAgICAgICAgLy8gYmUgdG9vIGJpZy4gSXQgd2lsbCBnbyBmcm9tIHRoZSBzdGFydCBvZiB0aGUgcHJldmlvdXMgZGF0YVxuICAgICAgICAgICAgLy8gdmFsdWUgdW50aWwgdGhlIHN0YXJ0IG9mIHRoZSBuZXh0IGRhdGEgdmFsdWUuXG4gICAgICAgICAgICBkLmRhdGEucHVzaCh7IHg6IHRpbWVzdGFtcC5nZXRUaW1lKCksIHk6IHByZXZWYWx1ZXNbaV0gfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGQuZGF0YS5wdXNoKHsgeDogdGltZXN0YW1wLmdldFRpbWUoKSwgeTogZGF0YXZhbHVlc1tpXSB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHByZXZWYWx1ZXMgPSBkYXRhdmFsdWVzO1xuICAgICAgfTtcblxuICAgICAgY29uc3QgYWRkRGF0YVNldCA9IChuYW1lWTogc3RyaW5nLCBmaWxsID0gZmFsc2UsIGNvbG9yPzogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICghY29sb3IpIHtcbiAgICAgICAgICBjb2xvciA9IGdldEdyYXBoQ29sb3JCeUluZGV4KGNvbG9ySW5kZXgsIGNvbXB1dGVkU3R5bGVzKTtcbiAgICAgICAgICBjb2xvckluZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgICBsYWJlbDogbmFtZVksXG4gICAgICAgICAgZmlsbDogZmlsbCA/IFwib3JpZ2luXCIgOiBmYWxzZSxcbiAgICAgICAgICBib3JkZXJDb2xvcjogY29sb3IsXG4gICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBjb2xvciArIFwiN0ZcIixcbiAgICAgICAgICBzdGVwcGVkOiBcImJlZm9yZVwiLFxuICAgICAgICAgIHBvaW50UmFkaXVzOiAwLFxuICAgICAgICAgIGRhdGE6IFtdLFxuICAgICAgICB9KTtcbiAgICAgICAgZW50aXR5SWRzLnB1c2goc3RhdGVzLmVudGl0eV9pZCk7XG4gICAgICAgIGRhdGFzZXRUb0RhdGFJbmRleC5wdXNoKGRhdGFJZHgpO1xuICAgICAgfTtcblxuICAgICAgaWYgKFxuICAgICAgICBkb21haW4gPT09IFwidGhlcm1vc3RhdFwiIHx8XG4gICAgICAgIGRvbWFpbiA9PT0gXCJjbGltYXRlXCIgfHxcbiAgICAgICAgZG9tYWluID09PSBcIndhdGVyX2hlYXRlclwiXG4gICAgICApIHtcbiAgICAgICAgY29uc3QgaGFzSHZhY0FjdGlvbiA9IHN0YXRlcy5zdGF0ZXMuc29tZShcbiAgICAgICAgICAoZW50aXR5U3RhdGUpID0+IGVudGl0eVN0YXRlLmF0dHJpYnV0ZXM/Lmh2YWNfYWN0aW9uXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgaXNIZWF0aW5nID1cbiAgICAgICAgICBkb21haW4gPT09IFwiY2xpbWF0ZVwiICYmIGhhc0h2YWNBY3Rpb25cbiAgICAgICAgICAgID8gKGVudGl0eVN0YXRlOiBMaW5lQ2hhcnRTdGF0ZSkgPT5cbiAgICAgICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzPy5odmFjX2FjdGlvbiA9PT0gXCJoZWF0aW5nXCJcbiAgICAgICAgICAgIDogKGVudGl0eVN0YXRlOiBMaW5lQ2hhcnRTdGF0ZSkgPT4gZW50aXR5U3RhdGUuc3RhdGUgPT09IFwiaGVhdFwiO1xuICAgICAgICBjb25zdCBpc0Nvb2xpbmcgPVxuICAgICAgICAgIGRvbWFpbiA9PT0gXCJjbGltYXRlXCIgJiYgaGFzSHZhY0FjdGlvblxuICAgICAgICAgICAgPyAoZW50aXR5U3RhdGU6IExpbmVDaGFydFN0YXRlKSA9PlxuICAgICAgICAgICAgICAgIGVudGl0eVN0YXRlLmF0dHJpYnV0ZXM/Lmh2YWNfYWN0aW9uID09PSBcImNvb2xpbmdcIlxuICAgICAgICAgICAgOiAoZW50aXR5U3RhdGU6IExpbmVDaGFydFN0YXRlKSA9PiBlbnRpdHlTdGF0ZS5zdGF0ZSA9PT0gXCJjb29sXCI7XG5cbiAgICAgICAgY29uc3QgaGFzSGVhdCA9IHN0YXRlcy5zdGF0ZXMuc29tZShpc0hlYXRpbmcpO1xuICAgICAgICBjb25zdCBoYXNDb29sID0gc3RhdGVzLnN0YXRlcy5zb21lKGlzQ29vbGluZyk7XG4gICAgICAgIC8vIFdlIGRpZmZlcmVudGlhdGUgYmV0d2VlbiB0aGVybW9zdGF0cyB0aGF0IGhhdmUgYSB0YXJnZXQgdGVtcGVyYXR1cmVcbiAgICAgICAgLy8gcmFuZ2UgdmVyc3VzIG9uZXMgdGhhdCBoYXZlIGp1c3QgYSB0YXJnZXQgdGVtcGVyYXR1cmVcblxuICAgICAgICAvLyBVc2luZyBzdGVwIGNoYXJ0IGJ5IHN0ZXAtYmVmb3JlIHNvIG1hbnVhbGx5IGludGVycG9sYXRpb24gbm90IG5lZWRlZC5cbiAgICAgICAgY29uc3QgaGFzVGFyZ2V0UmFuZ2UgPSBzdGF0ZXMuc3RhdGVzLnNvbWUoXG4gICAgICAgICAgKGVudGl0eVN0YXRlKSA9PlxuICAgICAgICAgICAgZW50aXR5U3RhdGUuYXR0cmlidXRlcyAmJlxuICAgICAgICAgICAgZW50aXR5U3RhdGUuYXR0cmlidXRlcy50YXJnZXRfdGVtcF9oaWdoICE9PVxuICAgICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzLnRhcmdldF90ZW1wX2xvd1xuICAgICAgICApO1xuICAgICAgICBhZGREYXRhU2V0KFxuICAgICAgICAgIGAke3RoaXMuaGFzcy5sb2NhbGl6ZShcInVpLmNhcmQuY2xpbWF0ZS5jdXJyZW50X3RlbXBlcmF0dXJlXCIsIHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgfSl9YFxuICAgICAgICApO1xuICAgICAgICBpZiAoaGFzSGVhdCkge1xuICAgICAgICAgIGFkZERhdGFTZXQoXG4gICAgICAgICAgICBgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmNsaW1hdGUuaGVhdGluZ1wiLCB7IG5hbWU6IG5hbWUgfSl9YCxcbiAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICBjb21wdXRlZFN0eWxlcy5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1zdGF0ZS1jbGltYXRlLWhlYXQtY29sb3JcIilcbiAgICAgICAgICApO1xuICAgICAgICAgIC8vIFRoZSBcImhlYXRpbmdcIiBzZXJpZXMgdXNlcyBzdGVwcGVkQXJlYSB0byBzaGFkZSB0aGUgYXJlYSBiZWxvdyB0aGUgY3VycmVudFxuICAgICAgICAgIC8vIHRlbXBlcmF0dXJlIHdoZW4gdGhlIHRoZXJtb3N0YXQgaXMgY2FsbGluZyBmb3IgaGVhdC5cbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFzQ29vbCkge1xuICAgICAgICAgIGFkZERhdGFTZXQoXG4gICAgICAgICAgICBgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmNsaW1hdGUuY29vbGluZ1wiLCB7IG5hbWU6IG5hbWUgfSl9YCxcbiAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICBjb21wdXRlZFN0eWxlcy5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1zdGF0ZS1jbGltYXRlLWNvb2wtY29sb3JcIilcbiAgICAgICAgICApO1xuICAgICAgICAgIC8vIFRoZSBcImNvb2xpbmdcIiBzZXJpZXMgdXNlcyBzdGVwcGVkQXJlYSB0byBzaGFkZSB0aGUgYXJlYSBiZWxvdyB0aGUgY3VycmVudFxuICAgICAgICAgIC8vIHRlbXBlcmF0dXJlIHdoZW4gdGhlIHRoZXJtb3N0YXQgaXMgY2FsbGluZyBmb3IgaGVhdC5cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChoYXNUYXJnZXRSYW5nZSkge1xuICAgICAgICAgIGFkZERhdGFTZXQoXG4gICAgICAgICAgICBgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmNsaW1hdGUudGFyZ2V0X3RlbXBlcmF0dXJlX21vZGVcIiwge1xuICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICBtb2RlOiB0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmNsaW1hdGUuaGlnaFwiKSxcbiAgICAgICAgICAgIH0pfWBcbiAgICAgICAgICApO1xuICAgICAgICAgIGFkZERhdGFTZXQoXG4gICAgICAgICAgICBgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmNsaW1hdGUudGFyZ2V0X3RlbXBlcmF0dXJlX21vZGVcIiwge1xuICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICBtb2RlOiB0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmNsaW1hdGUubG93XCIpLFxuICAgICAgICAgICAgfSl9YFxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWRkRGF0YVNldChcbiAgICAgICAgICAgIGAke3RoaXMuaGFzcy5sb2NhbGl6ZShcInVpLmNhcmQuY2xpbWF0ZS50YXJnZXRfdGVtcGVyYXR1cmVfZW50aXR5XCIsIHtcbiAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIH0pfWBcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGVzLnN0YXRlcy5mb3JFYWNoKChlbnRpdHlTdGF0ZSkgPT4ge1xuICAgICAgICAgIGlmICghZW50aXR5U3RhdGUuYXR0cmlidXRlcykgcmV0dXJuO1xuICAgICAgICAgIGNvbnN0IGN1clRlbXAgPSBzYWZlUGFyc2VGbG9hdChcbiAgICAgICAgICAgIGVudGl0eVN0YXRlLmF0dHJpYnV0ZXMuY3VycmVudF90ZW1wZXJhdHVyZVxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3Qgc2VyaWVzID0gW2N1clRlbXBdO1xuICAgICAgICAgIGlmIChoYXNIZWF0KSB7XG4gICAgICAgICAgICBzZXJpZXMucHVzaChpc0hlYXRpbmcoZW50aXR5U3RhdGUpID8gY3VyVGVtcCA6IG51bGwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaGFzQ29vbCkge1xuICAgICAgICAgICAgc2VyaWVzLnB1c2goaXNDb29saW5nKGVudGl0eVN0YXRlKSA/IGN1clRlbXAgOiBudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGhhc1RhcmdldFJhbmdlKSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRIaWdoID0gc2FmZVBhcnNlRmxvYXQoXG4gICAgICAgICAgICAgIGVudGl0eVN0YXRlLmF0dHJpYnV0ZXMudGFyZ2V0X3RlbXBfaGlnaFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldExvdyA9IHNhZmVQYXJzZUZsb2F0KFxuICAgICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzLnRhcmdldF90ZW1wX2xvd1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHNlcmllcy5wdXNoKHRhcmdldEhpZ2gsIHRhcmdldExvdyk7XG4gICAgICAgICAgICBwdXNoRGF0YShuZXcgRGF0ZShlbnRpdHlTdGF0ZS5sYXN0X2NoYW5nZWQpLCBzZXJpZXMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBzYWZlUGFyc2VGbG9hdChlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzLnRlbXBlcmF0dXJlKTtcbiAgICAgICAgICAgIHNlcmllcy5wdXNoKHRhcmdldCk7XG4gICAgICAgICAgICBwdXNoRGF0YShuZXcgRGF0ZShlbnRpdHlTdGF0ZS5sYXN0X2NoYW5nZWQpLCBzZXJpZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGRvbWFpbiA9PT0gXCJodW1pZGlmaWVyXCIpIHtcbiAgICAgICAgY29uc3QgaGFzQWN0aW9uID0gc3RhdGVzLnN0YXRlcy5zb21lKFxuICAgICAgICAgIChlbnRpdHlTdGF0ZSkgPT4gZW50aXR5U3RhdGUuYXR0cmlidXRlcz8uYWN0aW9uXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGhhc0N1cnJlbnQgPSBzdGF0ZXMuc3RhdGVzLnNvbWUoXG4gICAgICAgICAgKGVudGl0eVN0YXRlKSA9PiBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzPy5jdXJyZW50X2h1bWlkaXR5XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgaGFzSHVtaWRpZnlpbmcgPVxuICAgICAgICAgIGhhc0FjdGlvbiAmJlxuICAgICAgICAgIHN0YXRlcy5zdGF0ZXMuc29tZShcbiAgICAgICAgICAgIChlbnRpdHlTdGF0ZTogTGluZUNoYXJ0U3RhdGUpID0+XG4gICAgICAgICAgICAgIGVudGl0eVN0YXRlLmF0dHJpYnV0ZXM/LmFjdGlvbiA9PT0gXCJodW1pZGlmeWluZ1wiXG4gICAgICAgICAgKTtcbiAgICAgICAgY29uc3QgaGFzRHJ5aW5nID1cbiAgICAgICAgICBoYXNBY3Rpb24gJiZcbiAgICAgICAgICBzdGF0ZXMuc3RhdGVzLnNvbWUoXG4gICAgICAgICAgICAoZW50aXR5U3RhdGU6IExpbmVDaGFydFN0YXRlKSA9PlxuICAgICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzPy5hY3Rpb24gPT09IFwiZHJ5aW5nXCJcbiAgICAgICAgICApO1xuXG4gICAgICAgIGFkZERhdGFTZXQoXG4gICAgICAgICAgYCR7dGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY2FyZC5odW1pZGlmaWVyLnRhcmdldF9odW1pZGl0eV9lbnRpdHlcIiwge1xuICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICB9KX1gXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKGhhc0N1cnJlbnQpIHtcbiAgICAgICAgICBhZGREYXRhU2V0KFxuICAgICAgICAgICAgYCR7dGhpcy5oYXNzLmxvY2FsaXplKFxuICAgICAgICAgICAgICBcInVpLmNhcmQuaHVtaWRpZmllci5jdXJyZW50X2h1bWlkaXR5X2VudGl0eVwiLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKX1gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIGFjdGlvbiBhdHRyaWJ1dGUgaXMgYXZhaWxhYmxlLCB3ZSB1c2VkIGl0IHRvIHNoYWRlIHRoZSBhcmVhIGJlbG93IHRoZSBodW1pZGl0eS5cbiAgICAgICAgLy8gSWYgYWN0aW9uIGF0dHJpYnV0ZSBpcyBub3QgYXZhaWxhYmxlLCB3ZSBzaGFkZSB0aGUgYXJlYSB3aGVuIHRoZSBkZXZpY2UgaXMgb25cbiAgICAgICAgaWYgKGhhc0h1bWlkaWZ5aW5nKSB7XG4gICAgICAgICAgYWRkRGF0YVNldChcbiAgICAgICAgICAgIGAke3RoaXMuaGFzcy5sb2NhbGl6ZShcInVpLmNhcmQuaHVtaWRpZmllci5odW1pZGlmeWluZ1wiLCB7XG4gICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICB9KX1gLFxuICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgIGNvbXB1dGVkU3R5bGVzLmdldFByb3BlcnR5VmFsdWUoXCItLXN0YXRlLWh1bWlkaWZpZXItb24tY29sb3JcIilcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2UgaWYgKGhhc0RyeWluZykge1xuICAgICAgICAgIGFkZERhdGFTZXQoXG4gICAgICAgICAgICBgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jYXJkLmh1bWlkaWZpZXIuZHJ5aW5nXCIsIHtcbiAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIH0pfWAsXG4gICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgY29tcHV0ZWRTdHlsZXMuZ2V0UHJvcGVydHlWYWx1ZShcIi0tc3RhdGUtaHVtaWRpZmllci1vbi1jb2xvclwiKVxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWRkRGF0YVNldChcbiAgICAgICAgICAgIGAke3RoaXMuaGFzcy5sb2NhbGl6ZShcInVpLmNhcmQuaHVtaWRpZmllci5vbl9lbnRpdHlcIiwge1xuICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgfSl9YCxcbiAgICAgICAgICAgIHRydWVcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGVzLnN0YXRlcy5mb3JFYWNoKChlbnRpdHlTdGF0ZSkgPT4ge1xuICAgICAgICAgIGlmICghZW50aXR5U3RhdGUuYXR0cmlidXRlcykgcmV0dXJuO1xuICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHNhZmVQYXJzZUZsb2F0KGVudGl0eVN0YXRlLmF0dHJpYnV0ZXMuaHVtaWRpdHkpO1xuICAgICAgICAgIC8vIElmIHRoZSBjdXJyZW50IGh1bWlkaXR5IGlzIG5vdCBhdmFpbGFibGUsIHRoZW4gd2UgZmlsbCB1cCB0byB0aGUgdGFyZ2V0IGh1bWlkaXR5XG4gICAgICAgICAgY29uc3QgY3VycmVudCA9IGhhc0N1cnJlbnRcbiAgICAgICAgICAgID8gc2FmZVBhcnNlRmxvYXQoZW50aXR5U3RhdGUuYXR0cmlidXRlcz8uY3VycmVudF9odW1pZGl0eSlcbiAgICAgICAgICAgIDogdGFyZ2V0O1xuICAgICAgICAgIGNvbnN0IHNlcmllcyA9IFt0YXJnZXRdO1xuXG4gICAgICAgICAgaWYgKGhhc0N1cnJlbnQpIHtcbiAgICAgICAgICAgIHNlcmllcy5wdXNoKGN1cnJlbnQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChoYXNIdW1pZGlmeWluZykge1xuICAgICAgICAgICAgc2VyaWVzLnB1c2goXG4gICAgICAgICAgICAgIGVudGl0eVN0YXRlLmF0dHJpYnV0ZXM/LmFjdGlvbiA9PT0gXCJodW1pZGlmeWluZ1wiID8gY3VycmVudCA6IG51bGxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNEcnlpbmcpIHtcbiAgICAgICAgICAgIHNlcmllcy5wdXNoKFxuICAgICAgICAgICAgICBlbnRpdHlTdGF0ZS5hdHRyaWJ1dGVzPy5hY3Rpb24gPT09IFwiZHJ5aW5nXCIgPyBjdXJyZW50IDogbnVsbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VyaWVzLnB1c2goZW50aXR5U3RhdGUuc3RhdGUgPT09IFwib25cIiA/IGN1cnJlbnQgOiBudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcHVzaERhdGEobmV3IERhdGUoZW50aXR5U3RhdGUubGFzdF9jaGFuZ2VkKSwgc2VyaWVzKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhZGREYXRhU2V0KG5hbWUpO1xuXG4gICAgICAgIGxldCBsYXN0VmFsdWU6IG51bWJlcjtcbiAgICAgICAgbGV0IGxhc3REYXRlOiBEYXRlO1xuICAgICAgICBsZXQgbGFzdE51bGxEYXRlOiBEYXRlIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgICAgLy8gUHJvY2VzcyBjaGFydCBkYXRhLlxuICAgICAgICAvLyBXaGVuIHN0YXRlIGlzIGB1bmtub3duYCwgY2FsY3VsYXRlIHRoZSB2YWx1ZSBhbmQgYnJlYWsgdGhlIGxpbmUuXG4gICAgICAgIGNvbnN0IHByb2Nlc3NEYXRhID0gKGVudGl0eVN0YXRlOiBMaW5lQ2hhcnRTdGF0ZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHZhbHVlID0gc2FmZVBhcnNlRmxvYXQoZW50aXR5U3RhdGUuc3RhdGUpO1xuICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShlbnRpdHlTdGF0ZS5sYXN0X2NoYW5nZWQpO1xuICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiBsYXN0TnVsbERhdGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGVUaW1lID0gZGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICBjb25zdCBsYXN0TnVsbERhdGVUaW1lID0gbGFzdE51bGxEYXRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgIGNvbnN0IGxhc3REYXRlVGltZSA9IGxhc3REYXRlPy5nZXRUaW1lKCk7XG4gICAgICAgICAgICBjb25zdCB0bXBWYWx1ZSA9XG4gICAgICAgICAgICAgICh2YWx1ZSAtIGxhc3RWYWx1ZSkgKlxuICAgICAgICAgICAgICAgICgobGFzdE51bGxEYXRlVGltZSAtIGxhc3REYXRlVGltZSkgL1xuICAgICAgICAgICAgICAgICAgKGRhdGVUaW1lIC0gbGFzdERhdGVUaW1lKSkgK1xuICAgICAgICAgICAgICBsYXN0VmFsdWU7XG4gICAgICAgICAgICBwdXNoRGF0YShsYXN0TnVsbERhdGUsIFt0bXBWYWx1ZV0pO1xuICAgICAgICAgICAgcHVzaERhdGEobmV3IERhdGUobGFzdE51bGxEYXRlVGltZSArIDEpLCBbbnVsbF0pO1xuICAgICAgICAgICAgcHVzaERhdGEoZGF0ZSwgW3ZhbHVlXSk7XG4gICAgICAgICAgICBsYXN0RGF0ZSA9IGRhdGU7XG4gICAgICAgICAgICBsYXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIGxhc3ROdWxsRGF0ZSA9IG51bGw7XG4gICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiBsYXN0TnVsbERhdGUgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHB1c2hEYXRhKGRhdGUsIFt2YWx1ZV0pO1xuICAgICAgICAgICAgbGFzdERhdGUgPSBkYXRlO1xuICAgICAgICAgICAgbGFzdFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgIHZhbHVlID09PSBudWxsICYmXG4gICAgICAgICAgICBsYXN0TnVsbERhdGUgPT09IG51bGwgJiZcbiAgICAgICAgICAgIGxhc3RWYWx1ZSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBsYXN0TnVsbERhdGUgPSBkYXRlO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoc3RhdGVzLnN0YXRpc3RpY3MpIHtcbiAgICAgICAgICBjb25zdCBzdG9wVGltZSA9XG4gICAgICAgICAgICAhc3RhdGVzLnN0YXRlcyB8fCBzdGF0ZXMuc3RhdGVzLmxlbmd0aCA9PT0gMFxuICAgICAgICAgICAgICA/IDBcbiAgICAgICAgICAgICAgOiBzdGF0ZXMuc3RhdGVzWzBdLmxhc3RfY2hhbmdlZDtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlcy5zdGF0aXN0aWNzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc3RvcFRpbWUgJiYgc3RhdGVzLnN0YXRpc3RpY3NbaV0ubGFzdF9jaGFuZ2VkID49IHN0b3BUaW1lKSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJvY2Vzc0RhdGEoc3RhdGVzLnN0YXRpc3RpY3NbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzdGF0ZXMuc3RhdGVzLmZvckVhY2goKGVudGl0eVN0YXRlKSA9PiB7XG4gICAgICAgICAgcHJvY2Vzc0RhdGEoZW50aXR5U3RhdGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGxhc3ROdWxsRGF0ZSAhPT0gbnVsbCkge1xuICAgICAgICAgIHB1c2hEYXRhKGxhc3ROdWxsRGF0ZSwgW251bGxdKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBBZGQgYW4gZW50cnkgZm9yIGZpbmFsIHZhbHVlc1xuICAgICAgcHVzaERhdGEoZW5kVGltZSwgcHJldlZhbHVlcyk7XG5cbiAgICAgIC8vIENvbmNhdCB0d28gYXJyYXlzXG4gICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShkYXRhc2V0cywgZGF0YSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jaGFydERhdGEgPSB7XG4gICAgICBkYXRhc2V0cyxcbiAgICB9O1xuICAgIHRoaXMuX2VudGl0eUlkcyA9IGVudGl0eUlkcztcbiAgICB0aGlzLl9kYXRhc2V0VG9EYXRhSW5kZXggPSBkYXRhc2V0VG9EYXRhSW5kZXg7XG4gIH1cbn1cbmN1c3RvbUVsZW1lbnRzLmRlZmluZShcInN0YXRlLWhpc3RvcnktY2hhcnQtbGluZVwiLCBTdGF0ZUhpc3RvcnlDaGFydExpbmUpO1xuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBIVE1MRWxlbWVudFRhZ05hbWVNYXAge1xuICAgIFwic3RhdGUtaGlzdG9yeS1jaGFydC1saW5lXCI6IFN0YXRlSGlzdG9yeUNoYXJ0TGluZTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/components/chart/state-history-chart-line.ts\n");

/***/ }),

/***/ "./src/components/chart/state-history-chart-timeline.ts":
/*!**************************************************************!*\
  !*** ./src/components/chart/state-history-chart-timeline.ts ***!
  \**************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StateHistoryChartTimeline: () => (/* binding */ StateHistoryChartTimeline)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/decorate */ \"./node_modules/@babel/runtime/helpers/esm/decorate.js\");\n/* harmony import */ var chart_js_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! chart.js/helpers */ \"./node_modules/chart.js/helpers/helpers.js\");\n/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit */ \"./node_modules/lit/index.js\");\n/* harmony import */ var lit_decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lit/decorators */ \"./node_modules/lit/decorators.js\");\n/* harmony import */ var _common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/datetime/format_date_time */ \"./src/common/datetime/format_date_time.ts\");\n/* harmony import */ var _common_datetime_milliseconds_to_duration__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/datetime/milliseconds_to_duration */ \"./src/common/datetime/milliseconds_to_duration.ts\");\n/* harmony import */ var _common_dom_fire_event__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/dom/fire_event */ \"./src/common/dom/fire_event.ts\");\n/* harmony import */ var _common_number_format_number__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/number/format_number */ \"./src/common/number/format_number.ts\");\n/* harmony import */ var _common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/util/compute_rtl */ \"./src/common/util/compute_rtl.ts\");\n/* harmony import */ var _ha_chart_base__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ha-chart-base */ \"./src/components/chart/ha-chart-base.ts\");\n/* harmony import */ var _timeline_chart_timeline_color__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./timeline-chart/timeline-color */ \"./src/components/chart/timeline-chart/timeline-color.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__]);\n_common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\nlet StateHistoryChartTimeline = (0,_babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__[\"default\"])([(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.customElement)(\"state-history-chart-timeline\")], function (_initialize, _LitElement) {\n  class StateHistoryChartTimeline extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: StateHistoryChartTimeline,\n    d: [{\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        attribute: false\n      })],\n      key: \"data\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Boolean\n      })],\n      key: \"narrow\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        attribute: false\n      })],\n      key: \"names\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)()],\n      key: \"unit\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)()],\n      key: \"identifier\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Boolean\n      })],\n      key: \"showNames\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Boolean\n      })],\n      key: \"clickForMoreInfo\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Boolean\n      })],\n      key: \"chunked\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        attribute: false\n      })],\n      key: \"startTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        attribute: false\n      })],\n      key: \"endTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Number\n      })],\n      key: \"paddingYAxis\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.property)({\n        type: Number\n      })],\n      key: \"chartIndex\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.state)()],\n      key: \"_chartData\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.state)()],\n      key: \"_chartOptions\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.state)()],\n      key: \"_yWidth\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_chartTime\",\n      value() {\n        return new Date();\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_3__.query)(\"ha-chart-base\")],\n      key: \"_chart\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"resize\",\n      value() {\n        return options => {\n          var _this$_chart;\n          (_this$_chart = this._chart) === null || _this$_chart === void 0 || _this$_chart.resize(options);\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        return (0,lit__WEBPACK_IMPORTED_MODULE_2__.html)`\n      <ha-chart-base\n        .hass=${this.hass}\n        .data=${this._chartData}\n        .options=${this._chartOptions}\n        .height=${this.data.length * 30 + 30}\n        .paddingYAxis=${this.paddingYAxis - this._yWidth}\n        chart-type=\"timeline\"\n      ></ha-chart-base>\n    `;\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        if (!this.hasUpdated) {\n          this._createOptions();\n        }\n        if (changedProps.has(\"startTime\") || changedProps.has(\"endTime\") || changedProps.has(\"data\") || this._chartTime < new Date(this.endTime.getTime() - _ha_chart_base__WEBPACK_IMPORTED_MODULE_9__.MIN_TIME_BETWEEN_UPDATES)) {\n          // If the line is more than 5 minutes old, re-gen it\n          // so the X axis grows even if there is no new data\n          this._generateData();\n        }\n        if (changedProps.has(\"startTime\") || changedProps.has(\"endTime\") || changedProps.has(\"showNames\")) {\n          this._createOptions();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_createOptions\",\n      value: function _createOptions() {\n        const narrow = this.narrow;\n        this._chartOptions = {\n          maintainAspectRatio: false,\n          parsing: false,\n          animation: false,\n          scales: {\n            x: {\n              type: \"timeline\",\n              position: \"bottom\",\n              adapters: {\n                date: {\n                  locale: this.hass.locale,\n                  config: this.hass.config\n                }\n              },\n              suggestedMin: this.startTime,\n              suggestedMax: this.endTime,\n              ticks: {\n                autoSkip: true,\n                maxRotation: 0,\n                sampleSize: 5,\n                autoSkipPadding: 20,\n                major: {\n                  enabled: true\n                },\n                font: context => context.tick && context.tick.major ? {\n                  weight: \"bold\"\n                } : {}\n              },\n              grid: {\n                offset: false\n              },\n              time: {\n                tooltipFormat: \"datetimeseconds\"\n              }\n            },\n            y: {\n              type: \"category\",\n              barThickness: 20,\n              offset: true,\n              grid: {\n                display: false,\n                drawBorder: false,\n                drawTicks: false\n              },\n              ticks: {\n                display: this.chunked || this.showNames\n              },\n              afterSetDimensions: y => {\n                y.maxWidth = y.chart.width * 0.18;\n              },\n              afterFit: scaleInstance => {\n                if (this.chunked) {\n                  // ensure all the chart labels are the same width\n                  scaleInstance.width = narrow ? 105 : 185;\n                }\n              },\n              afterUpdate: y => {\n                var _y$width, _y$left;\n                const yWidth = this.showNames ? (_y$width = y.width) !== null && _y$width !== void 0 ? _y$width : 0 : (0,_common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_8__.computeRTL)(this.hass) ? 0 : (_y$left = y.left) !== null && _y$left !== void 0 ? _y$left : 0;\n                if (this._yWidth !== Math.floor(yWidth) && y.ticks.length === this.data.length) {\n                  this._yWidth = Math.floor(yWidth);\n                  (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_6__.fireEvent)(this, \"y-width-changed\", {\n                    value: this._yWidth,\n                    chartIndex: this.chartIndex\n                  });\n                }\n              },\n              position: (0,_common_util_compute_rtl__WEBPACK_IMPORTED_MODULE_8__.computeRTL)(this.hass) ? \"right\" : \"left\"\n            }\n          },\n          plugins: {\n            tooltip: {\n              mode: \"nearest\",\n              callbacks: {\n                title: context => context[0].chart.data.labels[context[0].datasetIndex],\n                beforeBody: context => context[0].dataset.label || \"\",\n                label: item => {\n                  const d = item.dataset.data[item.dataIndex];\n                  const durationInMs = d.end.getTime() - d.start.getTime();\n                  const formattedDuration = `${this.hass.localize(\"ui.components.history_charts.duration\")}: ${(0,_common_datetime_milliseconds_to_duration__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(durationInMs)}`;\n                  return [d.label || \"\", (0,_common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__.formatDateTimeWithSeconds)(d.start, this.hass.locale, this.hass.config), (0,_common_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_4__.formatDateTimeWithSeconds)(d.end, this.hass.locale, this.hass.config), formattedDuration];\n                },\n                labelColor: item => ({\n                  borderColor: item.dataset.data[item.dataIndex].color,\n                  backgroundColor: item.dataset.data[item.dataIndex].color\n                })\n              }\n            },\n            filler: {\n              propagate: true\n            }\n          },\n          // @ts-expect-error\n          locale: (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_7__.numberFormatToLocale)(this.hass.locale),\n          onClick: e => {\n            var _this$_chartData;\n            if (!this.clickForMoreInfo || !(e.native instanceof MouseEvent) || e.native instanceof PointerEvent && e.native.pointerType !== \"mouse\") {\n              return;\n            }\n            const chart = e.chart;\n            const canvasPosition = (0,chart_js_helpers__WEBPACK_IMPORTED_MODULE_1__.getRelativePosition)(e, chart);\n            const index = Math.abs(chart.scales.y.getValueForPixel(canvasPosition.y));\n            (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_6__.fireEvent)(this, \"hass-more-info\", {\n              // @ts-ignore\n              entityId: (_this$_chartData = this._chartData) === null || _this$_chartData === void 0 || (_this$_chartData = _this$_chartData.datasets[index]) === null || _this$_chartData === void 0 ? void 0 : _this$_chartData.label\n            });\n            chart.canvas.dispatchEvent(new Event(\"mouseout\")); // to hide tooltip\n          }\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"_generateData\",\n      value: function _generateData() {\n        const computedStyles = getComputedStyle(this);\n        let stateHistory = this.data;\n        if (!stateHistory) {\n          stateHistory = [];\n        }\n        this._chartTime = new Date();\n        const startTime = this.startTime;\n        const endTime = this.endTime;\n        const labels = [];\n        const datasets = [];\n        const names = this.names || {};\n        // stateHistory is a list of lists of sorted state objects\n        stateHistory.forEach(stateInfo => {\n          let newLastChanged;\n          let prevState = null;\n          let locState = null;\n          let prevLastChanged = startTime;\n          const entityDisplay = names[stateInfo.entity_id] || stateInfo.name;\n          const dataRow = [];\n          stateInfo.data.forEach(entityState => {\n            let newState = entityState.state;\n            const timeStamp = new Date(entityState.last_changed);\n            if (!newState) {\n              newState = null;\n            }\n            if (timeStamp > endTime) {\n              // Drop datapoints that are after the requested endTime. This could happen if\n              // endTime is 'now' and client time is not in sync with server time.\n              return;\n            }\n            if (prevState === null) {\n              prevState = newState;\n              locState = entityState.state_localize;\n              prevLastChanged = new Date(entityState.last_changed);\n            } else if (newState !== prevState) {\n              newLastChanged = new Date(entityState.last_changed);\n              dataRow.push({\n                start: prevLastChanged,\n                end: newLastChanged,\n                label: locState,\n                color: (0,_timeline_chart_timeline_color__WEBPACK_IMPORTED_MODULE_10__.computeTimelineColor)(prevState, computedStyles, this.hass.states[stateInfo.entity_id])\n              });\n              prevState = newState;\n              locState = entityState.state_localize;\n              prevLastChanged = newLastChanged;\n            }\n          });\n          if (prevState !== null) {\n            dataRow.push({\n              start: prevLastChanged,\n              end: endTime,\n              label: locState,\n              color: (0,_timeline_chart_timeline_color__WEBPACK_IMPORTED_MODULE_10__.computeTimelineColor)(prevState, computedStyles, this.hass.states[stateInfo.entity_id])\n            });\n          }\n          datasets.push({\n            data: dataRow,\n            label: stateInfo.entity_id\n          });\n          labels.push(entityDisplay);\n        });\n        this._chartData = {\n          labels: labels,\n          datasets: datasets\n        };\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return (0,lit__WEBPACK_IMPORTED_MODULE_2__.css)`\n      ha-chart-base {\n        --chart-max-height: none;\n      }\n    `;\n      }\n    }]\n  };\n}, lit__WEBPACK_IMPORTED_MODULE_2__.LitElement);\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50cy9jaGFydC9zdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFNQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQWdVQTtBQUFBO0FBQUE7QUFoVUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBS0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFjQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUtBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaG9tZS1hc3Npc3RhbnQtZnJvbnRlbmQvLi9zcmMvY29tcG9uZW50cy9jaGFydC9zdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lLnRzP2MwNTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBDaGFydERhdGEsIENoYXJ0RGF0YXNldCwgQ2hhcnRPcHRpb25zIH0gZnJvbSBcImNoYXJ0LmpzXCI7XG5pbXBvcnQgeyBnZXRSZWxhdGl2ZVBvc2l0aW9uIH0gZnJvbSBcImNoYXJ0LmpzL2hlbHBlcnNcIjtcbmltcG9ydCB7IGNzcywgQ1NTUmVzdWx0R3JvdXAsIGh0bWwsIExpdEVsZW1lbnQsIFByb3BlcnR5VmFsdWVzIH0gZnJvbSBcImxpdFwiO1xuaW1wb3J0IHsgY3VzdG9tRWxlbWVudCwgcHJvcGVydHksIHF1ZXJ5LCBzdGF0ZSB9IGZyb20gXCJsaXQvZGVjb3JhdG9yc1wiO1xuaW1wb3J0IHsgZm9ybWF0RGF0ZVRpbWVXaXRoU2Vjb25kcyB9IGZyb20gXCIuLi8uLi9jb21tb24vZGF0ZXRpbWUvZm9ybWF0X2RhdGVfdGltZVwiO1xuaW1wb3J0IG1pbGxpc2Vjb25kc1RvRHVyYXRpb24gZnJvbSBcIi4uLy4uL2NvbW1vbi9kYXRldGltZS9taWxsaXNlY29uZHNfdG9fZHVyYXRpb25cIjtcbmltcG9ydCB7IGZpcmVFdmVudCB9IGZyb20gXCIuLi8uLi9jb21tb24vZG9tL2ZpcmVfZXZlbnRcIjtcbmltcG9ydCB7IG51bWJlckZvcm1hdFRvTG9jYWxlIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9udW1iZXIvZm9ybWF0X251bWJlclwiO1xuaW1wb3J0IHsgY29tcHV0ZVJUTCB9IGZyb20gXCIuLi8uLi9jb21tb24vdXRpbC9jb21wdXRlX3J0bFwiO1xuaW1wb3J0IHsgVGltZWxpbmVFbnRpdHkgfSBmcm9tIFwiLi4vLi4vZGF0YS9oaXN0b3J5XCI7XG5pbXBvcnQgeyBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uLy4uL3R5cGVzXCI7XG5pbXBvcnQge1xuICBDaGFydFJlc2l6ZU9wdGlvbnMsXG4gIEhhQ2hhcnRCYXNlLFxuICBNSU5fVElNRV9CRVRXRUVOX1VQREFURVMsXG59IGZyb20gXCIuL2hhLWNoYXJ0LWJhc2VcIjtcbmltcG9ydCB0eXBlIHsgVGltZUxpbmVEYXRhIH0gZnJvbSBcIi4vdGltZWxpbmUtY2hhcnQvY29uc3RcIjtcbmltcG9ydCB7IGNvbXB1dGVUaW1lbGluZUNvbG9yIH0gZnJvbSBcIi4vdGltZWxpbmUtY2hhcnQvdGltZWxpbmUtY29sb3JcIjtcblxuQGN1c3RvbUVsZW1lbnQoXCJzdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lXCIpXG5leHBvcnQgY2xhc3MgU3RhdGVIaXN0b3J5Q2hhcnRUaW1lbGluZSBleHRlbmRzIExpdEVsZW1lbnQge1xuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBoYXNzITogSG9tZUFzc2lzdGFudDtcblxuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBkYXRhOiBUaW1lbGluZUVudGl0eVtdID0gW107XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiB9KSBwdWJsaWMgbmFycm93ID0gZmFsc2U7XG5cbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiBmYWxzZSB9KSBwdWJsaWMgbmFtZXM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXG4gIEBwcm9wZXJ0eSgpIHB1YmxpYyB1bml0Pzogc3RyaW5nO1xuXG4gIEBwcm9wZXJ0eSgpIHB1YmxpYyBpZGVudGlmaWVyPzogc3RyaW5nO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIHNob3dOYW1lcyA9IHRydWU7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiB9KSBwdWJsaWMgY2xpY2tGb3JNb3JlSW5mbyA9IHRydWU7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiB9KSBwdWJsaWMgY2h1bmtlZCA9IGZhbHNlO1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIHN0YXJ0VGltZSE6IERhdGU7XG5cbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiBmYWxzZSB9KSBwdWJsaWMgZW5kVGltZSE6IERhdGU7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogTnVtYmVyIH0pIHB1YmxpYyBwYWRkaW5nWUF4aXMgPSAwO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IE51bWJlciB9KSBwdWJsaWMgY2hhcnRJbmRleD87XG5cbiAgQHN0YXRlKCkgcHJpdmF0ZSBfY2hhcnREYXRhPzogQ2hhcnREYXRhPFwidGltZWxpbmVcIj47XG5cbiAgQHN0YXRlKCkgcHJpdmF0ZSBfY2hhcnRPcHRpb25zPzogQ2hhcnRPcHRpb25zPFwidGltZWxpbmVcIj47XG5cbiAgQHN0YXRlKCkgcHJpdmF0ZSBfeVdpZHRoID0gMDtcblxuICBwcml2YXRlIF9jaGFydFRpbWU6IERhdGUgPSBuZXcgRGF0ZSgpO1xuXG4gIEBxdWVyeShcImhhLWNoYXJ0LWJhc2VcIikgcHJpdmF0ZSBfY2hhcnQ/OiBIYUNoYXJ0QmFzZTtcblxuICBwdWJsaWMgcmVzaXplID0gKG9wdGlvbnM/OiBDaGFydFJlc2l6ZU9wdGlvbnMpOiB2b2lkID0+IHtcbiAgICB0aGlzLl9jaGFydD8ucmVzaXplKG9wdGlvbnMpO1xuICB9O1xuXG4gIHByb3RlY3RlZCByZW5kZXIoKSB7XG4gICAgcmV0dXJuIGh0bWxgXG4gICAgICA8aGEtY2hhcnQtYmFzZVxuICAgICAgICAuaGFzcz0ke3RoaXMuaGFzc31cbiAgICAgICAgLmRhdGE9JHt0aGlzLl9jaGFydERhdGF9XG4gICAgICAgIC5vcHRpb25zPSR7dGhpcy5fY2hhcnRPcHRpb25zfVxuICAgICAgICAuaGVpZ2h0PSR7dGhpcy5kYXRhLmxlbmd0aCAqIDMwICsgMzB9XG4gICAgICAgIC5wYWRkaW5nWUF4aXM9JHt0aGlzLnBhZGRpbmdZQXhpcyAtIHRoaXMuX3lXaWR0aH1cbiAgICAgICAgY2hhcnQtdHlwZT1cInRpbWVsaW5lXCJcbiAgICAgID48L2hhLWNoYXJ0LWJhc2U+XG4gICAgYDtcbiAgfVxuXG4gIHB1YmxpYyB3aWxsVXBkYXRlKGNoYW5nZWRQcm9wczogUHJvcGVydHlWYWx1ZXMpIHtcbiAgICBpZiAoIXRoaXMuaGFzVXBkYXRlZCkge1xuICAgICAgdGhpcy5fY3JlYXRlT3B0aW9ucygpO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJzdGFydFRpbWVcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJlbmRUaW1lXCIpIHx8XG4gICAgICBjaGFuZ2VkUHJvcHMuaGFzKFwiZGF0YVwiKSB8fFxuICAgICAgdGhpcy5fY2hhcnRUaW1lIDxcbiAgICAgICAgbmV3IERhdGUodGhpcy5lbmRUaW1lLmdldFRpbWUoKSAtIE1JTl9USU1FX0JFVFdFRU5fVVBEQVRFUylcbiAgICApIHtcbiAgICAgIC8vIElmIHRoZSBsaW5lIGlzIG1vcmUgdGhhbiA1IG1pbnV0ZXMgb2xkLCByZS1nZW4gaXRcbiAgICAgIC8vIHNvIHRoZSBYIGF4aXMgZ3Jvd3MgZXZlbiBpZiB0aGVyZSBpcyBubyBuZXcgZGF0YVxuICAgICAgdGhpcy5fZ2VuZXJhdGVEYXRhKCk7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcInN0YXJ0VGltZVwiKSB8fFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcImVuZFRpbWVcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJzaG93TmFtZXNcIilcbiAgICApIHtcbiAgICAgIHRoaXMuX2NyZWF0ZU9wdGlvbnMoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9jcmVhdGVPcHRpb25zKCkge1xuICAgIGNvbnN0IG5hcnJvdyA9IHRoaXMubmFycm93O1xuICAgIHRoaXMuX2NoYXJ0T3B0aW9ucyA9IHtcbiAgICAgIG1haW50YWluQXNwZWN0UmF0aW86IGZhbHNlLFxuICAgICAgcGFyc2luZzogZmFsc2UsXG4gICAgICBhbmltYXRpb246IGZhbHNlLFxuICAgICAgc2NhbGVzOiB7XG4gICAgICAgIHg6IHtcbiAgICAgICAgICB0eXBlOiBcInRpbWVsaW5lXCIsXG4gICAgICAgICAgcG9zaXRpb246IFwiYm90dG9tXCIsXG4gICAgICAgICAgYWRhcHRlcnM6IHtcbiAgICAgICAgICAgIGRhdGU6IHtcbiAgICAgICAgICAgICAgbG9jYWxlOiB0aGlzLmhhc3MubG9jYWxlLFxuICAgICAgICAgICAgICBjb25maWc6IHRoaXMuaGFzcy5jb25maWcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc3VnZ2VzdGVkTWluOiB0aGlzLnN0YXJ0VGltZSxcbiAgICAgICAgICBzdWdnZXN0ZWRNYXg6IHRoaXMuZW5kVGltZSxcbiAgICAgICAgICB0aWNrczoge1xuICAgICAgICAgICAgYXV0b1NraXA6IHRydWUsXG4gICAgICAgICAgICBtYXhSb3RhdGlvbjogMCxcbiAgICAgICAgICAgIHNhbXBsZVNpemU6IDUsXG4gICAgICAgICAgICBhdXRvU2tpcFBhZGRpbmc6IDIwLFxuICAgICAgICAgICAgbWFqb3I6IHtcbiAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmb250OiAoY29udGV4dCkgPT5cbiAgICAgICAgICAgICAgY29udGV4dC50aWNrICYmIGNvbnRleHQudGljay5tYWpvclxuICAgICAgICAgICAgICAgID8gKHsgd2VpZ2h0OiBcImJvbGRcIiB9IGFzIGFueSlcbiAgICAgICAgICAgICAgICA6IHt9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZ3JpZDoge1xuICAgICAgICAgICAgb2Zmc2V0OiBmYWxzZSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRpbWU6IHtcbiAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6IFwiZGF0ZXRpbWVzZWNvbmRzXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgeToge1xuICAgICAgICAgIHR5cGU6IFwiY2F0ZWdvcnlcIixcbiAgICAgICAgICBiYXJUaGlja25lc3M6IDIwLFxuICAgICAgICAgIG9mZnNldDogdHJ1ZSxcbiAgICAgICAgICBncmlkOiB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmYWxzZSxcbiAgICAgICAgICAgIGRyYXdCb3JkZXI6IGZhbHNlLFxuICAgICAgICAgICAgZHJhd1RpY2tzOiBmYWxzZSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRpY2tzOiB7XG4gICAgICAgICAgICBkaXNwbGF5OiB0aGlzLmNodW5rZWQgfHwgdGhpcy5zaG93TmFtZXMsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhZnRlclNldERpbWVuc2lvbnM6ICh5KSA9PiB7XG4gICAgICAgICAgICB5Lm1heFdpZHRoID0geS5jaGFydC53aWR0aCAqIDAuMTg7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhZnRlckZpdDogKHNjYWxlSW5zdGFuY2UpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNodW5rZWQpIHtcbiAgICAgICAgICAgICAgLy8gZW5zdXJlIGFsbCB0aGUgY2hhcnQgbGFiZWxzIGFyZSB0aGUgc2FtZSB3aWR0aFxuICAgICAgICAgICAgICBzY2FsZUluc3RhbmNlLndpZHRoID0gbmFycm93ID8gMTA1IDogMTg1O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgYWZ0ZXJVcGRhdGU6ICh5KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB5V2lkdGggPSB0aGlzLnNob3dOYW1lc1xuICAgICAgICAgICAgICA/IHkud2lkdGggPz8gMFxuICAgICAgICAgICAgICA6IGNvbXB1dGVSVEwodGhpcy5oYXNzKVxuICAgICAgICAgICAgICAgID8gMFxuICAgICAgICAgICAgICAgIDogeS5sZWZ0ID8/IDA7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgIHRoaXMuX3lXaWR0aCAhPT0gTWF0aC5mbG9vcih5V2lkdGgpICYmXG4gICAgICAgICAgICAgIHkudGlja3MubGVuZ3RoID09PSB0aGlzLmRhdGEubGVuZ3RoXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgdGhpcy5feVdpZHRoID0gTWF0aC5mbG9vcih5V2lkdGgpO1xuICAgICAgICAgICAgICBmaXJlRXZlbnQodGhpcywgXCJ5LXdpZHRoLWNoYW5nZWRcIiwge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLl95V2lkdGgsXG4gICAgICAgICAgICAgICAgY2hhcnRJbmRleDogdGhpcy5jaGFydEluZGV4LFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHBvc2l0aW9uOiBjb21wdXRlUlRMKHRoaXMuaGFzcykgPyBcInJpZ2h0XCIgOiBcImxlZnRcIixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBwbHVnaW5zOiB7XG4gICAgICAgIHRvb2x0aXA6IHtcbiAgICAgICAgICBtb2RlOiBcIm5lYXJlc3RcIixcbiAgICAgICAgICBjYWxsYmFja3M6IHtcbiAgICAgICAgICAgIHRpdGxlOiAoY29udGV4dCkgPT5cbiAgICAgICAgICAgICAgY29udGV4dCFbMF0uY2hhcnQhLmRhdGEhLmxhYmVscyFbXG4gICAgICAgICAgICAgICAgY29udGV4dFswXS5kYXRhc2V0SW5kZXhcbiAgICAgICAgICAgICAgXSBhcyBzdHJpbmcsXG4gICAgICAgICAgICBiZWZvcmVCb2R5OiAoY29udGV4dCkgPT4gY29udGV4dFswXS5kYXRhc2V0LmxhYmVsIHx8IFwiXCIsXG4gICAgICAgICAgICBsYWJlbDogKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgZCA9IGl0ZW0uZGF0YXNldC5kYXRhW2l0ZW0uZGF0YUluZGV4XSBhcyBUaW1lTGluZURhdGE7XG4gICAgICAgICAgICAgIGNvbnN0IGR1cmF0aW9uSW5NcyA9IGQuZW5kLmdldFRpbWUoKSAtIGQuc3RhcnQuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWREdXJhdGlvbiA9IGAke3RoaXMuaGFzcy5sb2NhbGl6ZShcbiAgICAgICAgICAgICAgICBcInVpLmNvbXBvbmVudHMuaGlzdG9yeV9jaGFydHMuZHVyYXRpb25cIlxuICAgICAgICAgICAgICApfTogJHttaWxsaXNlY29uZHNUb0R1cmF0aW9uKGR1cmF0aW9uSW5Ncyl9YDtcblxuICAgICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIGQubGFiZWwgfHwgXCJcIixcbiAgICAgICAgICAgICAgICBmb3JtYXREYXRlVGltZVdpdGhTZWNvbmRzKFxuICAgICAgICAgICAgICAgICAgZC5zdGFydCxcbiAgICAgICAgICAgICAgICAgIHRoaXMuaGFzcy5sb2NhbGUsXG4gICAgICAgICAgICAgICAgICB0aGlzLmhhc3MuY29uZmlnXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBmb3JtYXREYXRlVGltZVdpdGhTZWNvbmRzKFxuICAgICAgICAgICAgICAgICAgZC5lbmQsXG4gICAgICAgICAgICAgICAgICB0aGlzLmhhc3MubG9jYWxlLFxuICAgICAgICAgICAgICAgICAgdGhpcy5oYXNzLmNvbmZpZ1xuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkRHVyYXRpb24sXG4gICAgICAgICAgICAgIF07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGFiZWxDb2xvcjogKGl0ZW0pID0+ICh7XG4gICAgICAgICAgICAgIGJvcmRlckNvbG9yOiAoaXRlbS5kYXRhc2V0LmRhdGFbaXRlbS5kYXRhSW5kZXhdIGFzIFRpbWVMaW5lRGF0YSlcbiAgICAgICAgICAgICAgICAuY29sb3IhLFxuICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IChcbiAgICAgICAgICAgICAgICBpdGVtLmRhdGFzZXQuZGF0YVtpdGVtLmRhdGFJbmRleF0gYXMgVGltZUxpbmVEYXRhXG4gICAgICAgICAgICAgICkuY29sb3IhLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgZmlsbGVyOiB7XG4gICAgICAgICAgcHJvcGFnYXRlOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgICAgIGxvY2FsZTogbnVtYmVyRm9ybWF0VG9Mb2NhbGUodGhpcy5oYXNzLmxvY2FsZSksXG4gICAgICBvbkNsaWNrOiAoZTogYW55KSA9PiB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAhdGhpcy5jbGlja0Zvck1vcmVJbmZvIHx8XG4gICAgICAgICAgIShlLm5hdGl2ZSBpbnN0YW5jZW9mIE1vdXNlRXZlbnQpIHx8XG4gICAgICAgICAgKGUubmF0aXZlIGluc3RhbmNlb2YgUG9pbnRlckV2ZW50ICYmIGUubmF0aXZlLnBvaW50ZXJUeXBlICE9PSBcIm1vdXNlXCIpXG4gICAgICAgICkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNoYXJ0ID0gZS5jaGFydDtcbiAgICAgICAgY29uc3QgY2FudmFzUG9zaXRpb24gPSBnZXRSZWxhdGl2ZVBvc2l0aW9uKGUsIGNoYXJ0KTtcblxuICAgICAgICBjb25zdCBpbmRleCA9IE1hdGguYWJzKFxuICAgICAgICAgIGNoYXJ0LnNjYWxlcy55LmdldFZhbHVlRm9yUGl4ZWwoY2FudmFzUG9zaXRpb24ueSlcbiAgICAgICAgKTtcbiAgICAgICAgZmlyZUV2ZW50KHRoaXMsIFwiaGFzcy1tb3JlLWluZm9cIiwge1xuICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICBlbnRpdHlJZDogdGhpcy5fY2hhcnREYXRhPy5kYXRhc2V0c1tpbmRleF0/LmxhYmVsLFxuICAgICAgICB9KTtcbiAgICAgICAgY2hhcnQuY2FudmFzLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwibW91c2VvdXRcIikpOyAvLyB0byBoaWRlIHRvb2x0aXBcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgX2dlbmVyYXRlRGF0YSgpIHtcbiAgICBjb25zdCBjb21wdXRlZFN0eWxlcyA9IGdldENvbXB1dGVkU3R5bGUodGhpcyk7XG4gICAgbGV0IHN0YXRlSGlzdG9yeSA9IHRoaXMuZGF0YTtcblxuICAgIGlmICghc3RhdGVIaXN0b3J5KSB7XG4gICAgICBzdGF0ZUhpc3RvcnkgPSBbXTtcbiAgICB9XG5cbiAgICB0aGlzLl9jaGFydFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IHRoaXMuc3RhcnRUaW1lO1xuICAgIGNvbnN0IGVuZFRpbWUgPSB0aGlzLmVuZFRpbWU7XG4gICAgY29uc3QgbGFiZWxzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IGRhdGFzZXRzOiBDaGFydERhdGFzZXQ8XCJ0aW1lbGluZVwiPltdID0gW107XG4gICAgY29uc3QgbmFtZXMgPSB0aGlzLm5hbWVzIHx8IHt9O1xuICAgIC8vIHN0YXRlSGlzdG9yeSBpcyBhIGxpc3Qgb2YgbGlzdHMgb2Ygc29ydGVkIHN0YXRlIG9iamVjdHNcbiAgICBzdGF0ZUhpc3RvcnkuZm9yRWFjaCgoc3RhdGVJbmZvKSA9PiB7XG4gICAgICBsZXQgbmV3TGFzdENoYW5nZWQ6IERhdGU7XG4gICAgICBsZXQgcHJldlN0YXRlOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgICAgIGxldCBsb2NTdGF0ZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgICBsZXQgcHJldkxhc3RDaGFuZ2VkID0gc3RhcnRUaW1lO1xuICAgICAgY29uc3QgZW50aXR5RGlzcGxheTogc3RyaW5nID1cbiAgICAgICAgbmFtZXNbc3RhdGVJbmZvLmVudGl0eV9pZF0gfHwgc3RhdGVJbmZvLm5hbWU7XG5cbiAgICAgIGNvbnN0IGRhdGFSb3c6IFRpbWVMaW5lRGF0YVtdID0gW107XG4gICAgICBzdGF0ZUluZm8uZGF0YS5mb3JFYWNoKChlbnRpdHlTdGF0ZSkgPT4ge1xuICAgICAgICBsZXQgbmV3U3RhdGU6IHN0cmluZyB8IG51bGwgPSBlbnRpdHlTdGF0ZS5zdGF0ZTtcbiAgICAgICAgY29uc3QgdGltZVN0YW1wID0gbmV3IERhdGUoZW50aXR5U3RhdGUubGFzdF9jaGFuZ2VkKTtcbiAgICAgICAgaWYgKCFuZXdTdGF0ZSkge1xuICAgICAgICAgIG5ld1N0YXRlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGltZVN0YW1wID4gZW5kVGltZSkge1xuICAgICAgICAgIC8vIERyb3AgZGF0YXBvaW50cyB0aGF0IGFyZSBhZnRlciB0aGUgcmVxdWVzdGVkIGVuZFRpbWUuIFRoaXMgY291bGQgaGFwcGVuIGlmXG4gICAgICAgICAgLy8gZW5kVGltZSBpcyAnbm93JyBhbmQgY2xpZW50IHRpbWUgaXMgbm90IGluIHN5bmMgd2l0aCBzZXJ2ZXIgdGltZS5cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByZXZTdGF0ZSA9PT0gbnVsbCkge1xuICAgICAgICAgIHByZXZTdGF0ZSA9IG5ld1N0YXRlO1xuICAgICAgICAgIGxvY1N0YXRlID0gZW50aXR5U3RhdGUuc3RhdGVfbG9jYWxpemU7XG4gICAgICAgICAgcHJldkxhc3RDaGFuZ2VkID0gbmV3IERhdGUoZW50aXR5U3RhdGUubGFzdF9jaGFuZ2VkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuZXdTdGF0ZSAhPT0gcHJldlN0YXRlKSB7XG4gICAgICAgICAgbmV3TGFzdENoYW5nZWQgPSBuZXcgRGF0ZShlbnRpdHlTdGF0ZS5sYXN0X2NoYW5nZWQpO1xuXG4gICAgICAgICAgZGF0YVJvdy5wdXNoKHtcbiAgICAgICAgICAgIHN0YXJ0OiBwcmV2TGFzdENoYW5nZWQsXG4gICAgICAgICAgICBlbmQ6IG5ld0xhc3RDaGFuZ2VkLFxuICAgICAgICAgICAgbGFiZWw6IGxvY1N0YXRlLFxuICAgICAgICAgICAgY29sb3I6IGNvbXB1dGVUaW1lbGluZUNvbG9yKFxuICAgICAgICAgICAgICBwcmV2U3RhdGUsXG4gICAgICAgICAgICAgIGNvbXB1dGVkU3R5bGVzLFxuICAgICAgICAgICAgICB0aGlzLmhhc3Muc3RhdGVzW3N0YXRlSW5mby5lbnRpdHlfaWRdXG4gICAgICAgICAgICApLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcHJldlN0YXRlID0gbmV3U3RhdGU7XG4gICAgICAgICAgbG9jU3RhdGUgPSBlbnRpdHlTdGF0ZS5zdGF0ZV9sb2NhbGl6ZTtcbiAgICAgICAgICBwcmV2TGFzdENoYW5nZWQgPSBuZXdMYXN0Q2hhbmdlZDtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChwcmV2U3RhdGUgIT09IG51bGwpIHtcbiAgICAgICAgZGF0YVJvdy5wdXNoKHtcbiAgICAgICAgICBzdGFydDogcHJldkxhc3RDaGFuZ2VkLFxuICAgICAgICAgIGVuZDogZW5kVGltZSxcbiAgICAgICAgICBsYWJlbDogbG9jU3RhdGUsXG4gICAgICAgICAgY29sb3I6IGNvbXB1dGVUaW1lbGluZUNvbG9yKFxuICAgICAgICAgICAgcHJldlN0YXRlLFxuICAgICAgICAgICAgY29tcHV0ZWRTdHlsZXMsXG4gICAgICAgICAgICB0aGlzLmhhc3Muc3RhdGVzW3N0YXRlSW5mby5lbnRpdHlfaWRdXG4gICAgICAgICAgKSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBkYXRhc2V0cy5wdXNoKHtcbiAgICAgICAgZGF0YTogZGF0YVJvdyxcbiAgICAgICAgbGFiZWw6IHN0YXRlSW5mby5lbnRpdHlfaWQsXG4gICAgICB9KTtcbiAgICAgIGxhYmVscy5wdXNoKGVudGl0eURpc3BsYXkpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2hhcnREYXRhID0ge1xuICAgICAgbGFiZWxzOiBsYWJlbHMsXG4gICAgICBkYXRhc2V0czogZGF0YXNldHMsXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBnZXQgc3R5bGVzKCk6IENTU1Jlc3VsdEdyb3VwIHtcbiAgICByZXR1cm4gY3NzYFxuICAgICAgaGEtY2hhcnQtYmFzZSB7XG4gICAgICAgIC0tY2hhcnQtbWF4LWhlaWdodDogbm9uZTtcbiAgICAgIH1cbiAgICBgO1xuICB9XG59XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIEhUTUxFbGVtZW50VGFnTmFtZU1hcCB7XG4gICAgXCJzdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lXCI6IFN0YXRlSGlzdG9yeUNoYXJ0VGltZWxpbmU7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/components/chart/state-history-chart-timeline.ts\n");

/***/ }),

/***/ "./src/components/chart/state-history-charts.ts":
/*!******************************************************!*\
  !*** ./src/components/chart/state-history-charts.ts ***!
  \******************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StateHistoryCharts: () => (/* binding */ StateHistoryCharts)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/decorate */ \"./node_modules/@babel/runtime/helpers/esm/decorate.js\");\n/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit */ \"./node_modules/lit/index.js\");\n/* harmony import */ var lit_decorators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit/decorators */ \"./node_modules/lit/decorators.js\");\n/* harmony import */ var _common_config_is_component_loaded__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/config/is_component_loaded */ \"./src/common/config/is_component_loaded.ts\");\n/* harmony import */ var _common_decorators_restore_scroll__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/decorators/restore-scroll */ \"./src/common/decorators/restore-scroll.ts\");\n/* harmony import */ var _resources_virtualizer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../resources/virtualizer */ \"./src/resources/virtualizer.ts\");\n/* harmony import */ var _state_history_chart_line__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./state-history-chart-line */ \"./src/components/chart/state-history-chart-line.ts\");\n/* harmony import */ var _state_history_chart_timeline__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./state-history-chart-timeline */ \"./src/components/chart/state-history-chart-timeline.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_state_history_chart_timeline__WEBPACK_IMPORTED_MODULE_7__]);\n_state_history_chart_timeline__WEBPACK_IMPORTED_MODULE_7__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\nconst CANVAS_TIMELINE_ROWS_CHUNK = 10; // Split up the canvases to avoid hitting the render limit\n\nconst chunkData = (inputArray, chunks) => inputArray.reduce((results, item, idx) => {\n  const chunkIdx = Math.floor(idx / chunks);\n  if (!results[chunkIdx]) {\n    results[chunkIdx] = [];\n  }\n  results[chunkIdx].push(item);\n  return results;\n}, []);\nlet StateHistoryCharts = (0,_babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_0__[\"default\"])([(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.customElement)(\"state-history-charts\")], function (_initialize, _LitElement) {\n  class StateHistoryCharts extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: StateHistoryCharts,\n    d: [{\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"historyData\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"narrow\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"names\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean,\n        reflect: true\n      })],\n      key: \"virtualize\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"endTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"startTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean,\n        attribute: \"up-to-now\"\n      })],\n      key: \"upToNow\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Number\n      })],\n      key: \"hoursToShow\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"showNames\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"clickForMoreInfo\",\n      value() {\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"isLoadingData\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"logarithmicScale\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Number\n      })],\n      key: \"minYAxis\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Number\n      })],\n      key: \"maxYAxis\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean\n      })],\n      key: \"fitYData\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_computedStartTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_computedEndTime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_maxYWidth\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_childYWidths\",\n      value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.state)()],\n      key: \"_chartCount\",\n      value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,_common_decorators_restore_scroll__WEBPACK_IMPORTED_MODULE_4__.restoreScroll)(\".container\")],\n      key: \"_savedScrollPos\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.queryAll)(\"state-history-chart-line\")],\n      key: \"_charts\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"resize\",\n      value() {\n        return options => {\n          var _this$_charts;\n          (_this$_charts = this._charts) === null || _this$_charts === void 0 || _this$_charts.forEach(chart => chart.resize(options));\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value:\n      // @ts-ignore\n\n      function render() {\n        if (!(0,_common_config_is_component_loaded__WEBPACK_IMPORTED_MODULE_3__.isComponentLoaded)(this.hass, \"history\")) {\n          return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"info\">\n        ${this.hass.localize(\"ui.components.history_charts.history_disabled\")}\n      </div>`;\n        }\n        if (this.isLoadingData && !this.historyData) {\n          return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"info\">\n        ${this.hass.localize(\"ui.components.history_charts.loading_history\")}\n      </div>`;\n        }\n        if (this._isHistoryEmpty()) {\n          return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"info\">\n        ${this.hass.localize(\"ui.components.history_charts.no_history_found\")}\n      </div>`;\n        }\n        const combinedItems = this.historyData.timeline.length ? (this.virtualize ? chunkData(this.historyData.timeline, CANVAS_TIMELINE_ROWS_CHUNK) : [this.historyData.timeline]).concat(this.historyData.line) : this.historyData.line;\n        this._chartCount = combinedItems.length;\n        return this.virtualize ? (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"container ha-scrollbar\" @scroll=${this._saveScrollPos}>\n          <lit-virtualizer\n            scroller\n            class=\"ha-scrollbar\"\n            .items=${combinedItems}\n            .renderItem=${this._renderHistoryItem}\n          >\n          </lit-virtualizer>\n        </div>` : (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`${combinedItems.map((item, index) => this._renderHistoryItem(item, index))}`;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_renderHistoryItem\",\n      value() {\n        return (item, index) => {\n          if (!item || index === undefined) {\n            return lit__WEBPACK_IMPORTED_MODULE_1__.nothing;\n          }\n          if (!Array.isArray(item)) {\n            return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"entry-container\">\n        <state-history-chart-line\n          .hass=${this.hass}\n          .unit=${item.unit}\n          .data=${item.data}\n          .identifier=${item.identifier}\n          .showNames=${this.showNames}\n          .startTime=${this._computedStartTime}\n          .endTime=${this._computedEndTime}\n          .paddingYAxis=${this._maxYWidth}\n          .names=${this.names}\n          .chartIndex=${index}\n          .clickForMoreInfo=${this.clickForMoreInfo}\n          .logarithmicScale=${this.logarithmicScale}\n          .minYAxis=${this.minYAxis}\n          .maxYAxis=${this.maxYAxis}\n          .fitYData=${this.fitYData}\n          @y-width-changed=${this._yWidthChanged}\n        ></state-history-chart-line>\n      </div> `;\n          }\n          return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=\"entry-container\">\n      <state-history-chart-timeline\n        .hass=${this.hass}\n        .data=${item}\n        .startTime=${this._computedStartTime}\n        .endTime=${this._computedEndTime}\n        .showNames=${this.showNames}\n        .names=${this.names}\n        .narrow=${this.narrow}\n        .chunked=${this.virtualize}\n        .paddingYAxis=${this._maxYWidth}\n        .chartIndex=${index}\n        .clickForMoreInfo=${this.clickForMoreInfo}\n        @y-width-changed=${this._yWidthChanged}\n      ></state-history-chart-timeline>\n    </div> `;\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"shouldUpdate\",\n      value: function shouldUpdate(changedProps) {\n        if (changedProps.size === 1 && changedProps.has(\"hass\")) {\n          return false;\n        }\n        if (changedProps.size === 1 && changedProps.has(\"_maxYWidth\") && changedProps.get(\"_maxYWidth\") === this._maxYWidth) {\n          return false;\n        }\n        return true;\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        if (!this.hasUpdated) {\n          (0,_resources_virtualizer__WEBPACK_IMPORTED_MODULE_5__.loadVirtualizer)();\n        }\n        if ([...changedProps.keys()].some(prop => ![\"_maxYWidth\", \"_childYWidths\", \"_chartCount\"].includes(prop))) {\n          // Don't recompute times when we just want to update layout\n          const now = new Date();\n          this._computedEndTime = this.upToNow || !this.endTime || this.endTime > now ? now : this.endTime;\n          if (this.startTime) {\n            this._computedStartTime = this.startTime;\n          } else if (this.hoursToShow) {\n            this._computedStartTime = new Date(new Date().getTime() - 60 * 60 * this.hoursToShow * 1000);\n          } else {\n            var _this$historyData$tim, _this$historyData;\n            this._computedStartTime = new Date(((_this$historyData$tim = (_this$historyData = this.historyData) === null || _this$historyData === void 0 ? void 0 : _this$historyData.timeline) !== null && _this$historyData$tim !== void 0 ? _this$historyData$tim : []).reduce((minTime, stateInfo) => Math.min(minTime, new Date(stateInfo.data[0].last_changed).getTime()), new Date().getTime()));\n          }\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"updated\",\n      value: function updated(changedProps) {\n        if (changedProps.has(\"_chartCount\")) {\n          if (this._chartCount < this._childYWidths.length) {\n            this._childYWidths.length = this._chartCount;\n            this._maxYWidth = Math.max(...Object.values(this._childYWidths), 0);\n          }\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_yWidthChanged\",\n      value: function _yWidthChanged(e) {\n        this._childYWidths[e.detail.chartIndex] = e.detail.value;\n        this._maxYWidth = Math.max(...Object.values(this._childYWidths), 0);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_isHistoryEmpty\",\n      value: function _isHistoryEmpty() {\n        const historyDataEmpty = !this.historyData || !this.historyData.timeline || !this.historyData.line || this.historyData.timeline.length === 0 && this.historyData.line.length === 0;\n        return !this.isLoadingData && historyDataEmpty;\n      }\n    }, {\n      kind: \"method\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.eventOptions)({\n        passive: true\n      })],\n      key: \"_saveScrollPos\",\n      value: function _saveScrollPos(e) {\n        this._savedScrollPos = e.target.scrollTop;\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return (0,lit__WEBPACK_IMPORTED_MODULE_1__.css)`\n      :host {\n        display: block;\n        /* height of single timeline chart = 60px */\n        min-height: 60px;\n      }\n\n      :host([virtualize]) {\n        height: 100%;\n      }\n\n      .info {\n        text-align: center;\n        line-height: 60px;\n        color: var(--secondary-text-color);\n      }\n\n      .container {\n        max-height: var(--history-max-height);\n      }\n\n      .entry-container {\n        width: 100%;\n      }\n\n      .entry-container:hover {\n        z-index: 1;\n      }\n\n      :host([virtualize]) .entry-container {\n        padding-left: 1px;\n        padding-right: 1px;\n        padding-inline-start: 1px;\n        padding-inline-end: 1px;\n      }\n\n      .entry-container:not(:first-child) {\n        border-top: 2px solid var(--divider-color);\n        margin-top: 16px;\n      }\n\n      .container,\n      lit-virtualizer {\n        height: 100%;\n        width: 100%;\n      }\n\n      lit-virtualizer {\n        contain: size layout !important;\n      }\n\n      state-history-chart-timeline,\n      state-history-chart-line {\n        width: 100%;\n      }\n    `;\n      }\n    }]\n  };\n}, lit__WEBPACK_IMPORTED_MODULE_1__.LitElement);\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50cy9jaGFydC9zdGF0ZS1oaXN0b3J5LWNoYXJ0cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFRQTtBQU9BO0FBQ0E7QUFNQTtBQUVBO0FBQ0E7QUFLQTs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBK1JBO0FBQUE7QUFBQTtBQS9SQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBWEE7O0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUFBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ob21lLWFzc2lzdGFudC1mcm9udGVuZC8uL3NyYy9jb21wb25lbnRzL2NoYXJ0L3N0YXRlLWhpc3RvcnktY2hhcnRzLnRzP2EwZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgY3NzLFxuICBDU1NSZXN1bHRHcm91cCxcbiAgaHRtbCxcbiAgTGl0RWxlbWVudCxcbiAgbm90aGluZyxcbiAgUHJvcGVydHlWYWx1ZXMsXG59IGZyb20gXCJsaXRcIjtcbmltcG9ydCB7XG4gIGN1c3RvbUVsZW1lbnQsXG4gIGV2ZW50T3B0aW9ucyxcbiAgcHJvcGVydHksXG4gIHF1ZXJ5QWxsLFxuICBzdGF0ZSxcbn0gZnJvbSBcImxpdC9kZWNvcmF0b3JzXCI7XG5pbXBvcnQgeyBpc0NvbXBvbmVudExvYWRlZCB9IGZyb20gXCIuLi8uLi9jb21tb24vY29uZmlnL2lzX2NvbXBvbmVudF9sb2FkZWRcIjtcbmltcG9ydCB7IHJlc3RvcmVTY3JvbGwgfSBmcm9tIFwiLi4vLi4vY29tbW9uL2RlY29yYXRvcnMvcmVzdG9yZS1zY3JvbGxcIjtcbmltcG9ydCB7XG4gIEhpc3RvcnlSZXN1bHQsXG4gIExpbmVDaGFydFVuaXQsXG4gIFRpbWVsaW5lRW50aXR5LFxufSBmcm9tIFwiLi4vLi4vZGF0YS9oaXN0b3J5XCI7XG5pbXBvcnQgeyBsb2FkVmlydHVhbGl6ZXIgfSBmcm9tIFwiLi4vLi4vcmVzb3VyY2VzL3ZpcnR1YWxpemVyXCI7XG5pbXBvcnQgdHlwZSB7IEhvbWVBc3Npc3RhbnQgfSBmcm9tIFwiLi4vLi4vdHlwZXNcIjtcbmltcG9ydCBcIi4vc3RhdGUtaGlzdG9yeS1jaGFydC1saW5lXCI7XG5pbXBvcnQgXCIuL3N0YXRlLWhpc3RvcnktY2hhcnQtdGltZWxpbmVcIjtcbmltcG9ydCB0eXBlIHsgU3RhdGVIaXN0b3J5Q2hhcnRMaW5lIH0gZnJvbSBcIi4vc3RhdGUtaGlzdG9yeS1jaGFydC1saW5lXCI7XG5pbXBvcnQgdHlwZSB7IFN0YXRlSGlzdG9yeUNoYXJ0VGltZWxpbmUgfSBmcm9tIFwiLi9zdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lXCI7XG5pbXBvcnQgeyBDaGFydFJlc2l6ZU9wdGlvbnMgfSBmcm9tIFwiLi9oYS1jaGFydC1iYXNlXCI7XG5cbmNvbnN0IENBTlZBU19USU1FTElORV9ST1dTX0NIVU5LID0gMTA7IC8vIFNwbGl0IHVwIHRoZSBjYW52YXNlcyB0byBhdm9pZCBoaXR0aW5nIHRoZSByZW5kZXIgbGltaXRcblxuY29uc3QgY2h1bmtEYXRhID0gKGlucHV0QXJyYXk6IGFueVtdLCBjaHVua3M6IG51bWJlcikgPT5cbiAgaW5wdXRBcnJheS5yZWR1Y2UoKHJlc3VsdHMsIGl0ZW0sIGlkeCkgPT4ge1xuICAgIGNvbnN0IGNodW5rSWR4ID0gTWF0aC5mbG9vcihpZHggLyBjaHVua3MpO1xuICAgIGlmICghcmVzdWx0c1tjaHVua0lkeF0pIHtcbiAgICAgIHJlc3VsdHNbY2h1bmtJZHhdID0gW107XG4gICAgfVxuICAgIHJlc3VsdHNbY2h1bmtJZHhdLnB1c2goaXRlbSk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH0sIFtdKTtcblxuZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgSEFTU0RvbUV2ZW50cyB7XG4gICAgXCJ5LXdpZHRoLWNoYW5nZWRcIjogeyB2YWx1ZTogbnVtYmVyOyBjaGFydEluZGV4OiBudW1iZXIgfTtcbiAgfVxufVxuXG5AY3VzdG9tRWxlbWVudChcInN0YXRlLWhpc3RvcnktY2hhcnRzXCIpXG5leHBvcnQgY2xhc3MgU3RhdGVIaXN0b3J5Q2hhcnRzIGV4dGVuZHMgTGl0RWxlbWVudCB7XG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIGhhc3MhOiBIb21lQXNzaXN0YW50O1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIGhpc3RvcnlEYXRhITogSGlzdG9yeVJlc3VsdDtcblxuICBAcHJvcGVydHkoeyB0eXBlOiBCb29sZWFuIH0pIHB1YmxpYyBuYXJyb3cgPSBmYWxzZTtcblxuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBuYW1lcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiwgcmVmbGVjdDogdHJ1ZSB9KSBwdWJsaWMgdmlydHVhbGl6ZSA9IGZhbHNlO1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIGVuZFRpbWU/OiBEYXRlO1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIHN0YXJ0VGltZT86IERhdGU7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiwgYXR0cmlidXRlOiBcInVwLXRvLW5vd1wiIH0pIHB1YmxpYyB1cFRvTm93ID0gZmFsc2U7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogTnVtYmVyIH0pIHB1YmxpYyBob3Vyc1RvU2hvdz86IG51bWJlcjtcblxuICBAcHJvcGVydHkoeyB0eXBlOiBCb29sZWFuIH0pIHB1YmxpYyBzaG93TmFtZXMgPSB0cnVlO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIGNsaWNrRm9yTW9yZUluZm8gPSB0cnVlO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIGlzTG9hZGluZ0RhdGEgPSBmYWxzZTtcblxuICBAcHJvcGVydHkoeyB0eXBlOiBCb29sZWFuIH0pIHB1YmxpYyBsb2dhcml0aG1pY1NjYWxlID0gZmFsc2U7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogTnVtYmVyIH0pIHB1YmxpYyBtaW5ZQXhpcz86IG51bWJlcjtcblxuICBAcHJvcGVydHkoeyB0eXBlOiBOdW1iZXIgfSkgcHVibGljIG1heFlBeGlzPzogbnVtYmVyO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4gfSkgcHVibGljIGZpdFlEYXRhID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBfY29tcHV0ZWRTdGFydFRpbWUhOiBEYXRlO1xuXG4gIHByaXZhdGUgX2NvbXB1dGVkRW5kVGltZSE6IERhdGU7XG5cbiAgQHN0YXRlKCkgcHJpdmF0ZSBfbWF4WVdpZHRoID0gMDtcblxuICBAc3RhdGUoKSBwcml2YXRlIF9jaGlsZFlXaWR0aHM6IG51bWJlcltdID0gW107XG5cbiAgQHN0YXRlKCkgcHJpdmF0ZSBfY2hhcnRDb3VudCA9IDA7XG5cbiAgLy8gQHRzLWlnbm9yZVxuICBAcmVzdG9yZVNjcm9sbChcIi5jb250YWluZXJcIikgcHJpdmF0ZSBfc2F2ZWRTY3JvbGxQb3M/OiBudW1iZXI7XG5cbiAgQHF1ZXJ5QWxsKFwic3RhdGUtaGlzdG9yeS1jaGFydC1saW5lXCIpXG4gIHByaXZhdGUgX2NoYXJ0cz86IFN0YXRlSGlzdG9yeUNoYXJ0TGluZVtdO1xuXG4gIHB1YmxpYyByZXNpemUgPSAob3B0aW9ucz86IENoYXJ0UmVzaXplT3B0aW9ucyk6IHZvaWQgPT4ge1xuICAgIHRoaXMuX2NoYXJ0cz8uZm9yRWFjaChcbiAgICAgIChjaGFydDogU3RhdGVIaXN0b3J5Q2hhcnRMaW5lIHwgU3RhdGVIaXN0b3J5Q2hhcnRUaW1lbGluZSkgPT5cbiAgICAgICAgY2hhcnQucmVzaXplKG9wdGlvbnMpXG4gICAgKTtcbiAgfTtcblxuICBwcm90ZWN0ZWQgcmVuZGVyKCkge1xuICAgIGlmICghaXNDb21wb25lbnRMb2FkZWQodGhpcy5oYXNzLCBcImhpc3RvcnlcIikpIHtcbiAgICAgIHJldHVybiBodG1sYDxkaXYgY2xhc3M9XCJpbmZvXCI+XG4gICAgICAgICR7dGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY29tcG9uZW50cy5oaXN0b3J5X2NoYXJ0cy5oaXN0b3J5X2Rpc2FibGVkXCIpfVxuICAgICAgPC9kaXY+YDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0xvYWRpbmdEYXRhICYmICF0aGlzLmhpc3RvcnlEYXRhKSB7XG4gICAgICByZXR1cm4gaHRtbGA8ZGl2IGNsYXNzPVwiaW5mb1wiPlxuICAgICAgICAke3RoaXMuaGFzcy5sb2NhbGl6ZShcInVpLmNvbXBvbmVudHMuaGlzdG9yeV9jaGFydHMubG9hZGluZ19oaXN0b3J5XCIpfVxuICAgICAgPC9kaXY+YDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5faXNIaXN0b3J5RW1wdHkoKSkge1xuICAgICAgcmV0dXJuIGh0bWxgPGRpdiBjbGFzcz1cImluZm9cIj5cbiAgICAgICAgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jb21wb25lbnRzLmhpc3RvcnlfY2hhcnRzLm5vX2hpc3RvcnlfZm91bmRcIil9XG4gICAgICA8L2Rpdj5gO1xuICAgIH1cbiAgICBjb25zdCBjb21iaW5lZEl0ZW1zID0gdGhpcy5oaXN0b3J5RGF0YS50aW1lbGluZS5sZW5ndGhcbiAgICAgID8gKHRoaXMudmlydHVhbGl6ZVxuICAgICAgICAgID8gY2h1bmtEYXRhKHRoaXMuaGlzdG9yeURhdGEudGltZWxpbmUsIENBTlZBU19USU1FTElORV9ST1dTX0NIVU5LKVxuICAgICAgICAgIDogW3RoaXMuaGlzdG9yeURhdGEudGltZWxpbmVdXG4gICAgICAgICkuY29uY2F0KHRoaXMuaGlzdG9yeURhdGEubGluZSlcbiAgICAgIDogdGhpcy5oaXN0b3J5RGF0YS5saW5lO1xuXG4gICAgdGhpcy5fY2hhcnRDb3VudCA9IGNvbWJpbmVkSXRlbXMubGVuZ3RoO1xuXG4gICAgcmV0dXJuIHRoaXMudmlydHVhbGl6ZVxuICAgICAgPyBodG1sYDxkaXYgY2xhc3M9XCJjb250YWluZXIgaGEtc2Nyb2xsYmFyXCIgQHNjcm9sbD0ke3RoaXMuX3NhdmVTY3JvbGxQb3N9PlxuICAgICAgICAgIDxsaXQtdmlydHVhbGl6ZXJcbiAgICAgICAgICAgIHNjcm9sbGVyXG4gICAgICAgICAgICBjbGFzcz1cImhhLXNjcm9sbGJhclwiXG4gICAgICAgICAgICAuaXRlbXM9JHtjb21iaW5lZEl0ZW1zfVxuICAgICAgICAgICAgLnJlbmRlckl0ZW09JHt0aGlzLl9yZW5kZXJIaXN0b3J5SXRlbX1cbiAgICAgICAgICA+XG4gICAgICAgICAgPC9saXQtdmlydHVhbGl6ZXI+XG4gICAgICAgIDwvZGl2PmBcbiAgICAgIDogaHRtbGAke2NvbWJpbmVkSXRlbXMubWFwKChpdGVtLCBpbmRleCkgPT5cbiAgICAgICAgICB0aGlzLl9yZW5kZXJIaXN0b3J5SXRlbShpdGVtLCBpbmRleClcbiAgICAgICAgKX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBfcmVuZGVySGlzdG9yeUl0ZW0gPSAoXG4gICAgaXRlbTogVGltZWxpbmVFbnRpdHlbXSB8IExpbmVDaGFydFVuaXQsXG4gICAgaW5kZXg6IG51bWJlclxuICApID0+IHtcbiAgICBpZiAoIWl0ZW0gfHwgaW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIG5vdGhpbmc7XG4gICAgfVxuICAgIGlmICghQXJyYXkuaXNBcnJheShpdGVtKSkge1xuICAgICAgcmV0dXJuIGh0bWxgPGRpdiBjbGFzcz1cImVudHJ5LWNvbnRhaW5lclwiPlxuICAgICAgICA8c3RhdGUtaGlzdG9yeS1jaGFydC1saW5lXG4gICAgICAgICAgLmhhc3M9JHt0aGlzLmhhc3N9XG4gICAgICAgICAgLnVuaXQ9JHtpdGVtLnVuaXR9XG4gICAgICAgICAgLmRhdGE9JHtpdGVtLmRhdGF9XG4gICAgICAgICAgLmlkZW50aWZpZXI9JHtpdGVtLmlkZW50aWZpZXJ9XG4gICAgICAgICAgLnNob3dOYW1lcz0ke3RoaXMuc2hvd05hbWVzfVxuICAgICAgICAgIC5zdGFydFRpbWU9JHt0aGlzLl9jb21wdXRlZFN0YXJ0VGltZX1cbiAgICAgICAgICAuZW5kVGltZT0ke3RoaXMuX2NvbXB1dGVkRW5kVGltZX1cbiAgICAgICAgICAucGFkZGluZ1lBeGlzPSR7dGhpcy5fbWF4WVdpZHRofVxuICAgICAgICAgIC5uYW1lcz0ke3RoaXMubmFtZXN9XG4gICAgICAgICAgLmNoYXJ0SW5kZXg9JHtpbmRleH1cbiAgICAgICAgICAuY2xpY2tGb3JNb3JlSW5mbz0ke3RoaXMuY2xpY2tGb3JNb3JlSW5mb31cbiAgICAgICAgICAubG9nYXJpdGhtaWNTY2FsZT0ke3RoaXMubG9nYXJpdGhtaWNTY2FsZX1cbiAgICAgICAgICAubWluWUF4aXM9JHt0aGlzLm1pbllBeGlzfVxuICAgICAgICAgIC5tYXhZQXhpcz0ke3RoaXMubWF4WUF4aXN9XG4gICAgICAgICAgLmZpdFlEYXRhPSR7dGhpcy5maXRZRGF0YX1cbiAgICAgICAgICBAeS13aWR0aC1jaGFuZ2VkPSR7dGhpcy5feVdpZHRoQ2hhbmdlZH1cbiAgICAgICAgPjwvc3RhdGUtaGlzdG9yeS1jaGFydC1saW5lPlxuICAgICAgPC9kaXY+IGA7XG4gICAgfVxuICAgIHJldHVybiBodG1sYDxkaXYgY2xhc3M9XCJlbnRyeS1jb250YWluZXJcIj5cbiAgICAgIDxzdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lXG4gICAgICAgIC5oYXNzPSR7dGhpcy5oYXNzfVxuICAgICAgICAuZGF0YT0ke2l0ZW19XG4gICAgICAgIC5zdGFydFRpbWU9JHt0aGlzLl9jb21wdXRlZFN0YXJ0VGltZX1cbiAgICAgICAgLmVuZFRpbWU9JHt0aGlzLl9jb21wdXRlZEVuZFRpbWV9XG4gICAgICAgIC5zaG93TmFtZXM9JHt0aGlzLnNob3dOYW1lc31cbiAgICAgICAgLm5hbWVzPSR7dGhpcy5uYW1lc31cbiAgICAgICAgLm5hcnJvdz0ke3RoaXMubmFycm93fVxuICAgICAgICAuY2h1bmtlZD0ke3RoaXMudmlydHVhbGl6ZX1cbiAgICAgICAgLnBhZGRpbmdZQXhpcz0ke3RoaXMuX21heFlXaWR0aH1cbiAgICAgICAgLmNoYXJ0SW5kZXg9JHtpbmRleH1cbiAgICAgICAgLmNsaWNrRm9yTW9yZUluZm89JHt0aGlzLmNsaWNrRm9yTW9yZUluZm99XG4gICAgICAgIEB5LXdpZHRoLWNoYW5nZWQ9JHt0aGlzLl95V2lkdGhDaGFuZ2VkfVxuICAgICAgPjwvc3RhdGUtaGlzdG9yeS1jaGFydC10aW1lbGluZT5cbiAgICA8L2Rpdj4gYDtcbiAgfTtcblxuICBwcm90ZWN0ZWQgc2hvdWxkVXBkYXRlKGNoYW5nZWRQcm9wczogUHJvcGVydHlWYWx1ZXMpOiBib29sZWFuIHtcbiAgICBpZiAoY2hhbmdlZFByb3BzLnNpemUgPT09IDEgJiYgY2hhbmdlZFByb3BzLmhhcyhcImhhc3NcIikpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgY2hhbmdlZFByb3BzLnNpemUgPT09IDEgJiZcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJfbWF4WVdpZHRoXCIpICYmXG4gICAgICBjaGFuZ2VkUHJvcHMuZ2V0KFwiX21heFlXaWR0aFwiKSA9PT0gdGhpcy5fbWF4WVdpZHRoXG4gICAgKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcHJvdGVjdGVkIHdpbGxVcGRhdGUoY2hhbmdlZFByb3BzOiBQcm9wZXJ0eVZhbHVlcykge1xuICAgIGlmICghdGhpcy5oYXNVcGRhdGVkKSB7XG4gICAgICBsb2FkVmlydHVhbGl6ZXIoKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgWy4uLmNoYW5nZWRQcm9wcy5rZXlzKCldLnNvbWUoXG4gICAgICAgIChwcm9wKSA9PlxuICAgICAgICAgICEoXG4gICAgICAgICAgICBbXCJfbWF4WVdpZHRoXCIsIFwiX2NoaWxkWVdpZHRoc1wiLCBcIl9jaGFydENvdW50XCJdIGFzIFByb3BlcnR5S2V5W11cbiAgICAgICAgICApLmluY2x1ZGVzKHByb3ApXG4gICAgICApXG4gICAgKSB7XG4gICAgICAvLyBEb24ndCByZWNvbXB1dGUgdGltZXMgd2hlbiB3ZSBqdXN0IHdhbnQgdG8gdXBkYXRlIGxheW91dFxuICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcblxuICAgICAgdGhpcy5fY29tcHV0ZWRFbmRUaW1lID1cbiAgICAgICAgdGhpcy51cFRvTm93IHx8ICF0aGlzLmVuZFRpbWUgfHwgdGhpcy5lbmRUaW1lID4gbm93XG4gICAgICAgICAgPyBub3dcbiAgICAgICAgICA6IHRoaXMuZW5kVGltZTtcblxuICAgICAgaWYgKHRoaXMuc3RhcnRUaW1lKSB7XG4gICAgICAgIHRoaXMuX2NvbXB1dGVkU3RhcnRUaW1lID0gdGhpcy5zdGFydFRpbWU7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuaG91cnNUb1Nob3cpIHtcbiAgICAgICAgdGhpcy5fY29tcHV0ZWRTdGFydFRpbWUgPSBuZXcgRGF0ZShcbiAgICAgICAgICBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIDYwICogNjAgKiB0aGlzLmhvdXJzVG9TaG93ICogMTAwMFxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fY29tcHV0ZWRTdGFydFRpbWUgPSBuZXcgRGF0ZShcbiAgICAgICAgICAodGhpcy5oaXN0b3J5RGF0YT8udGltZWxpbmUgPz8gW10pLnJlZHVjZShcbiAgICAgICAgICAgIChtaW5UaW1lLCBzdGF0ZUluZm8pID0+XG4gICAgICAgICAgICAgIE1hdGgubWluKFxuICAgICAgICAgICAgICAgIG1pblRpbWUsXG4gICAgICAgICAgICAgICAgbmV3IERhdGUoc3RhdGVJbmZvLmRhdGFbMF0ubGFzdF9jaGFuZ2VkKS5nZXRUaW1lKClcbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCB1cGRhdGVkKGNoYW5nZWRQcm9wczogUHJvcGVydHlWYWx1ZXMpIHtcbiAgICBpZiAoY2hhbmdlZFByb3BzLmhhcyhcIl9jaGFydENvdW50XCIpKSB7XG4gICAgICBpZiAodGhpcy5fY2hhcnRDb3VudCA8IHRoaXMuX2NoaWxkWVdpZHRocy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5fY2hpbGRZV2lkdGhzLmxlbmd0aCA9IHRoaXMuX2NoYXJ0Q291bnQ7XG4gICAgICAgIHRoaXMuX21heFlXaWR0aCA9IE1hdGgubWF4KC4uLk9iamVjdC52YWx1ZXModGhpcy5fY2hpbGRZV2lkdGhzKSwgMCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBfeVdpZHRoQ2hhbmdlZChlOiBDdXN0b21FdmVudDxIQVNTRG9tRXZlbnRzW1wieS13aWR0aC1jaGFuZ2VkXCJdPikge1xuICAgIHRoaXMuX2NoaWxkWVdpZHRoc1tlLmRldGFpbC5jaGFydEluZGV4XSA9IGUuZGV0YWlsLnZhbHVlO1xuICAgIHRoaXMuX21heFlXaWR0aCA9IE1hdGgubWF4KC4uLk9iamVjdC52YWx1ZXModGhpcy5fY2hpbGRZV2lkdGhzKSwgMCk7XG4gIH1cblxuICBwcml2YXRlIF9pc0hpc3RvcnlFbXB0eSgpOiBib29sZWFuIHtcbiAgICBjb25zdCBoaXN0b3J5RGF0YUVtcHR5ID1cbiAgICAgICF0aGlzLmhpc3RvcnlEYXRhIHx8XG4gICAgICAhdGhpcy5oaXN0b3J5RGF0YS50aW1lbGluZSB8fFxuICAgICAgIXRoaXMuaGlzdG9yeURhdGEubGluZSB8fFxuICAgICAgKHRoaXMuaGlzdG9yeURhdGEudGltZWxpbmUubGVuZ3RoID09PSAwICYmXG4gICAgICAgIHRoaXMuaGlzdG9yeURhdGEubGluZS5sZW5ndGggPT09IDApO1xuICAgIHJldHVybiAhdGhpcy5pc0xvYWRpbmdEYXRhICYmIGhpc3RvcnlEYXRhRW1wdHk7XG4gIH1cblxuICBAZXZlbnRPcHRpb25zKHsgcGFzc2l2ZTogdHJ1ZSB9KVxuICBwcml2YXRlIF9zYXZlU2Nyb2xsUG9zKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5fc2F2ZWRTY3JvbGxQb3MgPSAoZS50YXJnZXQgYXMgSFRNTERpdkVsZW1lbnQpLnNjcm9sbFRvcDtcbiAgfVxuXG4gIHN0YXRpYyBnZXQgc3R5bGVzKCk6IENTU1Jlc3VsdEdyb3VwIHtcbiAgICByZXR1cm4gY3NzYFxuICAgICAgOmhvc3Qge1xuICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgLyogaGVpZ2h0IG9mIHNpbmdsZSB0aW1lbGluZSBjaGFydCA9IDYwcHggKi9cbiAgICAgICAgbWluLWhlaWdodDogNjBweDtcbiAgICAgIH1cblxuICAgICAgOmhvc3QoW3ZpcnR1YWxpemVdKSB7XG4gICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgIH1cblxuICAgICAgLmluZm8ge1xuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiA2MHB4O1xuICAgICAgICBjb2xvcjogdmFyKC0tc2Vjb25kYXJ5LXRleHQtY29sb3IpO1xuICAgICAgfVxuXG4gICAgICAuY29udGFpbmVyIHtcbiAgICAgICAgbWF4LWhlaWdodDogdmFyKC0taGlzdG9yeS1tYXgtaGVpZ2h0KTtcbiAgICAgIH1cblxuICAgICAgLmVudHJ5LWNvbnRhaW5lciB7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgfVxuXG4gICAgICAuZW50cnktY29udGFpbmVyOmhvdmVyIHtcbiAgICAgICAgei1pbmRleDogMTtcbiAgICAgIH1cblxuICAgICAgOmhvc3QoW3ZpcnR1YWxpemVdKSAuZW50cnktY29udGFpbmVyIHtcbiAgICAgICAgcGFkZGluZy1sZWZ0OiAxcHg7XG4gICAgICAgIHBhZGRpbmctcmlnaHQ6IDFweDtcbiAgICAgICAgcGFkZGluZy1pbmxpbmUtc3RhcnQ6IDFweDtcbiAgICAgICAgcGFkZGluZy1pbmxpbmUtZW5kOiAxcHg7XG4gICAgICB9XG5cbiAgICAgIC5lbnRyeS1jb250YWluZXI6bm90KDpmaXJzdC1jaGlsZCkge1xuICAgICAgICBib3JkZXItdG9wOiAycHggc29saWQgdmFyKC0tZGl2aWRlci1jb2xvcik7XG4gICAgICAgIG1hcmdpbi10b3A6IDE2cHg7XG4gICAgICB9XG5cbiAgICAgIC5jb250YWluZXIsXG4gICAgICBsaXQtdmlydHVhbGl6ZXIge1xuICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgfVxuXG4gICAgICBsaXQtdmlydHVhbGl6ZXIge1xuICAgICAgICBjb250YWluOiBzaXplIGxheW91dCAhaW1wb3J0YW50O1xuICAgICAgfVxuXG4gICAgICBzdGF0ZS1oaXN0b3J5LWNoYXJ0LXRpbWVsaW5lLFxuICAgICAgc3RhdGUtaGlzdG9yeS1jaGFydC1saW5lIHtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICB9XG4gICAgYDtcbiAgfVxufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBIVE1MRWxlbWVudFRhZ05hbWVNYXAge1xuICAgIFwic3RhdGUtaGlzdG9yeS1jaGFydHNcIjogU3RhdGVIaXN0b3J5Q2hhcnRzO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/components/chart/state-history-charts.ts\n");

/***/ }),

/***/ "./src/resources/virtualizer.ts":
/*!**************************************!*\
  !*** ./src/resources/virtualizer.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   loadVirtualizer: () => (/* binding */ loadVirtualizer)\n/* harmony export */ });\n/* harmony import */ var _resize_observer_polyfill__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./resize-observer.polyfill */ \"./src/resources/resize-observer.polyfill.ts\");\n\nconst loadVirtualizer = async () => {\n  await (0,_resize_observer_polyfill__WEBPACK_IMPORTED_MODULE_0__.loadPolyfillIfNeeded)();\n  await Promise.all(/*! import() */[__webpack_require__.e(\"vendors-node_modules_lit_directives_repeat_js\"), __webpack_require__.e(\"vendors-node_modules_lit-labs_virtualizer_lit-virtualizer_js\")]).then(__webpack_require__.bind(__webpack_require__, /*! @lit-labs/virtualizer */ \"./node_modules/@lit-labs/virtualizer/lit-virtualizer.js\"));\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVzb3VyY2VzL3ZpcnR1YWxpemVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL3Jlc291cmNlcy92aXJ0dWFsaXplci50cz80YjA0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxvYWRQb2x5ZmlsbElmTmVlZGVkIH0gZnJvbSBcIi4vcmVzaXplLW9ic2VydmVyLnBvbHlmaWxsXCI7XG5cbmV4cG9ydCBjb25zdCBsb2FkVmlydHVhbGl6ZXIgPSBhc3luYyAoKSA9PiB7XG4gIGF3YWl0IGxvYWRQb2x5ZmlsbElmTmVlZGVkKCk7XG4gIGF3YWl0IGltcG9ydChcIkBsaXQtbGFicy92aXJ0dWFsaXplclwiKTtcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/resources/virtualizer.ts\n");

/***/ })

};
