{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport { STATE_NOT_RUNNING } from \"home-assistant-js-websocket\";\nimport { ReactiveElement } from \"lit\";\nimport { customElement } from \"lit/decorators\";\nimport { isComponentLoaded } from \"../../../common/config/is_component_loaded\";\nimport { getEnergyPreferences } from \"../../../data/energy\";\nimport { generateDefaultViewConfig } from \"../common/generate-lovelace-config\";\nexport var OriginalStatesViewStrategy = _decorate([customElement(\"original-states-view-strategy\")], function (_initialize, _ReactiveElement) {\n  var OriginalStatesViewStrategy = /*#__PURE__*/function (_ReactiveElement2) {\n    _inherits(OriginalStatesViewStrategy, _ReactiveElement2);\n    function OriginalStatesViewStrategy() {\n      var _this;\n      _classCallCheck(this, OriginalStatesViewStrategy);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, OriginalStatesViewStrategy, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(OriginalStatesViewStrategy);\n  }(_ReactiveElement);\n  return {\n    F: OriginalStatesViewStrategy,\n    d: [{\n      kind: \"method\",\n      static: true,\n      key: \"generate\",\n      value: function () {\n        var _generate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(config, hass) {\n          var _yield$Promise$all, _yield$Promise$all2, localize, energyPrefs, view;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                if (!(hass.config.state === STATE_NOT_RUNNING)) {\n                  _context.next = 2;\n                  break;\n                }\n                return _context.abrupt(\"return\", {\n                  cards: [{\n                    type: \"starting\"\n                  }]\n                });\n              case 2:\n                if (!hass.config.recovery_mode) {\n                  _context.next = 4;\n                  break;\n                }\n                return _context.abrupt(\"return\", {\n                  cards: [{\n                    type: \"recovery-mode\"\n                  }]\n                });\n              case 4:\n                _context.next = 6;\n                return Promise.all([hass.loadBackendTranslation(\"title\"), isComponentLoaded(hass, \"energy\") ?\n                // It raises if not configured, just swallow that.\n                getEnergyPreferences(hass).catch(function () {\n                  return undefined;\n                }) : undefined]);\n              case 6:\n                _yield$Promise$all = _context.sent;\n                _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 2);\n                localize = _yield$Promise$all2[0];\n                energyPrefs = _yield$Promise$all2[1];\n                // User can override default view. If they didn't, we will add one\n                // that contains all entities.\n                view = generateDefaultViewConfig(hass.areas, hass.devices, hass.entities, hass.states, localize, energyPrefs, config.areas, config.hide_entities_without_area, config.hide_energy); // Add map of geo locations to default view if loaded\n                if (hass.config.components.includes(\"geo_location\")) {\n                  if (view && view.cards) {\n                    view.cards.push({\n                      type: \"map\",\n                      geo_location_sources: [\"all\"]\n                    });\n                  }\n                }\n\n                // User has no entities\n                if (view.cards.length === 0) {\n                  view.cards.push({\n                    type: \"empty-state\"\n                  });\n                }\n                return _context.abrupt(\"return\", view);\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n        function generate(_x, _x2) {\n          return _generate.apply(this, arguments);\n        }\n        return generate;\n      }()\n    }]\n  };\n}, ReactiveElement);","map":{"version":3,"names":["STATE_NOT_RUNNING","ReactiveElement","customElement","isComponentLoaded","getEnergyPreferences","generateDefaultViewConfig","OriginalStatesViewStrategy","_decorate","_initialize","_ReactiveElement","_ReactiveElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","static","key","value","_generate","_asyncToGenerator","_regeneratorRuntime","mark","_callee","config","hass","_yield$Promise$all","_yield$Promise$all2","localize","energyPrefs","view","wrap","_callee$","_context","prev","next","state","abrupt","cards","type","recovery_mode","Promise","all","loadBackendTranslation","catch","undefined","sent","_slicedToArray","areas","devices","entities","states","hide_entities_without_area","hide_energy","components","includes","push","geo_location_sources","stop","generate","_x","_x2","apply"],"sources":["/workspaces/frontend/src/panels/lovelace/strategies/original-states-view-strategy.ts"],"sourcesContent":["import { STATE_NOT_RUNNING } from \"home-assistant-js-websocket\";\nimport { ReactiveElement } from \"lit\";\nimport { customElement } from \"lit/decorators\";\nimport { isComponentLoaded } from \"../../../common/config/is_component_loaded\";\nimport type { AreaFilterValue } from \"../../../components/ha-area-filter\";\nimport { getEnergyPreferences } from \"../../../data/energy\";\nimport { LovelaceViewConfig } from \"../../../data/lovelace/config/view\";\nimport { HomeAssistant } from \"../../../types\";\nimport { generateDefaultViewConfig } from \"../common/generate-lovelace-config\";\n\nexport type OriginalStatesViewStrategyConfig = {\n  type: \"original-states\";\n  areas?: AreaFilterValue;\n  hide_entities_without_area?: boolean;\n  hide_energy?: boolean;\n};\n\n@customElement(\"original-states-view-strategy\")\nexport class OriginalStatesViewStrategy extends ReactiveElement {\n  static async generate(\n    config: OriginalStatesViewStrategyConfig,\n    hass: HomeAssistant\n  ): Promise<LovelaceViewConfig> {\n    if (hass.config.state === STATE_NOT_RUNNING) {\n      return {\n        cards: [{ type: \"starting\" }],\n      };\n    }\n\n    if (hass.config.recovery_mode) {\n      return {\n        cards: [{ type: \"recovery-mode\" }],\n      };\n    }\n\n    const [localize, energyPrefs] = await Promise.all([\n      hass.loadBackendTranslation(\"title\"),\n      isComponentLoaded(hass, \"energy\")\n        ? // It raises if not configured, just swallow that.\n          getEnergyPreferences(hass).catch(() => undefined)\n        : undefined,\n    ]);\n\n    // User can override default view. If they didn't, we will add one\n    // that contains all entities.\n    const view = generateDefaultViewConfig(\n      hass.areas,\n      hass.devices,\n      hass.entities,\n      hass.states,\n      localize,\n      energyPrefs,\n      config.areas,\n      config.hide_entities_without_area,\n      config.hide_energy\n    );\n\n    // Add map of geo locations to default view if loaded\n    if (hass.config.components.includes(\"geo_location\")) {\n      if (view && view.cards) {\n        view.cards.push({\n          type: \"map\",\n          geo_location_sources: [\"all\"],\n        });\n      }\n    }\n\n    // User has no entities\n    if (view.cards!.length === 0) {\n      view.cards!.push({\n        type: \"empty-state\",\n      });\n    }\n\n    return view;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"original-states-view-strategy\": OriginalStatesViewStrategy;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}