{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.assign.js\";\nexport var generateImageThumbnailUrl = function generateImageThumbnailUrl(mediaId, size) {\n  return \"/api/image/serve/\".concat(mediaId, \"/\").concat(size, \"x\").concat(size);\n};\nexport var fetchImages = function fetchImages(hass) {\n  return hass.callWS({\n    type: \"image/list\"\n  });\n};\nexport var createImage = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(hass, file) {\n    var fd, resp;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          fd = new FormData();\n          fd.append(\"file\", file);\n          _context.next = 4;\n          return hass.fetchWithAuth(\"/api/image/upload\", {\n            method: \"POST\",\n            body: fd\n          });\n        case 4:\n          resp = _context.sent;\n          if (!(resp.status === 413)) {\n            _context.next = 9;\n            break;\n          }\n          throw new Error(\"Uploaded image is too large (\".concat(file.name, \")\"));\n        case 9:\n          if (!(resp.status !== 200)) {\n            _context.next = 11;\n            break;\n          }\n          throw new Error(\"Unknown error\");\n        case 11:\n          return _context.abrupt(\"return\", resp.json());\n        case 12:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function createImage(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var updateImage = function updateImage(hass, id, updates) {\n  return hass.callWS(Object.assign({\n    type: \"image/update\",\n    media_id: id\n  }, updates));\n};\nexport var deleteImage = function deleteImage(hass, id) {\n  return hass.callWS({\n    type: \"image/delete\",\n    media_id: id\n  });\n};","map":{"version":3,"names":["generateImageThumbnailUrl","mediaId","size","concat","fetchImages","hass","callWS","type","createImage","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","file","fd","resp","wrap","_callee$","_context","prev","next","FormData","append","fetchWithAuth","method","body","sent","status","Error","name","abrupt","json","stop","_x","_x2","apply","arguments","updateImage","id","updates","Object","assign","media_id","deleteImage"],"sources":["/Users/sercanardil/Desktop/frontend/src/data/image_upload.ts"],"sourcesContent":["import { HomeAssistant } from \"../types\";\n\ninterface Image {\n  filesize: number;\n  name: string;\n  uploaded_at: string; // isoformat date\n  content_type: string;\n  id: string;\n}\n\nexport interface ImageMutableParams {\n  name: string;\n}\n\nexport const generateImageThumbnailUrl = (mediaId: string, size: number) =>\n  `/api/image/serve/${mediaId}/${size}x${size}`;\n\nexport const fetchImages = (hass: HomeAssistant) =>\n  hass.callWS<Image[]>({ type: \"image/list\" });\n\nexport const createImage = async (\n  hass: HomeAssistant,\n  file: File\n): Promise<Image> => {\n  const fd = new FormData();\n  fd.append(\"file\", file);\n  const resp = await hass.fetchWithAuth(\"/api/image/upload\", {\n    method: \"POST\",\n    body: fd,\n  });\n  if (resp.status === 413) {\n    throw new Error(`Uploaded image is too large (${file.name})`);\n  } else if (resp.status !== 200) {\n    throw new Error(\"Unknown error\");\n  }\n  return resp.json();\n};\n\nexport const updateImage = (\n  hass: HomeAssistant,\n  id: string,\n  updates: Partial<ImageMutableParams>\n) =>\n  hass.callWS<Image>({\n    type: \"image/update\",\n    media_id: id,\n    ...updates,\n  });\n\nexport const deleteImage = (hass: HomeAssistant, id: string) =>\n  hass.callWS({\n    type: \"image/delete\",\n    media_id: id,\n  });\n"],"mappings":";;;;;;AAcA,OAAO,IAAMA,yBAAyB,GAAG,SAA5BA,yBAAyBA,CAAIC,OAAe,EAAEC,IAAY;EAAA,2BAAAC,MAAA,CACjDF,OAAO,OAAAE,MAAA,CAAID,IAAI,OAAAC,MAAA,CAAID,IAAI;AAAA,CAAE;AAE/C,OAAO,IAAME,WAAW,GAAG,SAAdA,WAAWA,CAAIC,IAAmB;EAAA,OAC7CA,IAAI,CAACC,MAAM,CAAU;IAAEC,IAAI,EAAE;EAAa,CAAC,CAAC;AAAA;AAE9C,OAAO,IAAMC,WAAW;EAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QACzBR,IAAmB,EACnBS,IAAU;IAAA,IAAAC,EAAA,EAAAC,IAAA;IAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAEJN,EAAE,GAAG,IAAIO,QAAQ,CAAC,CAAC;UACzBP,EAAE,CAACQ,MAAM,CAAC,MAAM,EAAET,IAAI,CAAC;UAACK,QAAA,CAAAE,IAAA;UAAA,OACLhB,IAAI,CAACmB,aAAa,CAAC,mBAAmB,EAAE;YACzDC,MAAM,EAAE,MAAM;YACdC,IAAI,EAAEX;UACR,CAAC,CAAC;QAAA;UAHIC,IAAI,GAAAG,QAAA,CAAAQ,IAAA;UAAA,MAINX,IAAI,CAACY,MAAM,KAAK,GAAG;YAAAT,QAAA,CAAAE,IAAA;YAAA;UAAA;UAAA,MACf,IAAIQ,KAAK,iCAAA1B,MAAA,CAAiCW,IAAI,CAACgB,IAAI,MAAG,CAAC;QAAA;UAAA,MACpDd,IAAI,CAACY,MAAM,KAAK,GAAG;YAAAT,QAAA,CAAAE,IAAA;YAAA;UAAA;UAAA,MACtB,IAAIQ,KAAK,CAAC,eAAe,CAAC;QAAA;UAAA,OAAAV,QAAA,CAAAY,MAAA,WAE3Bf,IAAI,CAACgB,IAAI,CAAC,CAAC;QAAA;QAAA;UAAA,OAAAb,QAAA,CAAAc,IAAA;MAAA;IAAA,GAAApB,OAAA;EAAA,CACnB;EAAA,gBAhBYL,WAAWA,CAAA0B,EAAA,EAAAC,GAAA;IAAA,OAAA1B,IAAA,CAAA2B,KAAA,OAAAC,SAAA;EAAA;AAAA,GAgBvB;AAED,OAAO,IAAMC,WAAW,GAAG,SAAdA,WAAWA,CACtBjC,IAAmB,EACnBkC,EAAU,EACVC,OAAoC;EAAA,OAEpCnC,IAAI,CAACC,MAAM,CAAAmC,MAAA,CAAAC,MAAA;IACTnC,IAAI,EAAE,cAAc;IACpBoC,QAAQ,EAAEJ;EAAE,GACTC,OAAO,CACX,CAAC;AAAA;AAEJ,OAAO,IAAMI,WAAW,GAAG,SAAdA,WAAWA,CAAIvC,IAAmB,EAAEkC,EAAU;EAAA,OACzDlC,IAAI,CAACC,MAAM,CAAC;IACVC,IAAI,EAAE,cAAc;IACpBoC,QAAQ,EAAEJ;EACZ,CAAC,CAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}