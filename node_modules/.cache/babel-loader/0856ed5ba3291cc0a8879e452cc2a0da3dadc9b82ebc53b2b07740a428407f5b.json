{"ast":null,"code":"export const loggingMixin = superClass => class extends superClass {\n  hassConnected() {\n    super.hassConnected();\n    window.addEventListener(\"error\", async ev => {\n      var _this$hass;\n      if (!((_this$hass = this.hass) !== null && _this$hass !== void 0 && _this$hass.connected)) {\n        return;\n      }\n      if (!__DEV__ && (ev.message.includes(\"ResizeObserver loop limit exceeded\") || ev.message.includes(\"ResizeObserver loop completed with undelivered notifications\"))) {\n        ev.preventDefault();\n        ev.stopImmediatePropagation();\n        ev.stopPropagation();\n        return;\n      }\n      try {\n        const {\n          createLogMessage\n        } = await import(\"../resources/log-message\");\n        const message = await createLogMessage(ev.error, \"Uncaught error\",\n        // The error object from browsers includes the message and a stack trace,\n        // so use the data in the error event just as fallback\n        ev.message, `@${ev.filename}:${ev.lineno}:${ev.colno}`);\n        await this._writeLog({\n          message\n        });\n      } catch (e) {\n        // catch errors during logging so we don't get into a loop\n        // eslint-disable-next-line no-console\n        console.error(\"Failure writing uncaught error to system log:\", e);\n      }\n    });\n    window.addEventListener(\"unhandledrejection\", async ev => {\n      var _this$hass2;\n      if (!((_this$hass2 = this.hass) !== null && _this$hass2 !== void 0 && _this$hass2.connected)) {\n        return;\n      }\n      try {\n        const {\n          createLogMessage\n        } = await import(\"../resources/log-message\");\n        const message = await createLogMessage(ev.reason, \"Unhandled promise rejection\");\n        await this._writeLog({\n          message,\n          level: \"debug\"\n        });\n      } catch (e) {\n        // catch errors during logging so we don't get into a loop\n        // eslint-disable-next-line no-console\n        console.error(\"Failure writing unhandled promise rejection to system log:\", e);\n      }\n    });\n  }\n  firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    this.addEventListener(\"write_log\", ev => {\n      this._writeLog(ev.detail);\n    });\n  }\n  _writeLog(log) {\n    var _this$hass3;\n    return (_this$hass3 = this.hass) === null || _this$hass3 === void 0 ? void 0 : _this$hass3.callService(\"system_log\", \"write\", {\n      logger: `frontend.${__DEV__ ? \"js_dev\" : \"js\"}.${__BUILD__}.${__VERSION__.replace(\".\", \"\")}`,\n      message: log.message,\n      level: log.level || \"error\"\n    }, undefined, false);\n  }\n};","map":{"version":3,"names":["loggingMixin","superClass","hassConnected","window","addEventListener","ev","_this$hass","hass","connected","__DEV__","message","includes","preventDefault","stopImmediatePropagation","stopPropagation","createLogMessage","error","filename","lineno","colno","_writeLog","e","console","_this$hass2","reason","level","firstUpdated","changedProps","detail","log","_this$hass3","callService","logger","__BUILD__","__VERSION__","replace","undefined"],"sources":["/Users/sercanardil/Desktop/frontend/src/state/logging-mixin.ts"],"sourcesContent":["import { HASSDomEvent } from \"../common/dom/fire_event\";\nimport { SystemLogLevel } from \"../data/system_log\";\nimport { Constructor } from \"../types\";\nimport { HassBaseEl } from \"./hass-base-mixin\";\n\ninterface WriteLogParams {\n  level?: SystemLogLevel;\n  message: string;\n}\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    write_log: WriteLogParams;\n  }\n  interface HTMLElementEventMap {\n    write_log: HASSDomEvent<WriteLogParams>;\n  }\n}\n\nexport const loggingMixin = <T extends Constructor<HassBaseEl>>(\n  superClass: T\n) =>\n  class extends superClass {\n    protected hassConnected() {\n      super.hassConnected();\n      window.addEventListener(\"error\", async (ev) => {\n        if (!this.hass?.connected) {\n          return;\n        }\n        if (\n          !__DEV__ &&\n          (ev.message.includes(\"ResizeObserver loop limit exceeded\") ||\n            ev.message.includes(\n              \"ResizeObserver loop completed with undelivered notifications\"\n            ))\n        ) {\n          ev.preventDefault();\n          ev.stopImmediatePropagation();\n          ev.stopPropagation();\n          return;\n        }\n        try {\n          const { createLogMessage } = await import(\"../resources/log-message\");\n          const message = await createLogMessage(\n            ev.error,\n            \"Uncaught error\",\n            // The error object from browsers includes the message and a stack trace,\n            // so use the data in the error event just as fallback\n            ev.message,\n            `@${ev.filename}:${ev.lineno}:${ev.colno}`\n          );\n          await this._writeLog({ message });\n        } catch (e) {\n          // catch errors during logging so we don't get into a loop\n          // eslint-disable-next-line no-console\n          console.error(\"Failure writing uncaught error to system log:\", e);\n        }\n      });\n      window.addEventListener(\"unhandledrejection\", async (ev) => {\n        if (!this.hass?.connected) {\n          return;\n        }\n        try {\n          const { createLogMessage } = await import(\"../resources/log-message\");\n          const message = await createLogMessage(\n            ev.reason,\n            \"Unhandled promise rejection\"\n          );\n          await this._writeLog({\n            message,\n            level: \"debug\",\n          });\n        } catch (e) {\n          // catch errors during logging so we don't get into a loop\n          // eslint-disable-next-line no-console\n          console.error(\n            \"Failure writing unhandled promise rejection to system log:\",\n            e\n          );\n        }\n      });\n    }\n\n    protected firstUpdated(changedProps) {\n      super.firstUpdated(changedProps);\n      this.addEventListener(\"write_log\", (ev) => {\n        this._writeLog(ev.detail);\n      });\n    }\n\n    private _writeLog(log: WriteLogParams) {\n      return this.hass?.callService(\n        \"system_log\",\n        \"write\",\n        {\n          logger: `frontend.${\n            __DEV__ ? \"js_dev\" : \"js\"\n          }.${__BUILD__}.${__VERSION__.replace(\".\", \"\")}`,\n          message: log.message,\n          level: log.level || \"error\",\n        },\n        undefined,\n        false\n      );\n    }\n  };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}