{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7;\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport { ResizeController } from \"@lit-labs/observers/resize-controller\";\nimport \"@material/mwc-list\";\nvar mdiChevronDown = \"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z\";\nvar mdiPlus = \"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z\";\nvar mdiRefresh = \"M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z\";\nimport { LitElement, css, html, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport { storage } from \"../../common/decorators/storage\";\nimport { computeStateName } from \"../../common/entity/compute_state_name\";\nimport \"../../components/ha-button\";\nimport \"../../components/ha-button-menu\";\nimport \"../../components/ha-card\";\nimport \"../../components/ha-check-list-item\";\nimport \"../../components/ha-icon-button\";\nimport \"../../components/ha-menu-button\";\nimport \"../../components/ha-state-icon\";\nimport \"../../components/ha-svg-icon\";\nimport \"../../components/ha-two-pane-top-app-bar-fixed\";\nimport { fetchCalendarEvents, getCalendars } from \"../../data/calendar\";\nimport { fetchIntegrationManifest } from \"../../data/integration\";\nimport { showConfigFlowDialog } from \"../../dialogs/config-flow/show-dialog-config-flow\";\nimport { haStyle } from \"../../resources/styles\";\nimport \"./ha-full-calendar\";\nvar PanelCalendar = _decorate([customElement(\"ha-panel-calendar\")], function (_initialize, _LitElement) {\n  var PanelCalendar = /*#__PURE__*/function (_LitElement2) {\n    _inherits(PanelCalendar, _LitElement2);\n    function PanelCalendar() {\n      var _this;\n      _classCallCheck(this, PanelCalendar);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, PanelCalendar, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(PanelCalendar);\n  }(_LitElement);\n  return {\n    F: PanelCalendar,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean,\n        reflect: true\n      })],\n      key: \"narrow\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean,\n        reflect: true\n      })],\n      key: \"mobile\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_calendars\",\n      value: function value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_events\",\n      value: function value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_error\",\n      value: function value() {\n        return undefined;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [storage({\n        key: \"deSelectedCalendars\",\n        state: true\n      })],\n      key: \"_deSelectedCalendars\",\n      value: function value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      key: \"_start\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_end\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_showPaneController\",\n      value: function value() {\n        return new ResizeController(this, {\n          callback: function callback(entries) {\n            var _entries$;\n            return ((_entries$ = entries[0]) === null || _entries$ === void 0 ? void 0 : _entries$.contentRect.width) > 750;\n          }\n        });\n      }\n    }, {\n      kind: \"field\",\n      key: \"_mql\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_headerHeight\",\n      value: function value() {\n        return 56;\n      }\n    }, {\n      kind: \"method\",\n      key: \"connectedCallback\",\n      value: function connectedCallback() {\n        _get(_getPrototypeOf(PanelCalendar.prototype), \"connectedCallback\", this).call(this);\n        this._mql = window.matchMedia(\"(max-width: 450px), all and (max-height: 500px)\");\n        this._mql.addListener(this._setIsMobile);\n        this.mobile = this._mql.matches;\n        var computedStyles = getComputedStyle(this);\n        this._headerHeight = Number(computedStyles.getPropertyValue(\"--header-height\").replace(\"px\", \"\"));\n      }\n    }, {\n      kind: \"method\",\n      key: \"disconnectedCallback\",\n      value: function disconnectedCallback() {\n        var _this$_mql;\n        _get(_getPrototypeOf(PanelCalendar.prototype), \"disconnectedCallback\", this).call(this);\n        (_this$_mql = this._mql) === null || _this$_mql === void 0 || _this$_mql.removeListener(this._setIsMobile);\n        this._mql = undefined;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_setIsMobile\",\n      value: function value() {\n        var _this2 = this;\n        return function (ev) {\n          _this2.mobile = ev.matches;\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        _get(_getPrototypeOf(PanelCalendar.prototype), \"willUpdate\", this).call(this, changedProps);\n        if (!this.hasUpdated) {\n          this._calendars = getCalendars(this.hass);\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        var _this3 = this,\n          _this$_showPaneContro,\n          _this$hass$user,\n          _this$hass$user2;\n        var calendarItems = this._calendars.map(function (selCal) {\n          return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n        <ha-check-list-item\\n          @request-selected=\", \"\\n          graphic=\\\"icon\\\"\\n          style=\", \"\\n          .value=\", \"\\n          .selected=\", \"\\n        >\\n          <ha-state-icon\\n            slot=\\\"graphic\\\"\\n            .hass=\", \"\\n            .stateObj=\", \"\\n          ></ha-state-icon>\\n          \", \"\\n        </ha-check-list-item>\\n      \"])), _this3._requestSelected, styleMap({\n            \"--mdc-theme-secondary\": selCal.backgroundColor\n          }), selCal.entity_id, !_this3._deSelectedCalendars.includes(selCal.entity_id), _this3.hass, selCal, selCal.name);\n        });\n        var showPane = (_this$_showPaneContro = this._showPaneController.value) !== null && _this$_showPaneContro !== void 0 ? _this$_showPaneContro : !this.narrow;\n        return html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n      <ha-two-pane-top-app-bar-fixed .pane=\", \" footer>\\n        <ha-menu-button\\n          slot=\\\"navigationIcon\\\"\\n          .hass=\", \"\\n          .narrow=\", \"\\n        ></ha-menu-button>\\n\\n        \", \"\\n        <ha-icon-button\\n          slot=\\\"actionItems\\\"\\n          .path=\", \"\\n          .label=\", \"\\n          @click=\", \"\\n        ></ha-icon-button>\\n        \", \"\\n        <ha-full-calendar\\n          .events=\", \"\\n          .calendars=\", \"\\n          .narrow=\", \"\\n          .initialView=\", \"\\n          .hass=\", \"\\n          .error=\", \"\\n          @view-changed=\", \"\\n        ></ha-full-calendar>\\n      </ha-two-pane-top-app-bar-fixed>\\n    \"])), showPane, this.hass, this.narrow, !showPane ? html(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"<ha-button-menu\\n              slot=\\\"title\\\"\\n              class=\\\"lists\\\"\\n              multi\\n              fixed\\n              .noAnchor=\", \"\\n              .y=\", \"\\n              .x=\", \"\\n            >\\n              <ha-button slot=\\\"trigger\\\">\\n                \", \"\\n                <ha-svg-icon\\n                  slot=\\\"trailingIcon\\\"\\n                  .path=\", \"\\n                ></ha-svg-icon>\\n              </ha-button>\\n              \", \"\\n              \", \"\\n            </ha-button-menu>\"])), this.mobile, this.mobile ? this._headerHeight / 2 : this._headerHeight / 4, this.mobile ? 0 : undefined, this.hass.localize(\"ui.components.calendar.my_calendars\"), mdiChevronDown, calendarItems, (_this$hass$user = this.hass.user) !== null && _this$hass$user !== void 0 && _this$hass$user.is_admin ? html(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\" <li divider role=\\\"separator\\\"></li>\\n                    <ha-list-item graphic=\\\"icon\\\" @click=\", \">\\n                      <ha-svg-icon\\n                        .path=\", \"\\n                        slot=\\\"graphic\\\"\\n                      ></ha-svg-icon>\\n                      \", \"\\n                    </ha-list-item>\"])), this._addCalendar, mdiPlus, this.hass.localize(\"ui.components.calendar.create_calendar\")) : nothing) : html(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"<div slot=\\\"title\\\">\\n              \", \"\\n            </div>\"])), this.hass.localize(\"ui.components.calendar.my_calendars\")), mdiRefresh, this.hass.localize(\"ui.common.refresh\"), this._handleRefresh, showPane && (_this$hass$user2 = this.hass.user) !== null && _this$hass$user2 !== void 0 && _this$hass$user2.is_admin ? html(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"<mwc-list slot=\\\"pane\\\" multi}>\", \"</mwc-list>\\n              <ha-list-item\\n                graphic=\\\"icon\\\"\\n                slot=\\\"pane-footer\\\"\\n                @click=\", \"\\n              >\\n                <ha-svg-icon .path=\", \" slot=\\\"graphic\\\"></ha-svg-icon>\\n                \", \"\\n              </ha-list-item>\"])), calendarItems, this._addCalendar, mdiPlus, this.hass.localize(\"ui.components.calendar.create_calendar\")) : nothing, this._events, this._calendars, this.narrow, this.narrow ? \"listWeek\" : \"dayGridMonth\", this.hass, this._error, this._handleViewChanged);\n      }\n    }, {\n      kind: \"get\",\n      key: \"_selectedCalendars\",\n      value: function _selectedCalendars() {\n        var _this4 = this;\n        return this._calendars.filter(function (selCal) {\n          return !_this4._deSelectedCalendars.includes(selCal.entity_id);\n        }).map(function (cal) {\n          return cal;\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_fetchEvents\",\n      value: function () {\n        var _fetchEvents2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(start, end, calendars) {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                if (!(!calendars.length || !start || !end)) {\n                  _context.next = 2;\n                  break;\n                }\n                return _context.abrupt(\"return\", {\n                  events: [],\n                  errors: []\n                });\n              case 2:\n                return _context.abrupt(\"return\", fetchCalendarEvents(this.hass, start, end, calendars));\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this);\n        }));\n        function _fetchEvents(_x, _x2, _x3) {\n          return _fetchEvents2.apply(this, arguments);\n        }\n        return _fetchEvents;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_requestSelected\",\n      value: function () {\n        var _requestSelected2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(ev) {\n          var entityId, calendar, result;\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                ev.stopPropagation();\n                entityId = ev.target.value;\n                if (!ev.detail.selected) {\n                  _context2.next = 16;\n                  break;\n                }\n                this._deSelectedCalendars = this._deSelectedCalendars.filter(function (cal) {\n                  return cal !== entityId;\n                });\n                if (!(ev.detail.source === \"interaction\")) {\n                  _context2.next = 6;\n                  break;\n                }\n                return _context2.abrupt(\"return\");\n              case 6:\n                calendar = this._calendars.find(function (cal) {\n                  return cal.entity_id === entityId;\n                });\n                if (calendar) {\n                  _context2.next = 9;\n                  break;\n                }\n                return _context2.abrupt(\"return\");\n              case 9:\n                _context2.next = 11;\n                return this._fetchEvents(this._start, this._end, [calendar]);\n              case 11:\n                result = _context2.sent;\n                this._events = [].concat(_toConsumableArray(this._events), _toConsumableArray(result.events));\n                this._handleErrors(result.errors);\n                _context2.next = 18;\n                break;\n              case 16:\n                this._deSelectedCalendars = [].concat(_toConsumableArray(this._deSelectedCalendars), [entityId]);\n                this._events = this._events.filter(function (event) {\n                  return event.calendar !== entityId;\n                });\n              case 18:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2, this);\n        }));\n        function _requestSelected(_x4) {\n          return _requestSelected2.apply(this, arguments);\n        }\n        return _requestSelected;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_addCalendar\",\n      value: function () {\n        var _addCalendar2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n          var _this$hass$userData,\n            _this5 = this;\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.t0 = showConfigFlowDialog;\n                _context3.t1 = this;\n                _context3.t2 = (_this$hass$userData = this.hass.userData) === null || _this$hass$userData === void 0 ? void 0 : _this$hass$userData.showAdvanced;\n                _context3.next = 5;\n                return fetchIntegrationManifest(this.hass, \"local_calendar\");\n              case 5:\n                _context3.t3 = _context3.sent;\n                _context3.t4 = function dialogClosedCallback(_ref) {\n                  var flowFinished = _ref.flowFinished;\n                  if (flowFinished) {\n                    _this5._calendars = getCalendars(_this5.hass);\n                  }\n                };\n                _context3.t5 = {\n                  startFlowHandler: \"local_calendar\",\n                  showAdvanced: _context3.t2,\n                  manifest: _context3.t3,\n                  dialogClosedCallback: _context3.t4\n                };\n                (0, _context3.t0)(_context3.t1, _context3.t5);\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, this);\n        }));\n        function _addCalendar() {\n          return _addCalendar2.apply(this, arguments);\n        }\n        return _addCalendar;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_handleViewChanged\",\n      value: function () {\n        var _handleViewChanged2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(ev) {\n          var result;\n          return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n            while (1) switch (_context4.prev = _context4.next) {\n              case 0:\n                this._start = ev.detail.start;\n                this._end = ev.detail.end;\n                _context4.next = 4;\n                return this._fetchEvents(this._start, this._end, this._selectedCalendars);\n              case 4:\n                result = _context4.sent;\n                this._events = result.events;\n                this._handleErrors(result.errors);\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }, _callee4, this);\n        }));\n        function _handleViewChanged(_x5) {\n          return _handleViewChanged2.apply(this, arguments);\n        }\n        return _handleViewChanged;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_handleRefresh\",\n      value: function () {\n        var _handleRefresh2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n          var result;\n          return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n            while (1) switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return this._fetchEvents(this._start, this._end, this._selectedCalendars);\n              case 2:\n                result = _context5.sent;\n                this._events = result.events;\n                this._handleErrors(result.errors);\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }, _callee5, this);\n        }));\n        function _handleRefresh() {\n          return _handleRefresh2.apply(this, arguments);\n        }\n        return _handleRefresh;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_handleErrors\",\n      value: function _handleErrors(error_entity_ids) {\n        var _this6 = this;\n        this._error = undefined;\n        if (error_entity_ids.length > 0) {\n          var nameList = error_entity_ids.map(function (error_entity_id) {\n            return _this6.hass.states[error_entity_id] ? computeStateName(_this6.hass.states[error_entity_id]) : error_entity_id;\n          }).join(\", \");\n          this._error = \"\".concat(this.hass.localize(\"ui.components.calendar.event_retrieval_error\"), \" \").concat(nameList);\n        }\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return [haStyle, css(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\\n        :host {\\n          display: block;\\n        }\\n        ha-full-calendar {\\n          height: calc(100vh - var(--header-height));\\n          --calendar-header-padding: 12px;\\n          --calendar-border-radius: 0;\\n          --calendar-border-width: 1px 0;\\n        }\\n        ha-button-menu ha-button {\\n          --mdc-theme-primary: currentColor;\\n          --mdc-typography-button-text-transform: none;\\n          --mdc-typography-button-font-size: var(\\n            --mdc-typography-headline6-font-size,\\n            1.25rem\\n          );\\n          --mdc-typography-button-font-weight: var(\\n            --mdc-typography-headline6-font-weight,\\n            500\\n          );\\n          --mdc-typography-button-letter-spacing: var(\\n            --mdc-typography-headline6-letter-spacing,\\n            0.0125em\\n          );\\n          --mdc-typography-button-line-height: var(\\n            --mdc-typography-headline6-line-height,\\n            2rem\\n          );\\n          --button-height: 40px;\\n        }\\n        :host([mobile]) .lists {\\n          --mdc-menu-min-width: 100vw;\\n        }\\n        :host([mobile]) ha-button-menu {\\n          --mdc-shape-medium: 0 0 var(--mdc-shape-medium)\\n            var(--mdc-shape-medium);\\n        }\\n      \"])))];\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["ResizeController","mdiChevronDown","mdiPlus","mdiRefresh","LitElement","css","html","nothing","customElement","property","state","styleMap","storage","computeStateName","fetchCalendarEvents","getCalendars","fetchIntegrationManifest","showConfigFlowDialog","haStyle","PanelCalendar","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","decorators","attribute","key","value","type","Boolean","reflect","undefined","callback","entries","_entries$","contentRect","width","connectedCallback","_get","_getPrototypeOf","prototype","call","_mql","window","matchMedia","addListener","_setIsMobile","mobile","matches","computedStyles","getComputedStyle","_headerHeight","Number","getPropertyValue","replace","disconnectedCallback","_this$_mql","removeListener","_this2","ev","willUpdate","changedProps","hasUpdated","_calendars","hass","render","_this3","_this$_showPaneContro","_this$hass$user","_this$hass$user2","calendarItems","map","selCal","_templateObject","_taggedTemplateLiteral","_requestSelected","backgroundColor","entity_id","_deSelectedCalendars","includes","name","showPane","_showPaneController","narrow","_templateObject2","_templateObject3","localize","user","is_admin","_templateObject4","_addCalendar","_templateObject5","_handleRefresh","_templateObject6","_events","_error","_handleViewChanged","_selectedCalendars","_this4","filter","cal","_fetchEvents2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","start","end","calendars","wrap","_callee$","_context","prev","next","abrupt","events","errors","stop","_fetchEvents","_x","_x2","_x3","apply","_requestSelected2","_callee2","entityId","calendar","result","_callee2$","_context2","stopPropagation","target","detail","selected","source","find","_start","_end","sent","_toConsumableArray","_handleErrors","event","_x4","_addCalendar2","_callee3","_this$hass$userData","_this5","_callee3$","_context3","t0","t1","t2","userData","showAdvanced","t3","t4","dialogClosedCallback","_ref","flowFinished","t5","startFlowHandler","manifest","_handleViewChanged2","_callee4","_callee4$","_context4","_x5","_handleRefresh2","_callee5","_callee5$","_context5","error_entity_ids","_this6","nameList","error_entity_id","states","join","static","styles","_templateObject7"],"sources":["/workspaces/frontend/src/panels/calendar/ha-panel-calendar.ts"],"sourcesContent":["import { ResizeController } from \"@lit-labs/observers/resize-controller\";\nimport \"@material/mwc-list\";\nimport type { RequestSelectedDetail } from \"@material/mwc-list/mwc-list-item\";\nimport { mdiChevronDown, mdiPlus, mdiRefresh } from \"@mdi/js\";\nimport {\n  CSSResultGroup,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  css,\n  html,\n  nothing,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport { storage } from \"../../common/decorators/storage\";\nimport { HASSDomEvent } from \"../../common/dom/fire_event\";\nimport { computeStateName } from \"../../common/entity/compute_state_name\";\nimport \"../../components/ha-button\";\nimport \"../../components/ha-button-menu\";\nimport \"../../components/ha-card\";\nimport \"../../components/ha-check-list-item\";\nimport \"../../components/ha-icon-button\";\nimport type { HaListItem } from \"../../components/ha-list-item\";\nimport \"../../components/ha-menu-button\";\nimport \"../../components/ha-state-icon\";\nimport \"../../components/ha-svg-icon\";\nimport \"../../components/ha-two-pane-top-app-bar-fixed\";\nimport {\n  Calendar,\n  CalendarEvent,\n  fetchCalendarEvents,\n  getCalendars,\n} from \"../../data/calendar\";\nimport { fetchIntegrationManifest } from \"../../data/integration\";\nimport { showConfigFlowDialog } from \"../../dialogs/config-flow/show-dialog-config-flow\";\nimport { haStyle } from \"../../resources/styles\";\nimport type { CalendarViewChanged, HomeAssistant } from \"../../types\";\nimport \"./ha-full-calendar\";\n\n@customElement(\"ha-panel-calendar\")\nclass PanelCalendar extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ type: Boolean, reflect: true }) public narrow = false;\n\n  @property({ type: Boolean, reflect: true }) public mobile = false;\n\n  @state() private _calendars: Calendar[] = [];\n\n  @state() private _events: CalendarEvent[] = [];\n\n  @state() private _error?: string = undefined;\n\n  @storage({\n    key: \"deSelectedCalendars\",\n    state: true,\n  })\n  private _deSelectedCalendars: string[] = [];\n\n  private _start?: Date;\n\n  private _end?: Date;\n\n  private _showPaneController = new ResizeController(this, {\n    callback: (entries) => entries[0]?.contentRect.width > 750,\n  });\n\n  private _mql?: MediaQueryList;\n\n  private _headerHeight = 56;\n\n  public connectedCallback() {\n    super.connectedCallback();\n    this._mql = window.matchMedia(\n      \"(max-width: 450px), all and (max-height: 500px)\"\n    );\n    this._mql.addListener(this._setIsMobile);\n    this.mobile = this._mql.matches;\n    const computedStyles = getComputedStyle(this);\n    this._headerHeight = Number(\n      computedStyles.getPropertyValue(\"--header-height\").replace(\"px\", \"\")\n    );\n  }\n\n  public disconnectedCallback() {\n    super.disconnectedCallback();\n    this._mql?.removeListener(this._setIsMobile!);\n    this._mql = undefined;\n  }\n\n  private _setIsMobile = (ev: MediaQueryListEvent) => {\n    this.mobile = ev.matches;\n  };\n\n  public willUpdate(changedProps: PropertyValues): void {\n    super.willUpdate(changedProps);\n    if (!this.hasUpdated) {\n      this._calendars = getCalendars(this.hass);\n    }\n  }\n\n  protected render(): TemplateResult {\n    const calendarItems = this._calendars.map(\n      (selCal) => html`\n        <ha-check-list-item\n          @request-selected=${this._requestSelected}\n          graphic=\"icon\"\n          style=${styleMap({\n            \"--mdc-theme-secondary\": selCal.backgroundColor!,\n          })}\n          .value=${selCal.entity_id}\n          .selected=${!this._deSelectedCalendars.includes(selCal.entity_id)}\n        >\n          <ha-state-icon\n            slot=\"graphic\"\n            .hass=${this.hass}\n            .stateObj=${selCal}\n          ></ha-state-icon>\n          ${selCal.name}\n        </ha-check-list-item>\n      `\n    );\n    const showPane = this._showPaneController.value ?? !this.narrow;\n    return html`\n      <ha-two-pane-top-app-bar-fixed .pane=${showPane} footer>\n        <ha-menu-button\n          slot=\"navigationIcon\"\n          .hass=${this.hass}\n          .narrow=${this.narrow}\n        ></ha-menu-button>\n\n        ${!showPane\n          ? html`<ha-button-menu\n              slot=\"title\"\n              class=\"lists\"\n              multi\n              fixed\n              .noAnchor=${this.mobile}\n              .y=${this.mobile\n                ? this._headerHeight / 2\n                : this._headerHeight / 4}\n              .x=${this.mobile ? 0 : undefined}\n            >\n              <ha-button slot=\"trigger\">\n                ${this.hass.localize(\"ui.components.calendar.my_calendars\")}\n                <ha-svg-icon\n                  slot=\"trailingIcon\"\n                  .path=${mdiChevronDown}\n                ></ha-svg-icon>\n              </ha-button>\n              ${calendarItems}\n              ${this.hass.user?.is_admin\n                ? html` <li divider role=\"separator\"></li>\n                    <ha-list-item graphic=\"icon\" @click=${this._addCalendar}>\n                      <ha-svg-icon\n                        .path=${mdiPlus}\n                        slot=\"graphic\"\n                      ></ha-svg-icon>\n                      ${this.hass.localize(\n                        \"ui.components.calendar.create_calendar\"\n                      )}\n                    </ha-list-item>`\n                : nothing}\n            </ha-button-menu>`\n          : html`<div slot=\"title\">\n              ${this.hass.localize(\"ui.components.calendar.my_calendars\")}\n            </div>`}\n        <ha-icon-button\n          slot=\"actionItems\"\n          .path=${mdiRefresh}\n          .label=${this.hass.localize(\"ui.common.refresh\")}\n          @click=${this._handleRefresh}\n        ></ha-icon-button>\n        ${showPane && this.hass.user?.is_admin\n          ? html`<mwc-list slot=\"pane\" multi}>${calendarItems}</mwc-list>\n              <ha-list-item\n                graphic=\"icon\"\n                slot=\"pane-footer\"\n                @click=${this._addCalendar}\n              >\n                <ha-svg-icon .path=${mdiPlus} slot=\"graphic\"></ha-svg-icon>\n                ${this.hass.localize(\"ui.components.calendar.create_calendar\")}\n              </ha-list-item>`\n          : nothing}\n        <ha-full-calendar\n          .events=${this._events}\n          .calendars=${this._calendars}\n          .narrow=${this.narrow}\n          .initialView=${this.narrow ? \"listWeek\" : \"dayGridMonth\"}\n          .hass=${this.hass}\n          .error=${this._error}\n          @view-changed=${this._handleViewChanged}\n        ></ha-full-calendar>\n      </ha-two-pane-top-app-bar-fixed>\n    `;\n  }\n\n  private get _selectedCalendars(): Calendar[] {\n    return this._calendars\n      .filter((selCal) => !this._deSelectedCalendars.includes(selCal.entity_id))\n      .map((cal) => cal);\n  }\n\n  private async _fetchEvents(\n    start: Date | undefined,\n    end: Date | undefined,\n    calendars: Calendar[]\n  ): Promise<{ events: CalendarEvent[]; errors: string[] }> {\n    if (!calendars.length || !start || !end) {\n      return { events: [], errors: [] };\n    }\n\n    return fetchCalendarEvents(this.hass, start, end, calendars);\n  }\n\n  private async _requestSelected(ev: CustomEvent<RequestSelectedDetail>) {\n    ev.stopPropagation();\n    const entityId = (ev.target as HaListItem).value;\n    if (ev.detail.selected) {\n      this._deSelectedCalendars = this._deSelectedCalendars.filter(\n        (cal) => cal !== entityId\n      );\n      if (ev.detail.source === \"interaction\") {\n        // prevent adding the same calendar twice, an interaction event will be followed by a property event\n        return;\n      }\n      const calendar = this._calendars.find(\n        (cal) => cal.entity_id === entityId\n      );\n      if (!calendar) {\n        return;\n      }\n      const result = await this._fetchEvents(this._start, this._end, [\n        calendar,\n      ]);\n      this._events = [...this._events, ...result.events];\n      this._handleErrors(result.errors);\n    } else {\n      this._deSelectedCalendars = [...this._deSelectedCalendars, entityId];\n      this._events = this._events.filter(\n        (event) => event.calendar !== entityId\n      );\n    }\n  }\n\n  private async _addCalendar(): Promise<void> {\n    showConfigFlowDialog(this, {\n      startFlowHandler: \"local_calendar\",\n      showAdvanced: this.hass.userData?.showAdvanced,\n      manifest: await fetchIntegrationManifest(this.hass, \"local_calendar\"),\n      dialogClosedCallback: ({ flowFinished }) => {\n        if (flowFinished) {\n          this._calendars = getCalendars(this.hass);\n        }\n      },\n    });\n  }\n\n  private async _handleViewChanged(\n    ev: HASSDomEvent<CalendarViewChanged>\n  ): Promise<void> {\n    this._start = ev.detail.start;\n    this._end = ev.detail.end;\n    const result = await this._fetchEvents(\n      this._start,\n      this._end,\n      this._selectedCalendars\n    );\n    this._events = result.events;\n    this._handleErrors(result.errors);\n  }\n\n  private async _handleRefresh(): Promise<void> {\n    const result = await this._fetchEvents(\n      this._start,\n      this._end,\n      this._selectedCalendars\n    );\n    this._events = result.events;\n    this._handleErrors(result.errors);\n  }\n\n  private _handleErrors(error_entity_ids: string[]) {\n    this._error = undefined;\n    if (error_entity_ids.length > 0) {\n      const nameList = error_entity_ids\n        .map((error_entity_id) =>\n          this.hass!.states[error_entity_id]\n            ? computeStateName(this.hass!.states[error_entity_id])\n            : error_entity_id\n        )\n        .join(\", \");\n\n      this._error = `${this.hass!.localize(\n        \"ui.components.calendar.event_retrieval_error\"\n      )} ${nameList}`;\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      haStyle,\n      css`\n        :host {\n          display: block;\n        }\n        ha-full-calendar {\n          height: calc(100vh - var(--header-height));\n          --calendar-header-padding: 12px;\n          --calendar-border-radius: 0;\n          --calendar-border-width: 1px 0;\n        }\n        ha-button-menu ha-button {\n          --mdc-theme-primary: currentColor;\n          --mdc-typography-button-text-transform: none;\n          --mdc-typography-button-font-size: var(\n            --mdc-typography-headline6-font-size,\n            1.25rem\n          );\n          --mdc-typography-button-font-weight: var(\n            --mdc-typography-headline6-font-weight,\n            500\n          );\n          --mdc-typography-button-letter-spacing: var(\n            --mdc-typography-headline6-letter-spacing,\n            0.0125em\n          );\n          --mdc-typography-button-line-height: var(\n            --mdc-typography-headline6-line-height,\n            2rem\n          );\n          --button-height: 40px;\n        }\n        :host([mobile]) .lists {\n          --mdc-menu-min-width: 100vw;\n        }\n        :host([mobile]) ha-button-menu {\n          --mdc-shape-medium: 0 0 var(--mdc-shape-medium)\n            var(--mdc-shape-medium);\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-panel-calendar\": PanelCalendar;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}