{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nvar _templateObject, _templateObject2, _templateObject3;\nimport \"core-js/modules/es.array.concat.js\";\nimport { css, html, LitElement } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport \"../../../../components/buttons/ha-progress-button\";\nimport \"../../../../components/ha-alert\";\nimport \"../../../../components/ha-card\";\nimport \"../../../../components/ha-textfield\";\nimport { cloudForgotPassword } from \"../../../../data/cloud\";\nimport \"../../../../layouts/hass-subpage\";\nimport { haStyle } from \"../../../../resources/styles\";\nexport var CloudForgotPassword = _decorate([customElement(\"cloud-forgot-password\")], function (_initialize, _LitElement) {\n  var CloudForgotPassword = /*#__PURE__*/function (_LitElement2) {\n    _inherits(CloudForgotPassword, _LitElement2);\n    function CloudForgotPassword() {\n      var _this;\n      _classCallCheck(this, CloudForgotPassword);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, CloudForgotPassword, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(CloudForgotPassword);\n  }(_LitElement);\n  return {\n    F: CloudForgotPassword,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"narrow\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"email\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_requestInProgress\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_error\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [query(\"#email\", true)],\n      key: \"_emailField\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n      <hass-subpage\\n        .hass=\", \"\\n        .narrow=\", \"\\n        .header=\", \"\\n      >\\n        <div class=\\\"content\\\">\\n          <ha-card\\n            outlined\\n            .header=\", \"\\n          >\\n            <div class=\\\"card-content\\\">\\n              <p>\\n                \", \"\\n              </p>\\n              \", \"\\n              <ha-textfield\\n                autofocus\\n                id=\\\"email\\\"\\n                label=\", \"\\n                .value=\", \"\\n                type=\\\"email\\\"\\n                required\\n                @keydown=\", \"\\n                .validationMessage=\", \"\\n              ></ha-textfield>\\n            </div>\\n            <div class=\\\"card-actions\\\">\\n              <ha-progress-button\\n                @click=\", \"\\n                .progress=\", \"\\n              >\\n                \", \"\\n              </ha-progress-button>\\n            </div>\\n          </ha-card>\\n        </div>\\n      </hass-subpage>\\n    \"])), this.hass, this.narrow, this.hass.localize(\"ui.panel.config.cloud.forgot_password.title\"), this.hass.localize(\"ui.panel.config.cloud.forgot_password.subtitle\"), this.hass.localize(\"ui.panel.config.cloud.forgot_password.instructions\"), this._error ? html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"<ha-alert alert-type=\\\"error\\\">\", \"</ha-alert>\"])), this._error) : \"\", this.hass.localize(\"ui.panel.config.cloud.forgot_password.email\"), this.email, this._keyDown, this.hass.localize(\"ui.panel.config.cloud.forgot_password.email_error_msg\"), this._handleEmailPasswordReset, this._requestInProgress, this.hass.localize(\"ui.panel.config.cloud.forgot_password.send_reset_email\"));\n      }\n    }, {\n      kind: \"method\",\n      key: \"_keyDown\",\n      value: function _keyDown(ev) {\n        if (ev.key === \"Enter\") {\n          this._handleEmailPasswordReset();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_handleEmailPasswordReset\",\n      value: function () {\n        var _handleEmailPasswordReset2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          var emailField, email;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                emailField = this._emailField;\n                email = emailField.value;\n                if (emailField.reportValidity()) {\n                  _context.next = 5;\n                  break;\n                }\n                emailField.focus();\n                return _context.abrupt(\"return\");\n              case 5:\n                this._requestInProgress = true;\n                _context.prev = 6;\n                _context.next = 9;\n                return cloudForgotPassword(this.hass, email);\n              case 9:\n                // @ts-ignore\n                fireEvent(this, \"email-changed\", {\n                  value: email\n                });\n                this._requestInProgress = false;\n                // @ts-ignore\n                fireEvent(this, \"cloud-done\", {\n                  flashMessage: this.hass.localize(\"ui.panel.config.cloud.forgot_password.check_your_email\")\n                });\n                _context.next = 18;\n                break;\n              case 14:\n                _context.prev = 14;\n                _context.t0 = _context[\"catch\"](6);\n                this._requestInProgress = false;\n                this._error = _context.t0 && _context.t0.body && _context.t0.body.message ? _context.t0.body.message : \"Unknown error\";\n              case 18:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this, [[6, 14]]);\n        }));\n        function _handleEmailPasswordReset() {\n          return _handleEmailPasswordReset2.apply(this, arguments);\n        }\n        return _handleEmailPasswordReset;\n      }()\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return [haStyle, css(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n        .content {\\n          padding-bottom: 24px;\\n        }\\n        ha-card {\\n          max-width: 600px;\\n          margin: 0 auto;\\n          margin-top: 24px;\\n        }\\n        h1 {\\n          margin: 0;\\n        }\\n        ha-textfield {\\n          width: 100%;\\n        }\\n        .card-actions {\\n          display: flex;\\n          justify-content: space-between;\\n          align-items: center;\\n        }\\n        .card-actions a {\\n          color: var(--primary-text-color);\\n        }\\n      \"])))];\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["css","html","LitElement","customElement","property","query","state","fireEvent","cloudForgotPassword","haStyle","CloudForgotPassword","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","decorators","attribute","key","value","type","Boolean","render","_templateObject","_taggedTemplateLiteral","hass","narrow","localize","_error","_templateObject2","email","_keyDown","_handleEmailPasswordReset","_requestInProgress","ev","_handleEmailPasswordReset2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","emailField","wrap","_callee$","_context","prev","next","_emailField","reportValidity","focus","abrupt","flashMessage","t0","body","message","stop","apply","static","styles","_templateObject3"],"sources":["/workspaces/frontend/src/panels/config/cloud/forgot-password/cloud-forgot-password.ts"],"sourcesContent":["import { css, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport \"../../../../components/buttons/ha-progress-button\";\nimport \"../../../../components/ha-alert\";\nimport \"../../../../components/ha-card\";\nimport type { HaTextField } from \"../../../../components/ha-textfield\";\nimport \"../../../../components/ha-textfield\";\nimport { cloudForgotPassword } from \"../../../../data/cloud\";\nimport \"../../../../layouts/hass-subpage\";\nimport { haStyle } from \"../../../../resources/styles\";\nimport { HomeAssistant } from \"../../../../types\";\n\n@customElement(\"cloud-forgot-password\")\nexport class CloudForgotPassword extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ type: Boolean }) public narrow = false;\n\n  @property() public email?: string;\n\n  @state() public _requestInProgress = false;\n\n  @state() private _error?: string;\n\n  @query(\"#email\", true) private _emailField!: HaTextField;\n\n  protected render(): TemplateResult {\n    return html`\n      <hass-subpage\n        .hass=${this.hass}\n        .narrow=${this.narrow}\n        .header=${this.hass.localize(\n          \"ui.panel.config.cloud.forgot_password.title\"\n        )}\n      >\n        <div class=\"content\">\n          <ha-card\n            outlined\n            .header=${this.hass.localize(\n              \"ui.panel.config.cloud.forgot_password.subtitle\"\n            )}\n          >\n            <div class=\"card-content\">\n              <p>\n                ${this.hass.localize(\n                  \"ui.panel.config.cloud.forgot_password.instructions\"\n                )}\n              </p>\n              ${this._error\n                ? html`<ha-alert alert-type=\"error\">${this._error}</ha-alert>`\n                : \"\"}\n              <ha-textfield\n                autofocus\n                id=\"email\"\n                label=${this.hass.localize(\n                  \"ui.panel.config.cloud.forgot_password.email\"\n                )}\n                .value=${this.email}\n                type=\"email\"\n                required\n                @keydown=${this._keyDown}\n                .validationMessage=${this.hass.localize(\n                  \"ui.panel.config.cloud.forgot_password.email_error_msg\"\n                )}\n              ></ha-textfield>\n            </div>\n            <div class=\"card-actions\">\n              <ha-progress-button\n                @click=${this._handleEmailPasswordReset}\n                .progress=${this._requestInProgress}\n              >\n                ${this.hass.localize(\n                  \"ui.panel.config.cloud.forgot_password.send_reset_email\"\n                )}\n              </ha-progress-button>\n            </div>\n          </ha-card>\n        </div>\n      </hass-subpage>\n    `;\n  }\n\n  private _keyDown(ev: KeyboardEvent) {\n    if (ev.key === \"Enter\") {\n      this._handleEmailPasswordReset();\n    }\n  }\n\n  private async _handleEmailPasswordReset() {\n    const emailField = this._emailField;\n\n    const email = emailField.value;\n\n    if (!emailField.reportValidity()) {\n      emailField.focus();\n      return;\n    }\n\n    this._requestInProgress = true;\n\n    try {\n      await cloudForgotPassword(this.hass, email);\n      // @ts-ignore\n      fireEvent(this, \"email-changed\", { value: email });\n      this._requestInProgress = false;\n      // @ts-ignore\n      fireEvent(this, \"cloud-done\", {\n        flashMessage: this.hass.localize(\n          \"ui.panel.config.cloud.forgot_password.check_your_email\"\n        ),\n      });\n    } catch (err: any) {\n      this._requestInProgress = false;\n      this._error =\n        err && err.body && err.body.message\n          ? err.body.message\n          : \"Unknown error\";\n    }\n  }\n\n  static get styles() {\n    return [\n      haStyle,\n      css`\n        .content {\n          padding-bottom: 24px;\n        }\n        ha-card {\n          max-width: 600px;\n          margin: 0 auto;\n          margin-top: 24px;\n        }\n        h1 {\n          margin: 0;\n        }\n        ha-textfield {\n          width: 100%;\n        }\n        .card-actions {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n        .card-actions a {\n          color: var(--primary-text-color);\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-forgot-password\": CloudForgotPassword;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}