{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\nexport var resolveMediaSource = function resolveMediaSource(hass, media_content_id) {\n  return hass.callWS({\n    type: \"media_source/resolve_media\",\n    media_content_id: media_content_id\n  });\n};\nexport var browseLocalMediaPlayer = function browseLocalMediaPlayer(hass, mediaContentId) {\n  return hass.callWS({\n    type: \"media_source/browse_media\",\n    media_content_id: mediaContentId\n  });\n};\nexport var isLocalMediaSourceContentId = function isLocalMediaSourceContentId(mediaId) {\n  return mediaId.startsWith(\"media-source://media_source\");\n};\nexport var uploadLocalMedia = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(hass, media_content_id, file) {\n    var fd, resp;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          fd = new FormData();\n          fd.append(\"media_content_id\", media_content_id);\n          fd.append(\"file\", file);\n          _context.next = 5;\n          return hass.fetchWithAuth(\"/api/media_source/local_source/upload\", {\n            method: \"POST\",\n            body: fd\n          });\n        case 5:\n          resp = _context.sent;\n          if (!(resp.status === 413)) {\n            _context.next = 10;\n            break;\n          }\n          throw new Error(\"Uploaded file is too large (\".concat(file.name, \")\"));\n        case 10:\n          if (!(resp.status !== 200)) {\n            _context.next = 12;\n            break;\n          }\n          throw new Error(\"Unknown error\");\n        case 12:\n          return _context.abrupt(\"return\", resp.json());\n        case 13:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function uploadLocalMedia(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var removeLocalMedia = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(hass, media_content_id) {\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          return _context2.abrupt(\"return\", hass.callWS({\n            type: \"media_source/local_source/remove\",\n            media_content_id: media_content_id\n          }));\n        case 1:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return function removeLocalMedia(_x4, _x5) {\n    return _ref2.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["resolveMediaSource","hass","media_content_id","callWS","type","browseLocalMediaPlayer","mediaContentId","isLocalMediaSourceContentId","mediaId","startsWith","uploadLocalMedia","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","file","fd","resp","wrap","_callee$","_context","prev","next","FormData","append","fetchWithAuth","method","body","sent","status","Error","concat","name","abrupt","json","stop","_x","_x2","_x3","apply","arguments","removeLocalMedia","_ref2","_callee2","_callee2$","_context2","_x4","_x5"],"sources":["/workspaces/frontend/src/data/media_source.ts"],"sourcesContent":["import { HomeAssistant } from \"../types\";\nimport { MediaPlayerItem } from \"./media-player\";\n\nexport interface ResolvedMediaSource {\n  url: string;\n  mime_type: string;\n}\n\nexport const resolveMediaSource = (\n  hass: HomeAssistant,\n  media_content_id: string\n) =>\n  hass.callWS<ResolvedMediaSource>({\n    type: \"media_source/resolve_media\",\n    media_content_id,\n  });\n\nexport const browseLocalMediaPlayer = (\n  hass: HomeAssistant,\n  mediaContentId?: string\n): Promise<MediaPlayerItem> =>\n  hass.callWS<MediaPlayerItem>({\n    type: \"media_source/browse_media\",\n    media_content_id: mediaContentId,\n  });\n\nexport const isLocalMediaSourceContentId = (mediaId: string) =>\n  mediaId.startsWith(\"media-source://media_source\");\n\nexport const uploadLocalMedia = async (\n  hass: HomeAssistant,\n  media_content_id: string,\n  file: File\n) => {\n  const fd = new FormData();\n  fd.append(\"media_content_id\", media_content_id);\n  fd.append(\"file\", file);\n  const resp = await hass.fetchWithAuth(\n    \"/api/media_source/local_source/upload\",\n    {\n      method: \"POST\",\n      body: fd,\n    }\n  );\n  if (resp.status === 413) {\n    throw new Error(`Uploaded file is too large (${file.name})`);\n  } else if (resp.status !== 200) {\n    throw new Error(\"Unknown error\");\n  }\n  return resp.json();\n};\n\nexport const removeLocalMedia = async (\n  hass: HomeAssistant,\n  media_content_id: string\n) =>\n  hass.callWS({\n    type: \"media_source/local_source/remove\",\n    media_content_id,\n  });\n"],"mappings":";;;;;AAQA,OAAO,IAAMA,kBAAkB,GAAG,SAArBA,kBAAkBA,CAC7BC,IAAmB,EACnBC,gBAAwB;EAAA,OAExBD,IAAI,CAACE,MAAM,CAAsB;IAC/BC,IAAI,EAAE,4BAA4B;IAClCF,gBAAgB,EAAhBA;EACF,CAAC,CAAC;AAAA;AAEJ,OAAO,IAAMG,sBAAsB,GAAG,SAAzBA,sBAAsBA,CACjCJ,IAAmB,EACnBK,cAAuB;EAAA,OAEvBL,IAAI,CAACE,MAAM,CAAkB;IAC3BC,IAAI,EAAE,2BAA2B;IACjCF,gBAAgB,EAAEI;EACpB,CAAC,CAAC;AAAA;AAEJ,OAAO,IAAMC,2BAA2B,GAAG,SAA9BA,2BAA2BA,CAAIC,OAAe;EAAA,OACzDA,OAAO,CAACC,UAAU,CAAC,6BAA6B,CAAC;AAAA;AAEnD,OAAO,IAAMC,gBAAgB;EAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAC9Bd,IAAmB,EACnBC,gBAAwB,EACxBc,IAAU;IAAA,IAAAC,EAAA,EAAAC,IAAA;IAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAEJN,EAAE,GAAG,IAAIO,QAAQ,CAAC,CAAC;UACzBP,EAAE,CAACQ,MAAM,CAAC,kBAAkB,EAAEvB,gBAAgB,CAAC;UAC/Ce,EAAE,CAACQ,MAAM,CAAC,MAAM,EAAET,IAAI,CAAC;UAACK,QAAA,CAAAE,IAAA;UAAA,OACLtB,IAAI,CAACyB,aAAa,CACnC,uCAAuC,EACvC;YACEC,MAAM,EAAE,MAAM;YACdC,IAAI,EAAEX;UACR,CACF,CAAC;QAAA;UANKC,IAAI,GAAAG,QAAA,CAAAQ,IAAA;UAAA,MAONX,IAAI,CAACY,MAAM,KAAK,GAAG;YAAAT,QAAA,CAAAE,IAAA;YAAA;UAAA;UAAA,MACf,IAAIQ,KAAK,gCAAAC,MAAA,CAAgChB,IAAI,CAACiB,IAAI,MAAG,CAAC;QAAA;UAAA,MACnDf,IAAI,CAACY,MAAM,KAAK,GAAG;YAAAT,QAAA,CAAAE,IAAA;YAAA;UAAA;UAAA,MACtB,IAAIQ,KAAK,CAAC,eAAe,CAAC;QAAA;UAAA,OAAAV,QAAA,CAAAa,MAAA,WAE3BhB,IAAI,CAACiB,IAAI,CAAC,CAAC;QAAA;QAAA;UAAA,OAAAd,QAAA,CAAAe,IAAA;MAAA;IAAA,GAAArB,OAAA;EAAA,CACnB;EAAA,gBArBYL,gBAAgBA,CAAA2B,EAAA,EAAAC,GAAA,EAAAC,GAAA;IAAA,OAAA5B,IAAA,CAAA6B,KAAA,OAAAC,SAAA;EAAA;AAAA,GAqB5B;AAED,OAAO,IAAMC,gBAAgB;EAAA,IAAAC,KAAA,GAAA/B,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAA8B,SAC9B3C,IAAmB,EACnBC,gBAAwB;IAAA,OAAAW,mBAAA,GAAAM,IAAA,UAAA0B,UAAAC,SAAA;MAAA,kBAAAA,SAAA,CAAAxB,IAAA,GAAAwB,SAAA,CAAAvB,IAAA;QAAA;UAAA,OAAAuB,SAAA,CAAAZ,MAAA,WAExBjC,IAAI,CAACE,MAAM,CAAC;YACVC,IAAI,EAAE,kCAAkC;YACxCF,gBAAgB,EAAhBA;UACF,CAAC,CAAC;QAAA;QAAA;UAAA,OAAA4C,SAAA,CAAAV,IAAA;MAAA;IAAA,GAAAQ,QAAA;EAAA;EAAA,gBAPSF,gBAAgBA,CAAAK,GAAA,EAAAC,GAAA;IAAA,OAAAL,KAAA,CAAAH,KAAA,OAAAC,SAAA;EAAA;AAAA,GAOzB"},"metadata":{},"sourceType":"module","externalDependencies":[]}