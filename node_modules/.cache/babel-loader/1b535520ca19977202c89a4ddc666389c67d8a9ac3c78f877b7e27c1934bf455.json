{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _createForOfIteratorHelper from \"@babel/runtime/helpers/createForOfIteratorHelper\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9;\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.set.difference.v2.js\";\nimport \"core-js/modules/esnext.set.intersection.v2.js\";\nimport \"core-js/modules/esnext.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/esnext.set.is-subset-of.v2.js\";\nimport \"core-js/modules/esnext.set.is-superset-of.v2.js\";\nimport \"core-js/modules/esnext.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/esnext.set.union.v2.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"@material/mwc-button/mwc-button\";\nvar mdiSlopeUphill = \"M22,13V22H2V19L22,13M21.68,7.06L16.86,4.46L17.7,7.24L7.58,10.24C6.63,8.95 4.82,8.67 3.53,9.62C2.24,10.57 1.96,12.38 2.91,13.67C3.85,14.97 5.67,15.24 6.96,14.29C7.67,13.78 8.1,12.97 8.14,12.09L18.26,9.09L19.1,11.87L21.68,7.06Z\";\nimport { html, LitElement } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport \"../../../components/data-table/ha-data-table\";\nimport { subscribeEntityRegistry } from \"../../../data/entity_registry\";\nimport { clearStatistics, getStatisticIds, validateStatistics } from \"../../../data/recorder\";\nimport { showAlertDialog, showConfirmationDialog } from \"../../../dialogs/generic/show-dialog-box\";\nimport { SubscribeMixin } from \"../../../mixins/subscribe-mixin\";\nimport { haStyle } from \"../../../resources/styles\";\nimport { showStatisticsAdjustSumDialog } from \"./show-dialog-statistics-adjust-sum\";\nimport { showFixStatisticsUnitsChangedDialog } from \"./show-dialog-statistics-fix-units-changed\";\nimport { documentationUrl } from \"../../../util/documentation-url\";\nvar FIX_ISSUES_ORDER = {\n  no_state: 0,\n  entity_no_longer_recorded: 1,\n  entity_not_recorded: 1,\n  unsupported_state_class: 2,\n  units_changed: 3\n};\nvar HaPanelDevStatistics = _decorate([customElement(\"developer-tools-statistics\")], function (_initialize, _SubscribeMixin) {\n  var HaPanelDevStatistics = /*#__PURE__*/function (_SubscribeMixin2) {\n    _inherits(HaPanelDevStatistics, _SubscribeMixin2);\n    function HaPanelDevStatistics() {\n      var _this;\n      _classCallCheck(this, HaPanelDevStatistics);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, HaPanelDevStatistics, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(HaPanelDevStatistics);\n  }(_SubscribeMixin);\n  return {\n    F: HaPanelDevStatistics,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"narrow\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_data\",\n      value: function value() {\n        return [];\n      }\n    }, {\n      kind: \"field\",\n      key: \"_disabledEntities\",\n      value: function value() {\n        return new Set();\n      }\n    }, {\n      kind: \"field\",\n      key: \"_deletedStatistics\",\n      value: function value() {\n        return new Set();\n      }\n    }, {\n      kind: \"method\",\n      key: \"firstUpdated\",\n      value: function firstUpdated() {\n        this._validateStatistics();\n      }\n    }, {\n      kind: \"field\",\n      key: \"_displayData\",\n      value: function value() {\n        return memoizeOne(function (data, localize) {\n          return data.map(function (item) {\n            var _item$issues;\n            return Object.assign(Object.assign({}, item), {}, {\n              displayName: item.state ? computeStateName(item.state) : item.name || item.statistic_id,\n              issues_string: (_item$issues = item.issues) === null || _item$issues === void 0 ? void 0 : _item$issues.map(function (issue) {\n                return localize(\"ui.panel.developer-tools.tabs.statistics.issues.\".concat(issue.type), issue.data) || issue.type;\n              }).join(\" \")\n            });\n          });\n        });\n      }\n    }, {\n      kind: \"field\",\n      key: \"_columns\",\n      value: function value() {\n        var _this2 = this;\n        return memoizeOne(function (localize) {\n          return {\n            displayName: {\n              title: localize(\"ui.panel.developer-tools.tabs.statistics.data_table.name\"),\n              sortable: true,\n              filterable: true,\n              grows: true\n            },\n            statistic_id: {\n              title: localize(\"ui.panel.developer-tools.tabs.statistics.data_table.statistic_id\"),\n              sortable: true,\n              filterable: true,\n              hidden: _this2.narrow,\n              width: \"20%\"\n            },\n            statistics_unit_of_measurement: {\n              title: localize(\"ui.panel.developer-tools.tabs.statistics.data_table.statistics_unit\"),\n              sortable: true,\n              filterable: true,\n              width: \"10%\",\n              forceLTR: true\n            },\n            source: {\n              title: localize(\"ui.panel.developer-tools.tabs.statistics.data_table.source\"),\n              sortable: true,\n              filterable: true,\n              width: \"10%\"\n            },\n            issues_string: {\n              title: localize(\"ui.panel.developer-tools.tabs.statistics.data_table.issue\"),\n              sortable: true,\n              filterable: true,\n              direction: \"asc\",\n              width: \"30%\",\n              template: function template(statistic) {\n                var _statistic$issues_str;\n                return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\", \"\"])), (_statistic$issues_str = statistic.issues_string) !== null && _statistic$issues_str !== void 0 ? _statistic$issues_str : localize(\"ui.panel.developer-tools.tabs.statistics.no_issue\"));\n              }\n            },\n            fix: {\n              title: \"\",\n              label: _this2.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.fix\"),\n              template: function template(statistic) {\n                return html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\", \"\"])), statistic.issues ? html(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"<mwc-button\\n                @click=\", \"\\n                .data=\", \"\\n              >\\n                \", \"\\n              </mwc-button>\"])), _this2._fixIssue, statistic.issues, localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.fix\")) : \"â€”\");\n              },\n              width: \"113px\"\n            },\n            actions: {\n              title: \"\",\n              label: localize(\"ui.panel.developer-tools.tabs.statistics.adjust_sum\"),\n              type: \"icon-button\",\n              template: function template(statistic) {\n                return statistic.has_sum ? html(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n                <ha-icon-button\\n                  .label=\", \"\\n                  .path=\", \"\\n                  .statistic=\", \"\\n                  @click=\", \"\\n                ></ha-icon-button>\\n              \"])), localize(\"ui.panel.developer-tools.tabs.statistics.adjust_sum\"), mdiSlopeUphill, statistic, _this2._showStatisticsAdjustSumDialog) : \"\";\n              }\n            }\n          };\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        return html(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\\n      <ha-data-table\\n        .hass=\", \"\\n        .columns=\", \"\\n        .data=\", \"\\n        .noDataText=\", \"\\n        id=\\\"statistic_id\\\"\\n        clickable\\n        @row-click=\", \"\\n      ></ha-data-table>\\n    \"])), this.hass, this._columns(this.hass.localize), this._displayData(this._data, this.hass.localize), this.hass.localize(\"ui.panel.developer-tools.tabs.statistics.data_table.no_statistics\"), this._rowClicked);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_showStatisticsAdjustSumDialog\",\n      value: function _showStatisticsAdjustSumDialog(ev) {\n        ev.stopPropagation();\n        showStatisticsAdjustSumDialog(this, {\n          statistic: ev.currentTarget.statistic\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_rowClicked\",\n      value: function _rowClicked(ev) {\n        var id = ev.detail.id;\n        if (id in this.hass.states) {\n          fireEvent(this, \"hass-more-info\", {\n            entityId: id\n          });\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"hassSubscribe\",\n      value: function hassSubscribe() {\n        var _this3 = this;\n        return [subscribeEntityRegistry(this.hass.connection, function (entities) {\n          var disabledEntities = new Set();\n          var _iterator = _createForOfIteratorHelper(entities),\n            _step;\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var confEnt = _step.value;\n              if (!confEnt.disabled_by) {\n                continue;\n              }\n              disabledEntities.add(confEnt.entity_id);\n            }\n            // If the disabled entities changed, re-validate the statistics\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n          if (disabledEntities !== _this3._disabledEntities) {\n            _this3._disabledEntities = disabledEntities;\n            _this3._validateStatistics();\n          }\n        })];\n      }\n    }, {\n      kind: \"method\",\n      key: \"_validateStatistics\",\n      value: function () {\n        var _validateStatistics2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          var _this4 = this;\n          var _yield$Promise$all, _yield$Promise$all2, statisticIds, issues, statsIds;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return Promise.all([getStatisticIds(this.hass), validateStatistics(this.hass)]);\n              case 2:\n                _yield$Promise$all = _context.sent;\n                _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 2);\n                statisticIds = _yield$Promise$all2[0];\n                issues = _yield$Promise$all2[1];\n                statsIds = new Set();\n                this._data = statisticIds.filter(function (statistic) {\n                  return !_this4._disabledEntities.has(statistic.statistic_id) && !_this4._deletedStatistics.has(statistic.statistic_id);\n                }).map(function (statistic) {\n                  statsIds.add(statistic.statistic_id);\n                  return Object.assign(Object.assign({}, statistic), {}, {\n                    state: _this4.hass.states[statistic.statistic_id],\n                    issues: issues[statistic.statistic_id]\n                  });\n                });\n                Object.keys(issues).forEach(function (statisticId) {\n                  if (!statsIds.has(statisticId) && !_this4._disabledEntities.has(statisticId) && !_this4._deletedStatistics.has(statisticId)) {\n                    _this4._data.push({\n                      statistic_id: statisticId,\n                      statistics_unit_of_measurement: \"\",\n                      source: \"\",\n                      state: _this4.hass.states[statisticId],\n                      issues: issues[statisticId],\n                      has_mean: false,\n                      has_sum: false,\n                      unit_class: null\n                    });\n                  }\n                });\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this);\n        }));\n        function _validateStatistics() {\n          return _validateStatistics2.apply(this, arguments);\n        }\n        return _validateStatistics;\n      }()\n    }, {\n      kind: \"field\",\n      key: \"_fixIssue\",\n      value: function value() {\n        var _this5 = this;\n        return function (ev) {\n          var issues = ev.currentTarget.data.sort(function (itemA, itemB) {\n            var _FIX_ISSUES_ORDER$ite, _FIX_ISSUES_ORDER$ite2;\n            return ((_FIX_ISSUES_ORDER$ite = FIX_ISSUES_ORDER[itemA.type]) !== null && _FIX_ISSUES_ORDER$ite !== void 0 ? _FIX_ISSUES_ORDER$ite : 99) - ((_FIX_ISSUES_ORDER$ite2 = FIX_ISSUES_ORDER[itemB.type]) !== null && _FIX_ISSUES_ORDER$ite2 !== void 0 ? _FIX_ISSUES_ORDER$ite2 : 99);\n          });\n          var issue = issues[0];\n          switch (issue.type) {\n            case \"no_state\":\n              showConfirmationDialog(_this5, {\n                title: _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.no_state.title\"),\n                text: html(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\", \"<br /><br />\", \"\"])), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.no_state.info_text_1\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.no_state.info_text_2\", {\n                  statistic_id: issue.data.statistic_id\n                })),\n                confirmText: _this5.hass.localize(\"ui.common.delete\"),\n                confirm: function () {\n                  var _confirm = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n                    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n                      while (1) switch (_context2.prev = _context2.next) {\n                        case 0:\n                          _context2.next = 2;\n                          return clearStatistics(_this5.hass, [issue.data.statistic_id]);\n                        case 2:\n                          _this5._deletedStatistics.add(issue.data.statistic_id);\n                          _this5._validateStatistics();\n                        case 4:\n                        case \"end\":\n                          return _context2.stop();\n                      }\n                    }, _callee2);\n                  }));\n                  function confirm() {\n                    return _confirm.apply(this, arguments);\n                  }\n                  return confirm;\n                }()\n              });\n              break;\n            case \"entity_not_recorded\":\n              showAlertDialog(_this5, {\n                title: _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_not_recorded.title\"),\n                text: html(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\", \"<br /><br />\", \"<br /><br />\\n            <a\\n              href=\", \"\\n              target=\\\"_blank\\\"\\n              rel=\\\"noreferrer noopener\\\"\\n            >\\n              \", \"</a\\n            >\"])), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_not_recorded.info_text_1\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_not_recorded.info_text_2\"), documentationUrl(_this5.hass, \"/integrations/recorder/#configure-filter\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_not_recorded.info_text_3_link\"))\n              });\n              break;\n            case \"entity_no_longer_recorded\":\n              showAlertDialog(_this5, {\n                title: _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_no_longer_recorded.title\"),\n                text: html(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\", \"\\n            \", \"\\n            <a\\n              href=\", \"\\n              target=\\\"_blank\\\"\\n              rel=\\\"noreferrer noopener\\\"\\n            >\\n              \", \"</a\\n            >\"])), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_no_longer_recorded.info_text_1\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_no_longer_recorded.info_text_2\"), documentationUrl(_this5.hass, \"/integrations/recorder/#configure-filter\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_no_longer_recorded.info_text_3_link\"))\n              });\n              break;\n            case \"unsupported_state_class\":\n              showConfirmationDialog(_this5, {\n                title: _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.title\"),\n                text: html(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\", \"<br /><br />\\n            \", \"\\n            <ul>\\n              <li>\\n                \", \"\\n              </li>\\n              <li>\\n                \", \"\\n                <a\\n                  href=\\\"https://developers.home-assistant.io/docs/core/entity/sensor/#long-term-statistics\\\"\\n                  target=\\\"_blank\\\"\\n                  rel=\\\"noreferrer noopener\\\"\\n                >\\n                  \", \"</a\\n                >\\n              </li>\\n              <li>\\n                \", \"\\n              </li>\\n            </ul>\\n            \", \"\"])), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_1\", {\n                  state_class: issue.data.state_class\n                }), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_2\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_3\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_4\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_4_link\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_5\"), _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_6\", {\n                  statistic_id: issue.data.statistic_id\n                })),\n                confirmText: _this5.hass.localize(\"ui.common.delete\"),\n                confirm: function () {\n                  var _confirm2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n                    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n                      while (1) switch (_context3.prev = _context3.next) {\n                        case 0:\n                          _context3.next = 2;\n                          return clearStatistics(_this5.hass, [issue.data.statistic_id]);\n                        case 2:\n                          _this5._deletedStatistics.add(issue.data.statistic_id);\n                          _this5._validateStatistics();\n                        case 4:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }, _callee3);\n                  }));\n                  function confirm() {\n                    return _confirm2.apply(this, arguments);\n                  }\n                  return confirm;\n                }()\n              });\n              break;\n            case \"units_changed\":\n              showFixStatisticsUnitsChangedDialog(_this5, {\n                issue: issue,\n                fixedCallback: function fixedCallback() {\n                  _this5._validateStatistics();\n                }\n              });\n              break;\n            default:\n              showAlertDialog(_this5, {\n                title: _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.no_support.title\"),\n                text: _this5.hass.localize(\"ui.panel.developer-tools.tabs.statistics.fix_issue.no_support.info_text_1\")\n              });\n          }\n        };\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return haStyle;\n      }\n    }]\n  };\n}, SubscribeMixin(LitElement));","map":{"version":3,"names":["mdiSlopeUphill","html","LitElement","customElement","property","state","memoizeOne","fireEvent","computeStateName","subscribeEntityRegistry","clearStatistics","getStatisticIds","validateStatistics","showAlertDialog","showConfirmationDialog","SubscribeMixin","haStyle","showStatisticsAdjustSumDialog","showFixStatisticsUnitsChangedDialog","documentationUrl","FIX_ISSUES_ORDER","no_state","entity_no_longer_recorded","entity_not_recorded","unsupported_state_class","units_changed","HaPanelDevStatistics","_decorate","_initialize","_SubscribeMixin","_SubscribeMixin2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","decorators","attribute","key","value","type","Boolean","Set","firstUpdated","_validateStatistics","data","localize","map","item","_item$issues","Object","assign","displayName","name","statistic_id","issues_string","issues","issue","join","_this2","title","sortable","filterable","grows","hidden","narrow","width","statistics_unit_of_measurement","forceLTR","source","direction","template","statistic","_statistic$issues_str","_templateObject","_taggedTemplateLiteral","fix","label","hass","_templateObject2","_templateObject3","_fixIssue","actions","has_sum","_templateObject4","_showStatisticsAdjustSumDialog","render","_templateObject5","_columns","_displayData","_data","_rowClicked","ev","stopPropagation","currentTarget","id","detail","states","entityId","hassSubscribe","_this3","connection","entities","disabledEntities","_iterator","_createForOfIteratorHelper","_step","s","n","done","confEnt","disabled_by","add","entity_id","err","e","f","_disabledEntities","_validateStatistics2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this4","_yield$Promise$all","_yield$Promise$all2","statisticIds","statsIds","wrap","_callee$","_context","prev","next","Promise","all","sent","_slicedToArray","filter","has","_deletedStatistics","keys","forEach","statisticId","push","has_mean","unit_class","stop","apply","_this5","sort","itemA","itemB","_FIX_ISSUES_ORDER$ite","_FIX_ISSUES_ORDER$ite2","text","_templateObject6","confirmText","confirm","_confirm","_callee2","_callee2$","_context2","_templateObject7","_templateObject8","_templateObject9","state_class","_confirm2","_callee3","_callee3$","_context3","fixedCallback","static","styles"],"sources":["/Users/sercanardil/Desktop/frontend/src/panels/developer-tools/statistics/developer-tools-statistics.ts"],"sourcesContent":["import \"@material/mwc-button/mwc-button\";\nimport { mdiSlopeUphill } from \"@mdi/js\";\nimport { HassEntity, UnsubscribeFunc } from \"home-assistant-js-websocket\";\nimport { CSSResultGroup, html, LitElement } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { LocalizeFunc } from \"../../../common/translations/localize\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport \"../../../components/data-table/ha-data-table\";\nimport type { DataTableColumnContainer } from \"../../../components/data-table/ha-data-table\";\nimport { subscribeEntityRegistry } from \"../../../data/entity_registry\";\nimport {\n  clearStatistics,\n  getStatisticIds,\n  StatisticsMetaData,\n  StatisticsValidationResult,\n  validateStatistics,\n} from \"../../../data/recorder\";\nimport {\n  showAlertDialog,\n  showConfirmationDialog,\n} from \"../../../dialogs/generic/show-dialog-box\";\nimport { SubscribeMixin } from \"../../../mixins/subscribe-mixin\";\nimport { haStyle } from \"../../../resources/styles\";\nimport { HomeAssistant } from \"../../../types\";\nimport { showStatisticsAdjustSumDialog } from \"./show-dialog-statistics-adjust-sum\";\nimport { showFixStatisticsUnitsChangedDialog } from \"./show-dialog-statistics-fix-units-changed\";\nimport { documentationUrl } from \"../../../util/documentation-url\";\n\nconst FIX_ISSUES_ORDER = {\n  no_state: 0,\n  entity_no_longer_recorded: 1,\n  entity_not_recorded: 1,\n  unsupported_state_class: 2,\n  units_changed: 3,\n};\n\ntype StatisticData = StatisticsMetaData & {\n  issues?: StatisticsValidationResult[];\n  state?: HassEntity;\n};\n\ntype DisplayedStatisticData = StatisticData & {\n  displayName: string;\n  issues_string?: string;\n};\n\n@customElement(\"developer-tools-statistics\")\nclass HaPanelDevStatistics extends SubscribeMixin(LitElement) {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ type: Boolean }) public narrow = false;\n\n  @state() private _data: StatisticData[] = [] as StatisticsMetaData[];\n\n  private _disabledEntities = new Set<string>();\n\n  private _deletedStatistics = new Set<string>();\n\n  protected firstUpdated() {\n    this._validateStatistics();\n  }\n\n  private _displayData = memoizeOne(\n    (data: StatisticData[], localize: LocalizeFunc): DisplayedStatisticData[] =>\n      data.map((item) => ({\n        ...item,\n        displayName: item.state\n          ? computeStateName(item.state)\n          : item.name || item.statistic_id,\n        issues_string: item.issues\n          ?.map(\n            (issue) =>\n              localize(\n                `ui.panel.developer-tools.tabs.statistics.issues.${issue.type}`,\n                issue.data\n              ) || issue.type\n          )\n          .join(\" \"),\n      }))\n  );\n\n  private _columns = memoizeOne(\n    (\n      localize: LocalizeFunc\n    ): DataTableColumnContainer<DisplayedStatisticData> => ({\n      displayName: {\n        title: localize(\n          \"ui.panel.developer-tools.tabs.statistics.data_table.name\"\n        ),\n        sortable: true,\n        filterable: true,\n        grows: true,\n      },\n      statistic_id: {\n        title: localize(\n          \"ui.panel.developer-tools.tabs.statistics.data_table.statistic_id\"\n        ),\n        sortable: true,\n        filterable: true,\n        hidden: this.narrow,\n        width: \"20%\",\n      },\n      statistics_unit_of_measurement: {\n        title: localize(\n          \"ui.panel.developer-tools.tabs.statistics.data_table.statistics_unit\"\n        ),\n        sortable: true,\n        filterable: true,\n        width: \"10%\",\n        forceLTR: true,\n      },\n      source: {\n        title: localize(\n          \"ui.panel.developer-tools.tabs.statistics.data_table.source\"\n        ),\n        sortable: true,\n        filterable: true,\n        width: \"10%\",\n      },\n      issues_string: {\n        title: localize(\n          \"ui.panel.developer-tools.tabs.statistics.data_table.issue\"\n        ),\n        sortable: true,\n        filterable: true,\n        direction: \"asc\",\n        width: \"30%\",\n        template: (statistic) =>\n          html`${statistic.issues_string ??\n          localize(\"ui.panel.developer-tools.tabs.statistics.no_issue\")}`,\n      },\n      fix: {\n        title: \"\",\n        label: this.hass.localize(\n          \"ui.panel.developer-tools.tabs.statistics.fix_issue.fix\"\n        ),\n        template: (statistic) =>\n          html`${statistic.issues\n            ? html`<mwc-button\n                @click=${this._fixIssue}\n                .data=${statistic.issues}\n              >\n                ${localize(\n                  \"ui.panel.developer-tools.tabs.statistics.fix_issue.fix\"\n                )}\n              </mwc-button>`\n            : \"â€”\"}`,\n        width: \"113px\",\n      },\n      actions: {\n        title: \"\",\n        label: localize(\"ui.panel.developer-tools.tabs.statistics.adjust_sum\"),\n        type: \"icon-button\",\n        template: (statistic) =>\n          statistic.has_sum\n            ? html`\n                <ha-icon-button\n                  .label=${localize(\n                    \"ui.panel.developer-tools.tabs.statistics.adjust_sum\"\n                  )}\n                  .path=${mdiSlopeUphill}\n                  .statistic=${statistic}\n                  @click=${this._showStatisticsAdjustSumDialog}\n                ></ha-icon-button>\n              `\n            : \"\",\n      },\n    })\n  );\n\n  protected render() {\n    return html`\n      <ha-data-table\n        .hass=${this.hass}\n        .columns=${this._columns(this.hass.localize)}\n        .data=${this._displayData(this._data, this.hass.localize)}\n        .noDataText=${this.hass.localize(\n          \"ui.panel.developer-tools.tabs.statistics.data_table.no_statistics\"\n        )}\n        id=\"statistic_id\"\n        clickable\n        @row-click=${this._rowClicked}\n      ></ha-data-table>\n    `;\n  }\n\n  private _showStatisticsAdjustSumDialog(ev) {\n    ev.stopPropagation();\n    showStatisticsAdjustSumDialog(this, {\n      statistic: ev.currentTarget.statistic,\n    });\n  }\n\n  private _rowClicked(ev) {\n    const id = ev.detail.id;\n    if (id in this.hass.states) {\n      fireEvent(this, \"hass-more-info\", { entityId: id });\n    }\n  }\n\n  public hassSubscribe(): UnsubscribeFunc[] {\n    return [\n      subscribeEntityRegistry(this.hass.connection!, (entities) => {\n        const disabledEntities = new Set<string>();\n        for (const confEnt of entities) {\n          if (!confEnt.disabled_by) {\n            continue;\n          }\n          disabledEntities.add(confEnt.entity_id);\n        }\n        // If the disabled entities changed, re-validate the statistics\n        if (disabledEntities !== this._disabledEntities) {\n          this._disabledEntities = disabledEntities;\n          this._validateStatistics();\n        }\n      }),\n    ];\n  }\n\n  private async _validateStatistics() {\n    const [statisticIds, issues] = await Promise.all([\n      getStatisticIds(this.hass),\n      validateStatistics(this.hass),\n    ]);\n\n    const statsIds = new Set();\n\n    this._data = statisticIds\n      .filter(\n        (statistic) =>\n          !this._disabledEntities.has(statistic.statistic_id) &&\n          !this._deletedStatistics.has(statistic.statistic_id)\n      )\n      .map((statistic) => {\n        statsIds.add(statistic.statistic_id);\n        return {\n          ...statistic,\n          state: this.hass.states[statistic.statistic_id],\n          issues: issues[statistic.statistic_id],\n        };\n      });\n\n    Object.keys(issues).forEach((statisticId) => {\n      if (\n        !statsIds.has(statisticId) &&\n        !this._disabledEntities.has(statisticId) &&\n        !this._deletedStatistics.has(statisticId)\n      ) {\n        this._data.push({\n          statistic_id: statisticId,\n          statistics_unit_of_measurement: \"\",\n          source: \"\",\n          state: this.hass.states[statisticId],\n          issues: issues[statisticId],\n          has_mean: false,\n          has_sum: false,\n          unit_class: null,\n        });\n      }\n    });\n  }\n\n  private _fixIssue = (ev) => {\n    const issues = (ev.currentTarget.data as StatisticsValidationResult[]).sort(\n      (itemA, itemB) =>\n        (FIX_ISSUES_ORDER[itemA.type] ?? 99) -\n        (FIX_ISSUES_ORDER[itemB.type] ?? 99)\n    );\n    const issue = issues[0];\n    switch (issue.type) {\n      case \"no_state\":\n        showConfirmationDialog(this, {\n          title: this.hass.localize(\n            \"ui.panel.developer-tools.tabs.statistics.fix_issue.no_state.title\"\n          ),\n          text: html`${this.hass.localize(\n              \"ui.panel.developer-tools.tabs.statistics.fix_issue.no_state.info_text_1\"\n            )}<br /><br />${this.hass.localize(\n              \"ui.panel.developer-tools.tabs.statistics.fix_issue.no_state.info_text_2\",\n              { statistic_id: issue.data.statistic_id }\n            )}`,\n          confirmText: this.hass.localize(\"ui.common.delete\"),\n          confirm: async () => {\n            await clearStatistics(this.hass, [issue.data.statistic_id]);\n            this._deletedStatistics.add(issue.data.statistic_id);\n            this._validateStatistics();\n          },\n        });\n        break;\n      case \"entity_not_recorded\":\n        showAlertDialog(this, {\n          title: this.hass.localize(\n            \"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_not_recorded.title\"\n          ),\n          text: html`${this.hass.localize(\n              \"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_not_recorded.info_text_1\"\n            )}<br /><br />${this.hass.localize(\n              \"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_not_recorded.info_text_2\"\n            )}<br /><br />\n            <a\n              href=${documentationUrl(\n                this.hass,\n                \"/integrations/recorder/#configure-filter\"\n              )}\n              target=\"_blank\"\n              rel=\"noreferrer noopener\"\n            >\n              ${this.hass.localize(\n                \"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_not_recorded.info_text_3_link\"\n              )}</a\n            >`,\n        });\n        break;\n      case \"entity_no_longer_recorded\":\n        showAlertDialog(this, {\n          title: this.hass.localize(\n            \"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_no_longer_recorded.title\"\n          ),\n          text: html`${this.hass.localize(\n              \"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_no_longer_recorded.info_text_1\"\n            )}\n            ${this.hass.localize(\n              \"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_no_longer_recorded.info_text_2\"\n            )}\n            <a\n              href=${documentationUrl(\n                this.hass,\n                \"/integrations/recorder/#configure-filter\"\n              )}\n              target=\"_blank\"\n              rel=\"noreferrer noopener\"\n            >\n              ${this.hass.localize(\n                \"ui.panel.developer-tools.tabs.statistics.fix_issue.entity_no_longer_recorded.info_text_3_link\"\n              )}</a\n            >`,\n        });\n        break;\n      case \"unsupported_state_class\":\n        showConfirmationDialog(this, {\n          title: this.hass.localize(\n            \"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.title\"\n          ),\n          text: html`${this.hass.localize(\n              \"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_1\",\n              { state_class: issue.data.state_class }\n            )}<br /><br />\n            ${this.hass.localize(\n              \"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_2\"\n            )}\n            <ul>\n              <li>\n                ${this.hass.localize(\n                  \"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_3\"\n                )}\n              </li>\n              <li>\n                ${this.hass.localize(\n                  \"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_4\"\n                )}\n                <a\n                  href=\"https://developers.home-assistant.io/docs/core/entity/sensor/#long-term-statistics\"\n                  target=\"_blank\"\n                  rel=\"noreferrer noopener\"\n                >\n                  ${this.hass.localize(\n                    \"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_4_link\"\n                  )}</a\n                >\n              </li>\n              <li>\n                ${this.hass.localize(\n                  \"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_5\"\n                )}\n              </li>\n            </ul>\n            ${this.hass.localize(\n              \"ui.panel.developer-tools.tabs.statistics.fix_issue.unsupported_state_class.info_text_6\",\n              { statistic_id: issue.data.statistic_id }\n            )}`,\n          confirmText: this.hass.localize(\"ui.common.delete\"),\n          confirm: async () => {\n            await clearStatistics(this.hass, [issue.data.statistic_id]);\n            this._deletedStatistics.add(issue.data.statistic_id);\n            this._validateStatistics();\n          },\n        });\n        break;\n      case \"units_changed\":\n        showFixStatisticsUnitsChangedDialog(this, {\n          issue,\n          fixedCallback: () => {\n            this._validateStatistics();\n          },\n        });\n        break;\n      default:\n        showAlertDialog(this, {\n          title: this.hass.localize(\n            \"ui.panel.developer-tools.tabs.statistics.fix_issue.no_support.title\"\n          ),\n          text: this.hass.localize(\n            \"ui.panel.developer-tools.tabs.statistics.fix_issue.no_support.info_text_1\"\n          ),\n        });\n    }\n  };\n\n  static get styles(): CSSResultGroup {\n    return haStyle;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"developer-tools-statistics\": HaPanelDevStatistics;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}