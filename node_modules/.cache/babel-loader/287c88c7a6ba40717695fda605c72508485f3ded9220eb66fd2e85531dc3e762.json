{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport \"../../../components/ha-alert\";\nimport \"../../../components/ha-card\";\nexport let HuiIframeCard = _decorate([customElement(\"hui-iframe-card\")], function (_initialize, _LitElement) {\n  class HuiIframeCard extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: HuiIframeCard,\n    d: [{\n      kind: \"method\",\n      static: true,\n      key: \"getConfigElement\",\n      value: async function getConfigElement() {\n        await import(\"../editor/config-elements/hui-iframe-card-editor\");\n        return document.createElement(\"hui-iframe-card-editor\");\n      }\n    }, {\n      kind: \"method\",\n      static: true,\n      key: \"getStubConfig\",\n      value: function getStubConfig() {\n        return {\n          type: \"iframe\",\n          url: \"https://www.home-assistant.io\",\n          aspect_ratio: \"50%\"\n        };\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean,\n        reflect: true\n      })],\n      key: \"isPanel\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_config\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"getCardSize\",\n      value: function getCardSize() {\n        if (!this._config) {\n          return 5;\n        }\n        const aspectRatio = this._config.aspect_ratio ? Number(this._config.aspect_ratio.replace(\"%\", \"\")) : 50;\n        return 1 + aspectRatio / 25;\n      }\n    }, {\n      kind: \"method\",\n      key: \"setConfig\",\n      value: function setConfig(config) {\n        if (!config.url) {\n          throw new Error(\"URL required\");\n        }\n        this._config = config;\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this._config || !this.hass) {\n          return nothing;\n        }\n        let padding = \"\";\n        if (!this.isPanel && this._config.aspect_ratio) {\n          const ratio = parseAspectRatio(this._config.aspect_ratio);\n          if (ratio && ratio.w > 0 && ratio.h > 0) {\n            padding = `${(100 * ratio.h / ratio.w).toFixed(2)}%`;\n          }\n        } else if (!this.isPanel) {\n          padding = \"50%\";\n        }\n        const target_protocol = new URL(this._config.url, location.toString()).protocol;\n        if (location.protocol === \"https:\" && target_protocol !== \"https:\") {\n          return html`\n        <ha-alert alert-type=\"error\">\n          ${this.hass.localize(\"ui.panel.lovelace.cards.iframe.error_secure_context\", {\n            target_protocol,\n            context_protocol: location.protocol\n          })}\n        </ha-alert>\n      `;\n        }\n        let sandbox_user_params = \"\";\n        if (this._config.allow_open_top_navigation) {\n          sandbox_user_params += \"allow-top-navigation-by-user-activation\";\n        }\n        return html`\n      <ha-card .header=${this._config.title}>\n        <div\n          id=\"root\"\n          style=${styleMap({\n          \"padding-top\": padding\n        })}\n        >\n          <iframe\n            title=${ifDefined(this._config.title)}\n            src=${this._config.url}\n            sandbox=\"${sandbox_user_params} allow-forms allow-modals allow-popups allow-pointer-lock allow-same-origin allow-scripts\"\n            allow=\"fullscreen\"\n          ></iframe>\n        </div>\n      </ha-card>\n    `;\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return css`\n      :host([ispanel]) ha-card {\n        width: 100%;\n        height: 100%;\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n\n      #root {\n        width: 100%;\n        position: relative;\n      }\n\n      :host([ispanel]) #root {\n        height: 100%;\n      }\n\n      iframe {\n        position: absolute;\n        border: none;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n      }\n    `;\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["css","html","LitElement","nothing","customElement","property","state","ifDefined","styleMap","parseAspectRatio","HuiIframeCard","_decorate","_initialize","_LitElement","constructor","args","F","d","kind","static","key","value","getConfigElement","document","createElement","getStubConfig","type","url","aspect_ratio","decorators","Boolean","reflect","attribute","getCardSize","_config","aspectRatio","Number","replace","setConfig","config","Error","render","hass","padding","isPanel","ratio","w","h","toFixed","target_protocol","URL","location","toString","protocol","localize","context_protocol","sandbox_user_params","allow_open_top_navigation","title","styles"],"sources":["/workspaces/frontend/src/panels/lovelace/cards/hui-iframe-card.ts"],"sourcesContent":["import { css, CSSResultGroup, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport \"../../../components/ha-alert\";\nimport \"../../../components/ha-card\";\nimport type { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { IframeCardConfig } from \"./types\";\n\n@customElement(\"hui-iframe-card\")\nexport class HuiIframeCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-iframe-card-editor\");\n    return document.createElement(\"hui-iframe-card-editor\");\n  }\n\n  public static getStubConfig(): IframeCardConfig {\n    return {\n      type: \"iframe\",\n      url: \"https://www.home-assistant.io\",\n      aspect_ratio: \"50%\",\n    };\n  }\n\n  @property({ type: Boolean, reflect: true })\n  public isPanel = false;\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() protected _config?: IframeCardConfig;\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 5;\n    }\n    const aspectRatio = this._config.aspect_ratio\n      ? Number(this._config.aspect_ratio.replace(\"%\", \"\"))\n      : 50;\n    return 1 + aspectRatio / 25;\n  }\n\n  public setConfig(config: IframeCardConfig): void {\n    if (!config.url) {\n      throw new Error(\"URL required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render() {\n    if (!this._config || !this.hass) {\n      return nothing;\n    }\n\n    let padding = \"\";\n    if (!this.isPanel && this._config.aspect_ratio) {\n      const ratio = parseAspectRatio(this._config.aspect_ratio);\n      if (ratio && ratio.w > 0 && ratio.h > 0) {\n        padding = `${((100 * ratio.h) / ratio.w).toFixed(2)}%`;\n      }\n    } else if (!this.isPanel) {\n      padding = \"50%\";\n    }\n\n    const target_protocol = new URL(this._config.url, location.toString())\n      .protocol;\n    if (location.protocol === \"https:\" && target_protocol !== \"https:\") {\n      return html`\n        <ha-alert alert-type=\"error\">\n          ${this.hass!.localize(\n            \"ui.panel.lovelace.cards.iframe.error_secure_context\",\n            {\n              target_protocol,\n              context_protocol: location.protocol,\n            }\n          )}\n        </ha-alert>\n      `;\n    }\n\n    let sandbox_user_params = \"\";\n    if (this._config.allow_open_top_navigation) {\n      sandbox_user_params += \"allow-top-navigation-by-user-activation\";\n    }\n\n    return html`\n      <ha-card .header=${this._config.title}>\n        <div\n          id=\"root\"\n          style=${styleMap({\n            \"padding-top\": padding,\n          })}\n        >\n          <iframe\n            title=${ifDefined(this._config.title)}\n            src=${this._config.url}\n            sandbox=\"${sandbox_user_params} allow-forms allow-modals allow-popups allow-pointer-lock allow-same-origin allow-scripts\"\n            allow=\"fullscreen\"\n          ></iframe>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host([ispanel]) ha-card {\n        width: 100%;\n        height: 100%;\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n\n      #root {\n        width: 100%;\n        position: relative;\n      }\n\n      :host([ispanel]) #root {\n        height: 100%;\n      }\n\n      iframe {\n        position: absolute;\n        border: none;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-iframe-card\": HuiIframeCard;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}