{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { navigate } from \"../../../common/navigate\";\nimport { HassRouterPage } from \"../../../layouts/hass-router-page\";\nimport \"./account/cloud-account\";\nimport \"./login/cloud-login\";\nconst LOGGED_IN_URLS = [\"account\", \"google-assistant\", \"alexa\"];\nconst NOT_LOGGED_IN_URLS = [\"login\", \"register\", \"forgot-password\"];\nlet HaConfigCloud = _decorate([customElement(\"ha-config-cloud\")], function (_initialize, _HassRouterPage) {\n  class HaConfigCloud extends _HassRouterPage {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: HaConfigCloud,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"isWide\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"narrow\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"route\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"cloudStatus\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"routerOptions\",\n      value() {\n        return {\n          defaultPage: \"login\",\n          showLoading: true,\n          initialLoad: () => this._cloudStatusLoaded,\n          // Guard the different pages based on if we're logged in.\n          beforeRender: page => {\n            if (this.cloudStatus.logged_in) {\n              if (!LOGGED_IN_URLS.includes(page)) {\n                return \"account\";\n              }\n            } else if (!NOT_LOGGED_IN_URLS.includes(page)) {\n              return \"login\";\n            }\n            return undefined;\n          },\n          routes: {\n            login: {\n              tag: \"cloud-login\"\n            },\n            register: {\n              tag: \"cloud-register\",\n              load: () => import(\"./register/cloud-register\")\n            },\n            \"forgot-password\": {\n              tag: \"cloud-forgot-password\",\n              load: () => import(\"./forgot-password/cloud-forgot-password\")\n            },\n            account: {\n              tag: \"cloud-account\"\n            }\n          }\n        };\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_flashMessage\",\n      value() {\n        return \"\";\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_loginEmail\",\n      value() {\n        return \"\";\n      }\n    }, {\n      kind: \"field\",\n      key: \"_resolveCloudStatusLoaded\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_cloudStatusLoaded\",\n      value() {\n        return new Promise(resolve => {\n          this._resolveCloudStatusLoaded = resolve;\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"firstUpdated\",\n      value: function firstUpdated(changedProps) {\n        _get(_getPrototypeOf(HaConfigCloud.prototype), \"firstUpdated\", this).call(this, changedProps);\n        this.addEventListener(\"cloud-done\", ev => {\n          this._flashMessage = ev.detail.flashMessage;\n          navigate(\"/config/cloud/login\");\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"updated\",\n      value: function updated(changedProps) {\n        _get(_getPrototypeOf(HaConfigCloud.prototype), \"updated\", this).call(this, changedProps);\n        if (changedProps.has(\"cloudStatus\")) {\n          const oldStatus = changedProps.get(\"cloudStatus\");\n          if (oldStatus === undefined) {\n            this._resolveCloudStatusLoaded();\n          } else if (oldStatus.logged_in !== this.cloudStatus.logged_in) {\n            navigate(this.route.prefix, {\n              replace: true\n            });\n          }\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"createElement\",\n      value: function createElement(tag) {\n        const el = _get(_getPrototypeOf(HaConfigCloud.prototype), \"createElement\", this).call(this, tag);\n        el.addEventListener(\"email-changed\", ev => {\n          this._loginEmail = ev.detail.value;\n        });\n        el.addEventListener(\"flash-message-changed\", ev => {\n          this._flashMessage = ev.detail.value;\n        });\n        return el;\n      }\n    }, {\n      kind: \"method\",\n      key: \"updatePageEl\",\n      value: function updatePageEl(el) {\n        // We are not going to update if the current page if we are not logged in\n        // and the current page requires being logged in. Happens when we log out.\n        if (this.cloudStatus && !this.cloudStatus.logged_in && LOGGED_IN_URLS.includes(this._currentPage)) {\n          return;\n        }\n        el.hass = this.hass;\n        el.email = this._loginEmail;\n        el.isWide = this.isWide;\n        el.narrow = this.narrow;\n        el.cloudStatus = this.cloudStatus;\n        el.flashMessage = this._flashMessage;\n      }\n    }]\n  };\n}, HassRouterPage);","map":{"version":3,"names":["customElement","property","state","navigate","HassRouterPage","LOGGED_IN_URLS","NOT_LOGGED_IN_URLS","HaConfigCloud","_decorate","_initialize","_HassRouterPage","constructor","args","F","d","kind","decorators","attribute","key","value","type","Boolean","defaultPage","showLoading","initialLoad","_cloudStatusLoaded","beforeRender","page","cloudStatus","logged_in","includes","undefined","routes","login","tag","register","load","account","Promise","resolve","_resolveCloudStatusLoaded","firstUpdated","changedProps","_get","_getPrototypeOf","prototype","call","addEventListener","ev","_flashMessage","detail","flashMessage","updated","has","oldStatus","get","route","prefix","replace","createElement","el","_loginEmail","updatePageEl","_currentPage","hass","email","isWide","narrow"],"sources":["/Users/sercanardil/Desktop/frontend/src/panels/config/cloud/ha-config-cloud.ts"],"sourcesContent":["import { customElement, property, state } from \"lit/decorators\";\nimport { navigate } from \"../../../common/navigate\";\nimport { CloudStatus } from \"../../../data/cloud\";\nimport {\n  HassRouterPage,\n  RouterOptions,\n} from \"../../../layouts/hass-router-page\";\nimport { ValueChangedEvent, HomeAssistant, Route } from \"../../../types\";\nimport \"./account/cloud-account\";\nimport \"./login/cloud-login\";\n\nconst LOGGED_IN_URLS = [\"account\", \"google-assistant\", \"alexa\"];\nconst NOT_LOGGED_IN_URLS = [\"login\", \"register\", \"forgot-password\"];\n\n@customElement(\"ha-config-cloud\")\nclass HaConfigCloud extends HassRouterPage {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ type: Boolean }) public isWide = false;\n\n  @property({ type: Boolean }) public narrow = false;\n\n  @property({ attribute: false }) public route!: Route;\n\n  @property({ attribute: false }) public cloudStatus!: CloudStatus;\n\n  protected routerOptions: RouterOptions = {\n    defaultPage: \"login\",\n    showLoading: true,\n    initialLoad: () => this._cloudStatusLoaded,\n    // Guard the different pages based on if we're logged in.\n    beforeRender: (page: string) => {\n      if (this.cloudStatus.logged_in) {\n        if (!LOGGED_IN_URLS.includes(page)) {\n          return \"account\";\n        }\n      } else if (!NOT_LOGGED_IN_URLS.includes(page)) {\n        return \"login\";\n      }\n      return undefined;\n    },\n    routes: {\n      login: {\n        tag: \"cloud-login\",\n      },\n      register: {\n        tag: \"cloud-register\",\n        load: () => import(\"./register/cloud-register\"),\n      },\n      \"forgot-password\": {\n        tag: \"cloud-forgot-password\",\n        load: () => import(\"./forgot-password/cloud-forgot-password\"),\n      },\n      account: {\n        tag: \"cloud-account\",\n      },\n    },\n  };\n\n  @state() private _flashMessage = \"\";\n\n  @state() private _loginEmail = \"\";\n\n  private _resolveCloudStatusLoaded!: () => void;\n\n  private _cloudStatusLoaded = new Promise<void>((resolve) => {\n    this._resolveCloudStatusLoaded = resolve;\n  });\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    this.addEventListener(\"cloud-done\", (ev) => {\n      this._flashMessage = (ev as any).detail.flashMessage;\n      navigate(\"/config/cloud/login\");\n    });\n  }\n\n  protected updated(changedProps) {\n    super.updated(changedProps);\n\n    if (changedProps.has(\"cloudStatus\")) {\n      const oldStatus = changedProps.get(\"cloudStatus\") as\n        | CloudStatus\n        | undefined;\n      if (oldStatus === undefined) {\n        this._resolveCloudStatusLoaded();\n      } else if (oldStatus.logged_in !== this.cloudStatus.logged_in) {\n        navigate(this.route.prefix, { replace: true });\n      }\n    }\n  }\n\n  protected createElement(tag: string) {\n    const el = super.createElement(tag);\n    el.addEventListener(\"email-changed\", (ev) => {\n      this._loginEmail = (ev as ValueChangedEvent<string>).detail.value;\n    });\n    el.addEventListener(\"flash-message-changed\", (ev) => {\n      this._flashMessage = (ev as ValueChangedEvent<string>).detail.value;\n    });\n    return el;\n  }\n\n  protected updatePageEl(el) {\n    // We are not going to update if the current page if we are not logged in\n    // and the current page requires being logged in. Happens when we log out.\n    if (\n      this.cloudStatus &&\n      !this.cloudStatus.logged_in &&\n      LOGGED_IN_URLS.includes(this._currentPage)\n    ) {\n      return;\n    }\n\n    el.hass = this.hass;\n    el.email = this._loginEmail;\n    el.isWide = this.isWide;\n    el.narrow = this.narrow;\n    el.cloudStatus = this.cloudStatus;\n    el.flashMessage = this._flashMessage;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-config-cloud\": HaConfigCloud;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}