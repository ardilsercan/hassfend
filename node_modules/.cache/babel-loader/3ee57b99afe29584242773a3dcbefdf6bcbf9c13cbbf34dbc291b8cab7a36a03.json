{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport { addDays, differenceInMilliseconds, startOfDay } from \"date-fns\";\nimport { ReactiveElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { absoluteTime } from \"../common/datetime/absolute_time\";\nconst SAFE_MARGIN = 5 * 1000;\nlet HaAbsoluteTime = _decorate([customElement(\"ha-absolute-time\")], function (_initialize, _ReactiveElement) {\n  class HaAbsoluteTime extends _ReactiveElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: HaAbsoluteTime,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"datetime\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_timeout\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"disconnectedCallback\",\n      value: function disconnectedCallback() {\n        _get(_getPrototypeOf(HaAbsoluteTime.prototype), \"disconnectedCallback\", this).call(this);\n        this._clearTimeout();\n      }\n    }, {\n      kind: \"method\",\n      key: \"connectedCallback\",\n      value: function connectedCallback() {\n        _get(_getPrototypeOf(HaAbsoluteTime.prototype), \"connectedCallback\", this).call(this);\n        if (this.datetime) {\n          this._updateNextDay();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"createRenderRoot\",\n      value: function createRenderRoot() {\n        return this;\n      }\n    }, {\n      kind: \"method\",\n      key: \"firstUpdated\",\n      value: function firstUpdated(changedProps) {\n        _get(_getPrototypeOf(HaAbsoluteTime.prototype), \"firstUpdated\", this).call(this, changedProps);\n        this._updateAbsolute();\n      }\n    }, {\n      kind: \"method\",\n      key: \"update\",\n      value: function update(changedProps) {\n        _get(_getPrototypeOf(HaAbsoluteTime.prototype), \"update\", this).call(this, changedProps);\n        this._updateAbsolute();\n      }\n    }, {\n      kind: \"method\",\n      key: \"_clearTimeout\",\n      value: function _clearTimeout() {\n        if (this._timeout) {\n          window.clearTimeout(this._timeout);\n          this._timeout = undefined;\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_updateNextDay\",\n      value: function _updateNextDay() {\n        this._clearTimeout();\n        const now = new Date();\n        const nextDay = addDays(startOfDay(now), 1);\n        const ms = differenceInMilliseconds(nextDay, now) + SAFE_MARGIN;\n        this._timeout = window.setTimeout(() => {\n          this._updateNextDay();\n          this._updateAbsolute();\n        }, ms);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_updateAbsolute\",\n      value: function _updateAbsolute() {\n        if (!this.datetime) {\n          this.innerHTML = this.hass.localize(\"ui.components.absolute_time.never\");\n        } else {\n          this.innerHTML = absoluteTime(new Date(this.datetime), this.hass.locale, this.hass.config);\n        }\n      }\n    }]\n  };\n}, ReactiveElement);","map":{"version":3,"names":["addDays","differenceInMilliseconds","startOfDay","ReactiveElement","customElement","property","absoluteTime","SAFE_MARGIN","HaAbsoluteTime","_decorate","_initialize","_ReactiveElement","constructor","args","F","d","kind","decorators","attribute","key","value","disconnectedCallback","_get","_getPrototypeOf","prototype","call","_clearTimeout","connectedCallback","datetime","_updateNextDay","createRenderRoot","firstUpdated","changedProps","_updateAbsolute","update","_timeout","window","clearTimeout","undefined","now","Date","nextDay","ms","setTimeout","innerHTML","hass","localize","locale","config"],"sources":["/workspaces/frontend/src/components/ha-absolute-time.ts"],"sourcesContent":["import { addDays, differenceInMilliseconds, startOfDay } from \"date-fns\";\nimport { PropertyValues, ReactiveElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { absoluteTime } from \"../common/datetime/absolute_time\";\nimport type { HomeAssistant } from \"../types\";\n\nconst SAFE_MARGIN = 5 * 1000;\n\n@customElement(\"ha-absolute-time\")\nclass HaAbsoluteTime extends ReactiveElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public datetime?: string | Date;\n\n  private _timeout?: number;\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._clearTimeout();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (this.datetime) {\n      this._updateNextDay();\n    }\n  }\n\n  protected createRenderRoot() {\n    return this;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues) {\n    super.firstUpdated(changedProps);\n    this._updateAbsolute();\n  }\n\n  protected update(changedProps: PropertyValues) {\n    super.update(changedProps);\n    this._updateAbsolute();\n  }\n\n  private _clearTimeout(): void {\n    if (this._timeout) {\n      window.clearTimeout(this._timeout);\n      this._timeout = undefined;\n    }\n  }\n\n  private _updateNextDay(): void {\n    this._clearTimeout();\n\n    const now = new Date();\n    const nextDay = addDays(startOfDay(now), 1);\n    const ms = differenceInMilliseconds(nextDay, now) + SAFE_MARGIN;\n\n    this._timeout = window.setTimeout(() => {\n      this._updateNextDay();\n      this._updateAbsolute();\n    }, ms);\n  }\n\n  private _updateAbsolute(): void {\n    if (!this.datetime) {\n      this.innerHTML = this.hass.localize(\"ui.components.absolute_time.never\");\n    } else {\n      this.innerHTML = absoluteTime(\n        new Date(this.datetime),\n        this.hass.locale,\n        this.hass.config\n      );\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-absolute-time\": HaAbsoluteTime;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}