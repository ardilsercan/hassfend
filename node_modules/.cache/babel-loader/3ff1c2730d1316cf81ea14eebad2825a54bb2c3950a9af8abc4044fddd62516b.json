{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nvar _templateObject, _templateObject2, _templateObject3;\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport \"../../../components/ha-alert\";\nimport \"../../../components/ha-card\";\nexport var HuiIframeCard = _decorate([customElement(\"hui-iframe-card\")], function (_initialize, _LitElement) {\n  var HuiIframeCard = /*#__PURE__*/function (_LitElement2) {\n    _inherits(HuiIframeCard, _LitElement2);\n    function HuiIframeCard() {\n      var _this;\n      _classCallCheck(this, HuiIframeCard);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, HuiIframeCard, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(HuiIframeCard);\n  }(_LitElement);\n  return {\n    F: HuiIframeCard,\n    d: [{\n      kind: \"method\",\n      static: true,\n      key: \"getConfigElement\",\n      value: function () {\n        var _getConfigElement = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return import(\"../editor/config-elements/hui-iframe-card-editor\");\n              case 2:\n                return _context.abrupt(\"return\", document.createElement(\"hui-iframe-card-editor\"));\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n        function getConfigElement() {\n          return _getConfigElement.apply(this, arguments);\n        }\n        return getConfigElement;\n      }()\n    }, {\n      kind: \"method\",\n      static: true,\n      key: \"getStubConfig\",\n      value: function getStubConfig() {\n        return {\n          type: \"iframe\",\n          url: \"https://www.home-assistant.io\",\n          aspect_ratio: \"50%\"\n        };\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean,\n        reflect: true\n      })],\n      key: \"isPanel\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_config\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"getCardSize\",\n      value: function getCardSize() {\n        if (!this._config) {\n          return 5;\n        }\n        var aspectRatio = this._config.aspect_ratio ? Number(this._config.aspect_ratio.replace(\"%\", \"\")) : 50;\n        return 1 + aspectRatio / 25;\n      }\n    }, {\n      kind: \"method\",\n      key: \"setConfig\",\n      value: function setConfig(config) {\n        if (!config.url) {\n          throw new Error(\"URL required\");\n        }\n        this._config = config;\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this._config || !this.hass) {\n          return nothing;\n        }\n        var padding = \"\";\n        if (!this.isPanel && this._config.aspect_ratio) {\n          var ratio = parseAspectRatio(this._config.aspect_ratio);\n          if (ratio && ratio.w > 0 && ratio.h > 0) {\n            padding = \"\".concat((100 * ratio.h / ratio.w).toFixed(2), \"%\");\n          }\n        } else if (!this.isPanel) {\n          padding = \"50%\";\n        }\n        var target_protocol = new URL(this._config.url, location.toString()).protocol;\n        if (location.protocol === \"https:\" && target_protocol !== \"https:\") {\n          return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n        <ha-alert alert-type=\\\"error\\\">\\n          \", \"\\n        </ha-alert>\\n      \"])), this.hass.localize(\"ui.panel.lovelace.cards.iframe.error_secure_context\", {\n            target_protocol: target_protocol,\n            context_protocol: location.protocol\n          }));\n        }\n        var sandbox_user_params = \"\";\n        if (this._config.allow_open_top_navigation) {\n          sandbox_user_params += \"allow-top-navigation-by-user-activation\";\n        }\n        return html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n      <ha-card .header=\", \">\\n        <div\\n          id=\\\"root\\\"\\n          style=\", \"\\n        >\\n          <iframe\\n            title=\", \"\\n            src=\", \"\\n            sandbox=\\\"\", \" allow-forms allow-modals allow-popups allow-pointer-lock allow-same-origin allow-scripts\\\"\\n            allow=\\\"fullscreen\\\"\\n          ></iframe>\\n        </div>\\n      </ha-card>\\n    \"])), this._config.title, styleMap({\n          \"padding-top\": padding\n        }), ifDefined(this._config.title), this._config.url, sandbox_user_params);\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return css(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n      :host([ispanel]) ha-card {\\n        width: 100%;\\n        height: 100%;\\n      }\\n\\n      ha-card {\\n        overflow: hidden;\\n      }\\n\\n      #root {\\n        width: 100%;\\n        position: relative;\\n      }\\n\\n      :host([ispanel]) #root {\\n        height: 100%;\\n      }\\n\\n      iframe {\\n        position: absolute;\\n        border: none;\\n        width: 100%;\\n        height: 100%;\\n        top: 0;\\n        left: 0;\\n      }\\n    \"])));\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["css","html","LitElement","nothing","customElement","property","state","ifDefined","styleMap","parseAspectRatio","HuiIframeCard","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","static","key","value","_getConfigElement","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","document","createElement","stop","getConfigElement","apply","getStubConfig","type","url","aspect_ratio","decorators","Boolean","reflect","attribute","getCardSize","_config","aspectRatio","Number","replace","setConfig","config","Error","render","hass","padding","isPanel","ratio","w","h","toFixed","target_protocol","URL","location","toString","protocol","_templateObject","_taggedTemplateLiteral","localize","context_protocol","sandbox_user_params","allow_open_top_navigation","_templateObject2","title","styles","_templateObject3"],"sources":["/workspaces/frontend/src/panels/lovelace/cards/hui-iframe-card.ts"],"sourcesContent":["import { css, CSSResultGroup, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport \"../../../components/ha-alert\";\nimport \"../../../components/ha-card\";\nimport type { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { IframeCardConfig } from \"./types\";\n\n@customElement(\"hui-iframe-card\")\nexport class HuiIframeCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-iframe-card-editor\");\n    return document.createElement(\"hui-iframe-card-editor\");\n  }\n\n  public static getStubConfig(): IframeCardConfig {\n    return {\n      type: \"iframe\",\n      url: \"https://www.home-assistant.io\",\n      aspect_ratio: \"50%\",\n    };\n  }\n\n  @property({ type: Boolean, reflect: true })\n  public isPanel = false;\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() protected _config?: IframeCardConfig;\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 5;\n    }\n    const aspectRatio = this._config.aspect_ratio\n      ? Number(this._config.aspect_ratio.replace(\"%\", \"\"))\n      : 50;\n    return 1 + aspectRatio / 25;\n  }\n\n  public setConfig(config: IframeCardConfig): void {\n    if (!config.url) {\n      throw new Error(\"URL required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render() {\n    if (!this._config || !this.hass) {\n      return nothing;\n    }\n\n    let padding = \"\";\n    if (!this.isPanel && this._config.aspect_ratio) {\n      const ratio = parseAspectRatio(this._config.aspect_ratio);\n      if (ratio && ratio.w > 0 && ratio.h > 0) {\n        padding = `${((100 * ratio.h) / ratio.w).toFixed(2)}%`;\n      }\n    } else if (!this.isPanel) {\n      padding = \"50%\";\n    }\n\n    const target_protocol = new URL(this._config.url, location.toString())\n      .protocol;\n    if (location.protocol === \"https:\" && target_protocol !== \"https:\") {\n      return html`\n        <ha-alert alert-type=\"error\">\n          ${this.hass!.localize(\n            \"ui.panel.lovelace.cards.iframe.error_secure_context\",\n            {\n              target_protocol,\n              context_protocol: location.protocol,\n            }\n          )}\n        </ha-alert>\n      `;\n    }\n\n    let sandbox_user_params = \"\";\n    if (this._config.allow_open_top_navigation) {\n      sandbox_user_params += \"allow-top-navigation-by-user-activation\";\n    }\n\n    return html`\n      <ha-card .header=${this._config.title}>\n        <div\n          id=\"root\"\n          style=${styleMap({\n            \"padding-top\": padding,\n          })}\n        >\n          <iframe\n            title=${ifDefined(this._config.title)}\n            src=${this._config.url}\n            sandbox=\"${sandbox_user_params} allow-forms allow-modals allow-popups allow-pointer-lock allow-same-origin allow-scripts\"\n            allow=\"fullscreen\"\n          ></iframe>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host([ispanel]) ha-card {\n        width: 100%;\n        height: 100%;\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n\n      #root {\n        width: 100%;\n        position: relative;\n      }\n\n      :host([ispanel]) #root {\n        height: 100%;\n      }\n\n      iframe {\n        position: absolute;\n        border: none;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-iframe-card\": HuiIframeCard;\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,GAAG,EAAkBC,IAAI,EAAEC,UAAU,EAAEC,OAAO,QAAQ,KAAK;AACpE,SAASC,aAAa,EAAEC,QAAQ,EAAEC,KAAK,QAAQ,gBAAgB;AAC/D,SAASC,SAAS,QAAQ,2BAA2B;AACrD,SAASC,QAAQ,QAAQ,0BAA0B;AACnD,OAAOC,gBAAgB,MAAM,yCAAyC;AACtE,OAAO,8BAA8B;AACrC,OAAO,6BAA6B;AAKpC,WACaC,aAAa,GAAAC,SAAA,EADzBP,aAAa,CAAC,iBAAiB,CAAC,aAAAQ,WAAA,EAAAC,WAAA;EAAA,IACpBH,aAAa,0BAAAI,YAAA;IAAAC,SAAA,CAAAL,aAAA,EAAAI,YAAA;IAAA,SAAAJ,cAAA;MAAA,IAAAM,KAAA;MAAAC,eAAA,OAAAP,aAAA;MAAA,SAAAQ,IAAA,GAAAC,SAAA,CAAAC,MAAA,EAAAC,IAAA,OAAAC,KAAA,CAAAJ,IAAA,GAAAK,IAAA,MAAAA,IAAA,GAAAL,IAAA,EAAAK,IAAA;QAAAF,IAAA,CAAAE,IAAA,IAAAJ,SAAA,CAAAI,IAAA;MAAA;MAAAP,KAAA,GAAAQ,UAAA,OAAAd,aAAA,KAAAe,MAAA,CAAAJ,IAAA;MAAAT,WAAA,CAAAc,sBAAA,CAAAV,KAAA;MAAA,OAAAA,KAAA;IAAA;IAAA,OAAAW,YAAA,CAAAjB,aAAA;EAAA,EAAAG,WAAA;EAAA;IAAAe,CAAA,EAAblB,aAAa;IAAAmB,CAAA;MAAAC,IAAA;MAAAC,MAAA;MAAAC,GAAA;MAAAC,KAAA;QAAA,IAAAC,iBAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CACxB,SAAAC,QAAA;UAAA,OAAAF,mBAAA,GAAAG,IAAA,UAAAC,SAAAC,QAAA;YAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;cAAA;gBAAAF,QAAA,CAAAE,IAAA;gBAAA,OACQ,MAAM,CAAC,kDAAkD,CAAC;cAAA;gBAAA,OAAAF,QAAA,CAAAG,MAAA,WACzDC,QAAQ,CAACC,aAAa,CAAC,wBAAwB,CAAC;cAAA;cAAA;gBAAA,OAAAL,QAAA,CAAAM,IAAA;YAAA;UAAA,GAAAT,OAAA;QAAA,CACxD;QAAA,SAAAU,iBAAA;UAAA,OAAAd,iBAAA,CAAAe,KAAA,OAAA9B,SAAA;QAAA;QAAA,OAAA6B,gBAAA;MAAA;IAAA;MAAAlB,IAAA;MAAAC,MAAA;MAAAC,GAAA;MAAAC,KAAA,EAED,SAAAiB,cAAA,EAAgD;QAC9C,OAAO;UACLC,IAAI,EAAE,QAAQ;UACdC,GAAG,EAAE,+BAA+B;UACpCC,YAAY,EAAE;QAChB,CAAC;MACH;IAAC;MAAAvB,IAAA;MAAAwB,UAAA,GAEAjD,QAAQ,CAAC;QAAE8C,IAAI,EAAEI,OAAO;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;MAAAxB,GAAA;MAAAC,KAAA,WAAAA,MAAA;QAAA,OAC1B,KAAK;MAAA;IAAA;MAAAH,IAAA;MAAAwB,UAAA,GAErBjD,QAAQ,CAAC;QAAEoD,SAAS,EAAE;MAAM,CAAC,CAAC;MAAAzB,GAAA;MAAAC,KAAA;IAAA;MAAAH,IAAA;MAAAwB,UAAA,GAE9BhD,KAAK,CAAC,CAAC;MAAA0B,GAAA;MAAAC,KAAA;IAAA;MAAAH,IAAA;MAAAE,GAAA;MAAAC,KAAA,EAER,SAAAyB,YAAA,EAA6B;QAC3B,IAAI,CAAC,IAAI,CAACC,OAAO,EAAE;UACjB,OAAO,CAAC;QACV;QACA,IAAMC,WAAW,GAAG,IAAI,CAACD,OAAO,CAACN,YAAY,GACzCQ,MAAM,CAAC,IAAI,CAACF,OAAO,CAACN,YAAY,CAACS,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,GAClD,EAAE;QACN,OAAO,CAAC,GAAGF,WAAW,GAAG,EAAE;MAC7B;IAAC;MAAA9B,IAAA;MAAAE,GAAA;MAAAC,KAAA,EAED,SAAA8B,UAAiBC,MAAwB,EAAQ;QAC/C,IAAI,CAACA,MAAM,CAACZ,GAAG,EAAE;UACf,MAAM,IAAIa,KAAK,CAAC,cAAc,CAAC;QACjC;QAEA,IAAI,CAACN,OAAO,GAAGK,MAAM;MACvB;IAAC;MAAAlC,IAAA;MAAAE,GAAA;MAAAC,KAAA,EAED,SAAAiC,OAAA,EAAmB;QACjB,IAAI,CAAC,IAAI,CAACP,OAAO,IAAI,CAAC,IAAI,CAACQ,IAAI,EAAE;UAC/B,OAAOhE,OAAO;QAChB;QAEA,IAAIiE,OAAO,GAAG,EAAE;QAChB,IAAI,CAAC,IAAI,CAACC,OAAO,IAAI,IAAI,CAACV,OAAO,CAACN,YAAY,EAAE;UAC9C,IAAMiB,KAAK,GAAG7D,gBAAgB,CAAC,IAAI,CAACkD,OAAO,CAACN,YAAY,CAAC;UACzD,IAAIiB,KAAK,IAAIA,KAAK,CAACC,CAAC,GAAG,CAAC,IAAID,KAAK,CAACE,CAAC,GAAG,CAAC,EAAE;YACvCJ,OAAO,MAAA3C,MAAA,CAAM,CAAE,GAAG,GAAG6C,KAAK,CAACE,CAAC,GAAIF,KAAK,CAACC,CAAC,EAAEE,OAAO,CAAC,CAAC,CAAC,MAAG;UACxD;QACF,CAAC,MAAM,IAAI,CAAC,IAAI,CAACJ,OAAO,EAAE;UACxBD,OAAO,GAAG,KAAK;QACjB;QAEA,IAAMM,eAAe,GAAG,IAAIC,GAAG,CAAC,IAAI,CAAChB,OAAO,CAACP,GAAG,EAAEwB,QAAQ,CAACC,QAAQ,CAAC,CAAC,CAAC,CACnEC,QAAQ;QACX,IAAIF,QAAQ,CAACE,QAAQ,KAAK,QAAQ,IAAIJ,eAAe,KAAK,QAAQ,EAAE;UAClE,OAAOzE,IAAI,CAAA8E,eAAA,KAAAA,eAAA,GAAAC,sBAAA,+FAEL,IAAI,CAACb,IAAI,CAAEc,QAAQ,CACnB,qDAAqD,EACrD;YACEP,eAAe,EAAfA,eAAe;YACfQ,gBAAgB,EAAEN,QAAQ,CAACE;UAC7B,CACF,CAAC;QAGP;QAEA,IAAIK,mBAAmB,GAAG,EAAE;QAC5B,IAAI,IAAI,CAACxB,OAAO,CAACyB,yBAAyB,EAAE;UAC1CD,mBAAmB,IAAI,yCAAyC;QAClE;QAEA,OAAOlF,IAAI,CAAAoF,gBAAA,KAAAA,gBAAA,GAAAL,sBAAA,qYACU,IAAI,CAACrB,OAAO,CAAC2B,KAAK,EAGzB9E,QAAQ,CAAC;UACf,aAAa,EAAE4D;QACjB,CAAC,CAAC,EAGQ7D,SAAS,CAAC,IAAI,CAACoD,OAAO,CAAC2B,KAAK,CAAC,EAC/B,IAAI,CAAC3B,OAAO,CAACP,GAAG,EACX+B,mBAAmB;MAMxC;IAAC;MAAArD,IAAA;MAAAC,MAAA;MAAAC,GAAA;MAAAC,KAAA,EAED,SAAAsD,OAAA,EAAoC;QAClC,OAAOvF,GAAG,CAAAwF,gBAAA,KAAAA,gBAAA,GAAAR,sBAAA;MA4BZ;IAAC;EAAA;AAAA,GA3HgC9E,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}