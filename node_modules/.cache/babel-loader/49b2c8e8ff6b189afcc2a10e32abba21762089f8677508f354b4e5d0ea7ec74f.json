{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { createCollection } from \"home-assistant-js-websocket\";\nimport { debounce } from \"../common/util/debounce\";\nexport var severitySort = {\n  critical: 1,\n  error: 2,\n  warning: 3\n};\nexport var fetchRepairsIssues = function fetchRepairsIssues(conn) {\n  return conn.sendMessagePromise({\n    type: \"repairs/list_issues\"\n  });\n};\nexport var fetchRepairsIssueData = function fetchRepairsIssueData(conn, domain, issue_id) {\n  return conn.sendMessagePromise({\n    type: \"repairs/get_issue_data\",\n    domain: domain,\n    issue_id: issue_id\n  });\n};\nexport var ignoreRepairsIssue = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(hass, issue, ignore) {\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          return _context.abrupt(\"return\", hass.callWS({\n            type: \"repairs/ignore_issue\",\n            issue_id: issue.issue_id,\n            domain: issue.domain,\n            ignore: ignore\n          }));\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function ignoreRepairsIssue(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var createRepairsFlow = function createRepairsFlow(hass, handler, issue_id) {\n  return hass.callApi(\"POST\", \"repairs/issues/fix\", {\n    handler: handler,\n    issue_id: issue_id\n  });\n};\nexport var fetchRepairsFlow = function fetchRepairsFlow(hass, flowId) {\n  return hass.callApi(\"GET\", \"repairs/issues/fix/\".concat(flowId));\n};\nexport var handleRepairsFlowStep = function handleRepairsFlowStep(hass, flowId, data) {\n  return hass.callApi(\"POST\", \"repairs/issues/fix/\".concat(flowId), data);\n};\nexport var deleteRepairsFlow = function deleteRepairsFlow(hass, flowId) {\n  return hass.callApi(\"DELETE\", \"repairs/issues/fix/\".concat(flowId));\n};\nvar subscribeRepairsIssueUpdates = function subscribeRepairsIssueUpdates(conn, store) {\n  return conn.subscribeEvents(debounce(function () {\n    return fetchRepairsIssues(conn).then(function (repairs) {\n      return store.setState(repairs, true);\n    });\n  }, 500, true), \"repairs_issue_registry_updated\");\n};\nexport var subscribeRepairsIssueRegistry = function subscribeRepairsIssueRegistry(conn, onChange) {\n  return createCollection(\"_repairsIssueRegistry\", fetchRepairsIssues, subscribeRepairsIssueUpdates, conn, onChange);\n};","map":{"version":3,"names":["createCollection","debounce","severitySort","critical","error","warning","fetchRepairsIssues","conn","sendMessagePromise","type","fetchRepairsIssueData","domain","issue_id","ignoreRepairsIssue","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","hass","issue","ignore","wrap","_callee$","_context","prev","next","abrupt","callWS","stop","_x","_x2","_x3","apply","arguments","createRepairsFlow","handler","callApi","fetchRepairsFlow","flowId","concat","handleRepairsFlowStep","data","deleteRepairsFlow","subscribeRepairsIssueUpdates","store","subscribeEvents","then","repairs","setState","subscribeRepairsIssueRegistry","onChange"],"sources":["/Users/sercanardil/Desktop/frontend/src/data/repairs.ts"],"sourcesContent":["import type { Connection } from \"home-assistant-js-websocket\";\nimport { createCollection } from \"home-assistant-js-websocket\";\nimport type { Store } from \"home-assistant-js-websocket/dist/store\";\nimport { debounce } from \"../common/util/debounce\";\nimport type { HomeAssistant } from \"../types\";\nimport type { DataEntryFlowStep } from \"./data_entry_flow\";\n\nexport interface RepairsIssue {\n  domain: string;\n  issue_domain?: string;\n  issue_id: string;\n  active: boolean;\n  is_fixable: boolean;\n  severity: \"error\" | \"warning\" | \"critical\";\n  breaks_in_ha_version?: string;\n  ignored: boolean;\n  created: string;\n  dismissed_version?: string;\n  learn_more_url?: string;\n  translation_key?: string;\n  translation_placeholders?: Record<string, string>;\n}\n\nexport const severitySort = {\n  critical: 1,\n  error: 2,\n  warning: 3,\n};\n\nexport const fetchRepairsIssues = (conn: Connection) =>\n  conn.sendMessagePromise<{ issues: RepairsIssue[] }>({\n    type: \"repairs/list_issues\",\n  });\n\nexport const fetchRepairsIssueData = (conn: Connection, domain, issue_id) =>\n  conn.sendMessagePromise<{ issue_data: { string: any } }>({\n    type: \"repairs/get_issue_data\",\n    domain,\n    issue_id,\n  });\n\nexport const ignoreRepairsIssue = async (\n  hass: HomeAssistant,\n  issue: RepairsIssue,\n  ignore: boolean\n) =>\n  hass.callWS<string>({\n    type: \"repairs/ignore_issue\",\n    issue_id: issue.issue_id,\n    domain: issue.domain,\n    ignore,\n  });\n\nexport const createRepairsFlow = (\n  hass: HomeAssistant,\n  handler: string,\n  issue_id: string\n) =>\n  hass.callApi<DataEntryFlowStep>(\"POST\", \"repairs/issues/fix\", {\n    handler,\n    issue_id,\n  });\n\nexport const fetchRepairsFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi<DataEntryFlowStep>(\"GET\", `repairs/issues/fix/${flowId}`);\n\nexport const handleRepairsFlowStep = (\n  hass: HomeAssistant,\n  flowId: string,\n  data: Record<string, any>\n) =>\n  hass.callApi<DataEntryFlowStep>(\"POST\", `repairs/issues/fix/${flowId}`, data);\n\nexport const deleteRepairsFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi(\"DELETE\", `repairs/issues/fix/${flowId}`);\n\nconst subscribeRepairsIssueUpdates = (\n  conn: Connection,\n  store: Store<{ issues: RepairsIssue[] }>\n) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchRepairsIssues(conn).then((repairs) =>\n          store.setState(repairs, true)\n        ),\n      500,\n      true\n    ),\n    \"repairs_issue_registry_updated\"\n  );\n\nexport const subscribeRepairsIssueRegistry = (\n  conn: Connection,\n  onChange: (repairs: { issues: RepairsIssue[] }) => void\n) =>\n  createCollection<{ issues: RepairsIssue[] }>(\n    \"_repairsIssueRegistry\",\n    fetchRepairsIssues,\n    subscribeRepairsIssueUpdates,\n    conn,\n    onChange\n  );\n"],"mappings":";;AACA,SAASA,gBAAgB,QAAQ,6BAA6B;AAE9D,SAASC,QAAQ,QAAQ,yBAAyB;AAoBlD,OAAO,IAAMC,YAAY,GAAG;EAC1BC,QAAQ,EAAE,CAAC;EACXC,KAAK,EAAE,CAAC;EACRC,OAAO,EAAE;AACX,CAAC;AAED,OAAO,IAAMC,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAIC,IAAgB;EAAA,OACjDA,IAAI,CAACC,kBAAkB,CAA6B;IAClDC,IAAI,EAAE;EACR,CAAC,CAAC;AAAA;AAEJ,OAAO,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAqBA,CAAIH,IAAgB,EAAEI,MAAM,EAAEC,QAAQ;EAAA,OACtEL,IAAI,CAACC,kBAAkB,CAAkC;IACvDC,IAAI,EAAE,wBAAwB;IAC9BE,MAAM,EAANA,MAAM;IACNC,QAAQ,EAARA;EACF,CAAC,CAAC;AAAA;AAEJ,OAAO,IAAMC,kBAAkB;EAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAChCC,IAAmB,EACnBC,KAAmB,EACnBC,MAAe;IAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAAA,OAAAF,QAAA,CAAAG,MAAA,WAEfR,IAAI,CAACS,MAAM,CAAS;YAClBnB,IAAI,EAAE,sBAAsB;YAC5BG,QAAQ,EAAEQ,KAAK,CAACR,QAAQ;YACxBD,MAAM,EAAES,KAAK,CAACT,MAAM;YACpBU,MAAM,EAANA;UACF,CAAC,CAAC;QAAA;QAAA;UAAA,OAAAG,QAAA,CAAAK,IAAA;MAAA;IAAA,GAAAX,OAAA;EAAA;EAAA,gBAVSL,kBAAkBA,CAAAiB,EAAA,EAAAC,GAAA,EAAAC,GAAA;IAAA,OAAAlB,IAAA,CAAAmB,KAAA,OAAAC,SAAA;EAAA;AAAA,GAU3B;AAEJ,OAAO,IAAMC,iBAAiB,GAAG,SAApBA,iBAAiBA,CAC5BhB,IAAmB,EACnBiB,OAAe,EACfxB,QAAgB;EAAA,OAEhBO,IAAI,CAACkB,OAAO,CAAoB,MAAM,EAAE,oBAAoB,EAAE;IAC5DD,OAAO,EAAPA,OAAO;IACPxB,QAAQ,EAARA;EACF,CAAC,CAAC;AAAA;AAEJ,OAAO,IAAM0B,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAInB,IAAmB,EAAEoB,MAAc;EAAA,OAClEpB,IAAI,CAACkB,OAAO,CAAoB,KAAK,wBAAAG,MAAA,CAAwBD,MAAM,CAAE,CAAC;AAAA;AAExE,OAAO,IAAME,qBAAqB,GAAG,SAAxBA,qBAAqBA,CAChCtB,IAAmB,EACnBoB,MAAc,EACdG,IAAyB;EAAA,OAEzBvB,IAAI,CAACkB,OAAO,CAAoB,MAAM,wBAAAG,MAAA,CAAwBD,MAAM,GAAIG,IAAI,CAAC;AAAA;AAE/E,OAAO,IAAMC,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAIxB,IAAmB,EAAEoB,MAAc;EAAA,OACnEpB,IAAI,CAACkB,OAAO,CAAC,QAAQ,wBAAAG,MAAA,CAAwBD,MAAM,CAAE,CAAC;AAAA;AAExD,IAAMK,4BAA4B,GAAG,SAA/BA,4BAA4BA,CAChCrC,IAAgB,EAChBsC,KAAwC;EAAA,OAExCtC,IAAI,CAACuC,eAAe,CAClB7C,QAAQ,CACN;IAAA,OACEK,kBAAkB,CAACC,IAAI,CAAC,CAACwC,IAAI,CAAC,UAACC,OAAO;MAAA,OACpCH,KAAK,CAACI,QAAQ,CAACD,OAAO,EAAE,IAAI,CAAC;IAAA,CAC/B,CAAC;EAAA,GACH,GAAG,EACH,IACF,CAAC,EACD,gCACF,CAAC;AAAA;AAEH,OAAO,IAAME,6BAA6B,GAAG,SAAhCA,6BAA6BA,CACxC3C,IAAgB,EAChB4C,QAAuD;EAAA,OAEvDnD,gBAAgB,CACd,uBAAuB,EACvBM,kBAAkB,EAClBsC,4BAA4B,EAC5BrC,IAAI,EACJ4C,QACF,CAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}