{"ast":null,"code":"import { createCollection } from \"home-assistant-js-websocket\";\nimport { debounce } from \"../common/util/debounce\";\nexport var fetchDeviceRegistry = function fetchDeviceRegistry(conn) {\n  return conn.sendMessagePromise({\n    type: \"config/device_registry/list\"\n  });\n};\nvar subscribeDeviceRegistryUpdates = function subscribeDeviceRegistryUpdates(conn, store) {\n  return conn.subscribeEvents(debounce(function () {\n    return fetchDeviceRegistry(conn).then(function (devices) {\n      return store.setState(devices, true);\n    });\n  }, 500, true), \"device_registry_updated\");\n};\nexport var subscribeDeviceRegistry = function subscribeDeviceRegistry(conn, onChange) {\n  return createCollection(\"_dr\", fetchDeviceRegistry, subscribeDeviceRegistryUpdates, conn, onChange);\n};","map":{"version":3,"names":["createCollection","debounce","fetchDeviceRegistry","conn","sendMessagePromise","type","subscribeDeviceRegistryUpdates","store","subscribeEvents","then","devices","setState","subscribeDeviceRegistry","onChange"],"sources":["/workspaces/frontend/src/data/ws-device_registry.ts"],"sourcesContent":["import { Connection, createCollection } from \"home-assistant-js-websocket\";\nimport { Store } from \"home-assistant-js-websocket/dist/store\";\nimport { DeviceRegistryEntry } from \"./device_registry\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport const fetchDeviceRegistry = (conn: Connection) =>\n  conn.sendMessagePromise<DeviceRegistryEntry[]>({\n    type: \"config/device_registry/list\",\n  });\n\nconst subscribeDeviceRegistryUpdates = (\n  conn: Connection,\n  store: Store<DeviceRegistryEntry[]>\n) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchDeviceRegistry(conn).then((devices) =>\n          store.setState(devices, true)\n        ),\n      500,\n      true\n    ),\n    \"device_registry_updated\"\n  );\n\nexport const subscribeDeviceRegistry = (\n  conn: Connection,\n  onChange: (devices: DeviceRegistryEntry[]) => void\n) =>\n  createCollection<DeviceRegistryEntry[]>(\n    \"_dr\",\n    fetchDeviceRegistry,\n    subscribeDeviceRegistryUpdates,\n    conn,\n    onChange\n  );\n"],"mappings":"AAAA,SAAqBA,gBAAgB,QAAQ,6BAA6B;AAG1E,SAASC,QAAQ,QAAQ,yBAAyB;AAElD,OAAO,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAIC,IAAgB;EAAA,OAClDA,IAAI,CAACC,kBAAkB,CAAwB;IAC7CC,IAAI,EAAE;EACR,CAAC,CAAC;AAAA;AAEJ,IAAMC,8BAA8B,GAAG,SAAjCA,8BAA8BA,CAClCH,IAAgB,EAChBI,KAAmC;EAAA,OAEnCJ,IAAI,CAACK,eAAe,CAClBP,QAAQ,CACN;IAAA,OACEC,mBAAmB,CAACC,IAAI,CAAC,CAACM,IAAI,CAAC,UAACC,OAAO;MAAA,OACrCH,KAAK,CAACI,QAAQ,CAACD,OAAO,EAAE,IAAI,CAAC;IAAA,CAC/B,CAAC;EAAA,GACH,GAAG,EACH,IACF,CAAC,EACD,yBACF,CAAC;AAAA;AAEH,OAAO,IAAME,uBAAuB,GAAG,SAA1BA,uBAAuBA,CAClCT,IAAgB,EAChBU,QAAkD;EAAA,OAElDb,gBAAgB,CACd,KAAK,EACLE,mBAAmB,EACnBI,8BAA8B,EAC9BH,IAAI,EACJU,QACF,CAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}