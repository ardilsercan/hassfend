{"ast":null,"code":"/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { __assign, __extends, __values } from \"tslib\";\nimport { MDCFoundation } from '@material/base/foundation';\nimport { Corner, CornerBit, cssClasses, numbers, strings } from './constants';\nvar MDCMenuSurfaceFoundation = /** @class */function (_super) {\n  __extends(MDCMenuSurfaceFoundation, _super);\n  function MDCMenuSurfaceFoundation(adapter) {\n    var _this = _super.call(this, __assign(__assign({}, MDCMenuSurfaceFoundation.defaultAdapter), adapter)) || this;\n    _this.isSurfaceOpen = false;\n    _this.isQuickOpen = false;\n    _this.isHoistedElement = false;\n    _this.isFixedPosition = false;\n    _this.isHorizontallyCenteredOnViewport = false;\n    _this.maxHeight = 0;\n    _this.openBottomBias = 0;\n    _this.openAnimationEndTimerId = 0;\n    _this.closeAnimationEndTimerId = 0;\n    _this.animationRequestId = 0;\n    _this.anchorCorner = Corner.TOP_START;\n    /**\n     * Corner of the menu surface to which menu surface is attached to anchor.\n     *\n     *  Anchor corner --->+----------+\n     *                    |  ANCHOR  |\n     *                    +----------+\n     *  Origin corner --->+--------------+\n     *                    |              |\n     *                    |              |\n     *                    | MENU SURFACE |\n     *                    |              |\n     *                    |              |\n     *                    +--------------+\n     */\n    _this.originCorner = Corner.TOP_START;\n    _this.anchorMargin = {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0\n    };\n    _this.position = {\n      x: 0,\n      y: 0\n    };\n    return _this;\n  }\n  Object.defineProperty(MDCMenuSurfaceFoundation, \"cssClasses\", {\n    get: function () {\n      return cssClasses;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(MDCMenuSurfaceFoundation, \"strings\", {\n    get: function () {\n      return strings;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(MDCMenuSurfaceFoundation, \"numbers\", {\n    get: function () {\n      return numbers;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(MDCMenuSurfaceFoundation, \"Corner\", {\n    get: function () {\n      return Corner;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(MDCMenuSurfaceFoundation, \"defaultAdapter\", {\n    /**\n     * @see {@link MDCMenuSurfaceAdapter} for typing information on parameters and return types.\n     */\n    get: function () {\n      // tslint:disable:object-literal-sort-keys Methods should be in the same order as the adapter interface.\n      return {\n        addClass: function () {\n          return undefined;\n        },\n        removeClass: function () {\n          return undefined;\n        },\n        hasClass: function () {\n          return false;\n        },\n        hasAnchor: function () {\n          return false;\n        },\n        isElementInContainer: function () {\n          return false;\n        },\n        isFocused: function () {\n          return false;\n        },\n        isRtl: function () {\n          return false;\n        },\n        getInnerDimensions: function () {\n          return {\n            height: 0,\n            width: 0\n          };\n        },\n        getAnchorDimensions: function () {\n          return null;\n        },\n        getWindowDimensions: function () {\n          return {\n            height: 0,\n            width: 0\n          };\n        },\n        getBodyDimensions: function () {\n          return {\n            height: 0,\n            width: 0\n          };\n        },\n        getWindowScroll: function () {\n          return {\n            x: 0,\n            y: 0\n          };\n        },\n        setPosition: function () {\n          return undefined;\n        },\n        setMaxHeight: function () {\n          return undefined;\n        },\n        setTransformOrigin: function () {\n          return undefined;\n        },\n        saveFocus: function () {\n          return undefined;\n        },\n        restoreFocus: function () {\n          return undefined;\n        },\n        notifyClose: function () {\n          return undefined;\n        },\n        notifyClosing: function () {\n          return undefined;\n        },\n        notifyOpen: function () {\n          return undefined;\n        },\n        notifyOpening: function () {\n          return undefined;\n        }\n      };\n      // tslint:enable:object-literal-sort-keys\n    },\n    enumerable: false,\n    configurable: true\n  });\n  MDCMenuSurfaceFoundation.prototype.init = function () {\n    var _a = MDCMenuSurfaceFoundation.cssClasses,\n      ROOT = _a.ROOT,\n      OPEN = _a.OPEN;\n    if (!this.adapter.hasClass(ROOT)) {\n      throw new Error(ROOT + \" class required in root element.\");\n    }\n    if (this.adapter.hasClass(OPEN)) {\n      this.isSurfaceOpen = true;\n    }\n  };\n  MDCMenuSurfaceFoundation.prototype.destroy = function () {\n    clearTimeout(this.openAnimationEndTimerId);\n    clearTimeout(this.closeAnimationEndTimerId);\n    // Cancel any currently running animations.\n    cancelAnimationFrame(this.animationRequestId);\n  };\n  /**\n   * @param corner Default anchor corner alignment of top-left menu surface\n   *     corner.\n   */\n  MDCMenuSurfaceFoundation.prototype.setAnchorCorner = function (corner) {\n    this.anchorCorner = corner;\n  };\n  /**\n   * Flip menu corner horizontally.\n   */\n  MDCMenuSurfaceFoundation.prototype.flipCornerHorizontally = function () {\n    this.originCorner = this.originCorner ^ CornerBit.RIGHT;\n  };\n  /**\n   * @param margin Set of margin values from anchor.\n   */\n  MDCMenuSurfaceFoundation.prototype.setAnchorMargin = function (margin) {\n    this.anchorMargin.top = margin.top || 0;\n    this.anchorMargin.right = margin.right || 0;\n    this.anchorMargin.bottom = margin.bottom || 0;\n    this.anchorMargin.left = margin.left || 0;\n  };\n  /** Used to indicate if the menu-surface is hoisted to the body. */\n  MDCMenuSurfaceFoundation.prototype.setIsHoisted = function (isHoisted) {\n    this.isHoistedElement = isHoisted;\n  };\n  /**\n   * Used to set the menu-surface calculations based on a fixed position menu.\n   */\n  MDCMenuSurfaceFoundation.prototype.setFixedPosition = function (isFixedPosition) {\n    this.isFixedPosition = isFixedPosition;\n  };\n  /**\n   * @return Returns true if menu is in fixed (`position: fixed`) position.\n   */\n  MDCMenuSurfaceFoundation.prototype.isFixed = function () {\n    return this.isFixedPosition;\n  };\n  /** Sets the menu-surface position on the page. */\n  MDCMenuSurfaceFoundation.prototype.setAbsolutePosition = function (x, y) {\n    this.position.x = this.isFinite(x) ? x : 0;\n    this.position.y = this.isFinite(y) ? y : 0;\n  };\n  /** Sets whether menu-surface should be horizontally centered to viewport. */\n  MDCMenuSurfaceFoundation.prototype.setIsHorizontallyCenteredOnViewport = function (isCentered) {\n    this.isHorizontallyCenteredOnViewport = isCentered;\n  };\n  MDCMenuSurfaceFoundation.prototype.setQuickOpen = function (quickOpen) {\n    this.isQuickOpen = quickOpen;\n  };\n  /**\n   * Sets maximum menu-surface height on open.\n   * @param maxHeight The desired max-height. Set to 0 (default) to\n   *     automatically calculate max height based on available viewport space.\n   */\n  MDCMenuSurfaceFoundation.prototype.setMaxHeight = function (maxHeight) {\n    this.maxHeight = maxHeight;\n  };\n  /**\n   * Set to a positive integer to influence the menu to preferentially open\n   * below the anchor instead of above.\n   * @param bias A value of `x` simulates an extra `x` pixels of available space\n   *     below the menu during positioning calculations.\n   */\n  MDCMenuSurfaceFoundation.prototype.setOpenBottomBias = function (bias) {\n    this.openBottomBias = bias;\n  };\n  MDCMenuSurfaceFoundation.prototype.isOpen = function () {\n    return this.isSurfaceOpen;\n  };\n  /**\n   * Open the menu surface.\n   */\n  MDCMenuSurfaceFoundation.prototype.open = function () {\n    var _this = this;\n    if (this.isSurfaceOpen) {\n      return;\n    }\n    this.adapter.notifyOpening();\n    this.adapter.saveFocus();\n    if (this.isQuickOpen) {\n      this.isSurfaceOpen = true;\n      this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.OPEN);\n      this.dimensions = this.adapter.getInnerDimensions();\n      this.autoposition();\n      this.adapter.notifyOpen();\n    } else {\n      this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.ANIMATING_OPEN);\n      this.animationRequestId = requestAnimationFrame(function () {\n        _this.dimensions = _this.adapter.getInnerDimensions();\n        _this.autoposition();\n        _this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.OPEN);\n        _this.openAnimationEndTimerId = setTimeout(function () {\n          _this.openAnimationEndTimerId = 0;\n          _this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.ANIMATING_OPEN);\n          _this.adapter.notifyOpen();\n        }, numbers.TRANSITION_OPEN_DURATION);\n      });\n      this.isSurfaceOpen = true;\n    }\n  };\n  /**\n   * Closes the menu surface.\n   */\n  MDCMenuSurfaceFoundation.prototype.close = function (skipRestoreFocus) {\n    var _this = this;\n    if (skipRestoreFocus === void 0) {\n      skipRestoreFocus = false;\n    }\n    if (!this.isSurfaceOpen) {\n      return;\n    }\n    this.adapter.notifyClosing();\n    if (this.isQuickOpen) {\n      this.isSurfaceOpen = false;\n      if (!skipRestoreFocus) {\n        this.maybeRestoreFocus();\n      }\n      this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.OPEN);\n      this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.IS_OPEN_BELOW);\n      this.adapter.notifyClose();\n      return;\n    }\n    this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.ANIMATING_CLOSED);\n    requestAnimationFrame(function () {\n      _this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.OPEN);\n      _this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.IS_OPEN_BELOW);\n      _this.closeAnimationEndTimerId = setTimeout(function () {\n        _this.closeAnimationEndTimerId = 0;\n        _this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.ANIMATING_CLOSED);\n        _this.adapter.notifyClose();\n      }, numbers.TRANSITION_CLOSE_DURATION);\n    });\n    this.isSurfaceOpen = false;\n    if (!skipRestoreFocus) {\n      this.maybeRestoreFocus();\n    }\n  };\n  /** Handle clicks and close if not within menu-surface element. */\n  MDCMenuSurfaceFoundation.prototype.handleBodyClick = function (evt) {\n    var el = evt.target;\n    if (this.adapter.isElementInContainer(el)) {\n      return;\n    }\n    this.close();\n  };\n  /** Handle keys that close the surface. */\n  MDCMenuSurfaceFoundation.prototype.handleKeydown = function (evt) {\n    var keyCode = evt.keyCode,\n      key = evt.key;\n    var isEscape = key === 'Escape' || keyCode === 27;\n    if (isEscape) {\n      this.close();\n    }\n  };\n  MDCMenuSurfaceFoundation.prototype.autoposition = function () {\n    var _a;\n    // Compute measurements for autoposition methods reuse.\n    this.measurements = this.getAutoLayoutmeasurements();\n    var corner = this.getoriginCorner();\n    var maxMenuSurfaceHeight = this.getMenuSurfaceMaxHeight(corner);\n    var verticalAlignment = this.hasBit(corner, CornerBit.BOTTOM) ? 'bottom' : 'top';\n    var horizontalAlignment = this.hasBit(corner, CornerBit.RIGHT) ? 'right' : 'left';\n    var horizontalOffset = this.getHorizontalOriginOffset(corner);\n    var verticalOffset = this.getVerticalOriginOffset(corner);\n    var _b = this.measurements,\n      anchorSize = _b.anchorSize,\n      surfaceSize = _b.surfaceSize;\n    var position = (_a = {}, _a[horizontalAlignment] = horizontalOffset, _a[verticalAlignment] = verticalOffset, _a);\n    // Center align when anchor width is comparable or greater than menu\n    // surface, otherwise keep corner.\n    if (anchorSize.width / surfaceSize.width > numbers.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO) {\n      horizontalAlignment = 'center';\n    }\n    // If the menu-surface has been hoisted to the body, it's no longer relative\n    // to the anchor element\n    if (this.isHoistedElement || this.isFixedPosition) {\n      this.adjustPositionForHoistedElement(position);\n    }\n    this.adapter.setTransformOrigin(horizontalAlignment + \" \" + verticalAlignment);\n    this.adapter.setPosition(position);\n    this.adapter.setMaxHeight(maxMenuSurfaceHeight ? maxMenuSurfaceHeight + 'px' : '');\n    // If it is opened from the top then add is-open-below class\n    if (!this.hasBit(corner, CornerBit.BOTTOM)) {\n      this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.IS_OPEN_BELOW);\n    }\n  };\n  /**\n   * @return Measurements used to position menu surface popup.\n   */\n  MDCMenuSurfaceFoundation.prototype.getAutoLayoutmeasurements = function () {\n    var anchorRect = this.adapter.getAnchorDimensions();\n    var bodySize = this.adapter.getBodyDimensions();\n    var viewportSize = this.adapter.getWindowDimensions();\n    var windowScroll = this.adapter.getWindowScroll();\n    if (!anchorRect) {\n      // tslint:disable:object-literal-sort-keys Positional properties are more readable when they're grouped together\n      anchorRect = {\n        top: this.position.y,\n        right: this.position.x,\n        bottom: this.position.y,\n        left: this.position.x,\n        width: 0,\n        height: 0\n      };\n      // tslint:enable:object-literal-sort-keys\n    }\n    return {\n      anchorSize: anchorRect,\n      bodySize: bodySize,\n      surfaceSize: this.dimensions,\n      viewportDistance: {\n        // tslint:disable:object-literal-sort-keys Positional properties are more readable when they're grouped together\n        top: anchorRect.top,\n        right: viewportSize.width - anchorRect.right,\n        bottom: viewportSize.height - anchorRect.bottom,\n        left: anchorRect.left\n        // tslint:enable:object-literal-sort-keys\n      },\n      viewportSize: viewportSize,\n      windowScroll: windowScroll\n    };\n  };\n  /**\n   * Computes the corner of the anchor from which to animate and position the\n   * menu surface.\n   *\n   * Only LEFT or RIGHT bit is used to position the menu surface ignoring RTL\n   * context. E.g., menu surface will be positioned from right side on TOP_END.\n   */\n  MDCMenuSurfaceFoundation.prototype.getoriginCorner = function () {\n    var corner = this.originCorner;\n    var _a = this.measurements,\n      viewportDistance = _a.viewportDistance,\n      anchorSize = _a.anchorSize,\n      surfaceSize = _a.surfaceSize;\n    var MARGIN_TO_EDGE = MDCMenuSurfaceFoundation.numbers.MARGIN_TO_EDGE;\n    var isAnchoredToBottom = this.hasBit(this.anchorCorner, CornerBit.BOTTOM);\n    var availableTop;\n    var availableBottom;\n    if (isAnchoredToBottom) {\n      availableTop = viewportDistance.top - MARGIN_TO_EDGE + this.anchorMargin.bottom;\n      availableBottom = viewportDistance.bottom - MARGIN_TO_EDGE - this.anchorMargin.bottom;\n    } else {\n      availableTop = viewportDistance.top - MARGIN_TO_EDGE + this.anchorMargin.top;\n      availableBottom = viewportDistance.bottom - MARGIN_TO_EDGE + anchorSize.height - this.anchorMargin.top;\n    }\n    var isAvailableBottom = availableBottom - surfaceSize.height > 0;\n    if (!isAvailableBottom && availableTop > availableBottom + this.openBottomBias) {\n      // Attach bottom side of surface to the anchor.\n      corner = this.setBit(corner, CornerBit.BOTTOM);\n    }\n    var isRtl = this.adapter.isRtl();\n    var isFlipRtl = this.hasBit(this.anchorCorner, CornerBit.FLIP_RTL);\n    var hasRightBit = this.hasBit(this.anchorCorner, CornerBit.RIGHT) || this.hasBit(corner, CornerBit.RIGHT);\n    // Whether surface attached to right side of anchor element.\n    var isAnchoredToRight = false;\n    // Anchored to start\n    if (isRtl && isFlipRtl) {\n      isAnchoredToRight = !hasRightBit;\n    } else {\n      // Anchored to right\n      isAnchoredToRight = hasRightBit;\n    }\n    var availableLeft;\n    var availableRight;\n    if (isAnchoredToRight) {\n      availableLeft = viewportDistance.left + anchorSize.width + this.anchorMargin.right;\n      availableRight = viewportDistance.right - this.anchorMargin.right;\n    } else {\n      availableLeft = viewportDistance.left + this.anchorMargin.left;\n      availableRight = viewportDistance.right + anchorSize.width - this.anchorMargin.left;\n    }\n    var isAvailableLeft = availableLeft - surfaceSize.width > 0;\n    var isAvailableRight = availableRight - surfaceSize.width > 0;\n    var isOriginCornerAlignedToEnd = this.hasBit(corner, CornerBit.FLIP_RTL) && this.hasBit(corner, CornerBit.RIGHT);\n    if (isAvailableRight && isOriginCornerAlignedToEnd && isRtl || !isAvailableLeft && isOriginCornerAlignedToEnd) {\n      // Attach left side of surface to the anchor.\n      corner = this.unsetBit(corner, CornerBit.RIGHT);\n    } else if (isAvailableLeft && isAnchoredToRight && isRtl || isAvailableLeft && !isAnchoredToRight && hasRightBit || !isAvailableRight && availableLeft >= availableRight) {\n      // Attach right side of surface to the anchor.\n      corner = this.setBit(corner, CornerBit.RIGHT);\n    }\n    return corner;\n  };\n  /**\n   * @param corner Origin corner of the menu surface.\n   * @return Maximum height of the menu surface, based on available space. 0\n   *     indicates should not be set.\n   */\n  MDCMenuSurfaceFoundation.prototype.getMenuSurfaceMaxHeight = function (corner) {\n    if (this.maxHeight > 0) {\n      return this.maxHeight;\n    }\n    var viewportDistance = this.measurements.viewportDistance;\n    var maxHeight = 0;\n    var isBottomAligned = this.hasBit(corner, CornerBit.BOTTOM);\n    var isBottomAnchored = this.hasBit(this.anchorCorner, CornerBit.BOTTOM);\n    var MARGIN_TO_EDGE = MDCMenuSurfaceFoundation.numbers.MARGIN_TO_EDGE;\n    // When maximum height is not specified, it is handled from CSS.\n    if (isBottomAligned) {\n      maxHeight = viewportDistance.top + this.anchorMargin.top - MARGIN_TO_EDGE;\n      if (!isBottomAnchored) {\n        maxHeight += this.measurements.anchorSize.height;\n      }\n    } else {\n      maxHeight = viewportDistance.bottom - this.anchorMargin.bottom + this.measurements.anchorSize.height - MARGIN_TO_EDGE;\n      if (isBottomAnchored) {\n        maxHeight -= this.measurements.anchorSize.height;\n      }\n    }\n    return maxHeight;\n  };\n  /**\n   * @param corner Origin corner of the menu surface.\n   * @return Horizontal offset of menu surface origin corner from corresponding\n   *     anchor corner.\n   */\n  MDCMenuSurfaceFoundation.prototype.getHorizontalOriginOffset = function (corner) {\n    var anchorSize = this.measurements.anchorSize;\n    // isRightAligned corresponds to using the 'right' property on the surface.\n    var isRightAligned = this.hasBit(corner, CornerBit.RIGHT);\n    var avoidHorizontalOverlap = this.hasBit(this.anchorCorner, CornerBit.RIGHT);\n    if (isRightAligned) {\n      var rightOffset = avoidHorizontalOverlap ? anchorSize.width - this.anchorMargin.left : this.anchorMargin.right;\n      // For hoisted or fixed elements, adjust the offset by the difference\n      // between viewport width and body width so when we calculate the right\n      // value (`adjustPositionForHoistedElement`) based on the element\n      // position, the right property is correct.\n      if (this.isHoistedElement || this.isFixedPosition) {\n        return rightOffset - (this.measurements.viewportSize.width - this.measurements.bodySize.width);\n      }\n      return rightOffset;\n    }\n    return avoidHorizontalOverlap ? anchorSize.width - this.anchorMargin.right : this.anchorMargin.left;\n  };\n  /**\n   * @param corner Origin corner of the menu surface.\n   * @return Vertical offset of menu surface origin corner from corresponding\n   *     anchor corner.\n   */\n  MDCMenuSurfaceFoundation.prototype.getVerticalOriginOffset = function (corner) {\n    var anchorSize = this.measurements.anchorSize;\n    var isBottomAligned = this.hasBit(corner, CornerBit.BOTTOM);\n    var avoidVerticalOverlap = this.hasBit(this.anchorCorner, CornerBit.BOTTOM);\n    var y = 0;\n    if (isBottomAligned) {\n      y = avoidVerticalOverlap ? anchorSize.height - this.anchorMargin.top : -this.anchorMargin.bottom;\n    } else {\n      y = avoidVerticalOverlap ? anchorSize.height + this.anchorMargin.bottom : this.anchorMargin.top;\n    }\n    return y;\n  };\n  /**\n   * Calculates the offsets for positioning the menu-surface when the\n   * menu-surface has been hoisted to the body.\n   */\n  MDCMenuSurfaceFoundation.prototype.adjustPositionForHoistedElement = function (position) {\n    var e_1, _a;\n    var _b = this.measurements,\n      windowScroll = _b.windowScroll,\n      viewportDistance = _b.viewportDistance,\n      surfaceSize = _b.surfaceSize,\n      viewportSize = _b.viewportSize;\n    var props = Object.keys(position);\n    try {\n      for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        var value = position[prop] || 0;\n        if (this.isHorizontallyCenteredOnViewport && (prop === 'left' || prop === 'right')) {\n          position[prop] = (viewportSize.width - surfaceSize.width) / 2;\n          continue;\n        }\n        // Hoisted surfaces need to have the anchor elements location on the page\n        // added to the position properties for proper alignment on the body.\n        value += viewportDistance[prop];\n        // Surfaces that are absolutely positioned need to have additional\n        // calculations for scroll and bottom positioning.\n        if (!this.isFixedPosition) {\n          if (prop === 'top') {\n            value += windowScroll.y;\n          } else if (prop === 'bottom') {\n            value -= windowScroll.y;\n          } else if (prop === 'left') {\n            value += windowScroll.x;\n          } else {\n            // prop === 'right'\n            value -= windowScroll.x;\n          }\n        }\n        position[prop] = value;\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n  /**\n   * The last focused element when the menu surface was opened should regain\n   * focus, if the user is focused on or within the menu surface when it is\n   * closed.\n   */\n  MDCMenuSurfaceFoundation.prototype.maybeRestoreFocus = function () {\n    var _this = this;\n    var isRootFocused = this.adapter.isFocused();\n    var ownerDocument = this.adapter.getOwnerDocument ? this.adapter.getOwnerDocument() : document;\n    var childHasFocus = ownerDocument.activeElement && this.adapter.isElementInContainer(ownerDocument.activeElement);\n    if (isRootFocused || childHasFocus) {\n      // Wait before restoring focus when closing the menu surface. This is\n      // important because if a touch event triggered the menu close, and the\n      // subsequent mouse event occurs after focus is restored, then the\n      // restored focus would be lost.\n      setTimeout(function () {\n        _this.adapter.restoreFocus();\n      }, numbers.TOUCH_EVENT_WAIT_MS);\n    }\n  };\n  MDCMenuSurfaceFoundation.prototype.hasBit = function (corner, bit) {\n    return Boolean(corner & bit); // tslint:disable-line:no-bitwise\n  };\n  MDCMenuSurfaceFoundation.prototype.setBit = function (corner, bit) {\n    return corner | bit; // tslint:disable-line:no-bitwise\n  };\n  MDCMenuSurfaceFoundation.prototype.unsetBit = function (corner, bit) {\n    return corner ^ bit;\n  };\n  /**\n   * isFinite that doesn't force conversion to number type.\n   * Equivalent to Number.isFinite in ES2015, which is not supported in IE.\n   */\n  MDCMenuSurfaceFoundation.prototype.isFinite = function (num) {\n    return typeof num === 'number' && isFinite(num);\n  };\n  return MDCMenuSurfaceFoundation;\n}(MDCFoundation);\nexport { MDCMenuSurfaceFoundation };\n// tslint:disable-next-line:no-default-export Needed for backward compatibility with MDC Web v0.44.0 and earlier.\nexport default MDCMenuSurfaceFoundation;","map":{"version":3,"names":["MDCFoundation","Corner","CornerBit","cssClasses","numbers","strings","MDCMenuSurfaceFoundation","_super","__extends","adapter","_this","call","__assign","defaultAdapter","isSurfaceOpen","isQuickOpen","isHoistedElement","isFixedPosition","isHorizontallyCenteredOnViewport","maxHeight","openBottomBias","openAnimationEndTimerId","closeAnimationEndTimerId","animationRequestId","anchorCorner","TOP_START","originCorner","anchorMargin","top","right","bottom","left","position","x","y","Object","defineProperty","get","addClass","undefined","removeClass","hasClass","hasAnchor","isElementInContainer","isFocused","isRtl","getInnerDimensions","height","width","getAnchorDimensions","getWindowDimensions","getBodyDimensions","getWindowScroll","setPosition","setMaxHeight","setTransformOrigin","saveFocus","restoreFocus","notifyClose","notifyClosing","notifyOpen","notifyOpening","prototype","init","_a","ROOT","OPEN","Error","destroy","clearTimeout","cancelAnimationFrame","setAnchorCorner","corner","flipCornerHorizontally","RIGHT","setAnchorMargin","margin","setIsHoisted","isHoisted","setFixedPosition","isFixed","setAbsolutePosition","isFinite","setIsHorizontallyCenteredOnViewport","isCentered","setQuickOpen","quickOpen","setOpenBottomBias","bias","isOpen","open","dimensions","autoposition","ANIMATING_OPEN","requestAnimationFrame","setTimeout","TRANSITION_OPEN_DURATION","close","skipRestoreFocus","maybeRestoreFocus","IS_OPEN_BELOW","ANIMATING_CLOSED","TRANSITION_CLOSE_DURATION","handleBodyClick","evt","el","target","handleKeydown","keyCode","key","isEscape","measurements","getAutoLayoutmeasurements","getoriginCorner","maxMenuSurfaceHeight","getMenuSurfaceMaxHeight","verticalAlignment","hasBit","BOTTOM","horizontalAlignment","horizontalOffset","getHorizontalOriginOffset","verticalOffset","getVerticalOriginOffset","_b","anchorSize","surfaceSize","ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO","adjustPositionForHoistedElement","anchorRect","bodySize","viewportSize","windowScroll","viewportDistance","MARGIN_TO_EDGE","isAnchoredToBottom","availableTop","availableBottom","isAvailableBottom","setBit","isFlipRtl","FLIP_RTL","hasRightBit","isAnchoredToRight","availableLeft","availableRight","isAvailableLeft","isAvailableRight","isOriginCornerAlignedToEnd","unsetBit","isBottomAligned","isBottomAnchored","isRightAligned","avoidHorizontalOverlap","rightOffset","avoidVerticalOverlap","props","keys","props_1","__values","props_1_1","next","done","prop","value","isRootFocused","ownerDocument","getOwnerDocument","document","childHasFocus","activeElement","TOUCH_EVENT_WAIT_MS","bit","Boolean","num"],"sources":["foundation.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}