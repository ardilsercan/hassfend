{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport { LitElement, html } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { subscribePreviewTimeDate } from \"../../../data/time_date\";\nimport \"./entity-preview-row\";\nimport { debounce } from \"../../../common/util/debounce\";\nlet FlowPreviewTimeDate = _decorate([customElement(\"flow-preview-time_date\")], function (_initialize, _LitElement) {\n  class FlowPreviewTimeDate extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: FlowPreviewTimeDate,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"flowType\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"handler\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"stepId\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"flowId\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"stepData\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_preview\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_unsub\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"disconnectedCallback\",\n      value: function disconnectedCallback() {\n        _get(_getPrototypeOf(FlowPreviewTimeDate.prototype), \"disconnectedCallback\", this).call(this);\n        if (this._unsub) {\n          this._unsub.then(unsub => unsub());\n          this._unsub = undefined;\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        if (changedProps.has(\"stepData\")) {\n          this._debouncedSubscribePreview();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        return html`<entity-preview-row\n      .hass=${this.hass}\n      .stateObj=${this._preview}\n    ></entity-preview-row>`;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_setPreview\",\n      value() {\n        return preview => {\n          const now = new Date().toISOString();\n          this._preview = {\n            entity_id: `${this.stepId}.___flow_preview___`,\n            last_changed: now,\n            last_updated: now,\n            context: {\n              id: \"\",\n              parent_id: null,\n              user_id: null\n            },\n            ...preview\n          };\n        };\n      }\n    }, {\n      kind: \"field\",\n      key: \"_debouncedSubscribePreview\",\n      value() {\n        return debounce(() => {\n          this._subscribePreview();\n        }, 250);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_subscribePreview\",\n      value: async function _subscribePreview() {\n        if (this._unsub) {\n          (await this._unsub)();\n          this._unsub = undefined;\n        }\n        if (this.flowType === \"repair_flow\") {\n          return;\n        }\n        try {\n          this._unsub = subscribePreviewTimeDate(this.hass, this.flowId, this.flowType, this.stepData, this._setPreview);\n          await this._unsub;\n        } catch (err) {\n          this._preview = undefined;\n        }\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["LitElement","html","customElement","property","state","subscribePreviewTimeDate","debounce","FlowPreviewTimeDate","_decorate","_initialize","_LitElement","constructor","args","F","d","kind","decorators","attribute","key","value","disconnectedCallback","_get","_getPrototypeOf","prototype","call","_unsub","then","unsub","undefined","willUpdate","changedProps","has","_debouncedSubscribePreview","render","hass","_preview","preview","now","Date","toISOString","entity_id","stepId","last_changed","last_updated","context","id","parent_id","user_id","_subscribePreview","flowType","flowId","stepData","_setPreview","err"],"sources":["/Users/sercanardil/Desktop/frontend/src/dialogs/config-flow/previews/flow-preview-time_date.ts"],"sourcesContent":["import { HassEntity, UnsubscribeFunc } from \"home-assistant-js-websocket\";\nimport { LitElement, html } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { FlowType } from \"../../../data/data_entry_flow\";\nimport {\n  TimeDatePreview,\n  subscribePreviewTimeDate,\n} from \"../../../data/time_date\";\nimport { HomeAssistant } from \"../../../types\";\nimport \"./entity-preview-row\";\nimport { debounce } from \"../../../common/util/debounce\";\n\n@customElement(\"flow-preview-time_date\")\nclass FlowPreviewTimeDate extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public flowType!: FlowType;\n\n  public handler!: string;\n\n  @property() public stepId!: string;\n\n  @property() public flowId!: string;\n\n  @property() public stepData!: Record<string, any>;\n\n  @state() private _preview?: HassEntity;\n\n  private _unsub?: Promise<UnsubscribeFunc>;\n\n  disconnectedCallback(): void {\n    super.disconnectedCallback();\n    if (this._unsub) {\n      this._unsub.then((unsub) => unsub());\n      this._unsub = undefined;\n    }\n  }\n\n  willUpdate(changedProps) {\n    if (changedProps.has(\"stepData\")) {\n      this._debouncedSubscribePreview();\n    }\n  }\n\n  protected render() {\n    return html`<entity-preview-row\n      .hass=${this.hass}\n      .stateObj=${this._preview}\n    ></entity-preview-row>`;\n  }\n\n  private _setPreview = (preview: TimeDatePreview) => {\n    const now = new Date().toISOString();\n    this._preview = {\n      entity_id: `${this.stepId}.___flow_preview___`,\n      last_changed: now,\n      last_updated: now,\n      context: { id: \"\", parent_id: null, user_id: null },\n      ...preview,\n    };\n  };\n\n  private _debouncedSubscribePreview = debounce(() => {\n    this._subscribePreview();\n  }, 250);\n\n  private async _subscribePreview() {\n    if (this._unsub) {\n      (await this._unsub)();\n      this._unsub = undefined;\n    }\n    if (this.flowType === \"repair_flow\") {\n      return;\n    }\n    try {\n      this._unsub = subscribePreviewTimeDate(\n        this.hass,\n        this.flowId,\n        this.flowType,\n        this.stepData,\n        this._setPreview\n      );\n      await this._unsub;\n    } catch (err) {\n      this._preview = undefined;\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"flow-preview-time_date\": FlowPreviewTimeDate;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}