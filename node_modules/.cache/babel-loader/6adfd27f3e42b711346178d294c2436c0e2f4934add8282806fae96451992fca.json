{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9;\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.trim.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.some.js\";\nvar mdiAlertCircle = \"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { isComponentLoaded } from \"../../../common/config/is_component_loaded\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { generateFilter, isEmptyFilter } from \"../../../common/entity/entity_filter\";\nimport \"../../../components/ha-aliases-editor\";\nimport \"../../../components/ha-settings-row\";\nimport \"../../../components/ha-switch\";\nimport { fetchCloudAlexaEntity } from \"../../../data/alexa\";\nimport { fetchCloudStatus, updateCloudGoogleEntityConfig } from \"../../../data/cloud\";\nimport { getExtendedEntityRegistryEntry, updateEntityRegistryEntry } from \"../../../data/entity_registry\";\nimport { fetchCloudGoogleEntity } from \"../../../data/google_assistant\";\nimport { exposeEntities, voiceAssistants } from \"../../../data/expose\";\nimport { SubscribeMixin } from \"../../../mixins/subscribe-mixin\";\nimport { haStyle } from \"../../../resources/styles\";\nimport { brandsUrl } from \"../../../util/brands-url\";\nimport { documentationUrl } from \"../../../util/documentation-url\";\nexport var EntityVoiceSettings = _decorate([customElement(\"entity-voice-settings\")], function (_initialize, _SubscribeMixin) {\n  var EntityVoiceSettings = /*#__PURE__*/function (_SubscribeMixin2) {\n    _inherits(EntityVoiceSettings, _SubscribeMixin2);\n    function EntityVoiceSettings() {\n      var _this;\n      _classCallCheck(this, EntityVoiceSettings);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, EntityVoiceSettings, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(EntityVoiceSettings);\n  }(_SubscribeMixin);\n  return {\n    F: EntityVoiceSettings,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"entityId\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"exposed\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"entry\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_cloudStatus\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_aliases\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_googleEntity\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_unsupported\",\n      value: function value() {\n        return {};\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        var _this2 = this;\n        if (!isComponentLoaded(this.hass, \"cloud\")) {\n          return;\n        }\n        if (changedProps.has(\"entityId\") && this.entityId) {\n          this._fetchEntities();\n        }\n        if (!this.hasUpdated) {\n          fetchCloudStatus(this.hass).then(function (status) {\n            _this2._cloudStatus = status;\n          });\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_fetchEntities\",\n      value: function () {\n        var _fetchEntities2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          var googleEntity;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return fetchCloudGoogleEntity(this.hass, this.entityId);\n              case 3:\n                googleEntity = _context.sent;\n                this._googleEntity = googleEntity;\n                this.requestUpdate(\"_googleEntity\");\n                _context.next = 11;\n                break;\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                if (_context.t0.code === \"not_supported\") {\n                  this._unsupported[\"cloud.google_assistant\"] = true;\n                  this.requestUpdate(\"_unsupported\");\n                }\n              case 11:\n                _context.prev = 11;\n                _context.next = 14;\n                return fetchCloudAlexaEntity(this.hass, this.entityId);\n              case 14:\n                _context.next = 19;\n                break;\n              case 16:\n                _context.prev = 16;\n                _context.t1 = _context[\"catch\"](11);\n                if (_context.t1.code === \"not_supported\") {\n                  this._unsupported[\"cloud.alexa\"] = true;\n                  this.requestUpdate(\"_unsupported\");\n                }\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this, [[0, 8], [11, 16]]);\n        }));\n        function _fetchEntities() {\n          return _fetchEntities2.apply(this, arguments);\n        }\n        return _fetchEntities;\n      }()\n    }, {\n      kind: \"field\",\n      key: \"_getEntityFilterFuncs\",\n      value: function value() {\n        return memoizeOne(function (googleFilter, alexaFilter) {\n          return {\n            google: generateFilter(googleFilter.include_domains, googleFilter.include_entities, googleFilter.exclude_domains, googleFilter.exclude_entities),\n            alexa: generateFilter(alexaFilter.include_domains, alexaFilter.include_entities, alexaFilter.exclude_domains, alexaFilter.exclude_entities)\n          };\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        var _this$_cloudStatus,\n          _this$_cloudStatus2,\n          _this3 = this,\n          _this$_aliases;\n        var googleEnabled = ((_this$_cloudStatus = this._cloudStatus) === null || _this$_cloudStatus === void 0 ? void 0 : _this$_cloudStatus.logged_in) === true && this._cloudStatus.prefs.google_enabled === true;\n        var alexaEnabled = ((_this$_cloudStatus2 = this._cloudStatus) === null || _this$_cloudStatus2 === void 0 ? void 0 : _this$_cloudStatus2.logged_in) === true && this._cloudStatus.prefs.alexa_enabled === true;\n        var showAssistants = _toConsumableArray(Object.keys(voiceAssistants));\n        var uiAssistants = _toConsumableArray(showAssistants);\n        var alexaManual = alexaEnabled && !isEmptyFilter(this._cloudStatus.alexa_entities);\n        var googleManual = googleEnabled && !isEmptyFilter(this._cloudStatus.google_entities);\n        if (!googleEnabled) {\n          showAssistants.splice(showAssistants.indexOf(\"cloud.google_assistant\"), 1);\n          uiAssistants.splice(showAssistants.indexOf(\"cloud.google_assistant\"), 1);\n        } else if (googleManual) {\n          uiAssistants.splice(uiAssistants.indexOf(\"cloud.google_assistant\"), 1);\n        }\n        if (!alexaEnabled) {\n          showAssistants.splice(showAssistants.indexOf(\"cloud.alexa\"), 1);\n          uiAssistants.splice(uiAssistants.indexOf(\"cloud.alexa\"), 1);\n        } else if (alexaManual) {\n          uiAssistants.splice(uiAssistants.indexOf(\"cloud.alexa\"), 1);\n        }\n        var uiExposed = uiAssistants.some(function (key) {\n          return _this3.exposed[key];\n        });\n        var manFilterFuncs;\n        if (alexaManual || googleManual) {\n          manFilterFuncs = this._getEntityFilterFuncs(this._cloudStatus.google_entities, this._cloudStatus.alexa_entities);\n        }\n        var manExposedAlexa = alexaManual && manFilterFuncs.alexa(this.entityId);\n        var manExposedGoogle = googleManual && manFilterFuncs.google(this.entityId);\n        var anyExposed = uiExposed || manExposedAlexa || manExposedGoogle;\n        return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n      <ha-settings-row>\\n        <h3 slot=\\\"heading\\\">\\n          \", \"\\n        </h3>\\n        <ha-switch\\n          @change=\", \"\\n          .assistants=\", \"\\n          .checked=\", \"\\n        ></ha-switch>\\n      </ha-settings-row>\\n      \", \"\\n\\n      <h3 class=\\\"header\\\">\\n        \", \"\\n      </h3>\\n\\n      <p class=\\\"description\\\">\\n        \", \"\\n      </p>\\n\\n      \", \"\\n    \"])), this.hass.localize(\"ui.dialogs.voice-settings.expose_header\"), this._toggleAll, uiAssistants, anyExposed, anyExposed ? showAssistants.map(function (key) {\n          var _this3$_googleEntity, _this3$hass$themes;\n          var supported = !_this3._unsupported[key];\n          var exposed = alexaManual && key === \"cloud.alexa\" ? manExposedAlexa : googleManual && key === \"cloud.google_assistant\" ? manExposedGoogle : _this3.exposed[key];\n          var manualConfig = alexaManual && key === \"cloud.alexa\" || googleManual && key === \"cloud.google_assistant\";\n          var support2fa = key === \"cloud.google_assistant\" && !googleManual && supported && ((_this3$_googleEntity = _this3._googleEntity) === null || _this3$_googleEntity === void 0 ? void 0 : _this3$_googleEntity.might_2fa);\n          return html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n              <ha-settings-row .threeLine=\", \">\\n                <img\\n                  alt=\\\"\\\"\\n                  src=\", \"\\n                  crossorigin=\\\"anonymous\\\"\\n                  referrerpolicy=\\\"no-referrer\\\"\\n                  slot=\\\"prefix\\\"\\n                />\\n                <span slot=\\\"heading\\\">\", \"</span>\\n                \", \"\\n                \", \"\\n                \", \"\\n                <ha-switch\\n                  .assistant=\", \"\\n                  @change=\", \"\\n                  .disabled=\", \"\\n                  .checked=\", \"\\n                ></ha-switch>\\n              </ha-settings-row>\\n            \"])), !supported && manualConfig, brandsUrl({\n            domain: voiceAssistants[key].domain,\n            type: \"icon\",\n            darkOptimized: (_this3$hass$themes = _this3.hass.themes) === null || _this3$hass$themes === void 0 ? void 0 : _this3$hass$themes.darkMode\n          }), voiceAssistants[key].name, !supported ? html(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"<div slot=\\\"description\\\" class=\\\"unsupported\\\">\\n                      <ha-svg-icon .path=\", \"></ha-svg-icon>\\n                      \", \"\\n                    </div>\"])), mdiAlertCircle, _this3.hass.localize(\"ui.dialogs.voice-settings.unsupported\")) : nothing, manualConfig ? html(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n                      <div slot=\\\"description\\\">\\n                        \", \"\\n                      </div>\\n                    \"])), _this3.hass.localize(\"ui.dialogs.voice-settings.manual_config\")) : nothing, support2fa ? html(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\\n                      <ha-formfield\\n                        slot=\\\"description\\\"\\n                        .label=\", \"\\n                      >\\n                        <ha-checkbox\\n                          .checked=\", \"\\n                          @change=\", \"\\n                        ></ha-checkbox>\\n                      </ha-formfield>\\n                    \"])), _this3.hass.localize(\"ui.dialogs.voice-settings.ask_pin\"), !_this3._googleEntity.disable_2fa, _this3._2faChanged) : nothing, key, _this3._toggleAssistant, manualConfig || !exposed && !supported, exposed);\n        }) : nothing, this.hass.localize(\"ui.dialogs.voice-settings.aliases_header\"), this.hass.localize(\"ui.dialogs.voice-settings.aliases_description\"), !this.entry ? html(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"<ha-alert alert-type=\\\"warning\\\">\\n            \", \"\\n          </ha-alert>\"])), this.hass.localize(\"ui.dialogs.voice-settings.aliases_no_unique_id\", {\n          faq_link: html(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"<a\\n                  href=\", \"\\n                  target=\\\"_blank\\\"\\n                  rel=\\\"noreferrer\\\"\\n                  >\", \"</a\\n                >\"])), documentationUrl(this.hass, \"/faq/unique_id\"), this.hass.localize(\"ui.dialogs.entity_registry.faq\"))\n        })) : html(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"<ha-aliases-editor\\n            .hass=\", \"\\n            .aliases=\", \"\\n            @value-changed=\", \"\\n            @blur=\", \"\\n          ></ha-aliases-editor>\"])), this.hass, (_this$_aliases = this._aliases) !== null && _this$_aliases !== void 0 ? _this$_aliases : this.entry.aliases, this._aliasesChanged, this._saveAliases));\n      }\n    }, {\n      kind: \"method\",\n      key: \"_aliasesChanged\",\n      value: function _aliasesChanged(ev) {\n        this._aliases = ev.detail.value;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_2faChanged\",\n      value: function () {\n        var _2faChanged2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(ev) {\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return updateCloudGoogleEntityConfig(this.hass, this.entityId, !ev.target.checked);\n              case 3:\n                _context2.next = 8;\n                break;\n              case 5:\n                _context2.prev = 5;\n                _context2.t0 = _context2[\"catch\"](0);\n                ev.target.checked = !ev.target.checked;\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2, this, [[0, 5]]);\n        }));\n        function _2faChanged(_x) {\n          return _2faChanged2.apply(this, arguments);\n        }\n        return _2faChanged;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_saveAliases\",\n      value: function () {\n        var _saveAliases2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n          var result;\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                if (this._aliases) {\n                  _context3.next = 2;\n                  break;\n                }\n                return _context3.abrupt(\"return\");\n              case 2:\n                _context3.next = 4;\n                return updateEntityRegistryEntry(this.hass, this.entityId, {\n                  aliases: this._aliases.map(function (alias) {\n                    return alias.trim();\n                  }).filter(function (alias) {\n                    return alias;\n                  })\n                });\n              case 4:\n                result = _context3.sent;\n                fireEvent(this, \"entity-entry-updated\", result.entity_entry);\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, this);\n        }));\n        function _saveAliases() {\n          return _saveAliases2.apply(this, arguments);\n        }\n        return _saveAliases;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_toggleAssistant\",\n      value: function () {\n        var _toggleAssistant2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(ev) {\n          var entry;\n          return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n            while (1) switch (_context4.prev = _context4.next) {\n              case 0:\n                exposeEntities(this.hass, [ev.target.assistant], [this.entityId], ev.target.checked);\n                if (!this.entry) {\n                  _context4.next = 6;\n                  break;\n                }\n                _context4.next = 4;\n                return getExtendedEntityRegistryEntry(this.hass, this.entityId);\n              case 4:\n                entry = _context4.sent;\n                fireEvent(this, \"entity-entry-updated\", entry);\n              case 6:\n                fireEvent(this, \"exposed-entities-changed\");\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }, _callee4, this);\n        }));\n        function _toggleAssistant(_x2) {\n          return _toggleAssistant2.apply(this, arguments);\n        }\n        return _toggleAssistant;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_toggleAll\",\n      value: function () {\n        var _toggleAll2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(ev) {\n          var _this4 = this;\n          var expose, assistants, entry;\n          return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n            while (1) switch (_context5.prev = _context5.next) {\n              case 0:\n                expose = ev.target.checked;\n                assistants = expose ? ev.target.assistants.filter(function (key) {\n                  return !_this4._unsupported[key];\n                }) : ev.target.assistants;\n                exposeEntities(this.hass, assistants, [this.entityId], ev.target.checked);\n                if (!this.entry) {\n                  _context5.next = 8;\n                  break;\n                }\n                _context5.next = 6;\n                return getExtendedEntityRegistryEntry(this.hass, this.entityId);\n              case 6:\n                entry = _context5.sent;\n                fireEvent(this, \"entity-entry-updated\", entry);\n              case 8:\n                fireEvent(this, \"exposed-entities-changed\");\n              case 9:\n              case \"end\":\n                return _context5.stop();\n            }\n          }, _callee5, this);\n        }));\n        function _toggleAll(_x3) {\n          return _toggleAll2.apply(this, arguments);\n        }\n        return _toggleAll;\n      }()\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return [haStyle, css(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\\n        :host {\\n          display: block;\\n          margin: 32px;\\n          margin-top: 0;\\n          --settings-row-prefix-display: contents;\\n          --settings-row-content-display: contents;\\n        }\\n        ha-settings-row {\\n          padding: 0;\\n        }\\n        img {\\n          height: 32px;\\n          width: 32px;\\n          margin-right: 16px;\\n          margin-inline-end: 16px;\\n          margin-inline-start: initial;\\n        }\\n        ha-aliases-editor {\\n          display: block;\\n        }\\n        ha-alert {\\n          display: block;\\n          margin-top: 16px;\\n        }\\n        ha-formfield {\\n          margin-left: -8px;\\n          margin-inline-start: -8px;\\n          margin-inline-end: initial;\\n        }\\n        ha-checkbox {\\n          --mdc-checkbox-state-layer-size: 40px;\\n        }\\n        .unsupported {\\n          display: flex;\\n          align-items: center;\\n        }\\n        .unsupported ha-svg-icon {\\n          color: var(--error-color);\\n          --mdc-icon-size: 16px;\\n          margin-right: 4px;\\n          margin-inline-end: 4px;\\n          margin-inline-start: initial;\\n        }\\n        .header {\\n          margin-top: 8px;\\n          margin-bottom: 4px;\\n        }\\n        .description {\\n          color: var(--secondary-text-color);\\n          font-size: 14px;\\n          line-height: 20px;\\n          margin-top: 0;\\n          margin-bottom: 16px;\\n        }\\n      \"])))];\n      }\n    }]\n  };\n}, SubscribeMixin(LitElement));","map":{"version":3,"names":["css","html","LitElement","nothing","customElement","property","state","memoizeOne","isComponentLoaded","fireEvent","generateFilter","isEmptyFilter","fetchCloudAlexaEntity","fetchCloudStatus","updateCloudGoogleEntityConfig","getExtendedEntityRegistryEntry","updateEntityRegistryEntry","fetchCloudGoogleEntity","exposeEntities","voiceAssistants","SubscribeMixin","haStyle","brandsUrl","documentationUrl","EntityVoiceSettings","_decorate","_initialize","_SubscribeMixin","_SubscribeMixin2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","decorators","attribute","key","value","willUpdate","changedProps","_this2","hass","has","entityId","_fetchEntities","hasUpdated","then","status","_cloudStatus","_fetchEntities2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","googleEntity","wrap","_callee$","_context","prev","next","sent","_googleEntity","requestUpdate","t0","code","_unsupported","t1","stop","apply","googleFilter","alexaFilter","google","include_domains","include_entities","exclude_domains","exclude_entities","alexa","render","_this$_cloudStatus","_this$_cloudStatus2","_this3","_this$_aliases","googleEnabled","logged_in","prefs","google_enabled","alexaEnabled","alexa_enabled","showAssistants","_toConsumableArray","Object","keys","uiAssistants","alexaManual","alexa_entities","googleManual","google_entities","splice","indexOf","uiExposed","some","exposed","manFilterFuncs","_getEntityFilterFuncs","manExposedAlexa","manExposedGoogle","anyExposed","_templateObject","_taggedTemplateLiteral","localize","_toggleAll","map","_this3$_googleEntity","_this3$hass$themes","supported","manualConfig","support2fa","might_2fa","_templateObject2","domain","type","darkOptimized","themes","darkMode","name","_templateObject3","mdiAlertCircle","_templateObject4","_templateObject5","disable_2fa","_2faChanged","_toggleAssistant","entry","_templateObject6","faq_link","_templateObject7","_templateObject8","_aliases","aliases","_aliasesChanged","_saveAliases","ev","detail","_2faChanged2","_callee2","_callee2$","_context2","target","checked","_x","_saveAliases2","_callee3","result","_callee3$","_context3","abrupt","alias","trim","filter","entity_entry","_toggleAssistant2","_callee4","_callee4$","_context4","assistant","_x2","_toggleAll2","_callee5","_this4","expose","assistants","_callee5$","_context5","_x3","static","styles","_templateObject9"],"sources":["/workspaces/frontend/src/panels/config/voice-assistants/entity-voice-settings.ts"],"sourcesContent":["import { mdiAlertCircle } from \"@mdi/js\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  nothing,\n  PropertyValues,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { isComponentLoaded } from \"../../../common/config/is_component_loaded\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport {\n  EntityFilter,\n  FilterFunc,\n  generateFilter,\n  isEmptyFilter,\n} from \"../../../common/entity/entity_filter\";\nimport \"../../../components/ha-aliases-editor\";\nimport \"../../../components/ha-settings-row\";\nimport \"../../../components/ha-switch\";\nimport { fetchCloudAlexaEntity } from \"../../../data/alexa\";\nimport {\n  CloudStatus,\n  CloudStatusLoggedIn,\n  fetchCloudStatus,\n  updateCloudGoogleEntityConfig,\n} from \"../../../data/cloud\";\nimport {\n  ExtEntityRegistryEntry,\n  getExtendedEntityRegistryEntry,\n  updateEntityRegistryEntry,\n} from \"../../../data/entity_registry\";\nimport {\n  fetchCloudGoogleEntity,\n  GoogleEntity,\n} from \"../../../data/google_assistant\";\nimport {\n  exposeEntities,\n  ExposeEntitySettings,\n  voiceAssistants,\n} from \"../../../data/expose\";\nimport { SubscribeMixin } from \"../../../mixins/subscribe-mixin\";\nimport { haStyle } from \"../../../resources/styles\";\nimport type { HomeAssistant } from \"../../../types\";\nimport { brandsUrl } from \"../../../util/brands-url\";\nimport { EntityRegistrySettings } from \"../entities/entity-registry-settings\";\nimport { documentationUrl } from \"../../../util/documentation-url\";\n\n@customElement(\"entity-voice-settings\")\nexport class EntityVoiceSettings extends SubscribeMixin(LitElement) {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public entityId!: string;\n\n  @property({ attribute: false }) public exposed!: ExposeEntitySettings;\n\n  @property({ attribute: false }) public entry?: ExtEntityRegistryEntry;\n\n  @state() private _cloudStatus?: CloudStatus;\n\n  @state() private _aliases?: string[];\n\n  @state() private _googleEntity?: GoogleEntity;\n\n  @state() private _unsupported: Partial<\n    Record<\"cloud.google_assistant\" | \"cloud.alexa\" | \"conversation\", boolean>\n  > = {};\n\n  protected willUpdate(changedProps: PropertyValues<this>) {\n    if (!isComponentLoaded(this.hass, \"cloud\")) {\n      return;\n    }\n    if (changedProps.has(\"entityId\") && this.entityId) {\n      this._fetchEntities();\n    }\n    if (!this.hasUpdated) {\n      fetchCloudStatus(this.hass).then((status) => {\n        this._cloudStatus = status;\n      });\n    }\n  }\n\n  private async _fetchEntities() {\n    try {\n      const googleEntity = await fetchCloudGoogleEntity(\n        this.hass,\n        this.entityId\n      );\n      this._googleEntity = googleEntity;\n      this.requestUpdate(\"_googleEntity\");\n    } catch (err: any) {\n      if (err.code === \"not_supported\") {\n        this._unsupported[\"cloud.google_assistant\"] = true;\n        this.requestUpdate(\"_unsupported\");\n      }\n    }\n\n    try {\n      await fetchCloudAlexaEntity(this.hass, this.entityId);\n    } catch (err: any) {\n      if (err.code === \"not_supported\") {\n        this._unsupported[\"cloud.alexa\"] = true;\n        this.requestUpdate(\"_unsupported\");\n      }\n    }\n  }\n\n  private _getEntityFilterFuncs = memoizeOne(\n    (googleFilter: EntityFilter, alexaFilter: EntityFilter) => ({\n      google: generateFilter(\n        googleFilter.include_domains,\n        googleFilter.include_entities,\n        googleFilter.exclude_domains,\n        googleFilter.exclude_entities\n      ),\n      alexa: generateFilter(\n        alexaFilter.include_domains,\n        alexaFilter.include_entities,\n        alexaFilter.exclude_domains,\n        alexaFilter.exclude_entities\n      ),\n    })\n  );\n\n  protected render() {\n    const googleEnabled =\n      this._cloudStatus?.logged_in === true &&\n      this._cloudStatus.prefs.google_enabled === true;\n\n    const alexaEnabled =\n      this._cloudStatus?.logged_in === true &&\n      this._cloudStatus.prefs.alexa_enabled === true;\n\n    const showAssistants = [...Object.keys(voiceAssistants)];\n    const uiAssistants = [...showAssistants];\n\n    const alexaManual =\n      alexaEnabled &&\n      !isEmptyFilter((this._cloudStatus as CloudStatusLoggedIn).alexa_entities);\n    const googleManual =\n      googleEnabled &&\n      !isEmptyFilter(\n        (this._cloudStatus as CloudStatusLoggedIn).google_entities\n      );\n\n    if (!googleEnabled) {\n      showAssistants.splice(\n        showAssistants.indexOf(\"cloud.google_assistant\"),\n        1\n      );\n      uiAssistants.splice(showAssistants.indexOf(\"cloud.google_assistant\"), 1);\n    } else if (googleManual) {\n      uiAssistants.splice(uiAssistants.indexOf(\"cloud.google_assistant\"), 1);\n    }\n\n    if (!alexaEnabled) {\n      showAssistants.splice(showAssistants.indexOf(\"cloud.alexa\"), 1);\n      uiAssistants.splice(uiAssistants.indexOf(\"cloud.alexa\"), 1);\n    } else if (alexaManual) {\n      uiAssistants.splice(uiAssistants.indexOf(\"cloud.alexa\"), 1);\n    }\n\n    const uiExposed = uiAssistants.some((key) => this.exposed[key]);\n\n    let manFilterFuncs:\n      | {\n          google: FilterFunc;\n          alexa: FilterFunc;\n        }\n      | undefined;\n\n    if (alexaManual || googleManual) {\n      manFilterFuncs = this._getEntityFilterFuncs(\n        (this._cloudStatus as CloudStatusLoggedIn).google_entities,\n        (this._cloudStatus as CloudStatusLoggedIn).alexa_entities\n      );\n    }\n\n    const manExposedAlexa = alexaManual && manFilterFuncs!.alexa(this.entityId);\n    const manExposedGoogle =\n      googleManual && manFilterFuncs!.google(this.entityId);\n\n    const anyExposed = uiExposed || manExposedAlexa || manExposedGoogle;\n\n    return html`\n      <ha-settings-row>\n        <h3 slot=\"heading\">\n          ${this.hass.localize(\"ui.dialogs.voice-settings.expose_header\")}\n        </h3>\n        <ha-switch\n          @change=${this._toggleAll}\n          .assistants=${uiAssistants}\n          .checked=${anyExposed}\n        ></ha-switch>\n      </ha-settings-row>\n      ${anyExposed\n        ? showAssistants.map((key) => {\n            const supported = !this._unsupported[key];\n\n            const exposed =\n              alexaManual && key === \"cloud.alexa\"\n                ? manExposedAlexa\n                : googleManual && key === \"cloud.google_assistant\"\n                  ? manExposedGoogle\n                  : this.exposed[key];\n\n            const manualConfig =\n              (alexaManual && key === \"cloud.alexa\") ||\n              (googleManual && key === \"cloud.google_assistant\");\n\n            const support2fa =\n              key === \"cloud.google_assistant\" &&\n              !googleManual &&\n              supported &&\n              this._googleEntity?.might_2fa;\n\n            return html`\n              <ha-settings-row .threeLine=${!supported && manualConfig}>\n                <img\n                  alt=\"\"\n                  src=${brandsUrl({\n                    domain: voiceAssistants[key].domain,\n                    type: \"icon\",\n                    darkOptimized: this.hass.themes?.darkMode,\n                  })}\n                  crossorigin=\"anonymous\"\n                  referrerpolicy=\"no-referrer\"\n                  slot=\"prefix\"\n                />\n                <span slot=\"heading\">${voiceAssistants[key].name}</span>\n                ${!supported\n                  ? html`<div slot=\"description\" class=\"unsupported\">\n                      <ha-svg-icon .path=${mdiAlertCircle}></ha-svg-icon>\n                      ${this.hass.localize(\n                        \"ui.dialogs.voice-settings.unsupported\"\n                      )}\n                    </div>`\n                  : nothing}\n                ${manualConfig\n                  ? html`\n                      <div slot=\"description\">\n                        ${this.hass.localize(\n                          \"ui.dialogs.voice-settings.manual_config\"\n                        )}\n                      </div>\n                    `\n                  : nothing}\n                ${support2fa\n                  ? html`\n                      <ha-formfield\n                        slot=\"description\"\n                        .label=${this.hass.localize(\n                          \"ui.dialogs.voice-settings.ask_pin\"\n                        )}\n                      >\n                        <ha-checkbox\n                          .checked=${!this._googleEntity!.disable_2fa}\n                          @change=${this._2faChanged}\n                        ></ha-checkbox>\n                      </ha-formfield>\n                    `\n                  : nothing}\n                <ha-switch\n                  .assistant=${key}\n                  @change=${this._toggleAssistant}\n                  .disabled=${manualConfig || (!exposed && !supported)}\n                  .checked=${exposed}\n                ></ha-switch>\n              </ha-settings-row>\n            `;\n          })\n        : nothing}\n\n      <h3 class=\"header\">\n        ${this.hass.localize(\"ui.dialogs.voice-settings.aliases_header\")}\n      </h3>\n\n      <p class=\"description\">\n        ${this.hass.localize(\"ui.dialogs.voice-settings.aliases_description\")}\n      </p>\n\n      ${!this.entry\n        ? html`<ha-alert alert-type=\"warning\">\n            ${this.hass.localize(\n              \"ui.dialogs.voice-settings.aliases_no_unique_id\",\n              {\n                faq_link: html`<a\n                  href=${documentationUrl(this.hass, \"/faq/unique_id\")}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  >${this.hass.localize(\"ui.dialogs.entity_registry.faq\")}</a\n                >`,\n              }\n            )}\n          </ha-alert>`\n        : html`<ha-aliases-editor\n            .hass=${this.hass}\n            .aliases=${this._aliases ?? this.entry.aliases}\n            @value-changed=${this._aliasesChanged}\n            @blur=${this._saveAliases}\n          ></ha-aliases-editor>`}\n    `;\n  }\n\n  private _aliasesChanged(ev) {\n    this._aliases = ev.detail.value;\n  }\n\n  private async _2faChanged(ev) {\n    try {\n      await updateCloudGoogleEntityConfig(\n        this.hass,\n        this.entityId,\n        !ev.target.checked\n      );\n    } catch (_err) {\n      ev.target.checked = !ev.target.checked;\n    }\n  }\n\n  private async _saveAliases() {\n    if (!this._aliases) {\n      return;\n    }\n    const result = await updateEntityRegistryEntry(this.hass, this.entityId, {\n      aliases: this._aliases\n        .map((alias) => alias.trim())\n        .filter((alias) => alias),\n    });\n    fireEvent(this, \"entity-entry-updated\", result.entity_entry);\n  }\n\n  private async _toggleAssistant(ev) {\n    exposeEntities(\n      this.hass,\n      [ev.target.assistant],\n      [this.entityId],\n      ev.target.checked\n    );\n    if (this.entry) {\n      const entry = await getExtendedEntityRegistryEntry(\n        this.hass,\n        this.entityId\n      );\n      fireEvent(this, \"entity-entry-updated\", entry);\n    }\n    fireEvent(this, \"exposed-entities-changed\");\n  }\n\n  private async _toggleAll(ev) {\n    const expose = ev.target.checked;\n\n    const assistants = expose\n      ? ev.target.assistants.filter((key) => !this._unsupported[key])\n      : ev.target.assistants;\n\n    exposeEntities(this.hass, assistants, [this.entityId], ev.target.checked);\n    if (this.entry) {\n      const entry = await getExtendedEntityRegistryEntry(\n        this.hass,\n        this.entityId\n      );\n      fireEvent(this, \"entity-entry-updated\", entry);\n    }\n    fireEvent(this, \"exposed-entities-changed\");\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      haStyle,\n      css`\n        :host {\n          display: block;\n          margin: 32px;\n          margin-top: 0;\n          --settings-row-prefix-display: contents;\n          --settings-row-content-display: contents;\n        }\n        ha-settings-row {\n          padding: 0;\n        }\n        img {\n          height: 32px;\n          width: 32px;\n          margin-right: 16px;\n          margin-inline-end: 16px;\n          margin-inline-start: initial;\n        }\n        ha-aliases-editor {\n          display: block;\n        }\n        ha-alert {\n          display: block;\n          margin-top: 16px;\n        }\n        ha-formfield {\n          margin-left: -8px;\n          margin-inline-start: -8px;\n          margin-inline-end: initial;\n        }\n        ha-checkbox {\n          --mdc-checkbox-state-layer-size: 40px;\n        }\n        .unsupported {\n          display: flex;\n          align-items: center;\n        }\n        .unsupported ha-svg-icon {\n          color: var(--error-color);\n          --mdc-icon-size: 16px;\n          margin-right: 4px;\n          margin-inline-end: 4px;\n          margin-inline-start: initial;\n        }\n        .header {\n          margin-top: 8px;\n          margin-bottom: 4px;\n        }\n        .description {\n          color: var(--secondary-text-color);\n          font-size: 14px;\n          line-height: 20px;\n          margin-top: 0;\n          margin-bottom: 16px;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"entity-registry-settings\": EntityRegistrySettings;\n  }\n  interface HASSDomEvents {\n    \"entity-entry-updated\": ExtEntityRegistryEntry;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"entity-voice-settings\": EntityVoiceSettings;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}