{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13, _templateObject14, _templateObject15, _templateObject16;\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.array.unshift.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"@material/mwc-list/mwc-list\";\nvar mdiClock = \"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z\";\nvar mdiDelete = \"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z\";\nvar mdiDeleteSweep = \"M15,16H19V18H15V16M15,8H22V10H15V8M15,12H21V14H15V12M3,18A2,2 0 0,0 5,20H11A2,2 0 0,0 13,18V8H3V18M14,5H11L10,4H6L5,5H2V7H14V5Z\";\nvar mdiDotsVertical = \"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z\";\nvar mdiDrag = \"M7,19V17H9V19H7M11,19V17H13V19H11M15,19V17H17V19H15M7,15V13H9V15H7M11,15V13H13V15H11M15,15V13H17V15H15M7,11V9H9V11H7M11,11V9H13V11H11M15,11V9H17V11H15M7,7V5H9V7H7M11,7V5H13V7H11M15,7V5H17V7H15Z\";\nvar mdiPlus = \"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z\";\nvar mdiSort = \"M18 21L14 17H17V7H14L18 3L22 7H19V17H22M2 19V17H12V19M2 13V11H9V13M2 7V5H6V7H2Z\";\nimport { endOfDay, isSameDay } from \"date-fns\";\nimport { LitElement, css, html, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { repeat } from \"lit/directives/repeat\";\nimport memoizeOne from \"memoize-one\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { supportsFeature } from \"../../../common/entity/supports-feature\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-check-list-item\";\nimport \"../../../components/ha-checkbox\";\nimport \"../../../components/ha-icon-button\";\nimport \"../../../components/ha-list-item\";\nimport \"../../../components/ha-markdown-element\";\nimport \"../../../components/ha-relative-time\";\nimport \"../../../components/ha-select\";\nimport \"../../../components/ha-sortable\";\nimport \"../../../components/ha-svg-icon\";\nimport \"../../../components/ha-textfield\";\nimport { isUnavailableState } from \"../../../data/entity\";\nimport { TodoItemStatus, TodoListEntityFeature, createItem, deleteItems, moveItem, subscribeItems, updateItem } from \"../../../data/todo\";\nimport { showConfirmationDialog } from \"../../../dialogs/generic/show-dialog-box\";\nimport { showTodoItemEditDialog } from \"../../todo/show-dialog-todo-item-editor\";\nimport { findEntities } from \"../common/find-entities\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nexport var HuiTodoListCard = _decorate([customElement(\"hui-todo-list-card\")], function (_initialize, _LitElement) {\n  var HuiTodoListCard = /*#__PURE__*/function (_LitElement2) {\n    _inherits(HuiTodoListCard, _LitElement2);\n    function HuiTodoListCard() {\n      var _this;\n      _classCallCheck(this, HuiTodoListCard);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, HuiTodoListCard, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(HuiTodoListCard);\n  }(_LitElement);\n  return {\n    F: HuiTodoListCard,\n    d: [{\n      kind: \"method\",\n      static: true,\n      key: \"getConfigElement\",\n      value: function () {\n        var _getConfigElement = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return import(\"../editor/config-elements/hui-todo-list-editor\");\n              case 2:\n                return _context.abrupt(\"return\", document.createElement(\"hui-todo-list-card-editor\"));\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n        function getConfigElement() {\n          return _getConfigElement.apply(this, arguments);\n        }\n        return getConfigElement;\n      }()\n    }, {\n      kind: \"method\",\n      static: true,\n      key: \"getStubConfig\",\n      value: function getStubConfig(hass, entities, entitiesFallback) {\n        var includeDomains = [\"todo\"];\n        var maxEntities = 1;\n        var foundEntities = findEntities(hass, maxEntities, entities, entitiesFallback, includeDomains);\n        return {\n          type: \"todo-list\",\n          entity: foundEntities[0] || \"\"\n        };\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_config\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_entityId\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_items\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_reordering\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_unsubItems\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"connectedCallback\",\n      value: function connectedCallback() {\n        _get(_getPrototypeOf(HuiTodoListCard.prototype), \"connectedCallback\", this).call(this);\n        if (this.hasUpdated) {\n          this._subscribeItems();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"disconnectedCallback\",\n      value: function disconnectedCallback() {\n        var _this$_unsubItems;\n        _get(_getPrototypeOf(HuiTodoListCard.prototype), \"disconnectedCallback\", this).call(this);\n        (_this$_unsubItems = this._unsubItems) === null || _this$_unsubItems === void 0 || _this$_unsubItems.then(function (unsub) {\n          return unsub();\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"getCardSize\",\n      value: function getCardSize() {\n        return (this._config ? this._config.title ? 2 : 0 : 0) + 3;\n      }\n    }, {\n      kind: \"method\",\n      key: \"setConfig\",\n      value: function setConfig(config) {\n        this.checkConfig(config);\n        this._config = config;\n        this._entityId = config.entity;\n      }\n    }, {\n      kind: \"method\",\n      key: \"checkConfig\",\n      value: function checkConfig(config) {\n        if (!config.entity || config.entity.split(\".\")[0] !== \"todo\") {\n          throw new Error(\"Specify an entity from within the todo domain\");\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"getEntityId\",\n      value: function getEntityId() {\n        // not implemented, todo list should always have an entity id set;\n        return undefined;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_getCheckedItems\",\n      value: function value() {\n        return memoizeOne(function (items) {\n          return items ? items.filter(function (item) {\n            return item.status === TodoItemStatus.Completed;\n          }) : [];\n        });\n      }\n    }, {\n      kind: \"field\",\n      key: \"_getUncheckedItems\",\n      value: function value() {\n        return memoizeOne(function (items) {\n          return items ? items.filter(function (item) {\n            return item.status === TodoItemStatus.NeedsAction;\n          }) : [];\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProperties) {\n        if (!this.hasUpdated) {\n          if (!this._entityId) {\n            this._entityId = this.getEntityId();\n          }\n          this._subscribeItems();\n        } else if (changedProperties.has(\"_entityId\") || !this._items) {\n          this._items = undefined;\n          this._subscribeItems();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"updated\",\n      value: function updated(changedProps) {\n        _get(_getPrototypeOf(HuiTodoListCard.prototype), \"updated\", this).call(this, changedProps);\n        if (!this._config || !this.hass) {\n          return;\n        }\n        var oldHass = changedProps.get(\"hass\");\n        var oldConfig = changedProps.get(\"_config\");\n        if (changedProps.has(\"hass\") && (oldHass === null || oldHass === void 0 ? void 0 : oldHass.themes) !== this.hass.themes || changedProps.has(\"_config\") && (oldConfig === null || oldConfig === void 0 ? void 0 : oldConfig.theme) !== this._config.theme) {\n          applyThemesOnElement(this, this.hass.themes, this._config.theme);\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this._config || !this.hass || !this._entityId) {\n          return nothing;\n        }\n        var stateObj = this.hass.states[this._entityId];\n        if (!stateObj) {\n          return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n        <hui-warning>\\n          \", \"\\n        </hui-warning>\\n      \"])), createEntityNotFoundWarning(this.hass, this._entityId));\n        }\n        var unavailable = isUnavailableState(stateObj.state);\n        var checkedItems = this._getCheckedItems(this._items);\n        var uncheckedItems = this._getUncheckedItems(this._items);\n        return html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n      <ha-card\\n        .header=\", \"\\n        class=\", \"\\n      >\\n        <div class=\\\"addRow\\\">\\n          \", \"\\n        </div>\\n        <ha-sortable\\n          handle-selector=\\\"ha-svg-icon\\\"\\n          draggable-selector=\\\".draggable\\\"\\n          .disabled=\", \"\\n          @item-moved=\", \"\\n        >\\n          <mwc-list wrapFocus multi>\\n            \", \"\\n            \", \"\\n          </mwc-list>\\n        </ha-sortable>\\n      </ha-card>\\n    \"])), this._config.title, classMap({\n          \"has-header\": \"title\" in this._config\n        }), this.todoListSupportsFeature(TodoListEntityFeature.CREATE_TODO_ITEM) ? html(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n                <ha-textfield\\n                  class=\\\"addBox\\\"\\n                  .placeholder=\", \"\\n                  @keydown=\", \"\\n                  .disabled=\", \"\\n                ></ha-textfield>\\n                <ha-icon-button\\n                  class=\\\"addButton\\\"\\n                  .path=\", \"\\n                  .title=\", \"\\n                  .disabled=\", \"\\n                  @click=\", \"\\n                >\\n                </ha-icon-button>\\n              \"])), this.hass.localize(\"ui.panel.lovelace.cards.todo-list.add_item\"), this._addKeyPress, unavailable, mdiPlus, this.hass.localize(\"ui.panel.lovelace.cards.todo-list.add_item\"), unavailable, this._addItem) : nothing, !this._reordering, this._itemMoved, uncheckedItems.length ? html(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n                  <div class=\\\"header\\\" role=\\\"seperator\\\">\\n                    <h2>\\n                      \", \"\\n                    </h2>\\n                    \", \"\\n                  </div>\\n                  \", \"\\n                \"])), this.hass.localize(\"ui.panel.lovelace.cards.todo-list.unchecked_items\"), this.todoListSupportsFeature(TodoListEntityFeature.MOVE_TODO_ITEM) ? html(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"<ha-button-menu>\\n                          <ha-icon-button\\n                            slot=\\\"trigger\\\"\\n                            .path=\", \"\\n                          ></ha-icon-button>\\n                          <ha-list-item\\n                            @click=\", \"\\n                            graphic=\\\"icon\\\"\\n                          >\\n                            \", \"\\n                            <ha-svg-icon\\n                              slot=\\\"graphic\\\"\\n                              .path=\", \"\\n                              .disabled=\", \"\\n                            >\\n                            </ha-svg-icon>\\n                          </ha-list-item>\\n                        </ha-button-menu>\"])), mdiDotsVertical, this._toggleReorder, this.hass.localize(this._reordering ? \"ui.panel.lovelace.cards.todo-list.exit_reorder_items\" : \"ui.panel.lovelace.cards.todo-list.reorder_items\"), mdiSort, unavailable) : nothing, this._renderItems(uncheckedItems, unavailable)) : html(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"<p class=\\\"empty\\\">\\n                  \", \"\\n                </p>\"])), this.hass.localize(\"ui.panel.lovelace.cards.todo-list.no_unchecked_items\")), checkedItems.length ? html(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\\n                  <div role=\\\"separator\\\">\\n                    <div class=\\\"divider\\\"></div>\\n                    <div class=\\\"header\\\">\\n                      <h2>\\n                        \", \"\\n                      </h2>\\n                      \", \"\\n                    </div>\\n                  </div>\\n                  \", \"\\n                \"])), this.hass.localize(\"ui.panel.lovelace.cards.todo-list.checked_items\"), this.todoListSupportsFeature(TodoListEntityFeature.DELETE_TODO_ITEM) ? html(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"<ha-button-menu>\\n                            <ha-icon-button\\n                              slot=\\\"trigger\\\"\\n                              .path=\", \"\\n                            ></ha-icon-button>\\n                            <ha-list-item\\n                              @click=\", \"\\n                              graphic=\\\"icon\\\"\\n                              class=\\\"warning\\\"\\n                            >\\n                              \", \"\\n                              <ha-svg-icon\\n                                class=\\\"warning\\\"\\n                                slot=\\\"graphic\\\"\\n                                .path=\", \"\\n                                .disabled=\", \"\\n                              >\\n                              </ha-svg-icon>\\n                            </ha-list-item>\\n                          </ha-button-menu>\"])), mdiDotsVertical, this._clearCompletedItems, this.hass.localize(\"ui.panel.lovelace.cards.todo-list.clear_items\"), mdiDeleteSweep, unavailable) : nothing, this._renderItems(checkedItems, unavailable)) : \"\");\n      }\n    }, {\n      kind: \"method\",\n      key: \"_renderItems\",\n      value: function _renderItems(items) {\n        var _this2 = this;\n        var unavailable = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        return html(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\\n      \", \"\\n    \"])), repeat(items, function (item) {\n          return item.uid;\n        }, function (item) {\n          var showDelete = _this2.todoListSupportsFeature(TodoListEntityFeature.DELETE_TODO_ITEM) && !_this2.todoListSupportsFeature(TodoListEntityFeature.UPDATE_TODO_ITEM);\n          var showReorder = item.status !== TodoItemStatus.Completed && _this2._reordering;\n          var due = item.due ? item.due.includes(\"T\") ? new Date(item.due) : endOfDay(new Date(\"\".concat(item.due, \"T00:00:00\"))) : undefined;\n          var today = due && !item.due.includes(\"T\") && isSameDay(new Date(), due);\n          return html(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"\\n            <ha-check-list-item\\n              left\\n              .hasMeta=\", \"\\n              class=\\\"editRow \", \"\\\"\\n              .selected=\", \"\\n              .disabled=\", \"\\n              item-id=\", \"\\n              .itemId=\", \"\\n              @change=\", \"\\n              @click=\", \"\\n              @request-selected=\", \"\\n              @keydown=\", \"\\n            >\\n              <div class=\\\"column\\\">\\n                <span class=\\\"summary\\\">\", \"</span>\\n                \", \"\\n                \", \"\\n              </div>\\n              \", \"\\n            </ha-check-list-item>\\n          \"])), showReorder || showDelete, classMap({\n            draggable: item.status === TodoItemStatus.NeedsAction,\n            completed: item.status === TodoItemStatus.Completed,\n            multiline: Boolean(item.description || item.due)\n          }), item.status === TodoItemStatus.Completed, unavailable || !_this2.todoListSupportsFeature(TodoListEntityFeature.UPDATE_TODO_ITEM), item.uid, item.uid, _this2._completeItem, _this2._openItem, _this2._requestSelected, _this2._handleKeydown, item.summary, item.description ? html(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"<ha-markdown-element\\n                      class=\\\"description\\\"\\n                      .content=\", \"\\n                    ></ha-markdown-element>\"])), item.description) : nothing, due ? html(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"<div class=\\\"due \", \"\\\">\\n                      <ha-svg-icon .path=\", \"></ha-svg-icon>\", \"\\n                    </div>\"])), due < new Date() ? \"overdue\" : \"\", mdiClock, today ? _this2.hass.localize(\"ui.panel.lovelace.cards.todo-list.today\") : html(_templateObject13 || (_templateObject13 = _taggedTemplateLiteral([\"<ha-relative-time\\n                            capitalize\\n                            .hass=\", \"\\n                            .datetime=\", \"\\n                          ></ha-relative-time>\"])), _this2.hass, due)) : nothing, showReorder ? html(_templateObject14 || (_templateObject14 = _taggedTemplateLiteral([\"\\n                    <ha-svg-icon\\n                      .title=\", \"\\n                      class=\\\"reorderButton handle\\\"\\n                      .path=\", \"\\n                      slot=\\\"meta\\\"\\n                    >\\n                    </ha-svg-icon>\\n                  \"])), _this2.hass.localize(\"ui.panel.lovelace.cards.todo-list.drag_and_drop\"), mdiDrag) : showDelete ? html(_templateObject15 || (_templateObject15 = _taggedTemplateLiteral([\"<ha-icon-button\\n                      .title=\", \"\\n                      class=\\\"deleteItemButton\\\"\\n                      .path=\", \"\\n                      .itemId=\", \"\\n                      slot=\\\"meta\\\"\\n                      @click=\", \"\\n                    >\\n                    </ha-icon-button>\"])), _this2.hass.localize(\"ui.panel.lovelace.cards.todo-list.delete_item\"), mdiDelete, item.uid, _this2._deleteItem) : nothing);\n        }));\n      }\n    }, {\n      kind: \"method\",\n      key: \"todoListSupportsFeature\",\n      value: function todoListSupportsFeature(feature) {\n        var entityStateObj = this.hass.states[this._entityId];\n        return entityStateObj && supportsFeature(entityStateObj, feature);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_subscribeItems\",\n      value: function () {\n        var _subscribeItems2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n          var _this3 = this;\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this._unsubItems) {\n                  this._unsubItems.then(function (unsub) {\n                    return unsub();\n                  });\n                  this._unsubItems = undefined;\n                }\n                if (!(!this.hass || !this._entityId)) {\n                  _context2.next = 3;\n                  break;\n                }\n                return _context2.abrupt(\"return\");\n              case 3:\n                if (this._entityId in this.hass.states) {\n                  _context2.next = 5;\n                  break;\n                }\n                return _context2.abrupt(\"return\");\n              case 5:\n                this._unsubItems = subscribeItems(this.hass, this._entityId, function (update) {\n                  _this3._items = update.items;\n                });\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2, this);\n        }));\n        function _subscribeItems() {\n          return _subscribeItems2.apply(this, arguments);\n        }\n        return _subscribeItems;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_getItem\",\n      value: function _getItem(itemId) {\n        var _this$_items;\n        return (_this$_items = this._items) === null || _this$_items === void 0 ? void 0 : _this$_items.find(function (item) {\n          return item.uid === itemId;\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_requestSelected\",\n      value: function _requestSelected(ev) {\n        ev.stopPropagation();\n      }\n    }, {\n      kind: \"method\",\n      key: \"_handleKeydown\",\n      value: function _handleKeydown(ev) {\n        if (ev.key === \" \") {\n          this._completeItem(ev);\n          return;\n        }\n        if (ev.key === \"Enter\") {\n          this._openItem(ev);\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_openItem\",\n      value: function _openItem(ev) {\n        ev.stopPropagation();\n        if (ev.composedPath().find(function (el) {\n          return [\"input\", \"a\", \"button\"].includes(el.localName);\n        })) {\n          return;\n        }\n        var item = this._getItem(ev.currentTarget.itemId);\n        showTodoItemEditDialog(this, {\n          entity: this._config.entity,\n          item: item\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_completeItem\",\n      value: function () {\n        var _completeItem2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(ev) {\n          var focusedIndex, list, item;\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                if (ev.type === \"keydown\") {\n                  list = this.renderRoot.querySelector(\"mwc-list\");\n                  focusedIndex = list.getFocusedItemIndex();\n                }\n                item = this._getItem(ev.currentTarget.itemId);\n                if (item) {\n                  _context3.next = 4;\n                  break;\n                }\n                return _context3.abrupt(\"return\");\n              case 4:\n                _context3.next = 6;\n                return updateItem(this.hass, this._entityId, {\n                  uid: item.uid,\n                  summary: item.summary,\n                  status: item.status === TodoItemStatus.NeedsAction ? TodoItemStatus.Completed : TodoItemStatus.NeedsAction\n                });\n              case 6:\n                if (!(focusedIndex !== undefined && list)) {\n                  _context3.next = 12;\n                  break;\n                }\n                _context3.next = 9;\n                return this.updateComplete;\n              case 9:\n                _context3.next = 11;\n                return list.updateComplete;\n              case 11:\n                list.focusItemAtIndex(focusedIndex);\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, this);\n        }));\n        function _completeItem(_x) {\n          return _completeItem2.apply(this, arguments);\n        }\n        return _completeItem;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_clearCompletedItems\",\n      value: function () {\n        var _clearCompletedItems2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n          var _this4 = this;\n          var checkedItems, uids;\n          return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n            while (1) switch (_context4.prev = _context4.next) {\n              case 0:\n                if (this.hass) {\n                  _context4.next = 2;\n                  break;\n                }\n                return _context4.abrupt(\"return\");\n              case 2:\n                checkedItems = this._getCheckedItems(this._items);\n                uids = checkedItems.map(function (item) {\n                  return item.uid;\n                });\n                showConfirmationDialog(this, {\n                  title: this.hass.localize(\"ui.panel.lovelace.cards.todo-list.delete_confirm_title\"),\n                  text: this.hass.localize(\"ui.panel.lovelace.cards.todo-list.delete_confirm_text\", {\n                    number: uids.length\n                  }),\n                  dismissText: this.hass.localize(\"ui.common.cancel\"),\n                  confirmText: this.hass.localize(\"ui.common.delete\"),\n                  destructive: true,\n                  confirm: function confirm() {\n                    deleteItems(_this4.hass, _this4._entityId, uids);\n                  }\n                });\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }, _callee4, this);\n        }));\n        function _clearCompletedItems() {\n          return _clearCompletedItems2.apply(this, arguments);\n        }\n        return _clearCompletedItems;\n      }()\n    }, {\n      kind: \"get\",\n      key: \"_newItem\",\n      value: function _newItem() {\n        return this.shadowRoot.querySelector(\".addBox\");\n      }\n    }, {\n      kind: \"method\",\n      key: \"_addItem\",\n      value: function _addItem(ev) {\n        var newItem = this._newItem;\n        if (newItem.value.length > 0) {\n          createItem(this.hass, this._entityId, {\n            summary: newItem.value\n          });\n        }\n        newItem.value = \"\";\n        if (ev) {\n          newItem.focus();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_deleteItem\",\n      value: function _deleteItem(ev) {\n        var item = this._getItem(ev.target.itemId);\n        if (!item) {\n          return;\n        }\n        deleteItems(this.hass, this._entityId, [item.uid]);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_addKeyPress\",\n      value: function _addKeyPress(ev) {\n        if (ev.key === \"Enter\") {\n          this._addItem(null);\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_toggleReorder\",\n      value: function () {\n        var _toggleReorder2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n          return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n            while (1) switch (_context5.prev = _context5.next) {\n              case 0:\n                this._reordering = !this._reordering;\n              case 1:\n              case \"end\":\n                return _context5.stop();\n            }\n          }, _callee5, this);\n        }));\n        function _toggleReorder() {\n          return _toggleReorder2.apply(this, arguments);\n        }\n        return _toggleReorder;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_itemMoved\",\n      value: function () {\n        var _itemMoved2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(ev) {\n          var _ev$detail, oldIndex, newIndex;\n          return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n            while (1) switch (_context6.prev = _context6.next) {\n              case 0:\n                ev.stopPropagation();\n                _ev$detail = ev.detail, oldIndex = _ev$detail.oldIndex, newIndex = _ev$detail.newIndex;\n                this._moveItem(oldIndex, newIndex);\n              case 3:\n              case \"end\":\n                return _context6.stop();\n            }\n          }, _callee6, this);\n        }));\n        function _itemMoved(_x2) {\n          return _itemMoved2.apply(this, arguments);\n        }\n        return _itemMoved;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_moveItem\",\n      value: function () {\n        var _moveItem2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(oldIndex, newIndex) {\n          var _prevItem;\n          var uncheckedItems, item, prevItem, itemIndex, prevIndex;\n          return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n            while (1) switch (_context7.prev = _context7.next) {\n              case 0:\n                // correct index for header\n                oldIndex -= 1;\n                newIndex -= 1;\n                uncheckedItems = this._getUncheckedItems(this._items);\n                item = uncheckedItems[oldIndex];\n                if (newIndex > 0) {\n                  if (newIndex < oldIndex) {\n                    prevItem = uncheckedItems[newIndex - 1];\n                  } else {\n                    prevItem = uncheckedItems[newIndex];\n                  }\n                }\n\n                // Optimistic change\n                itemIndex = this._items.findIndex(function (itm) {\n                  return itm.uid === item.uid;\n                });\n                this._items.splice(itemIndex, 1);\n                if (newIndex === 0) {\n                  this._items.unshift(item);\n                } else {\n                  prevIndex = this._items.findIndex(function (itm) {\n                    return itm.uid === prevItem.uid;\n                  });\n                  this._items.splice(prevIndex + 1, 0, item);\n                }\n                this._items = _toConsumableArray(this._items);\n                _context7.next = 11;\n                return moveItem(this.hass, this._entityId, item.uid, (_prevItem = prevItem) === null || _prevItem === void 0 ? void 0 : _prevItem.uid);\n              case 11:\n              case \"end\":\n                return _context7.stop();\n            }\n          }, _callee7, this);\n        }));\n        function _moveItem(_x3, _x4) {\n          return _moveItem2.apply(this, arguments);\n        }\n        return _moveItem;\n      }()\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return css(_templateObject16 || (_templateObject16 = _taggedTemplateLiteral([\"\\n      ha-card {\\n        height: 100%;\\n        box-sizing: border-box;\\n      }\\n\\n      .has-header {\\n        padding-top: 0;\\n      }\\n\\n      .addRow {\\n        padding: 16px;\\n        padding-bottom: 0;\\n        position: relative;\\n      }\\n\\n      .addRow ha-icon-button {\\n        position: absolute;\\n        right: 16px;\\n        inset-inline-start: initial;\\n        inset-inline-end: 16px;\\n      }\\n\\n      .addRow,\\n      .header {\\n        display: flex;\\n        flex-direction: row;\\n        align-items: center;\\n      }\\n\\n      .header {\\n        padding-left: 30px;\\n        padding-right: 16px;\\n        padding-inline-start: 30px;\\n        padding-inline-end: 16px;\\n        margin-top: 8px;\\n        justify-content: space-between;\\n        direction: var(--direction);\\n      }\\n\\n      .header h2 {\\n        color: var(--primary-text-color);\\n        font-size: inherit;\\n        font-weight: 500;\\n      }\\n\\n      .empty {\\n        padding: 16px 32px;\\n        display: inline-block;\\n      }\\n\\n      .item {\\n        margin-top: 8px;\\n      }\\n\\n      ha-check-list-item {\\n        --mdc-list-item-meta-size: 56px;\\n        min-height: 56px;\\n        height: auto;\\n      }\\n\\n      ha-check-list-item.multiline {\\n        align-items: flex-start;\\n        --check-list-item-graphic-margin-top: 8px;\\n      }\\n\\n      .row {\\n        display: flex;\\n        justify-content: space-between;\\n      }\\n\\n      .multiline .column {\\n        display: flex;\\n        flex-direction: column;\\n        margin-top: 18px;\\n        margin-bottom: 12px;\\n      }\\n\\n      .completed .summary {\\n        text-decoration: line-through;\\n      }\\n\\n      .description,\\n      .due {\\n        font-size: 12px;\\n        color: var(--secondary-text-color);\\n      }\\n\\n      .description {\\n        white-space: initial;\\n        overflow: hidden;\\n        display: -webkit-box;\\n        -webkit-line-clamp: 3;\\n        line-clamp: 3;\\n        -webkit-box-orient: vertical;\\n      }\\n\\n      .description p {\\n        margin: 0;\\n      }\\n\\n      .description a {\\n        color: var(--primary-color);\\n      }\\n\\n      .due {\\n        display: flex;\\n        align-items: center;\\n      }\\n\\n      .due ha-svg-icon {\\n        margin-right: 4px;\\n        margin-inline-end: 4px;\\n        margin-inline-start: initial;\\n        --mdc-icon-size: 14px;\\n      }\\n\\n      .due.overdue {\\n        color: var(--warning-color);\\n      }\\n\\n      .completed .due.overdue {\\n        color: var(--secondary-text-color);\\n      }\\n\\n      .handle {\\n        cursor: move; /* fallback if grab cursor is unsupported */\\n        cursor: grab;\\n        height: 24px;\\n        padding: 16px 4px;\\n      }\\n\\n      .deleteItemButton {\\n        position: relative;\\n        left: 8px;\\n      }\\n\\n      ha-textfield {\\n        flex-grow: 1;\\n      }\\n\\n      .divider {\\n        height: 1px;\\n        background-color: var(--divider-color);\\n        margin: 10px 0;\\n      }\\n\\n      .clearall {\\n        cursor: pointer;\\n      }\\n\\n      .todoList {\\n        display: block;\\n        padding: 8px;\\n      }\\n\\n      .warning {\\n        color: var(--error-color);\\n      }\\n    \"])));\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["mdiClock","mdiDelete","mdiDeleteSweep","mdiDotsVertical","mdiDrag","mdiPlus","mdiSort","endOfDay","isSameDay","LitElement","css","html","nothing","customElement","property","state","classMap","repeat","memoizeOne","applyThemesOnElement","supportsFeature","isUnavailableState","TodoItemStatus","TodoListEntityFeature","createItem","deleteItems","moveItem","subscribeItems","updateItem","showConfirmationDialog","showTodoItemEditDialog","findEntities","createEntityNotFoundWarning","HuiTodoListCard","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","static","key","value","_getConfigElement","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","document","createElement","stop","getConfigElement","apply","getStubConfig","hass","entities","entitiesFallback","includeDomains","maxEntities","foundEntities","type","entity","decorators","attribute","connectedCallback","_get","_getPrototypeOf","prototype","call","hasUpdated","_subscribeItems","disconnectedCallback","_this$_unsubItems","_unsubItems","then","unsub","getCardSize","_config","title","setConfig","config","checkConfig","_entityId","split","Error","getEntityId","undefined","items","filter","item","status","Completed","NeedsAction","willUpdate","changedProperties","has","_items","updated","changedProps","oldHass","get","oldConfig","themes","theme","render","stateObj","states","_templateObject","_taggedTemplateLiteral","unavailable","checkedItems","_getCheckedItems","uncheckedItems","_getUncheckedItems","_templateObject2","todoListSupportsFeature","CREATE_TODO_ITEM","_templateObject3","localize","_addKeyPress","_addItem","_reordering","_itemMoved","_templateObject4","MOVE_TODO_ITEM","_templateObject5","_toggleReorder","_renderItems","_templateObject6","_templateObject7","DELETE_TODO_ITEM","_templateObject8","_clearCompletedItems","_this2","_templateObject9","uid","showDelete","UPDATE_TODO_ITEM","showReorder","due","includes","Date","today","_templateObject10","draggable","completed","multiline","Boolean","description","_completeItem","_openItem","_requestSelected","_handleKeydown","summary","_templateObject11","_templateObject12","_templateObject13","_templateObject14","_templateObject15","_deleteItem","feature","entityStateObj","_subscribeItems2","_callee2","_this3","_callee2$","_context2","update","_getItem","itemId","_this$_items","find","ev","stopPropagation","composedPath","el","localName","currentTarget","_completeItem2","_callee3","focusedIndex","list","_callee3$","_context3","renderRoot","querySelector","getFocusedItemIndex","updateComplete","focusItemAtIndex","_x","_clearCompletedItems2","_callee4","_this4","uids","_callee4$","_context4","map","text","number","dismissText","confirmText","destructive","confirm","_newItem","shadowRoot","newItem","focus","target","_toggleReorder2","_callee5","_callee5$","_context5","_itemMoved2","_callee6","_ev$detail","oldIndex","newIndex","_callee6$","_context6","detail","_moveItem","_x2","_moveItem2","_callee7","_prevItem","prevItem","itemIndex","prevIndex","_callee7$","_context7","findIndex","itm","splice","unshift","_toConsumableArray","_x3","_x4","styles","_templateObject16"],"sources":["/workspaces/frontend/src/panels/lovelace/cards/hui-todo-list-card.ts"],"sourcesContent":["import \"@material/mwc-list/mwc-list\";\nimport type { List } from \"@material/mwc-list/mwc-list\";\nimport {\n  mdiClock,\n  mdiDelete,\n  mdiDeleteSweep,\n  mdiDotsVertical,\n  mdiDrag,\n  mdiPlus,\n  mdiSort,\n} from \"@mdi/js\";\nimport { endOfDay, isSameDay } from \"date-fns\";\nimport { UnsubscribeFunc } from \"home-assistant-js-websocket\";\nimport {\n  CSSResultGroup,\n  LitElement,\n  PropertyValueMap,\n  PropertyValues,\n  css,\n  html,\n  nothing,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { repeat } from \"lit/directives/repeat\";\nimport memoizeOne from \"memoize-one\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { supportsFeature } from \"../../../common/entity/supports-feature\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-check-list-item\";\nimport \"../../../components/ha-checkbox\";\nimport \"../../../components/ha-icon-button\";\nimport \"../../../components/ha-list-item\";\nimport \"../../../components/ha-markdown-element\";\nimport \"../../../components/ha-relative-time\";\nimport \"../../../components/ha-select\";\nimport \"../../../components/ha-sortable\";\nimport \"../../../components/ha-svg-icon\";\nimport \"../../../components/ha-textfield\";\nimport type { HaTextField } from \"../../../components/ha-textfield\";\nimport { isUnavailableState } from \"../../../data/entity\";\nimport {\n  TodoItem,\n  TodoItemStatus,\n  TodoListEntityFeature,\n  createItem,\n  deleteItems,\n  moveItem,\n  subscribeItems,\n  updateItem,\n} from \"../../../data/todo\";\nimport { showConfirmationDialog } from \"../../../dialogs/generic/show-dialog-box\";\nimport { HomeAssistant } from \"../../../types\";\nimport { showTodoItemEditDialog } from \"../../todo/show-dialog-todo-item-editor\";\nimport { findEntities } from \"../common/find-entities\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { TodoListCardConfig } from \"./types\";\n\n@customElement(\"hui-todo-list-card\")\nexport class HuiTodoListCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-todo-list-editor\");\n    return document.createElement(\"hui-todo-list-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): TodoListCardConfig {\n    const includeDomains = [\"todo\"];\n    const maxEntities = 1;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      includeDomains\n    );\n\n    return { type: \"todo-list\", entity: foundEntities[0] || \"\" };\n  }\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: TodoListCardConfig;\n\n  @state() private _entityId?: string;\n\n  @state() private _items?: TodoItem[];\n\n  @state() private _reordering = false;\n\n  private _unsubItems?: Promise<UnsubscribeFunc>;\n\n  connectedCallback(): void {\n    super.connectedCallback();\n    if (this.hasUpdated) {\n      this._subscribeItems();\n    }\n  }\n\n  disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._unsubItems?.then((unsub) => unsub());\n  }\n\n  public getCardSize(): number {\n    return (this._config ? (this._config.title ? 2 : 0) : 0) + 3;\n  }\n\n  public setConfig(config: TodoListCardConfig): void {\n    this.checkConfig(config);\n\n    this._config = config;\n    this._entityId = config.entity;\n  }\n\n  protected checkConfig(config: TodoListCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"todo\") {\n      throw new Error(\"Specify an entity from within the todo domain\");\n    }\n  }\n\n  protected getEntityId(): string | undefined {\n    // not implemented, todo list should always have an entity id set;\n    return undefined;\n  }\n\n  private _getCheckedItems = memoizeOne((items?: TodoItem[]): TodoItem[] =>\n    items\n      ? items.filter((item) => item.status === TodoItemStatus.Completed)\n      : []\n  );\n\n  private _getUncheckedItems = memoizeOne((items?: TodoItem[]): TodoItem[] =>\n    items\n      ? items.filter((item) => item.status === TodoItemStatus.NeedsAction)\n      : []\n  );\n\n  public willUpdate(\n    changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>\n  ): void {\n    if (!this.hasUpdated) {\n      if (!this._entityId) {\n        this._entityId = this.getEntityId();\n      }\n      this._subscribeItems();\n    } else if (changedProperties.has(\"_entityId\") || !this._items) {\n      this._items = undefined;\n      this._subscribeItems();\n    }\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | TodoListCardConfig\n      | undefined;\n\n    if (\n      (changedProps.has(\"hass\") && oldHass?.themes !== this.hass.themes) ||\n      (changedProps.has(\"_config\") && oldConfig?.theme !== this._config.theme)\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  protected render() {\n    if (!this._config || !this.hass || !this._entityId) {\n      return nothing;\n    }\n\n    const stateObj = this.hass.states[this._entityId];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._entityId)}\n        </hui-warning>\n      `;\n    }\n\n    const unavailable = isUnavailableState(stateObj.state);\n\n    const checkedItems = this._getCheckedItems(this._items);\n    const uncheckedItems = this._getUncheckedItems(this._items);\n\n    return html`\n      <ha-card\n        .header=${this._config.title}\n        class=${classMap({\n          \"has-header\": \"title\" in this._config,\n        })}\n      >\n        <div class=\"addRow\">\n          ${this.todoListSupportsFeature(TodoListEntityFeature.CREATE_TODO_ITEM)\n            ? html`\n                <ha-textfield\n                  class=\"addBox\"\n                  .placeholder=${this.hass!.localize(\n                    \"ui.panel.lovelace.cards.todo-list.add_item\"\n                  )}\n                  @keydown=${this._addKeyPress}\n                  .disabled=${unavailable}\n                ></ha-textfield>\n                <ha-icon-button\n                  class=\"addButton\"\n                  .path=${mdiPlus}\n                  .title=${this.hass!.localize(\n                    \"ui.panel.lovelace.cards.todo-list.add_item\"\n                  )}\n                  .disabled=${unavailable}\n                  @click=${this._addItem}\n                >\n                </ha-icon-button>\n              `\n            : nothing}\n        </div>\n        <ha-sortable\n          handle-selector=\"ha-svg-icon\"\n          draggable-selector=\".draggable\"\n          .disabled=${!this._reordering}\n          @item-moved=${this._itemMoved}\n        >\n          <mwc-list wrapFocus multi>\n            ${uncheckedItems.length\n              ? html`\n                  <div class=\"header\" role=\"seperator\">\n                    <h2>\n                      ${this.hass!.localize(\n                        \"ui.panel.lovelace.cards.todo-list.unchecked_items\"\n                      )}\n                    </h2>\n                    ${this.todoListSupportsFeature(\n                      TodoListEntityFeature.MOVE_TODO_ITEM\n                    )\n                      ? html`<ha-button-menu>\n                          <ha-icon-button\n                            slot=\"trigger\"\n                            .path=${mdiDotsVertical}\n                          ></ha-icon-button>\n                          <ha-list-item\n                            @click=${this._toggleReorder}\n                            graphic=\"icon\"\n                          >\n                            ${this.hass!.localize(\n                              this._reordering\n                                ? \"ui.panel.lovelace.cards.todo-list.exit_reorder_items\"\n                                : \"ui.panel.lovelace.cards.todo-list.reorder_items\"\n                            )}\n                            <ha-svg-icon\n                              slot=\"graphic\"\n                              .path=${mdiSort}\n                              .disabled=${unavailable}\n                            >\n                            </ha-svg-icon>\n                          </ha-list-item>\n                        </ha-button-menu>`\n                      : nothing}\n                  </div>\n                  ${this._renderItems(uncheckedItems, unavailable)}\n                `\n              : html`<p class=\"empty\">\n                  ${this.hass.localize(\n                    \"ui.panel.lovelace.cards.todo-list.no_unchecked_items\"\n                  )}\n                </p>`}\n            ${checkedItems.length\n              ? html`\n                  <div role=\"separator\">\n                    <div class=\"divider\"></div>\n                    <div class=\"header\">\n                      <h2>\n                        ${this.hass!.localize(\n                          \"ui.panel.lovelace.cards.todo-list.checked_items\"\n                        )}\n                      </h2>\n                      ${this.todoListSupportsFeature(\n                        TodoListEntityFeature.DELETE_TODO_ITEM\n                      )\n                        ? html`<ha-button-menu>\n                            <ha-icon-button\n                              slot=\"trigger\"\n                              .path=${mdiDotsVertical}\n                            ></ha-icon-button>\n                            <ha-list-item\n                              @click=${this._clearCompletedItems}\n                              graphic=\"icon\"\n                              class=\"warning\"\n                            >\n                              ${this.hass!.localize(\n                                \"ui.panel.lovelace.cards.todo-list.clear_items\"\n                              )}\n                              <ha-svg-icon\n                                class=\"warning\"\n                                slot=\"graphic\"\n                                .path=${mdiDeleteSweep}\n                                .disabled=${unavailable}\n                              >\n                              </ha-svg-icon>\n                            </ha-list-item>\n                          </ha-button-menu>`\n                        : nothing}\n                    </div>\n                  </div>\n                  ${this._renderItems(checkedItems, unavailable)}\n                `\n              : \"\"}\n          </mwc-list>\n        </ha-sortable>\n      </ha-card>\n    `;\n  }\n\n  private _renderItems(items: TodoItem[], unavailable = false) {\n    return html`\n      ${repeat(\n        items,\n        (item) => item.uid,\n        (item) => {\n          const showDelete =\n            this.todoListSupportsFeature(\n              TodoListEntityFeature.DELETE_TODO_ITEM\n            ) &&\n            !this.todoListSupportsFeature(\n              TodoListEntityFeature.UPDATE_TODO_ITEM\n            );\n          const showReorder =\n            item.status !== TodoItemStatus.Completed && this._reordering;\n          const due = item.due\n            ? item.due.includes(\"T\")\n              ? new Date(item.due)\n              : endOfDay(new Date(`${item.due}T00:00:00`))\n            : undefined;\n          const today =\n            due && !item.due!.includes(\"T\") && isSameDay(new Date(), due);\n          return html`\n            <ha-check-list-item\n              left\n              .hasMeta=${showReorder || showDelete}\n              class=\"editRow ${classMap({\n                draggable: item.status === TodoItemStatus.NeedsAction,\n                completed: item.status === TodoItemStatus.Completed,\n                multiline: Boolean(item.description || item.due),\n              })}\"\n              .selected=${item.status === TodoItemStatus.Completed}\n              .disabled=${unavailable ||\n              !this.todoListSupportsFeature(\n                TodoListEntityFeature.UPDATE_TODO_ITEM\n              )}\n              item-id=${item.uid}\n              .itemId=${item.uid}\n              @change=${this._completeItem}\n              @click=${this._openItem}\n              @request-selected=${this._requestSelected}\n              @keydown=${this._handleKeydown}\n            >\n              <div class=\"column\">\n                <span class=\"summary\">${item.summary}</span>\n                ${item.description\n                  ? html`<ha-markdown-element\n                      class=\"description\"\n                      .content=${item.description}\n                    ></ha-markdown-element>`\n                  : nothing}\n                ${due\n                  ? html`<div class=\"due ${due < new Date() ? \"overdue\" : \"\"}\">\n                      <ha-svg-icon .path=${mdiClock}></ha-svg-icon>${today\n                        ? this.hass!.localize(\n                            \"ui.panel.lovelace.cards.todo-list.today\"\n                          )\n                        : html`<ha-relative-time\n                            capitalize\n                            .hass=${this.hass}\n                            .datetime=${due}\n                          ></ha-relative-time>`}\n                    </div>`\n                  : nothing}\n              </div>\n              ${showReorder\n                ? html`\n                    <ha-svg-icon\n                      .title=${this.hass!.localize(\n                        \"ui.panel.lovelace.cards.todo-list.drag_and_drop\"\n                      )}\n                      class=\"reorderButton handle\"\n                      .path=${mdiDrag}\n                      slot=\"meta\"\n                    >\n                    </ha-svg-icon>\n                  `\n                : showDelete\n                  ? html`<ha-icon-button\n                      .title=${this.hass!.localize(\n                        \"ui.panel.lovelace.cards.todo-list.delete_item\"\n                      )}\n                      class=\"deleteItemButton\"\n                      .path=${mdiDelete}\n                      .itemId=${item.uid}\n                      slot=\"meta\"\n                      @click=${this._deleteItem}\n                    >\n                    </ha-icon-button>`\n                  : nothing}\n            </ha-check-list-item>\n          `;\n        }\n      )}\n    `;\n  }\n\n  private todoListSupportsFeature(feature: number): boolean {\n    const entityStateObj = this.hass!.states[this._entityId!];\n    return entityStateObj && supportsFeature(entityStateObj, feature);\n  }\n\n  private async _subscribeItems(): Promise<void> {\n    if (this._unsubItems) {\n      this._unsubItems.then((unsub) => unsub());\n      this._unsubItems = undefined;\n    }\n    if (!this.hass || !this._entityId) {\n      return;\n    }\n    if (!(this._entityId in this.hass.states)) {\n      return;\n    }\n    this._unsubItems = subscribeItems(this.hass!, this._entityId, (update) => {\n      this._items = update.items;\n    });\n  }\n\n  private _getItem(itemId: string) {\n    return this._items?.find((item) => item.uid === itemId);\n  }\n\n  private _requestSelected(ev: Event): void {\n    ev.stopPropagation();\n  }\n\n  private _handleKeydown(ev) {\n    if (ev.key === \" \") {\n      this._completeItem(ev);\n      return;\n    }\n    if (ev.key === \"Enter\") {\n      this._openItem(ev);\n    }\n  }\n\n  private _openItem(ev): void {\n    ev.stopPropagation();\n\n    if (\n      ev\n        .composedPath()\n        .find((el) => [\"input\", \"a\", \"button\"].includes(el.localName))\n    ) {\n      return;\n    }\n\n    const item = this._getItem(ev.currentTarget.itemId);\n    showTodoItemEditDialog(this, {\n      entity: this._config!.entity!,\n      item,\n    });\n  }\n\n  private async _completeItem(ev): Promise<void> {\n    let focusedIndex: number | undefined;\n    let list: List | undefined;\n    if (ev.type === \"keydown\") {\n      list = this.renderRoot.querySelector(\"mwc-list\")!;\n      focusedIndex = list.getFocusedItemIndex();\n    }\n    const item = this._getItem(ev.currentTarget.itemId);\n    if (!item) {\n      return;\n    }\n    await updateItem(this.hass!, this._entityId!, {\n      uid: item.uid,\n      summary: item.summary,\n      status:\n        item.status === TodoItemStatus.NeedsAction\n          ? TodoItemStatus.Completed\n          : TodoItemStatus.NeedsAction,\n    });\n    if (focusedIndex !== undefined && list) {\n      await this.updateComplete;\n      await list.updateComplete;\n      list.focusItemAtIndex(focusedIndex);\n    }\n  }\n\n  private async _clearCompletedItems(): Promise<void> {\n    if (!this.hass) {\n      return;\n    }\n    const checkedItems = this._getCheckedItems(this._items);\n    const uids = checkedItems.map((item: TodoItem) => item.uid);\n    showConfirmationDialog(this, {\n      title: this.hass.localize(\n        \"ui.panel.lovelace.cards.todo-list.delete_confirm_title\"\n      ),\n      text: this.hass.localize(\n        \"ui.panel.lovelace.cards.todo-list.delete_confirm_text\",\n        { number: uids.length }\n      ),\n      dismissText: this.hass.localize(\"ui.common.cancel\"),\n      confirmText: this.hass.localize(\"ui.common.delete\"),\n      destructive: true,\n      confirm: () => {\n        deleteItems(this.hass!, this._entityId!, uids);\n      },\n    });\n  }\n\n  private get _newItem(): HaTextField {\n    return this.shadowRoot!.querySelector(\".addBox\") as HaTextField;\n  }\n\n  private _addItem(ev): void {\n    const newItem = this._newItem;\n    if (newItem.value!.length > 0) {\n      createItem(this.hass!, this._entityId!, {\n        summary: newItem.value!,\n      });\n    }\n\n    newItem.value = \"\";\n    if (ev) {\n      newItem.focus();\n    }\n  }\n\n  private _deleteItem(ev): void {\n    const item = this._getItem(ev.target.itemId);\n    if (!item) {\n      return;\n    }\n    deleteItems(this.hass!, this._entityId!, [item.uid]);\n  }\n\n  private _addKeyPress(ev): void {\n    if (ev.key === \"Enter\") {\n      this._addItem(null);\n    }\n  }\n\n  private async _toggleReorder() {\n    this._reordering = !this._reordering;\n  }\n\n  private async _itemMoved(ev: CustomEvent) {\n    ev.stopPropagation();\n    const { oldIndex, newIndex } = ev.detail;\n    this._moveItem(oldIndex, newIndex);\n  }\n\n  private async _moveItem(oldIndex: number, newIndex: number) {\n    // correct index for header\n    oldIndex -= 1;\n    newIndex -= 1;\n    const uncheckedItems = this._getUncheckedItems(this._items);\n    const item = uncheckedItems[oldIndex];\n    let prevItem: TodoItem | undefined;\n    if (newIndex > 0) {\n      if (newIndex < oldIndex) {\n        prevItem = uncheckedItems[newIndex - 1];\n      } else {\n        prevItem = uncheckedItems[newIndex];\n      }\n    }\n\n    // Optimistic change\n    const itemIndex = this._items!.findIndex((itm) => itm.uid === item.uid);\n    this._items!.splice(itemIndex, 1);\n    if (newIndex === 0) {\n      this._items!.unshift(item);\n    } else {\n      const prevIndex = this._items!.findIndex(\n        (itm) => itm.uid === prevItem!.uid\n      );\n      this._items!.splice(prevIndex + 1, 0, item);\n    }\n    this._items = [...this._items!];\n\n    await moveItem(this.hass!, this._entityId!, item.uid, prevItem?.uid);\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ha-card {\n        height: 100%;\n        box-sizing: border-box;\n      }\n\n      .has-header {\n        padding-top: 0;\n      }\n\n      .addRow {\n        padding: 16px;\n        padding-bottom: 0;\n        position: relative;\n      }\n\n      .addRow ha-icon-button {\n        position: absolute;\n        right: 16px;\n        inset-inline-start: initial;\n        inset-inline-end: 16px;\n      }\n\n      .addRow,\n      .header {\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n      }\n\n      .header {\n        padding-left: 30px;\n        padding-right: 16px;\n        padding-inline-start: 30px;\n        padding-inline-end: 16px;\n        margin-top: 8px;\n        justify-content: space-between;\n        direction: var(--direction);\n      }\n\n      .header h2 {\n        color: var(--primary-text-color);\n        font-size: inherit;\n        font-weight: 500;\n      }\n\n      .empty {\n        padding: 16px 32px;\n        display: inline-block;\n      }\n\n      .item {\n        margin-top: 8px;\n      }\n\n      ha-check-list-item {\n        --mdc-list-item-meta-size: 56px;\n        min-height: 56px;\n        height: auto;\n      }\n\n      ha-check-list-item.multiline {\n        align-items: flex-start;\n        --check-list-item-graphic-margin-top: 8px;\n      }\n\n      .row {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .multiline .column {\n        display: flex;\n        flex-direction: column;\n        margin-top: 18px;\n        margin-bottom: 12px;\n      }\n\n      .completed .summary {\n        text-decoration: line-through;\n      }\n\n      .description,\n      .due {\n        font-size: 12px;\n        color: var(--secondary-text-color);\n      }\n\n      .description {\n        white-space: initial;\n        overflow: hidden;\n        display: -webkit-box;\n        -webkit-line-clamp: 3;\n        line-clamp: 3;\n        -webkit-box-orient: vertical;\n      }\n\n      .description p {\n        margin: 0;\n      }\n\n      .description a {\n        color: var(--primary-color);\n      }\n\n      .due {\n        display: flex;\n        align-items: center;\n      }\n\n      .due ha-svg-icon {\n        margin-right: 4px;\n        margin-inline-end: 4px;\n        margin-inline-start: initial;\n        --mdc-icon-size: 14px;\n      }\n\n      .due.overdue {\n        color: var(--warning-color);\n      }\n\n      .completed .due.overdue {\n        color: var(--secondary-text-color);\n      }\n\n      .handle {\n        cursor: move; /* fallback if grab cursor is unsupported */\n        cursor: grab;\n        height: 24px;\n        padding: 16px 4px;\n      }\n\n      .deleteItemButton {\n        position: relative;\n        left: 8px;\n      }\n\n      ha-textfield {\n        flex-grow: 1;\n      }\n\n      .divider {\n        height: 1px;\n        background-color: var(--divider-color);\n        margin: 10px 0;\n      }\n\n      .clearall {\n        cursor: pointer;\n      }\n\n      .todoList {\n        display: block;\n        padding: 8px;\n      }\n\n      .warning {\n        color: var(--error-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-todo-list-card\": HuiTodoListCard;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}