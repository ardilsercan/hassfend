{"ast":null,"code":"import { ensureArray } from \"../../../common/array/ensure-array\";\nimport { UNAVAILABLE } from \"../../../data/entity\";\nfunction checkStateCondition(condition, hass) {\n  const state = condition.entity && hass.states[condition.entity] ? hass.states[condition.entity].state : UNAVAILABLE;\n  return condition.state != null ? ensureArray(condition.state).includes(state) : !ensureArray(condition.state_not).includes(state);\n}\nfunction checkStateNumericCondition(condition, hass) {\n  var _ref;\n  const entity = (_ref = condition.entity ? hass.states[condition.entity] : undefined) !== null && _ref !== void 0 ? _ref : undefined;\n  if (!entity) {\n    return false;\n  }\n  const numericState = Number(entity.state);\n  if (isNaN(numericState)) {\n    return false;\n  }\n  return (condition.above == null || condition.above < numericState) && (condition.below == null || condition.below > numericState);\n}\nfunction checkScreenCondition(condition, _) {\n  return condition.media_query ? matchMedia(condition.media_query).matches : false;\n}\nfunction checkUserCondition(condition, hass) {\n  var _hass$user;\n  return condition.users && (_hass$user = hass.user) !== null && _hass$user !== void 0 && _hass$user.id ? condition.users.includes(hass.user.id) : false;\n}\nfunction checkAndCondition(condition, hass) {\n  if (!condition.conditions) return true;\n  return checkConditionsMet(condition.conditions, hass);\n}\nfunction checkOrCondition(condition, hass) {\n  if (!condition.conditions) return true;\n  return condition.conditions.some(c => checkConditionsMet([c], hass));\n}\nexport function checkConditionsMet(conditions, hass) {\n  return conditions.every(c => {\n    if (\"condition\" in c) {\n      switch (c.condition) {\n        case \"screen\":\n          return checkScreenCondition(c, hass);\n        case \"user\":\n          return checkUserCondition(c, hass);\n        case \"numeric_state\":\n          return checkStateNumericCondition(c, hass);\n        case \"and\":\n          return checkAndCondition(c, hass);\n        case \"or\":\n          return checkOrCondition(c, hass);\n        default:\n          return checkStateCondition(c, hass);\n      }\n    }\n    return checkStateCondition(c, hass);\n  });\n}\nfunction validateStateCondition(condition) {\n  return condition.entity != null && (condition.state != null || condition.state_not != null);\n}\nfunction validateScreenCondition(condition) {\n  return condition.media_query != null;\n}\nfunction validateUserCondition(condition) {\n  return condition.users != null;\n}\nfunction validateAndCondition(condition) {\n  return condition.conditions != null;\n}\nfunction validateOrCondition(condition) {\n  return condition.conditions != null;\n}\nfunction validateNumericStateCondition(condition) {\n  return condition.entity != null && (condition.above != null || condition.below != null);\n}\nexport function validateConditionalConfig(conditions) {\n  return conditions.every(c => {\n    if (\"condition\" in c) {\n      switch (c.condition) {\n        case \"screen\":\n          return validateScreenCondition(c);\n        case \"user\":\n          return validateUserCondition(c);\n        case \"numeric_state\":\n          return validateNumericStateCondition(c);\n        case \"and\":\n          return validateAndCondition(c);\n        case \"or\":\n          return validateOrCondition(c);\n        default:\n          return validateStateCondition(c);\n      }\n    }\n    return validateStateCondition(c);\n  });\n}","map":{"version":3,"names":["ensureArray","UNAVAILABLE","checkStateCondition","condition","hass","state","entity","states","includes","state_not","checkStateNumericCondition","_ref","undefined","numericState","Number","isNaN","above","below","checkScreenCondition","_","media_query","matchMedia","matches","checkUserCondition","_hass$user","users","user","id","checkAndCondition","conditions","checkConditionsMet","checkOrCondition","some","c","every","validateStateCondition","validateScreenCondition","validateUserCondition","validateAndCondition","validateOrCondition","validateNumericStateCondition","validateConditionalConfig"],"sources":["/Users/sercanardil/Desktop/frontend/src/panels/lovelace/common/validate-condition.ts"],"sourcesContent":["import { ensureArray } from \"../../../common/array/ensure-array\";\nimport { UNAVAILABLE } from \"../../../data/entity\";\nimport { HomeAssistant } from \"../../../types\";\n\nexport type Condition =\n  | NumericStateCondition\n  | ScreenCondition\n  | StateCondition\n  | UserCondition\n  | OrCondition\n  | AndCondition;\n\nexport type LegacyCondition = {\n  entity?: string;\n  state?: string | string[];\n  state_not?: string | string[];\n};\n\nexport type NumericStateCondition = {\n  condition: \"numeric_state\";\n  entity?: string;\n  below?: number;\n  above?: number;\n};\n\nexport type StateCondition = {\n  condition: \"state\";\n  entity?: string;\n  state?: string | string[];\n  state_not?: string | string[];\n};\n\nexport type ScreenCondition = {\n  condition: \"screen\";\n  media_query?: string;\n};\n\nexport type UserCondition = {\n  condition: \"user\";\n  users?: string[];\n};\n\nexport type OrCondition = {\n  condition: \"or\";\n  conditions?: Condition[];\n};\n\nexport type AndCondition = {\n  condition: \"and\";\n  conditions?: Condition[];\n};\n\nfunction checkStateCondition(\n  condition: StateCondition | LegacyCondition,\n  hass: HomeAssistant\n) {\n  const state =\n    condition.entity && hass.states[condition.entity]\n      ? hass.states[condition.entity].state\n      : UNAVAILABLE;\n\n  return condition.state != null\n    ? ensureArray(condition.state).includes(state)\n    : !ensureArray(condition.state_not).includes(state);\n}\n\nfunction checkStateNumericCondition(\n  condition: NumericStateCondition,\n  hass: HomeAssistant\n) {\n  const entity =\n    (condition.entity ? hass.states[condition.entity] : undefined) ?? undefined;\n\n  if (!entity) {\n    return false;\n  }\n\n  const numericState = Number(entity.state);\n\n  if (isNaN(numericState)) {\n    return false;\n  }\n\n  return (\n    (condition.above == null || condition.above < numericState) &&\n    (condition.below == null || condition.below > numericState)\n  );\n}\n\nfunction checkScreenCondition(condition: ScreenCondition, _: HomeAssistant) {\n  return condition.media_query\n    ? matchMedia(condition.media_query).matches\n    : false;\n}\n\nfunction checkUserCondition(condition: UserCondition, hass: HomeAssistant) {\n  return condition.users && hass.user?.id\n    ? condition.users.includes(hass.user.id)\n    : false;\n}\n\nfunction checkAndCondition(condition: AndCondition, hass: HomeAssistant) {\n  if (!condition.conditions) return true;\n  return checkConditionsMet(condition.conditions, hass);\n}\n\nfunction checkOrCondition(condition: OrCondition, hass: HomeAssistant) {\n  if (!condition.conditions) return true;\n  return condition.conditions.some((c) => checkConditionsMet([c], hass));\n}\n\nexport function checkConditionsMet(\n  conditions: (Condition | LegacyCondition)[],\n  hass: HomeAssistant\n): boolean {\n  return conditions.every((c) => {\n    if (\"condition\" in c) {\n      switch (c.condition) {\n        case \"screen\":\n          return checkScreenCondition(c, hass);\n        case \"user\":\n          return checkUserCondition(c, hass);\n        case \"numeric_state\":\n          return checkStateNumericCondition(c, hass);\n        case \"and\":\n          return checkAndCondition(c, hass);\n        case \"or\":\n          return checkOrCondition(c, hass);\n        default:\n          return checkStateCondition(c, hass);\n      }\n    }\n    return checkStateCondition(c, hass);\n  });\n}\n\nfunction validateStateCondition(condition: StateCondition | LegacyCondition) {\n  return (\n    condition.entity != null &&\n    (condition.state != null || condition.state_not != null)\n  );\n}\n\nfunction validateScreenCondition(condition: ScreenCondition) {\n  return condition.media_query != null;\n}\n\nfunction validateUserCondition(condition: UserCondition) {\n  return condition.users != null;\n}\n\nfunction validateAndCondition(condition: AndCondition) {\n  return condition.conditions != null;\n}\n\nfunction validateOrCondition(condition: OrCondition) {\n  return condition.conditions != null;\n}\n\nfunction validateNumericStateCondition(condition: NumericStateCondition) {\n  return (\n    condition.entity != null &&\n    (condition.above != null || condition.below != null)\n  );\n}\n\nexport function validateConditionalConfig(\n  conditions: (Condition | LegacyCondition)[]\n): boolean {\n  return conditions.every((c) => {\n    if (\"condition\" in c) {\n      switch (c.condition) {\n        case \"screen\":\n          return validateScreenCondition(c);\n        case \"user\":\n          return validateUserCondition(c);\n        case \"numeric_state\":\n          return validateNumericStateCondition(c);\n        case \"and\":\n          return validateAndCondition(c);\n        case \"or\":\n          return validateOrCondition(c);\n        default:\n          return validateStateCondition(c);\n      }\n    }\n    return validateStateCondition(c);\n  });\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}