{"ast":null,"code":"/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { __assign, __extends } from \"tslib\";\nimport { MDCFoundation } from '@material/base/foundation';\nimport { cssClasses as listCssClasses } from '@material/list/constants';\nimport { MDCMenuSurfaceFoundation } from '@material/menu-surface/foundation';\nimport { cssClasses, DefaultFocusState, numbers, strings } from './constants';\nvar MDCMenuFoundation = /** @class */function (_super) {\n  __extends(MDCMenuFoundation, _super);\n  function MDCMenuFoundation(adapter) {\n    var _this = _super.call(this, __assign(__assign({}, MDCMenuFoundation.defaultAdapter), adapter)) || this;\n    _this.closeAnimationEndTimerId = 0;\n    _this.defaultFocusState = DefaultFocusState.LIST_ROOT;\n    _this.selectedIndex = -1;\n    return _this;\n  }\n  Object.defineProperty(MDCMenuFoundation, \"cssClasses\", {\n    get: function () {\n      return cssClasses;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(MDCMenuFoundation, \"strings\", {\n    get: function () {\n      return strings;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(MDCMenuFoundation, \"numbers\", {\n    get: function () {\n      return numbers;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(MDCMenuFoundation, \"defaultAdapter\", {\n    /**\n     * @see {@link MDCMenuAdapter} for typing information on parameters and return types.\n     */\n    get: function () {\n      // tslint:disable:object-literal-sort-keys Methods should be in the same order as the adapter interface.\n      return {\n        addClassToElementAtIndex: function () {\n          return undefined;\n        },\n        removeClassFromElementAtIndex: function () {\n          return undefined;\n        },\n        addAttributeToElementAtIndex: function () {\n          return undefined;\n        },\n        removeAttributeFromElementAtIndex: function () {\n          return undefined;\n        },\n        getAttributeFromElementAtIndex: function () {\n          return null;\n        },\n        elementContainsClass: function () {\n          return false;\n        },\n        closeSurface: function () {\n          return undefined;\n        },\n        getElementIndex: function () {\n          return -1;\n        },\n        notifySelected: function () {\n          return undefined;\n        },\n        getMenuItemCount: function () {\n          return 0;\n        },\n        focusItemAtIndex: function () {\n          return undefined;\n        },\n        focusListRoot: function () {\n          return undefined;\n        },\n        getSelectedSiblingOfItemAtIndex: function () {\n          return -1;\n        },\n        isSelectableItemAtIndex: function () {\n          return false;\n        }\n      };\n      // tslint:enable:object-literal-sort-keys\n    },\n    enumerable: false,\n    configurable: true\n  });\n  MDCMenuFoundation.prototype.destroy = function () {\n    if (this.closeAnimationEndTimerId) {\n      clearTimeout(this.closeAnimationEndTimerId);\n    }\n    this.adapter.closeSurface();\n  };\n  MDCMenuFoundation.prototype.handleKeydown = function (evt) {\n    var key = evt.key,\n      keyCode = evt.keyCode;\n    var isTab = key === 'Tab' || keyCode === 9;\n    if (isTab) {\n      this.adapter.closeSurface( /** skipRestoreFocus */true);\n    }\n  };\n  MDCMenuFoundation.prototype.handleItemAction = function (listItem) {\n    var _this = this;\n    var index = this.adapter.getElementIndex(listItem);\n    if (index < 0) {\n      return;\n    }\n    this.adapter.notifySelected({\n      index: index\n    });\n    var skipRestoreFocus = this.adapter.getAttributeFromElementAtIndex(index, strings.SKIP_RESTORE_FOCUS) === 'true';\n    this.adapter.closeSurface(skipRestoreFocus);\n    // Wait for the menu to close before adding/removing classes that affect styles.\n    this.closeAnimationEndTimerId = setTimeout(function () {\n      // Recompute the index in case the menu contents have changed.\n      var recomputedIndex = _this.adapter.getElementIndex(listItem);\n      if (recomputedIndex >= 0 && _this.adapter.isSelectableItemAtIndex(recomputedIndex)) {\n        _this.setSelectedIndex(recomputedIndex);\n      }\n    }, MDCMenuSurfaceFoundation.numbers.TRANSITION_CLOSE_DURATION);\n  };\n  MDCMenuFoundation.prototype.handleMenuSurfaceOpened = function () {\n    switch (this.defaultFocusState) {\n      case DefaultFocusState.FIRST_ITEM:\n        this.adapter.focusItemAtIndex(0);\n        break;\n      case DefaultFocusState.LAST_ITEM:\n        this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount() - 1);\n        break;\n      case DefaultFocusState.NONE:\n        // Do nothing.\n        break;\n      default:\n        this.adapter.focusListRoot();\n        break;\n    }\n  };\n  /**\n   * Sets default focus state where the menu should focus every time when menu\n   * is opened. Focuses the list root (`DefaultFocusState.LIST_ROOT`) element by\n   * default.\n   */\n  MDCMenuFoundation.prototype.setDefaultFocusState = function (focusState) {\n    this.defaultFocusState = focusState;\n  };\n  /** @return Index of the currently selected list item within the menu. */\n  MDCMenuFoundation.prototype.getSelectedIndex = function () {\n    return this.selectedIndex;\n  };\n  /**\n   * Selects the list item at `index` within the menu.\n   * @param index Index of list item within the menu.\n   */\n  MDCMenuFoundation.prototype.setSelectedIndex = function (index) {\n    this.validatedIndex(index);\n    if (!this.adapter.isSelectableItemAtIndex(index)) {\n      throw new Error('MDCMenuFoundation: No selection group at specified index.');\n    }\n    var prevSelectedIndex = this.adapter.getSelectedSiblingOfItemAtIndex(index);\n    if (prevSelectedIndex >= 0) {\n      this.adapter.removeAttributeFromElementAtIndex(prevSelectedIndex, strings.ARIA_CHECKED_ATTR);\n      this.adapter.removeClassFromElementAtIndex(prevSelectedIndex, cssClasses.MENU_SELECTED_LIST_ITEM);\n    }\n    this.adapter.addClassToElementAtIndex(index, cssClasses.MENU_SELECTED_LIST_ITEM);\n    this.adapter.addAttributeToElementAtIndex(index, strings.ARIA_CHECKED_ATTR, 'true');\n    this.selectedIndex = index;\n  };\n  /**\n   * Sets the enabled state to isEnabled for the menu item at the given index.\n   * @param index Index of the menu item\n   * @param isEnabled The desired enabled state of the menu item.\n   */\n  MDCMenuFoundation.prototype.setEnabled = function (index, isEnabled) {\n    this.validatedIndex(index);\n    if (isEnabled) {\n      this.adapter.removeClassFromElementAtIndex(index, listCssClasses.LIST_ITEM_DISABLED_CLASS);\n      this.adapter.addAttributeToElementAtIndex(index, strings.ARIA_DISABLED_ATTR, 'false');\n    } else {\n      this.adapter.addClassToElementAtIndex(index, listCssClasses.LIST_ITEM_DISABLED_CLASS);\n      this.adapter.addAttributeToElementAtIndex(index, strings.ARIA_DISABLED_ATTR, 'true');\n    }\n  };\n  MDCMenuFoundation.prototype.validatedIndex = function (index) {\n    var menuSize = this.adapter.getMenuItemCount();\n    var isIndexInRange = index >= 0 && index < menuSize;\n    if (!isIndexInRange) {\n      throw new Error('MDCMenuFoundation: No list item at specified index.');\n    }\n  };\n  return MDCMenuFoundation;\n}(MDCFoundation);\nexport { MDCMenuFoundation };\n// tslint:disable-next-line:no-default-export Needed for backward compatibility with MDC Web v0.44.0 and earlier.\nexport default MDCMenuFoundation;","map":{"version":3,"names":["MDCFoundation","cssClasses","listCssClasses","MDCMenuSurfaceFoundation","DefaultFocusState","numbers","strings","MDCMenuFoundation","_super","__extends","adapter","_this","call","__assign","defaultAdapter","closeAnimationEndTimerId","defaultFocusState","LIST_ROOT","selectedIndex","Object","defineProperty","get","addClassToElementAtIndex","undefined","removeClassFromElementAtIndex","addAttributeToElementAtIndex","removeAttributeFromElementAtIndex","getAttributeFromElementAtIndex","elementContainsClass","closeSurface","getElementIndex","notifySelected","getMenuItemCount","focusItemAtIndex","focusListRoot","getSelectedSiblingOfItemAtIndex","isSelectableItemAtIndex","prototype","destroy","clearTimeout","handleKeydown","evt","key","keyCode","isTab","handleItemAction","listItem","index","skipRestoreFocus","SKIP_RESTORE_FOCUS","setTimeout","recomputedIndex","setSelectedIndex","TRANSITION_CLOSE_DURATION","handleMenuSurfaceOpened","FIRST_ITEM","LAST_ITEM","NONE","setDefaultFocusState","focusState","getSelectedIndex","validatedIndex","Error","prevSelectedIndex","ARIA_CHECKED_ATTR","MENU_SELECTED_LIST_ITEM","setEnabled","isEnabled","LIST_ITEM_DISABLED_CLASS","ARIA_DISABLED_ATTR","menuSize","isIndexInRange"],"sources":["foundation.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}