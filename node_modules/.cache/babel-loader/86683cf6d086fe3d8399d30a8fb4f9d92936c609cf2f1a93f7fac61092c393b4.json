{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nimport { LitElement, html, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { computeAttributeNameDisplay } from \"../../common/entity/compute_attribute_display\";\nimport \"../ha-combo-box\";\nlet HaEntityAttributePicker = _decorate([customElement(\"ha-entity-attribute-picker\")], function (_initialize, _LitElement) {\n  class HaEntityAttributePicker extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: HaEntityAttributePicker,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"entityId\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Array,\n        attribute: \"hide-attributes\"\n      })],\n      key: \"hideAttributes\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"autofocus\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"disabled\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"required\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean,\n        attribute: \"allow-custom-value\"\n      })],\n      key: \"allowCustomValue\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"label\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"value\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"helper\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_opened\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [query(\"ha-combo-box\", true)],\n      key: \"_comboBox\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"shouldUpdate\",\n      value:\n      /**\n       * List of attributes to be hidden.\n       * @type {Array}\n       * @attr hide-attributes\n       */\n\n      function shouldUpdate(changedProps) {\n        return !(!changedProps.has(\"_opened\") && this._opened);\n      }\n    }, {\n      kind: \"method\",\n      key: \"updated\",\n      value: function updated(changedProps) {\n        if (changedProps.has(\"_opened\") && this._opened) {\n          const entityState = this.entityId ? this.hass.states[this.entityId] : undefined;\n          this._comboBox.items = entityState ? Object.keys(entityState.attributes).filter(key => {\n            var _this$hideAttributes;\n            return !((_this$hideAttributes = this.hideAttributes) !== null && _this$hideAttributes !== void 0 && _this$hideAttributes.includes(key));\n          }).map(key => ({\n            value: key,\n            label: computeAttributeNameDisplay(this.hass.localize, entityState, this.hass.entities, key)\n          })) : [];\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        var _this$label;\n        if (!this.hass) {\n          return nothing;\n        }\n        return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        .value=${this.value ? computeAttributeNameDisplay(this.hass.localize, this.hass.states[this.entityId], this.hass.entities, this.value) : \"\"}\n        .autofocus=${this.autofocus}\n        .label=${(_this$label = this.label) !== null && _this$label !== void 0 ? _this$label : this.hass.localize(\"ui.components.entity.entity-attribute-picker.attribute\")}\n        .disabled=${this.disabled || !this.entityId}\n        .required=${this.required}\n        .helper=${this.helper}\n        .allowCustomValue=${this.allowCustomValue}\n        item-value-path=\"value\"\n        item-label-path=\"label\"\n        @opened-changed=${this._openedChanged}\n        @value-changed=${this._valueChanged}\n      >\n      </ha-combo-box>\n    `;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_openedChanged\",\n      value: function _openedChanged(ev) {\n        this._opened = ev.detail.value;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_valueChanged\",\n      value: function _valueChanged(ev) {\n        this.value = ev.detail.value;\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["LitElement","html","nothing","customElement","property","query","state","computeAttributeNameDisplay","HaEntityAttributePicker","_decorate","_initialize","_LitElement","constructor","args","F","d","kind","decorators","attribute","key","value","type","Array","Boolean","shouldUpdate","changedProps","has","_opened","updated","entityState","entityId","hass","states","undefined","_comboBox","items","Object","keys","attributes","filter","_this$hideAttributes","hideAttributes","includes","map","label","localize","entities","render","_this$label","autofocus","disabled","required","helper","allowCustomValue","_openedChanged","_valueChanged","ev","detail"],"sources":["/workspaces/frontend/src/components/entity/ha-entity-attribute-picker.ts"],"sourcesContent":["import { HassEntity } from \"home-assistant-js-websocket\";\nimport { LitElement, PropertyValues, html, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { computeAttributeNameDisplay } from \"../../common/entity/compute_attribute_display\";\nimport { HomeAssistant, ValueChangedEvent } from \"../../types\";\nimport \"../ha-combo-box\";\nimport type { HaComboBox } from \"../ha-combo-box\";\n\nexport type HaEntityPickerEntityFilterFunc = (entityId: HassEntity) => boolean;\n\n@customElement(\"ha-entity-attribute-picker\")\nclass HaEntityAttributePicker extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public entityId?: string;\n\n  /**\n   * List of attributes to be hidden.\n   * @type {Array}\n   * @attr hide-attributes\n   */\n  @property({ type: Array, attribute: \"hide-attributes\" })\n  public hideAttributes?: string[];\n\n  @property({ type: Boolean }) public autofocus = false;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @property({ type: Boolean, attribute: \"allow-custom-value\" })\n  public allowCustomValue;\n\n  @property() public label?: string;\n\n  @property() public value?: string;\n\n  @property() public helper?: string;\n\n  @state() private _opened = false;\n\n  @query(\"ha-combo-box\", true) private _comboBox!: HaComboBox;\n\n  protected shouldUpdate(changedProps: PropertyValues) {\n    return !(!changedProps.has(\"_opened\") && this._opened);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    if (changedProps.has(\"_opened\") && this._opened) {\n      const entityState = this.entityId\n        ? this.hass.states[this.entityId]\n        : undefined;\n      (this._comboBox as any).items = entityState\n        ? Object.keys(entityState.attributes)\n            .filter((key) => !this.hideAttributes?.includes(key))\n            .map((key) => ({\n              value: key,\n              label: computeAttributeNameDisplay(\n                this.hass.localize,\n                entityState,\n                this.hass.entities,\n                key\n              ),\n            }))\n        : [];\n    }\n  }\n\n  protected render() {\n    if (!this.hass) {\n      return nothing;\n    }\n\n    return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        .value=${this.value\n          ? computeAttributeNameDisplay(\n              this.hass.localize,\n              this.hass.states[this.entityId!],\n              this.hass.entities,\n              this.value\n            )\n          : \"\"}\n        .autofocus=${this.autofocus}\n        .label=${this.label ??\n        this.hass.localize(\n          \"ui.components.entity.entity-attribute-picker.attribute\"\n        )}\n        .disabled=${this.disabled || !this.entityId}\n        .required=${this.required}\n        .helper=${this.helper}\n        .allowCustomValue=${this.allowCustomValue}\n        item-value-path=\"value\"\n        item-label-path=\"label\"\n        @opened-changed=${this._openedChanged}\n        @value-changed=${this._valueChanged}\n      >\n      </ha-combo-box>\n    `;\n  }\n\n  private _openedChanged(ev: ValueChangedEvent<boolean>) {\n    this._opened = ev.detail.value;\n  }\n\n  private _valueChanged(ev: ValueChangedEvent<string>) {\n    this.value = ev.detail.value;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-entity-attribute-picker\": HaEntityAttributePicker;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}