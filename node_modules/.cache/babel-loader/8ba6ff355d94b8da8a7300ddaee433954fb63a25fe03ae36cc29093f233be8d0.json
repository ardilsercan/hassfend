{"ast":null,"code":"import _createForOfIteratorHelper from \"@babel/runtime/helpers/createForOfIteratorHelper\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12;\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array-buffer.slice.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.typed-array.int16-array.js\";\nimport \"core-js/modules/es.typed-array.uint8-array.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.copy-within.js\";\nimport \"core-js/modules/es.typed-array.every.js\";\nimport \"core-js/modules/es.typed-array.fill.js\";\nimport \"core-js/modules/es.typed-array.filter.js\";\nimport \"core-js/modules/es.typed-array.find.js\";\nimport \"core-js/modules/es.typed-array.find-index.js\";\nimport \"core-js/modules/es.typed-array.find-last.js\";\nimport \"core-js/modules/es.typed-array.find-last-index.js\";\nimport \"core-js/modules/es.typed-array.for-each.js\";\nimport \"core-js/modules/es.typed-array.includes.js\";\nimport \"core-js/modules/es.typed-array.index-of.js\";\nimport \"core-js/modules/es.typed-array.iterator.js\";\nimport \"core-js/modules/es.typed-array.join.js\";\nimport \"core-js/modules/es.typed-array.last-index-of.js\";\nimport \"core-js/modules/es.typed-array.map.js\";\nimport \"core-js/modules/es.typed-array.reduce.js\";\nimport \"core-js/modules/es.typed-array.reduce-right.js\";\nimport \"core-js/modules/es.typed-array.reverse.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/es.typed-array.slice.js\";\nimport \"core-js/modules/es.typed-array.some.js\";\nimport \"core-js/modules/es.typed-array.sort.js\";\nimport \"core-js/modules/es.typed-array.subarray.js\";\nimport \"core-js/modules/es.typed-array.to-locale-string.js\";\nimport \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.to-string.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/esnext.array-buffer.detached.js\";\nimport \"core-js/modules/esnext.array-buffer.transfer.js\";\nimport \"core-js/modules/esnext.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"@material/mwc-button/mwc-button\";\nvar mdiAlertCircle = \"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z\";\nvar mdiChevronDown = \"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z\";\nvar mdiClose = \"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\";\nvar mdiHelpCircleOutline = \"M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z\";\nvar mdiMicrophone = \"M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z\";\nvar mdiSend = \"M2,21L23,12L2,3V10L17,12L2,14V21Z\";\nvar mdiStar = \"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { storage } from \"../../common/decorators/storage\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { stopPropagation } from \"../../common/dom/stop_propagation\";\nimport \"../../components/ha-button\";\nimport \"../../components/ha-button-menu\";\nimport \"../../components/ha-dialog\";\nimport \"../../components/ha-dialog-header\";\nimport \"../../components/ha-icon-button\";\nimport \"../../components/ha-list-item\";\nimport \"../../components/ha-textfield\";\nimport { getAssistPipeline, listAssistPipelines, runAssistPipeline } from \"../../data/assist_pipeline\";\nimport { haStyleDialog } from \"../../resources/styles\";\nimport { AudioRecorder } from \"../../util/audio-recorder\";\nimport { documentationUrl } from \"../../util/documentation-url\";\nimport { showAlertDialog } from \"../generic/show-dialog-box\";\nexport var HaVoiceCommandDialog = _decorate([customElement(\"ha-voice-command-dialog\")], function (_initialize, _LitElement) {\n  var HaVoiceCommandDialog = /*#__PURE__*/function (_LitElement2) {\n    _inherits(HaVoiceCommandDialog, _LitElement2);\n    function HaVoiceCommandDialog() {\n      var _this;\n      _classCallCheck(this, HaVoiceCommandDialog);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, HaVoiceCommandDialog, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(HaVoiceCommandDialog);\n  }(_LitElement);\n  return {\n    F: HaVoiceCommandDialog,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_conversation\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_opened\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [storage({\n        key: \"AssistPipelineId\",\n        state: true,\n        subscribe: false\n      })],\n      key: \"_pipelineId\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_pipeline\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_showSendButton\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_pipelines\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_preferredPipeline\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [query(\"#scroll-container\")],\n      key: \"_scrollContainer\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [query(\"#message-input\")],\n      key: \"_messageInput\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_conversationId\",\n      value: function value() {\n        return null;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_audioRecorder\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_audioBuffer\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_audio\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_stt_binary_handler_id\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_pipelinePromise\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"showDialog\",\n      value: function () {\n        var _showDialog = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(params) {\n          var _this$_pipeline;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                if (!(params.pipeline_id === \"last_used\")) {\n                  _context.next = 3;\n                  break;\n                }\n                _context.next = 10;\n                break;\n              case 3:\n                if (!(params.pipeline_id === \"preferred\")) {\n                  _context.next = 9;\n                  break;\n                }\n                _context.next = 6;\n                return this._loadPipelines();\n              case 6:\n                this._pipelineId = this._preferredPipeline;\n                _context.next = 10;\n                break;\n              case 9:\n                this._pipelineId = params.pipeline_id;\n              case 10:\n                this._conversation = [{\n                  who: \"hass\",\n                  text: this.hass.localize(\"ui.dialogs.voice_command.how_can_i_help\")\n                }];\n                this._opened = true;\n                _context.next = 14;\n                return this.updateComplete;\n              case 14:\n                this._scrollMessagesBottom();\n                _context.next = 17;\n                return this._pipelinePromise;\n              case 17:\n                if (params !== null && params !== void 0 && params.start_listening && (_this$_pipeline = this._pipeline) !== null && _this$_pipeline !== void 0 && _this$_pipeline.stt_engine && AudioRecorder.isSupported) {\n                  this._toggleListening();\n                }\n              case 18:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this);\n        }));\n        function showDialog(_x) {\n          return _showDialog.apply(this, arguments);\n        }\n        return showDialog;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"closeDialog\",\n      value: function () {\n        var _closeDialog = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n          var _this$_audioRecorder, _this$_audio;\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                this._opened = false;\n                this._pipeline = undefined;\n                this._pipelines = undefined;\n                this._conversation = undefined;\n                this._conversationId = null;\n                (_this$_audioRecorder = this._audioRecorder) === null || _this$_audioRecorder === void 0 || _this$_audioRecorder.close();\n                this._audioRecorder = undefined;\n                (_this$_audio = this._audio) === null || _this$_audio === void 0 || _this$_audio.pause();\n                fireEvent(this, \"dialog-closed\", {\n                  dialog: this.localName\n                });\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2, this);\n        }));\n        function closeDialog() {\n          return _closeDialog.apply(this, arguments);\n        }\n        return closeDialog;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        var _this$_pipeline2,\n          _this$_pipeline3,\n          _this$_pipelines,\n          _this2 = this,\n          _this$hass$user,\n          _this$_audioRecorder2;\n        if (!this._opened) {\n          return nothing;\n        }\n        var supportsMicrophone = AudioRecorder.isSupported;\n        var supportsSTT = (_this$_pipeline2 = this._pipeline) === null || _this$_pipeline2 === void 0 ? void 0 : _this$_pipeline2.stt_engine;\n        return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n      <ha-dialog\\n        open\\n        @closed=\", \"\\n        .heading=\", \"\\n        flexContent\\n      >\\n        <ha-dialog-header slot=\\\"heading\\\">\\n          <ha-icon-button\\n            slot=\\\"navigationIcon\\\"\\n            dialogAction=\\\"cancel\\\"\\n            .label=\", \"\\n            .path=\", \"\\n          ></ha-icon-button>\\n          <div slot=\\\"title\\\">\\n            \", \"\\n            <ha-button-menu\\n              @opened=\", \"\\n              @closed=\", \"\\n              activatable\\n              fixed\\n            >\\n              <ha-button slot=\\\"trigger\\\">\\n                \", \"\\n                <ha-svg-icon\\n                  slot=\\\"trailingIcon\\\"\\n                  .path=\", \"\\n                ></ha-svg-icon>\\n              </ha-button>\\n              \", \"\\n              \", \"\\n            </ha-button-menu>\\n          </div>\\n          <a\\n            href=\", \"\\n            slot=\\\"actionItems\\\"\\n            target=\\\"_blank\\\"\\n            rel=\\\"noopener noreferer\\\"\\n          >\\n            <ha-icon-button\\n              .label=\", \"\\n              .path=\", \"\\n            ></ha-icon-button>\\n          </a>\\n        </ha-dialog-header>\\n        <div class=\\\"messages\\\">\\n          <div class=\\\"messages-container\\\" id=\\\"scroll-container\\\">\\n            \", \"\\n          </div>\\n        </div>\\n        <div class=\\\"input\\\" slot=\\\"primaryAction\\\">\\n          <ha-textfield\\n            id=\\\"message-input\\\"\\n            @keyup=\", \"\\n            @input=\", \"\\n            .label=\", \"\\n            dialogInitialFocus\\n            iconTrailing\\n          >\\n            <span slot=\\\"trailingIcon\\\">\\n              \", \"\\n            </span>\\n          </ha-textfield>\\n        </div>\\n      </ha-dialog>\\n    \"])), this.closeDialog, this.hass.localize(\"ui.dialogs.voice_command.title\"), this.hass.localize(\"ui.common.close\"), mdiClose, this.hass.localize(\"ui.dialogs.voice_command.title\"), this._loadPipelines, stopPropagation, (_this$_pipeline3 = this._pipeline) === null || _this$_pipeline3 === void 0 ? void 0 : _this$_pipeline3.name, mdiChevronDown, (_this$_pipelines = this._pipelines) === null || _this$_pipelines === void 0 ? void 0 : _this$_pipelines.map(function (pipeline) {\n          return html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"<ha-list-item\\n                    ?selected=\", \"\\n                    .pipeline=\", \"\\n                    @click=\", \"\\n                    .hasMeta=\", \"\\n                  >\\n                    \", \"\", \"\\n                  </ha-list-item>\"])), pipeline.id === _this2._pipelineId || !_this2._pipelineId && pipeline.id === _this2._preferredPipeline, pipeline.id, _this2._selectPipeline, pipeline.id === _this2._preferredPipeline, pipeline.name, pipeline.id === _this2._preferredPipeline ? html(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n                          <ha-svg-icon\\n                            slot=\\\"meta\\\"\\n                            .path=\", \"\\n                          ></ha-svg-icon>\\n                        \"])), mdiStar) : nothing);\n        }), (_this$hass$user = this.hass.user) !== null && _this$hass$user !== void 0 && _this$hass$user.is_admin ? html(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"<li divider role=\\\"separator\\\"></li>\\n                    <a href=\\\"/config/voice-assistants/assistants\\\"\\n                      ><ha-list-item @click=\", \"\\n                        >\", \"</ha-list-item\\n                      ></a\\n                    >\"])), this.closeDialog, this.hass.localize(\"ui.dialogs.voice_command.manage_assistants\")) : nothing, documentationUrl(this.hass, \"/docs/assist/\"), this.hass.localize(\"ui.common.help\"), mdiHelpCircleOutline, this._conversation.map(function (message) {\n          return html(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\\n                <div class=\", \">\\n                  \", \"\\n                </div>\\n              \"])), _this2._computeMessageClasses(message), message.text);\n        }), this._handleKeyUp, this._handleInput, this.hass.localize(\"ui.dialogs.voice_command.input_label\"), this._showSendButton || !supportsSTT ? html(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\\n                    <ha-icon-button\\n                      class=\\\"listening-icon\\\"\\n                      .path=\", \"\\n                      @click=\", \"\\n                      .label=\", \"\\n                    >\\n                    </ha-icon-button>\\n                  \"])), mdiSend, this._handleSendMessage, this.hass.localize(\"ui.dialogs.voice_command.send_text\")) : html(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\\n                    \", \"\\n\\n                    <div class=\\\"listening-icon\\\">\\n                      <ha-icon-button\\n                        .path=\", \"\\n                        @click=\", \"\\n                        .label=\", \"\\n                      >\\n                      </ha-icon-button>\\n                      \", \"\\n                    </div>\\n                  \"])), (_this$_audioRecorder2 = this._audioRecorder) !== null && _this$_audioRecorder2 !== void 0 && _this$_audioRecorder2.active ? html(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\\n                          <div class=\\\"bouncer\\\">\\n                            <div class=\\\"double-bounce1\\\"></div>\\n                            <div class=\\\"double-bounce2\\\"></div>\\n                          </div>\\n                        \"]))) : nothing, mdiMicrophone, this._handleListeningButton, this.hass.localize(\"ui.dialogs.voice_command.start_listening\"), !supportsMicrophone ? html(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\\n                            <ha-svg-icon\\n                              .path=\", \"\\n                              class=\\\"unsupported\\\"\\n                            ></ha-svg-icon>\\n                          \"])), mdiAlertCircle) : null));\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProperties) {\n        if (changedProperties.has(\"_pipelineId\") || changedProperties.has(\"_opened\") && this._opened === true) {\n          this._getPipeline();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_getPipeline\",\n      value: function () {\n        var _getPipeline2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                this._pipelinePromise = getAssistPipeline(this.hass, this._pipelineId);\n                _context3.next = 4;\n                return this._pipelinePromise;\n              case 4:\n                this._pipeline = _context3.sent;\n                _context3.next = 10;\n                break;\n              case 7:\n                _context3.prev = 7;\n                _context3.t0 = _context3[\"catch\"](0);\n                if (_context3.t0.code === \"not_found\") {\n                  this._pipelineId = undefined;\n                }\n              case 10:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, this, [[0, 7]]);\n        }));\n        function _getPipeline() {\n          return _getPipeline2.apply(this, arguments);\n        }\n        return _getPipeline;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_loadPipelines\",\n      value: function () {\n        var _loadPipelines2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n          var _yield$listAssistPipe, pipelines, preferred_pipeline;\n          return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n            while (1) switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!this._pipelines) {\n                  _context4.next = 2;\n                  break;\n                }\n                return _context4.abrupt(\"return\");\n              case 2:\n                _context4.next = 4;\n                return listAssistPipelines(this.hass);\n              case 4:\n                _yield$listAssistPipe = _context4.sent;\n                pipelines = _yield$listAssistPipe.pipelines;\n                preferred_pipeline = _yield$listAssistPipe.preferred_pipeline;\n                this._pipelines = pipelines;\n                this._preferredPipeline = preferred_pipeline || undefined;\n              case 9:\n              case \"end\":\n                return _context4.stop();\n            }\n          }, _callee4, this);\n        }));\n        function _loadPipelines() {\n          return _loadPipelines2.apply(this, arguments);\n        }\n        return _loadPipelines;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_selectPipeline\",\n      value: function () {\n        var _selectPipeline2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(ev) {\n          return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n            while (1) switch (_context5.prev = _context5.next) {\n              case 0:\n                this._pipelineId = ev.currentTarget.pipeline;\n                this._conversation = [{\n                  who: \"hass\",\n                  text: this.hass.localize(\"ui.dialogs.voice_command.how_can_i_help\")\n                }];\n                _context5.next = 4;\n                return this.updateComplete;\n              case 4:\n                this._scrollMessagesBottom();\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }, _callee5, this);\n        }));\n        function _selectPipeline(_x2) {\n          return _selectPipeline2.apply(this, arguments);\n        }\n        return _selectPipeline;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"updated\",\n      value: function updated(changedProps) {\n        _get(_getPrototypeOf(HaVoiceCommandDialog.prototype), \"updated\", this).call(this, changedProps);\n        if (changedProps.has(\"_conversation\") || changedProps.has(\"results\")) {\n          this._scrollMessagesBottom();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_addMessage\",\n      value: function _addMessage(message) {\n        this._conversation = [].concat(_toConsumableArray(this._conversation), [message]);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_handleKeyUp\",\n      value: function _handleKeyUp(ev) {\n        var input = ev.target;\n        if (ev.key === \"Enter\" && input.value) {\n          this._processText(input.value);\n          input.value = \"\";\n          this._showSendButton = false;\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_handleInput\",\n      value: function _handleInput(ev) {\n        var value = ev.target.value;\n        if (value && !this._showSendButton) {\n          this._showSendButton = true;\n        } else if (!value && this._showSendButton) {\n          this._showSendButton = false;\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_handleSendMessage\",\n      value: function _handleSendMessage() {\n        if (this._messageInput.value) {\n          this._processText(this._messageInput.value);\n          this._messageInput.value = \"\";\n          this._showSendButton = false;\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_processText\",\n      value: function () {\n        var _processText2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(text) {\n          var _this$_audio2,\n            _this3 = this;\n          var message, _this$_pipeline4, unsub;\n          return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n            while (1) switch (_context6.prev = _context6.next) {\n              case 0:\n                (_this$_audio2 = this._audio) === null || _this$_audio2 === void 0 || _this$_audio2.pause();\n                this._addMessage({\n                  who: \"user\",\n                  text: text\n                });\n                message = {\n                  who: \"hass\",\n                  text: \"…\"\n                }; // To make sure the answer is placed at the right user text, we add it before we process it\n                this._addMessage(message);\n                _context6.prev = 4;\n                _context6.next = 7;\n                return runAssistPipeline(this.hass, function (event) {\n                  if (event.type === \"intent-end\") {\n                    var _event$data$intent_ou;\n                    _this3._conversationId = event.data.intent_output.conversation_id;\n                    var plain = (_event$data$intent_ou = event.data.intent_output.response.speech) === null || _event$data$intent_ou === void 0 ? void 0 : _event$data$intent_ou.plain;\n                    if (plain) {\n                      message.text = plain.speech;\n                    }\n                    _this3.requestUpdate(\"_conversation\");\n                    unsub();\n                  }\n                  if (event.type === \"error\") {\n                    message.text = event.data.message;\n                    message.error = true;\n                    _this3.requestUpdate(\"_conversation\");\n                    unsub();\n                  }\n                }, {\n                  start_stage: \"intent\",\n                  input: {\n                    text: text\n                  },\n                  end_stage: \"intent\",\n                  pipeline: (_this$_pipeline4 = this._pipeline) === null || _this$_pipeline4 === void 0 ? void 0 : _this$_pipeline4.id,\n                  conversation_id: this._conversationId\n                });\n              case 7:\n                unsub = _context6.sent;\n                _context6.next = 15;\n                break;\n              case 10:\n                _context6.prev = 10;\n                _context6.t0 = _context6[\"catch\"](4);\n                message.text = this.hass.localize(\"ui.dialogs.voice_command.error\");\n                message.error = true;\n                this.requestUpdate(\"_conversation\");\n              case 15:\n              case \"end\":\n                return _context6.stop();\n            }\n          }, _callee6, this, [[4, 10]]);\n        }));\n        function _processText(_x3) {\n          return _processText2.apply(this, arguments);\n        }\n        return _processText;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_handleListeningButton\",\n      value: function _handleListeningButton(ev) {\n        ev.stopPropagation();\n        ev.preventDefault();\n        this._toggleListening();\n      }\n    }, {\n      kind: \"method\",\n      key: \"_toggleListening\",\n      value: function _toggleListening() {\n        var _this$_audioRecorder3;\n        var supportsMicrophone = AudioRecorder.isSupported;\n        if (!supportsMicrophone) {\n          this._showNotSupportedMessage();\n          return;\n        }\n        if (!((_this$_audioRecorder3 = this._audioRecorder) !== null && _this$_audioRecorder3 !== void 0 && _this$_audioRecorder3.active)) {\n          this._startListening();\n        } else {\n          this._stopListening();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_showNotSupportedMessage\",\n      value: function () {\n        var _showNotSupportedMessage2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n          return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n            while (1) switch (_context7.prev = _context7.next) {\n              case 0:\n                this._addMessage({\n                  who: \"hass\",\n                  text: html(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"\\n        <p>\\n          \", \"\\n        </p>\\n        <p>\\n          \", \"\\n        </p>\\n      \"])), this.hass.localize(\"ui.dialogs.voice_command.not_supported_microphone_browser\"), this.hass.localize(\"ui.dialogs.voice_command.not_supported_microphone_documentation\", {\n                    documentation_link: html(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"\\n                <a\\n                  target=\\\"_blank\\\"\\n                  rel=\\\"noopener noreferrer\\\"\\n                  href=\", \"\\n                >\\n                  \", \"\\n                </a>\\n              \"])), documentationUrl(this.hass, \"/docs/configuration/securing/#remote-access\"), this.hass.localize(\"ui.dialogs.voice_command.not_supported_microphone_documentation_link\"))\n                  }))\n                });\n              case 1:\n              case \"end\":\n                return _context7.stop();\n            }\n          }, _callee7, this);\n        }));\n        function _showNotSupportedMessage() {\n          return _showNotSupportedMessage2.apply(this, arguments);\n        }\n        return _showNotSupportedMessage;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_startListening\",\n      value: function () {\n        var _startListening2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n          var _this$_audio3,\n            _this4 = this;\n          var userMessage, hassMessage, _this$_pipeline5, _this$_pipeline6, unsub;\n          return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n            while (1) switch (_context8.prev = _context8.next) {\n              case 0:\n                (_this$_audio3 = this._audio) === null || _this$_audio3 === void 0 || _this$_audio3.pause();\n                if (!this._audioRecorder) {\n                  this._audioRecorder = new AudioRecorder(function (audio) {\n                    if (_this4._audioBuffer) {\n                      _this4._audioBuffer.push(audio);\n                    } else {\n                      _this4._sendAudioChunk(audio);\n                    }\n                  });\n                }\n                this._stt_binary_handler_id = undefined;\n                this._audioBuffer = [];\n                userMessage = {\n                  who: \"user\",\n                  text: \"…\"\n                };\n                this._audioRecorder.start().then(function () {\n                  _this4._addMessage(userMessage);\n                  _this4.requestUpdate(\"_audioRecorder\");\n                });\n                hassMessage = {\n                  who: \"hass\",\n                  text: \"…\"\n                }; // To make sure the answer is placed at the right user text, we add it before we process it\n                _context8.prev = 7;\n                _context8.next = 10;\n                return runAssistPipeline(this.hass, function (event) {\n                  if (event.type === \"run-start\") {\n                    _this4._stt_binary_handler_id = event.data.runner_data.stt_binary_handler_id;\n                  }\n\n                  // When we start STT stage, the WS has a binary handler\n                  if (event.type === \"stt-start\" && _this4._audioBuffer) {\n                    // Send the buffer over the WS to the STT engine.\n                    var _iterator = _createForOfIteratorHelper(_this4._audioBuffer),\n                      _step;\n                    try {\n                      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                        var buffer = _step.value;\n                        _this4._sendAudioChunk(buffer);\n                      }\n                    } catch (err) {\n                      _iterator.e(err);\n                    } finally {\n                      _iterator.f();\n                    }\n                    _this4._audioBuffer = undefined;\n                  }\n\n                  // Stop recording if the server is done with STT stage\n                  if (event.type === \"stt-end\") {\n                    _this4._stt_binary_handler_id = undefined;\n                    _this4._stopListening();\n                    userMessage.text = event.data.stt_output.text;\n                    _this4.requestUpdate(\"_conversation\");\n                    // To make sure the answer is placed at the right user text, we add it before we process it\n                    _this4._addMessage(hassMessage);\n                  }\n                  if (event.type === \"intent-end\") {\n                    var _event$data$intent_ou2;\n                    _this4._conversationId = event.data.intent_output.conversation_id;\n                    var plain = (_event$data$intent_ou2 = event.data.intent_output.response.speech) === null || _event$data$intent_ou2 === void 0 ? void 0 : _event$data$intent_ou2.plain;\n                    if (plain) {\n                      hassMessage.text = plain.speech;\n                    }\n                    _this4.requestUpdate(\"_conversation\");\n                  }\n                  if (event.type === \"tts-end\") {\n                    var url = event.data.tts_output.url;\n                    _this4._audio = new Audio(url);\n                    _this4._audio.play();\n                    _this4._audio.addEventListener(\"ended\", _this4._unloadAudio);\n                    _this4._audio.addEventListener(\"pause\", _this4._unloadAudio);\n                    _this4._audio.addEventListener(\"canplaythrough\", _this4._playAudio);\n                    _this4._audio.addEventListener(\"error\", _this4._audioError);\n                  }\n                  if (event.type === \"run-end\") {\n                    _this4._stt_binary_handler_id = undefined;\n                    unsub();\n                  }\n                  if (event.type === \"error\") {\n                    _this4._stt_binary_handler_id = undefined;\n                    if (userMessage.text === \"…\") {\n                      userMessage.text = event.data.message;\n                      userMessage.error = true;\n                    } else {\n                      hassMessage.text = event.data.message;\n                      hassMessage.error = true;\n                    }\n                    _this4._stopListening();\n                    _this4.requestUpdate(\"_conversation\");\n                    unsub();\n                  }\n                }, {\n                  start_stage: \"stt\",\n                  end_stage: (_this$_pipeline5 = this._pipeline) !== null && _this$_pipeline5 !== void 0 && _this$_pipeline5.tts_engine ? \"tts\" : \"intent\",\n                  input: {\n                    sample_rate: this._audioRecorder.sampleRate\n                  },\n                  pipeline: (_this$_pipeline6 = this._pipeline) === null || _this$_pipeline6 === void 0 ? void 0 : _this$_pipeline6.id,\n                  conversation_id: this._conversationId\n                });\n              case 10:\n                unsub = _context8.sent;\n                _context8.next = 18;\n                break;\n              case 13:\n                _context8.prev = 13;\n                _context8.t0 = _context8[\"catch\"](7);\n                _context8.next = 17;\n                return showAlertDialog(this, {\n                  title: \"Error starting pipeline\",\n                  text: _context8.t0.message || _context8.t0\n                });\n              case 17:\n                this._stopListening();\n              case 18:\n              case \"end\":\n                return _context8.stop();\n            }\n          }, _callee8, this, [[7, 13]]);\n        }));\n        function _startListening() {\n          return _startListening2.apply(this, arguments);\n        }\n        return _startListening;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_stopListening\",\n      value: function _stopListening() {\n        var _this$_audioRecorder4;\n        (_this$_audioRecorder4 = this._audioRecorder) === null || _this$_audioRecorder4 === void 0 || _this$_audioRecorder4.stop();\n        this.requestUpdate(\"_audioRecorder\");\n        // We're currently STTing, so finish audio\n        if (this._stt_binary_handler_id) {\n          if (this._audioBuffer) {\n            var _iterator2 = _createForOfIteratorHelper(this._audioBuffer),\n              _step2;\n            try {\n              for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                var chunk = _step2.value;\n                this._sendAudioChunk(chunk);\n              }\n            } catch (err) {\n              _iterator2.e(err);\n            } finally {\n              _iterator2.f();\n            }\n          }\n          // Send empty message to indicate we're done streaming.\n          this._sendAudioChunk(new Int16Array());\n          this._stt_binary_handler_id = undefined;\n        }\n        this._audioBuffer = undefined;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_sendAudioChunk\",\n      value: function _sendAudioChunk(chunk) {\n        this.hass.connection.socket.binaryType = \"arraybuffer\";\n\n        // eslint-disable-next-line eqeqeq\n        if (this._stt_binary_handler_id == undefined) {\n          return;\n        }\n        // Turn into 8 bit so we can prefix our handler ID.\n        var data = new Uint8Array(1 + chunk.length * 2);\n        data[0] = this._stt_binary_handler_id;\n        data.set(new Uint8Array(chunk.buffer), 1);\n        this.hass.connection.socket.send(data);\n      }\n    }, {\n      kind: \"field\",\n      key: \"_playAudio\",\n      value: function value() {\n        var _this5 = this;\n        return function () {\n          var _this5$_audio;\n          (_this5$_audio = _this5._audio) === null || _this5$_audio === void 0 || _this5$_audio.play();\n        };\n      }\n    }, {\n      kind: \"field\",\n      key: \"_audioError\",\n      value: function value() {\n        var _this6 = this;\n        return function () {\n          var _this6$_audio;\n          showAlertDialog(_this6, {\n            title: \"Error playing audio.\"\n          });\n          (_this6$_audio = _this6._audio) === null || _this6$_audio === void 0 || _this6$_audio.removeAttribute(\"src\");\n        };\n      }\n    }, {\n      kind: \"field\",\n      key: \"_unloadAudio\",\n      value: function value() {\n        var _this7 = this;\n        return function () {\n          var _this7$_audio;\n          (_this7$_audio = _this7._audio) === null || _this7$_audio === void 0 || _this7$_audio.removeAttribute(\"src\");\n          _this7._audio = undefined;\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"_scrollMessagesBottom\",\n      value: function _scrollMessagesBottom() {\n        var scrollContainer = this._scrollContainer;\n        if (!scrollContainer) {\n          return;\n        }\n        scrollContainer.scrollTo(0, 99999);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_computeMessageClasses\",\n      value: function _computeMessageClasses(message) {\n        return \"message \".concat(message.who, \" \").concat(message.error ? \" error\" : \"\");\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return [haStyleDialog, css(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"\\n        .listening-icon {\\n          position: relative;\\n          color: var(--secondary-text-color);\\n          margin-right: -24px;\\n          margin-inline-end: -24px;\\n          margin-inline-start: initial;\\n          direction: var(--direction);\\n        }\\n\\n        .listening-icon[active] {\\n          color: var(--primary-color);\\n        }\\n\\n        .unsupported {\\n          color: var(--error-color);\\n          position: absolute;\\n          --mdc-icon-size: 16px;\\n          right: 5px;\\n          top: 0px;\\n        }\\n\\n        ha-dialog {\\n          --primary-action-button-flex: 1;\\n          --secondary-action-button-flex: 0;\\n          --mdc-dialog-max-width: 500px;\\n          --mdc-dialog-max-height: 500px;\\n          --dialog-content-padding: 0;\\n        }\\n        ha-dialog-header a {\\n          color: var(--primary-text-color);\\n        }\\n        div[slot=\\\"title\\\"] {\\n          display: flex;\\n          flex-direction: column;\\n          margin: -4px 0;\\n        }\\n        ha-button-menu {\\n          --mdc-theme-on-primary: var(--text-primary-color);\\n          --mdc-theme-primary: var(--primary-color);\\n          margin-top: -8px;\\n          margin-bottom: 0;\\n          margin-right: 0;\\n          margin-inline-end: 0;\\n          margin-left: -8px;\\n          margin-inline-start: -8px;\\n        }\\n        ha-button-menu ha-button {\\n          --mdc-theme-primary: var(--secondary-text-color);\\n          --mdc-typography-button-text-transform: none;\\n          --mdc-typography-button-font-size: unset;\\n          --mdc-typography-button-font-weight: 400;\\n          --mdc-typography-button-letter-spacing: var(\\n            --mdc-typography-headline6-letter-spacing,\\n            0.0125em\\n          );\\n          --mdc-typography-button-line-height: var(\\n            --mdc-typography-headline6-line-height,\\n            2rem\\n          );\\n          --button-height: auto;\\n        }\\n        ha-button-menu ha-button ha-svg-icon {\\n          height: 28px;\\n          margin-left: 4px;\\n          margin-inline-start: 4px;\\n          margin-inline-end: initial;\\n          direction: var(--direction);\\n        }\\n        ha-list-item {\\n          --mdc-list-item-meta-size: 16px;\\n        }\\n        ha-list-item ha-svg-icon {\\n          margin-left: 4px;\\n          margin-inline-start: 4px;\\n          margin-inline-end: initial;\\n          direction: var(--direction);\\n          display: block;\\n        }\\n        ha-button-menu a {\\n          text-decoration: none;\\n        }\\n        ha-textfield {\\n          display: block;\\n          overflow: hidden;\\n        }\\n        a.button {\\n          text-decoration: none;\\n        }\\n        a.button > mwc-button {\\n          width: 100%;\\n        }\\n        .side-by-side {\\n          display: flex;\\n          margin: 8px 0;\\n        }\\n        .side-by-side > * {\\n          flex: 1 0;\\n          padding: 4px;\\n        }\\n        .messages {\\n          display: block;\\n          height: 400px;\\n          box-sizing: border-box;\\n          position: relative;\\n        }\\n        @media all and (max-width: 450px), all and (max-height: 500px) {\\n          ha-dialog {\\n            --mdc-dialog-max-width: 100%;\\n          }\\n          .messages {\\n            height: 100%;\\n            flex: 1;\\n          }\\n        }\\n        .messages-container {\\n          position: absolute;\\n          bottom: 0px;\\n          right: 0px;\\n          left: 0px;\\n          padding: 24px;\\n          box-sizing: border-box;\\n          overflow-y: auto;\\n          max-height: 100%;\\n        }\\n        .message {\\n          font-size: 18px;\\n          clear: both;\\n          margin: 8px 0;\\n          padding: 8px;\\n          border-radius: 15px;\\n        }\\n        .message p {\\n          margin: 0;\\n        }\\n        .message p:not(:last-child) {\\n          margin-bottom: 8px;\\n        }\\n\\n        .message.user {\\n          margin-left: 24px;\\n          margin-inline-start: 24px;\\n          margin-inline-end: initial;\\n          float: var(--float-end);\\n          text-align: right;\\n          border-bottom-right-radius: 0px;\\n          background-color: var(--light-primary-color);\\n          color: var(--text-light-primary-color, var(--primary-text-color));\\n          direction: var(--direction);\\n        }\\n\\n        .message.hass {\\n          margin-right: 24px;\\n          margin-inline-end: 24px;\\n          margin-inline-start: initial;\\n          float: var(--float-start);\\n          border-bottom-left-radius: 0px;\\n          background-color: var(--primary-color);\\n          color: var(--text-primary-color);\\n          direction: var(--direction);\\n        }\\n\\n        .message a {\\n          color: var(--text-primary-color);\\n        }\\n\\n        .message img {\\n          width: 100%;\\n          border-radius: 10px;\\n        }\\n\\n        .message.error {\\n          background-color: var(--error-color);\\n          color: var(--text-primary-color);\\n        }\\n\\n        .input {\\n          margin-left: 0;\\n          margin-right: 0;\\n        }\\n\\n        .bouncer {\\n          width: 48px;\\n          height: 48px;\\n          position: absolute;\\n        }\\n        .double-bounce1,\\n        .double-bounce2 {\\n          width: 48px;\\n          height: 48px;\\n          border-radius: 50%;\\n          background-color: var(--primary-color);\\n          opacity: 0.2;\\n          position: absolute;\\n          top: 0;\\n          left: 0;\\n          -webkit-animation: sk-bounce 2s infinite ease-in-out;\\n          animation: sk-bounce 2s infinite ease-in-out;\\n        }\\n        .double-bounce2 {\\n          -webkit-animation-delay: -1s;\\n          animation-delay: -1s;\\n        }\\n        @-webkit-keyframes sk-bounce {\\n          0%,\\n          100% {\\n            -webkit-transform: scale(0);\\n          }\\n          50% {\\n            -webkit-transform: scale(1);\\n          }\\n        }\\n        @keyframes sk-bounce {\\n          0%,\\n          100% {\\n            transform: scale(0);\\n            -webkit-transform: scale(0);\\n          }\\n          50% {\\n            transform: scale(1);\\n            -webkit-transform: scale(1);\\n          }\\n        }\\n\\n        @media all and (max-width: 450px), all and (max-height: 500px) {\\n          .message {\\n            font-size: 16px;\\n          }\\n        }\\n      \"])))];\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["mdiAlertCircle","mdiChevronDown","mdiClose","mdiHelpCircleOutline","mdiMicrophone","mdiSend","mdiStar","css","html","LitElement","nothing","customElement","property","query","state","storage","fireEvent","stopPropagation","getAssistPipeline","listAssistPipelines","runAssistPipeline","haStyleDialog","AudioRecorder","documentationUrl","showAlertDialog","HaVoiceCommandDialog","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","decorators","attribute","key","value","subscribe","_showDialog","_asyncToGenerator","_regeneratorRuntime","mark","_callee","params","_this$_pipeline","wrap","_callee$","_context","prev","next","pipeline_id","_loadPipelines","_pipelineId","_preferredPipeline","_conversation","who","text","hass","localize","_opened","updateComplete","_scrollMessagesBottom","_pipelinePromise","start_listening","_pipeline","stt_engine","isSupported","_toggleListening","stop","showDialog","_x","apply","_closeDialog","_callee2","_this$_audioRecorder","_this$_audio","_callee2$","_context2","undefined","_pipelines","_conversationId","_audioRecorder","close","_audio","pause","dialog","localName","closeDialog","render","_this$_pipeline2","_this$_pipeline3","_this$_pipelines","_this2","_this$hass$user","_this$_audioRecorder2","supportsMicrophone","supportsSTT","_templateObject","_taggedTemplateLiteral","name","map","pipeline","_templateObject2","id","_selectPipeline","_templateObject3","user","is_admin","_templateObject4","message","_templateObject5","_computeMessageClasses","_handleKeyUp","_handleInput","_showSendButton","_templateObject6","_handleSendMessage","_templateObject7","active","_templateObject8","_handleListeningButton","_templateObject9","willUpdate","changedProperties","has","_getPipeline","_getPipeline2","_callee3","_callee3$","_context3","sent","t0","code","_loadPipelines2","_callee4","_yield$listAssistPipe","pipelines","preferred_pipeline","_callee4$","_context4","abrupt","_selectPipeline2","_callee5","ev","_callee5$","_context5","currentTarget","_x2","updated","changedProps","_get","_getPrototypeOf","prototype","call","_addMessage","_toConsumableArray","input","target","_processText","_messageInput","_processText2","_callee6","_this$_audio2","_this3","_this$_pipeline4","unsub","_callee6$","_context6","event","type","_event$data$intent_ou","data","intent_output","conversation_id","plain","response","speech","requestUpdate","error","start_stage","end_stage","_x3","preventDefault","_this$_audioRecorder3","_showNotSupportedMessage","_startListening","_stopListening","_showNotSupportedMessage2","_callee7","_callee7$","_context7","_templateObject10","documentation_link","_templateObject11","_startListening2","_callee8","_this$_audio3","_this4","userMessage","hassMessage","_this$_pipeline5","_this$_pipeline6","_callee8$","_context8","audio","_audioBuffer","push","_sendAudioChunk","_stt_binary_handler_id","start","then","runner_data","stt_binary_handler_id","_iterator","_createForOfIteratorHelper","_step","s","n","done","buffer","err","e","f","stt_output","_event$data$intent_ou2","url","tts_output","Audio","play","addEventListener","_unloadAudio","_playAudio","_audioError","tts_engine","sample_rate","sampleRate","title","_this$_audioRecorder4","_iterator2","_step2","chunk","Int16Array","connection","socket","binaryType","Uint8Array","set","send","_this5","_this5$_audio","_this6","_this6$_audio","removeAttribute","_this7","_this7$_audio","scrollContainer","_scrollContainer","scrollTo","static","styles","_templateObject12"],"sources":["/workspaces/frontend/src/dialogs/voice-command-dialog/ha-voice-command-dialog.ts"],"sourcesContent":["import \"@material/mwc-button/mwc-button\";\nimport {\n  mdiAlertCircle,\n  mdiChevronDown,\n  mdiClose,\n  mdiHelpCircleOutline,\n  mdiMicrophone,\n  mdiSend,\n  mdiStar,\n} from \"@mdi/js\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  nothing,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { storage } from \"../../common/decorators/storage\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { stopPropagation } from \"../../common/dom/stop_propagation\";\nimport \"../../components/ha-button\";\nimport \"../../components/ha-button-menu\";\nimport \"../../components/ha-dialog\";\nimport \"../../components/ha-dialog-header\";\nimport \"../../components/ha-icon-button\";\nimport \"../../components/ha-list-item\";\nimport \"../../components/ha-textfield\";\nimport type { HaTextField } from \"../../components/ha-textfield\";\nimport {\n  AssistPipeline,\n  getAssistPipeline,\n  listAssistPipelines,\n  runAssistPipeline,\n} from \"../../data/assist_pipeline\";\nimport { haStyleDialog } from \"../../resources/styles\";\nimport type { HomeAssistant } from \"../../types\";\nimport { AudioRecorder } from \"../../util/audio-recorder\";\nimport { documentationUrl } from \"../../util/documentation-url\";\nimport { showAlertDialog } from \"../generic/show-dialog-box\";\nimport { VoiceCommandDialogParams } from \"./show-ha-voice-command-dialog\";\n\ninterface Message {\n  who: string;\n  text?: string | TemplateResult;\n  error?: boolean;\n}\n\n@customElement(\"ha-voice-command-dialog\")\nexport class HaVoiceCommandDialog extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @state() private _conversation?: Message[];\n\n  @state() private _opened = false;\n\n  @storage({\n    key: \"AssistPipelineId\",\n    state: true,\n    subscribe: false,\n  })\n  private _pipelineId?: string;\n\n  @state() private _pipeline?: AssistPipeline;\n\n  @state() private _showSendButton = false;\n\n  @state() private _pipelines?: AssistPipeline[];\n\n  @state() private _preferredPipeline?: string;\n\n  @query(\"#scroll-container\") private _scrollContainer!: HTMLDivElement;\n\n  @query(\"#message-input\") private _messageInput!: HaTextField;\n\n  private _conversationId: string | null = null;\n\n  private _audioRecorder?: AudioRecorder;\n\n  private _audioBuffer?: Int16Array[];\n\n  private _audio?: HTMLAudioElement;\n\n  private _stt_binary_handler_id?: number | null;\n\n  private _pipelinePromise?: Promise<AssistPipeline>;\n\n  public async showDialog(\n    params: Required<VoiceCommandDialogParams>\n  ): Promise<void> {\n    if (params.pipeline_id === \"last_used\") {\n      // Do not set pipeline id (retrieve from storage)\n    } else if (params.pipeline_id === \"preferred\") {\n      await this._loadPipelines();\n      this._pipelineId = this._preferredPipeline;\n    } else {\n      this._pipelineId = params.pipeline_id;\n    }\n\n    this._conversation = [\n      {\n        who: \"hass\",\n        text: this.hass.localize(\"ui.dialogs.voice_command.how_can_i_help\"),\n      },\n    ];\n    this._opened = true;\n    await this.updateComplete;\n    this._scrollMessagesBottom();\n\n    await this._pipelinePromise;\n    if (\n      params?.start_listening &&\n      this._pipeline?.stt_engine &&\n      AudioRecorder.isSupported\n    ) {\n      this._toggleListening();\n    }\n  }\n\n  public async closeDialog(): Promise<void> {\n    this._opened = false;\n    this._pipeline = undefined;\n    this._pipelines = undefined;\n    this._conversation = undefined;\n    this._conversationId = null;\n    this._audioRecorder?.close();\n    this._audioRecorder = undefined;\n    this._audio?.pause();\n    fireEvent(this, \"dialog-closed\", { dialog: this.localName });\n  }\n\n  protected render() {\n    if (!this._opened) {\n      return nothing;\n    }\n\n    const supportsMicrophone = AudioRecorder.isSupported;\n    const supportsSTT = this._pipeline?.stt_engine;\n\n    return html`\n      <ha-dialog\n        open\n        @closed=${this.closeDialog}\n        .heading=${this.hass.localize(\"ui.dialogs.voice_command.title\")}\n        flexContent\n      >\n        <ha-dialog-header slot=\"heading\">\n          <ha-icon-button\n            slot=\"navigationIcon\"\n            dialogAction=\"cancel\"\n            .label=${this.hass.localize(\"ui.common.close\")}\n            .path=${mdiClose}\n          ></ha-icon-button>\n          <div slot=\"title\">\n            ${this.hass.localize(\"ui.dialogs.voice_command.title\")}\n            <ha-button-menu\n              @opened=${this._loadPipelines}\n              @closed=${stopPropagation}\n              activatable\n              fixed\n            >\n              <ha-button slot=\"trigger\">\n                ${this._pipeline?.name}\n                <ha-svg-icon\n                  slot=\"trailingIcon\"\n                  .path=${mdiChevronDown}\n                ></ha-svg-icon>\n              </ha-button>\n              ${this._pipelines?.map(\n                (pipeline) =>\n                  html`<ha-list-item\n                    ?selected=${pipeline.id === this._pipelineId ||\n                    (!this._pipelineId &&\n                      pipeline.id === this._preferredPipeline)}\n                    .pipeline=${pipeline.id}\n                    @click=${this._selectPipeline}\n                    .hasMeta=${pipeline.id === this._preferredPipeline}\n                  >\n                    ${pipeline.name}${pipeline.id === this._preferredPipeline\n                      ? html`\n                          <ha-svg-icon\n                            slot=\"meta\"\n                            .path=${mdiStar}\n                          ></ha-svg-icon>\n                        `\n                      : nothing}\n                  </ha-list-item>`\n              )}\n              ${this.hass.user?.is_admin\n                ? html`<li divider role=\"separator\"></li>\n                    <a href=\"/config/voice-assistants/assistants\"\n                      ><ha-list-item @click=${this.closeDialog}\n                        >${this.hass.localize(\n                          \"ui.dialogs.voice_command.manage_assistants\"\n                        )}</ha-list-item\n                      ></a\n                    >`\n                : nothing}\n            </ha-button-menu>\n          </div>\n          <a\n            href=${documentationUrl(this.hass, \"/docs/assist/\")}\n            slot=\"actionItems\"\n            target=\"_blank\"\n            rel=\"noopener noreferer\"\n          >\n            <ha-icon-button\n              .label=${this.hass.localize(\"ui.common.help\")}\n              .path=${mdiHelpCircleOutline}\n            ></ha-icon-button>\n          </a>\n        </ha-dialog-header>\n        <div class=\"messages\">\n          <div class=\"messages-container\" id=\"scroll-container\">\n            ${this._conversation!.map(\n              (message) => html`\n                <div class=${this._computeMessageClasses(message)}>\n                  ${message.text}\n                </div>\n              `\n            )}\n          </div>\n        </div>\n        <div class=\"input\" slot=\"primaryAction\">\n          <ha-textfield\n            id=\"message-input\"\n            @keyup=${this._handleKeyUp}\n            @input=${this._handleInput}\n            .label=${this.hass.localize(`ui.dialogs.voice_command.input_label`)}\n            dialogInitialFocus\n            iconTrailing\n          >\n            <span slot=\"trailingIcon\">\n              ${this._showSendButton || !supportsSTT\n                ? html`\n                    <ha-icon-button\n                      class=\"listening-icon\"\n                      .path=${mdiSend}\n                      @click=${this._handleSendMessage}\n                      .label=${this.hass.localize(\n                        \"ui.dialogs.voice_command.send_text\"\n                      )}\n                    >\n                    </ha-icon-button>\n                  `\n                : html`\n                    ${this._audioRecorder?.active\n                      ? html`\n                          <div class=\"bouncer\">\n                            <div class=\"double-bounce1\"></div>\n                            <div class=\"double-bounce2\"></div>\n                          </div>\n                        `\n                      : nothing}\n\n                    <div class=\"listening-icon\">\n                      <ha-icon-button\n                        .path=${mdiMicrophone}\n                        @click=${this._handleListeningButton}\n                        .label=${this.hass.localize(\n                          \"ui.dialogs.voice_command.start_listening\"\n                        )}\n                      >\n                      </ha-icon-button>\n                      ${!supportsMicrophone\n                        ? html`\n                            <ha-svg-icon\n                              .path=${mdiAlertCircle}\n                              class=\"unsupported\"\n                            ></ha-svg-icon>\n                          `\n                        : null}\n                    </div>\n                  `}\n            </span>\n          </ha-textfield>\n        </div>\n      </ha-dialog>\n    `;\n  }\n\n  protected willUpdate(changedProperties: PropertyValues): void {\n    if (\n      changedProperties.has(\"_pipelineId\") ||\n      (changedProperties.has(\"_opened\") && this._opened === true)\n    ) {\n      this._getPipeline();\n    }\n  }\n\n  private async _getPipeline() {\n    try {\n      this._pipelinePromise = getAssistPipeline(this.hass, this._pipelineId);\n      this._pipeline = await this._pipelinePromise;\n    } catch (e: any) {\n      if (e.code === \"not_found\") {\n        this._pipelineId = undefined;\n      }\n    }\n  }\n\n  private async _loadPipelines() {\n    if (this._pipelines) {\n      return;\n    }\n    const { pipelines, preferred_pipeline } = await listAssistPipelines(\n      this.hass\n    );\n    this._pipelines = pipelines;\n    this._preferredPipeline = preferred_pipeline || undefined;\n  }\n\n  private async _selectPipeline(ev: CustomEvent) {\n    this._pipelineId = (ev.currentTarget as any).pipeline;\n    this._conversation = [\n      {\n        who: \"hass\",\n        text: this.hass.localize(\"ui.dialogs.voice_command.how_can_i_help\"),\n      },\n    ];\n    await this.updateComplete;\n    this._scrollMessagesBottom();\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n    if (changedProps.has(\"_conversation\") || changedProps.has(\"results\")) {\n      this._scrollMessagesBottom();\n    }\n  }\n\n  private _addMessage(message: Message) {\n    this._conversation = [...this._conversation!, message];\n  }\n\n  private _handleKeyUp(ev: KeyboardEvent) {\n    const input = ev.target as HaTextField;\n    if (ev.key === \"Enter\" && input.value) {\n      this._processText(input.value);\n      input.value = \"\";\n      this._showSendButton = false;\n    }\n  }\n\n  private _handleInput(ev: InputEvent) {\n    const value = (ev.target as HaTextField).value;\n    if (value && !this._showSendButton) {\n      this._showSendButton = true;\n    } else if (!value && this._showSendButton) {\n      this._showSendButton = false;\n    }\n  }\n\n  private _handleSendMessage() {\n    if (this._messageInput.value) {\n      this._processText(this._messageInput.value);\n      this._messageInput.value = \"\";\n      this._showSendButton = false;\n    }\n  }\n\n  private async _processText(text: string) {\n    this._audio?.pause();\n    this._addMessage({ who: \"user\", text });\n    const message: Message = {\n      who: \"hass\",\n      text: \"…\",\n    };\n    // To make sure the answer is placed at the right user text, we add it before we process it\n    this._addMessage(message);\n    try {\n      const unsub = await runAssistPipeline(\n        this.hass,\n        (event) => {\n          if (event.type === \"intent-end\") {\n            this._conversationId = event.data.intent_output.conversation_id;\n            const plain = event.data.intent_output.response.speech?.plain;\n            if (plain) {\n              message.text = plain.speech;\n            }\n            this.requestUpdate(\"_conversation\");\n            unsub();\n          }\n          if (event.type === \"error\") {\n            message.text = event.data.message;\n            message.error = true;\n            this.requestUpdate(\"_conversation\");\n            unsub();\n          }\n        },\n        {\n          start_stage: \"intent\",\n          input: { text },\n          end_stage: \"intent\",\n          pipeline: this._pipeline?.id,\n          conversation_id: this._conversationId,\n        }\n      );\n    } catch {\n      message.text = this.hass.localize(\"ui.dialogs.voice_command.error\");\n      message.error = true;\n      this.requestUpdate(\"_conversation\");\n    }\n  }\n\n  private _handleListeningButton(ev) {\n    ev.stopPropagation();\n    ev.preventDefault();\n    this._toggleListening();\n  }\n\n  private _toggleListening() {\n    const supportsMicrophone = AudioRecorder.isSupported;\n    if (!supportsMicrophone) {\n      this._showNotSupportedMessage();\n      return;\n    }\n    if (!this._audioRecorder?.active) {\n      this._startListening();\n    } else {\n      this._stopListening();\n    }\n  }\n\n  private async _showNotSupportedMessage() {\n    this._addMessage({\n      who: \"hass\",\n      text: html`\n        <p>\n          ${this.hass.localize(\n            \"ui.dialogs.voice_command.not_supported_microphone_browser\"\n          )}\n        </p>\n        <p>\n          ${this.hass.localize(\n            \"ui.dialogs.voice_command.not_supported_microphone_documentation\",\n            {\n              documentation_link: html`\n                <a\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  href=${documentationUrl(\n                    this.hass,\n                    \"/docs/configuration/securing/#remote-access\"\n                  )}\n                >\n                  ${this.hass.localize(\n                    \"ui.dialogs.voice_command.not_supported_microphone_documentation_link\"\n                  )}\n                </a>\n              `,\n            }\n          )}\n        </p>\n      `,\n    });\n  }\n\n  private async _startListening() {\n    this._audio?.pause();\n    if (!this._audioRecorder) {\n      this._audioRecorder = new AudioRecorder((audio) => {\n        if (this._audioBuffer) {\n          this._audioBuffer.push(audio);\n        } else {\n          this._sendAudioChunk(audio);\n        }\n      });\n    }\n    this._stt_binary_handler_id = undefined;\n    this._audioBuffer = [];\n    const userMessage: Message = {\n      who: \"user\",\n      text: \"…\",\n    };\n    this._audioRecorder.start().then(() => {\n      this._addMessage(userMessage);\n      this.requestUpdate(\"_audioRecorder\");\n    });\n    const hassMessage: Message = {\n      who: \"hass\",\n      text: \"…\",\n    };\n    // To make sure the answer is placed at the right user text, we add it before we process it\n    try {\n      const unsub = await runAssistPipeline(\n        this.hass,\n        (event) => {\n          if (event.type === \"run-start\") {\n            this._stt_binary_handler_id =\n              event.data.runner_data.stt_binary_handler_id;\n          }\n\n          // When we start STT stage, the WS has a binary handler\n          if (event.type === \"stt-start\" && this._audioBuffer) {\n            // Send the buffer over the WS to the STT engine.\n            for (const buffer of this._audioBuffer) {\n              this._sendAudioChunk(buffer);\n            }\n            this._audioBuffer = undefined;\n          }\n\n          // Stop recording if the server is done with STT stage\n          if (event.type === \"stt-end\") {\n            this._stt_binary_handler_id = undefined;\n            this._stopListening();\n            userMessage.text = event.data.stt_output.text;\n            this.requestUpdate(\"_conversation\");\n            // To make sure the answer is placed at the right user text, we add it before we process it\n            this._addMessage(hassMessage);\n          }\n\n          if (event.type === \"intent-end\") {\n            this._conversationId = event.data.intent_output.conversation_id;\n            const plain = event.data.intent_output.response.speech?.plain;\n            if (plain) {\n              hassMessage.text = plain.speech;\n            }\n            this.requestUpdate(\"_conversation\");\n          }\n\n          if (event.type === \"tts-end\") {\n            const url = event.data.tts_output.url;\n            this._audio = new Audio(url);\n            this._audio.play();\n            this._audio.addEventListener(\"ended\", this._unloadAudio);\n            this._audio.addEventListener(\"pause\", this._unloadAudio);\n            this._audio.addEventListener(\"canplaythrough\", this._playAudio);\n            this._audio.addEventListener(\"error\", this._audioError);\n          }\n\n          if (event.type === \"run-end\") {\n            this._stt_binary_handler_id = undefined;\n            unsub();\n          }\n\n          if (event.type === \"error\") {\n            this._stt_binary_handler_id = undefined;\n            if (userMessage.text === \"…\") {\n              userMessage.text = event.data.message;\n              userMessage.error = true;\n            } else {\n              hassMessage.text = event.data.message;\n              hassMessage.error = true;\n            }\n            this._stopListening();\n            this.requestUpdate(\"_conversation\");\n            unsub();\n          }\n        },\n        {\n          start_stage: \"stt\",\n          end_stage: this._pipeline?.tts_engine ? \"tts\" : \"intent\",\n          input: { sample_rate: this._audioRecorder.sampleRate! },\n          pipeline: this._pipeline?.id,\n          conversation_id: this._conversationId,\n        }\n      );\n    } catch (err: any) {\n      await showAlertDialog(this, {\n        title: \"Error starting pipeline\",\n        text: err.message || err,\n      });\n      this._stopListening();\n    }\n  }\n\n  private _stopListening() {\n    this._audioRecorder?.stop();\n    this.requestUpdate(\"_audioRecorder\");\n    // We're currently STTing, so finish audio\n    if (this._stt_binary_handler_id) {\n      if (this._audioBuffer) {\n        for (const chunk of this._audioBuffer) {\n          this._sendAudioChunk(chunk);\n        }\n      }\n      // Send empty message to indicate we're done streaming.\n      this._sendAudioChunk(new Int16Array());\n      this._stt_binary_handler_id = undefined;\n    }\n    this._audioBuffer = undefined;\n  }\n\n  private _sendAudioChunk(chunk: Int16Array) {\n    this.hass.connection.socket!.binaryType = \"arraybuffer\";\n\n    // eslint-disable-next-line eqeqeq\n    if (this._stt_binary_handler_id == undefined) {\n      return;\n    }\n    // Turn into 8 bit so we can prefix our handler ID.\n    const data = new Uint8Array(1 + chunk.length * 2);\n    data[0] = this._stt_binary_handler_id;\n    data.set(new Uint8Array(chunk.buffer), 1);\n\n    this.hass.connection.socket!.send(data);\n  }\n\n  private _playAudio = () => {\n    this._audio?.play();\n  };\n\n  private _audioError = () => {\n    showAlertDialog(this, { title: \"Error playing audio.\" });\n    this._audio?.removeAttribute(\"src\");\n  };\n\n  private _unloadAudio = () => {\n    this._audio?.removeAttribute(\"src\");\n    this._audio = undefined;\n  };\n\n  private _scrollMessagesBottom() {\n    const scrollContainer = this._scrollContainer;\n    if (!scrollContainer) {\n      return;\n    }\n    scrollContainer.scrollTo(0, 99999);\n  }\n\n  private _computeMessageClasses(message: Message) {\n    return `message ${message.who} ${message.error ? \" error\" : \"\"}`;\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      haStyleDialog,\n      css`\n        .listening-icon {\n          position: relative;\n          color: var(--secondary-text-color);\n          margin-right: -24px;\n          margin-inline-end: -24px;\n          margin-inline-start: initial;\n          direction: var(--direction);\n        }\n\n        .listening-icon[active] {\n          color: var(--primary-color);\n        }\n\n        .unsupported {\n          color: var(--error-color);\n          position: absolute;\n          --mdc-icon-size: 16px;\n          right: 5px;\n          top: 0px;\n        }\n\n        ha-dialog {\n          --primary-action-button-flex: 1;\n          --secondary-action-button-flex: 0;\n          --mdc-dialog-max-width: 500px;\n          --mdc-dialog-max-height: 500px;\n          --dialog-content-padding: 0;\n        }\n        ha-dialog-header a {\n          color: var(--primary-text-color);\n        }\n        div[slot=\"title\"] {\n          display: flex;\n          flex-direction: column;\n          margin: -4px 0;\n        }\n        ha-button-menu {\n          --mdc-theme-on-primary: var(--text-primary-color);\n          --mdc-theme-primary: var(--primary-color);\n          margin-top: -8px;\n          margin-bottom: 0;\n          margin-right: 0;\n          margin-inline-end: 0;\n          margin-left: -8px;\n          margin-inline-start: -8px;\n        }\n        ha-button-menu ha-button {\n          --mdc-theme-primary: var(--secondary-text-color);\n          --mdc-typography-button-text-transform: none;\n          --mdc-typography-button-font-size: unset;\n          --mdc-typography-button-font-weight: 400;\n          --mdc-typography-button-letter-spacing: var(\n            --mdc-typography-headline6-letter-spacing,\n            0.0125em\n          );\n          --mdc-typography-button-line-height: var(\n            --mdc-typography-headline6-line-height,\n            2rem\n          );\n          --button-height: auto;\n        }\n        ha-button-menu ha-button ha-svg-icon {\n          height: 28px;\n          margin-left: 4px;\n          margin-inline-start: 4px;\n          margin-inline-end: initial;\n          direction: var(--direction);\n        }\n        ha-list-item {\n          --mdc-list-item-meta-size: 16px;\n        }\n        ha-list-item ha-svg-icon {\n          margin-left: 4px;\n          margin-inline-start: 4px;\n          margin-inline-end: initial;\n          direction: var(--direction);\n          display: block;\n        }\n        ha-button-menu a {\n          text-decoration: none;\n        }\n        ha-textfield {\n          display: block;\n          overflow: hidden;\n        }\n        a.button {\n          text-decoration: none;\n        }\n        a.button > mwc-button {\n          width: 100%;\n        }\n        .side-by-side {\n          display: flex;\n          margin: 8px 0;\n        }\n        .side-by-side > * {\n          flex: 1 0;\n          padding: 4px;\n        }\n        .messages {\n          display: block;\n          height: 400px;\n          box-sizing: border-box;\n          position: relative;\n        }\n        @media all and (max-width: 450px), all and (max-height: 500px) {\n          ha-dialog {\n            --mdc-dialog-max-width: 100%;\n          }\n          .messages {\n            height: 100%;\n            flex: 1;\n          }\n        }\n        .messages-container {\n          position: absolute;\n          bottom: 0px;\n          right: 0px;\n          left: 0px;\n          padding: 24px;\n          box-sizing: border-box;\n          overflow-y: auto;\n          max-height: 100%;\n        }\n        .message {\n          font-size: 18px;\n          clear: both;\n          margin: 8px 0;\n          padding: 8px;\n          border-radius: 15px;\n        }\n        .message p {\n          margin: 0;\n        }\n        .message p:not(:last-child) {\n          margin-bottom: 8px;\n        }\n\n        .message.user {\n          margin-left: 24px;\n          margin-inline-start: 24px;\n          margin-inline-end: initial;\n          float: var(--float-end);\n          text-align: right;\n          border-bottom-right-radius: 0px;\n          background-color: var(--light-primary-color);\n          color: var(--text-light-primary-color, var(--primary-text-color));\n          direction: var(--direction);\n        }\n\n        .message.hass {\n          margin-right: 24px;\n          margin-inline-end: 24px;\n          margin-inline-start: initial;\n          float: var(--float-start);\n          border-bottom-left-radius: 0px;\n          background-color: var(--primary-color);\n          color: var(--text-primary-color);\n          direction: var(--direction);\n        }\n\n        .message a {\n          color: var(--text-primary-color);\n        }\n\n        .message img {\n          width: 100%;\n          border-radius: 10px;\n        }\n\n        .message.error {\n          background-color: var(--error-color);\n          color: var(--text-primary-color);\n        }\n\n        .input {\n          margin-left: 0;\n          margin-right: 0;\n        }\n\n        .bouncer {\n          width: 48px;\n          height: 48px;\n          position: absolute;\n        }\n        .double-bounce1,\n        .double-bounce2 {\n          width: 48px;\n          height: 48px;\n          border-radius: 50%;\n          background-color: var(--primary-color);\n          opacity: 0.2;\n          position: absolute;\n          top: 0;\n          left: 0;\n          -webkit-animation: sk-bounce 2s infinite ease-in-out;\n          animation: sk-bounce 2s infinite ease-in-out;\n        }\n        .double-bounce2 {\n          -webkit-animation-delay: -1s;\n          animation-delay: -1s;\n        }\n        @-webkit-keyframes sk-bounce {\n          0%,\n          100% {\n            -webkit-transform: scale(0);\n          }\n          50% {\n            -webkit-transform: scale(1);\n          }\n        }\n        @keyframes sk-bounce {\n          0%,\n          100% {\n            transform: scale(0);\n            -webkit-transform: scale(0);\n          }\n          50% {\n            transform: scale(1);\n            -webkit-transform: scale(1);\n          }\n        }\n\n        @media all and (max-width: 450px), all and (max-height: 500px) {\n          .message {\n            font-size: 16px;\n          }\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-voice-command-dialog\": HaVoiceCommandDialog;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}