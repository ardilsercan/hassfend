{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _createForOfIteratorHelper from \"@babel/runtime/helpers/createForOfIteratorHelper\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport { computeDomain } from \"../../../common/entity/compute_domain\";\nvar arrayFilter = function arrayFilter(array, conditions, maxSize) {\n  if (!maxSize || maxSize > array.length) {\n    maxSize = array.length;\n  }\n  var filteredArray = [];\n  for (var i = 0; i < array.length && filteredArray.length < maxSize; i++) {\n    var meetsConditions = true;\n    var _iterator = _createForOfIteratorHelper(conditions),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var condition = _step.value;\n        if (!condition(array[i])) {\n          meetsConditions = false;\n          break;\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n    if (meetsConditions) {\n      filteredArray.push(array[i]);\n    }\n  }\n  return filteredArray;\n};\nexport var findEntities = function findEntities(hass, maxEntities, entities, entitiesFallback, includeDomains, entityFilter) {\n  var conditions = [];\n  if (includeDomains !== null && includeDomains !== void 0 && includeDomains.length) {\n    conditions.push(function (eid) {\n      return includeDomains.includes(computeDomain(eid));\n    });\n  }\n  if (entityFilter) {\n    conditions.push(function (eid) {\n      return hass.states[eid] && entityFilter(hass.states[eid]);\n    });\n  }\n  var entityIds = arrayFilter(entities, conditions, maxEntities);\n  if (entityIds.length < maxEntities && entitiesFallback.length) {\n    var fallbackEntityIds = findEntities(hass, maxEntities - entityIds.length, entitiesFallback, [], includeDomains, entityFilter);\n    entityIds.push.apply(entityIds, _toConsumableArray(fallbackEntityIds));\n  }\n  return entityIds;\n};","map":{"version":3,"names":["computeDomain","arrayFilter","array","conditions","maxSize","length","filteredArray","i","meetsConditions","_iterator","_createForOfIteratorHelper","_step","s","n","done","condition","value","err","e","f","push","findEntities","hass","maxEntities","entities","entitiesFallback","includeDomains","entityFilter","eid","includes","states","entityIds","fallbackEntityIds","apply","_toConsumableArray"],"sources":["/Users/sercanardil/Desktop/frontend/src/panels/lovelace/common/find-entities.ts"],"sourcesContent":["import { HassEntity } from \"home-assistant-js-websocket\";\nimport { computeDomain } from \"../../../common/entity/compute_domain\";\nimport { HomeAssistant } from \"../../../types\";\n\nconst arrayFilter = (\n  array: any[],\n  conditions: Array<(value: any) => boolean>,\n  maxSize: number\n) => {\n  if (!maxSize || maxSize > array.length) {\n    maxSize = array.length;\n  }\n\n  const filteredArray: any[] = [];\n\n  for (let i = 0; i < array.length && filteredArray.length < maxSize; i++) {\n    let meetsConditions = true;\n\n    for (const condition of conditions) {\n      if (!condition(array[i])) {\n        meetsConditions = false;\n        break;\n      }\n    }\n\n    if (meetsConditions) {\n      filteredArray.push(array[i]);\n    }\n  }\n\n  return filteredArray;\n};\n\nexport const findEntities = (\n  hass: HomeAssistant,\n  maxEntities: number,\n  entities: string[],\n  entitiesFallback: string[],\n  includeDomains?: string[],\n  entityFilter?: (stateObj: HassEntity) => boolean\n) => {\n  const conditions: Array<(value: string) => boolean> = [];\n\n  if (includeDomains?.length) {\n    conditions.push((eid) => includeDomains!.includes(computeDomain(eid)));\n  }\n\n  if (entityFilter) {\n    conditions.push(\n      (eid) => hass.states[eid] && entityFilter(hass.states[eid])\n    );\n  }\n\n  const entityIds = arrayFilter(entities, conditions, maxEntities);\n\n  if (entityIds.length < maxEntities && entitiesFallback.length) {\n    const fallbackEntityIds = findEntities(\n      hass,\n      maxEntities - entityIds.length,\n      entitiesFallback,\n      [],\n      includeDomains,\n      entityFilter\n    );\n\n    entityIds.push(...fallbackEntityIds);\n  }\n\n  return entityIds;\n};\n"],"mappings":";;;;;AACA,SAASA,aAAa,QAAQ,uCAAuC;AAGrE,IAAMC,WAAW,GAAG,SAAdA,WAAWA,CACfC,KAAY,EACZC,UAA0C,EAC1CC,OAAe,EACZ;EACH,IAAI,CAACA,OAAO,IAAIA,OAAO,GAAGF,KAAK,CAACG,MAAM,EAAE;IACtCD,OAAO,GAAGF,KAAK,CAACG,MAAM;EACxB;EAEA,IAAMC,aAAoB,GAAG,EAAE;EAE/B,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,KAAK,CAACG,MAAM,IAAIC,aAAa,CAACD,MAAM,GAAGD,OAAO,EAAEG,CAAC,EAAE,EAAE;IACvE,IAAIC,eAAe,GAAG,IAAI;IAAC,IAAAC,SAAA,GAAAC,0BAAA,CAEHP,UAAU;MAAAQ,KAAA;IAAA;MAAlC,KAAAF,SAAA,CAAAG,CAAA,MAAAD,KAAA,GAAAF,SAAA,CAAAI,CAAA,IAAAC,IAAA,GAAoC;QAAA,IAAzBC,SAAS,GAAAJ,KAAA,CAAAK,KAAA;QAClB,IAAI,CAACD,SAAS,CAACb,KAAK,CAACK,CAAC,CAAC,CAAC,EAAE;UACxBC,eAAe,GAAG,KAAK;UACvB;QACF;MACF;IAAC,SAAAS,GAAA;MAAAR,SAAA,CAAAS,CAAA,CAAAD,GAAA;IAAA;MAAAR,SAAA,CAAAU,CAAA;IAAA;IAED,IAAIX,eAAe,EAAE;MACnBF,aAAa,CAACc,IAAI,CAAClB,KAAK,CAACK,CAAC,CAAC,CAAC;IAC9B;EACF;EAEA,OAAOD,aAAa;AACtB,CAAC;AAED,OAAO,IAAMe,YAAY,GAAG,SAAfA,YAAYA,CACvBC,IAAmB,EACnBC,WAAmB,EACnBC,QAAkB,EAClBC,gBAA0B,EAC1BC,cAAyB,EACzBC,YAAgD,EAC7C;EACH,IAAMxB,UAA6C,GAAG,EAAE;EAExD,IAAIuB,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAErB,MAAM,EAAE;IAC1BF,UAAU,CAACiB,IAAI,CAAC,UAACQ,GAAG;MAAA,OAAKF,cAAc,CAAEG,QAAQ,CAAC7B,aAAa,CAAC4B,GAAG,CAAC,CAAC;IAAA,EAAC;EACxE;EAEA,IAAID,YAAY,EAAE;IAChBxB,UAAU,CAACiB,IAAI,CACb,UAACQ,GAAG;MAAA,OAAKN,IAAI,CAACQ,MAAM,CAACF,GAAG,CAAC,IAAID,YAAY,CAACL,IAAI,CAACQ,MAAM,CAACF,GAAG,CAAC,CAAC;IAAA,CAC7D,CAAC;EACH;EAEA,IAAMG,SAAS,GAAG9B,WAAW,CAACuB,QAAQ,EAAErB,UAAU,EAAEoB,WAAW,CAAC;EAEhE,IAAIQ,SAAS,CAAC1B,MAAM,GAAGkB,WAAW,IAAIE,gBAAgB,CAACpB,MAAM,EAAE;IAC7D,IAAM2B,iBAAiB,GAAGX,YAAY,CACpCC,IAAI,EACJC,WAAW,GAAGQ,SAAS,CAAC1B,MAAM,EAC9BoB,gBAAgB,EAChB,EAAE,EACFC,cAAc,EACdC,YACF,CAAC;IAEDI,SAAS,CAACX,IAAI,CAAAa,KAAA,CAAdF,SAAS,EAAAG,kBAAA,CAASF,iBAAiB,EAAC;EACtC;EAEA,OAAOD,SAAS;AAClB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}