{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nconst mdiDrag = \"M7,19V17H9V19H7M11,19V17H13V19H11M15,19V17H17V19H15M7,15V13H9V15H7M11,15V13H13V15H11M15,15V13H17V15H15M7,11V9H9V11H7M11,11V9H13V11H11M15,11V9H17V11H15M7,7V5H9V7H7M11,7V5H13V7H11M15,7V5H17V7H15Z\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { repeat } from \"lit/directives/repeat\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport \"../../../components/entity/ha-entity-picker\";\nimport \"../../../components/ha-icon-button\";\nimport \"../../../components/ha-sortable\";\nexport let HuiEntityEditor = _decorate([customElement(\"hui-entity-editor\")], function (_initialize, _LitElement) {\n  class HuiEntityEditor extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: HuiEntityEditor,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"entities\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"entityFilter\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"label\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_entityKeys\",\n      value() {\n        return new WeakMap();\n      }\n    }, {\n      kind: \"method\",\n      key: \"_getKey\",\n      value: function _getKey(action) {\n        if (!this._entityKeys.has(action)) {\n          this._entityKeys.set(action, Math.random().toString());\n        }\n        return this._entityKeys.get(action);\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this.entities) {\n          return nothing;\n        }\n        return html`\n      <h3>\n        ${this.label || this.hass.localize(\"ui.panel.lovelace.editor.card.generic.entities\") + \" (\" + this.hass.localize(\"ui.panel.lovelace.editor.card.config.required\") + \")\"}\n      </h3>\n      <ha-sortable handle-selector=\".handle\" @item-moved=${this._entityMoved}>\n        <div class=\"entities\">\n          ${repeat(this.entities, entityConf => this._getKey(entityConf), (entityConf, index) => html`\n              <div class=\"entity\" data-entity-id=${entityConf.entity}>\n                <div class=\"handle\">\n                  <ha-svg-icon .path=${mdiDrag}></ha-svg-icon>\n                </div>\n                <ha-entity-picker\n                  .hass=${this.hass}\n                  .value=${entityConf.entity}\n                  .index=${index}\n                  .entityFilter=${this.entityFilter}\n                  @value-changed=${this._valueChanged}\n                  allow-custom-entity\n                ></ha-entity-picker>\n              </div>\n            `)}\n        </div>\n      </ha-sortable>\n      <ha-entity-picker\n        class=\"add-entity\"\n        .hass=${this.hass}\n        .entityFilter=${this.entityFilter}\n        @value-changed=${this._addEntity}\n      ></ha-entity-picker>\n    `;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_addEntity\",\n      value: async function _addEntity(ev) {\n        const value = ev.detail.value;\n        if (value === \"\") {\n          return;\n        }\n        const newConfigEntities = this.entities.concat({\n          entity: value\n        });\n        ev.target.value = \"\";\n        fireEvent(this, \"entities-changed\", {\n          entities: newConfigEntities\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_entityMoved\",\n      value: function _entityMoved(ev) {\n        ev.stopPropagation();\n        const {\n          oldIndex,\n          newIndex\n        } = ev.detail;\n        const newEntities = this.entities.concat();\n        newEntities.splice(newIndex, 0, newEntities.splice(oldIndex, 1)[0]);\n        fireEvent(this, \"entities-changed\", {\n          entities: newEntities\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_valueChanged\",\n      value: function _valueChanged(ev) {\n        const value = ev.detail.value;\n        const index = ev.target.index;\n        const newConfigEntities = this.entities.concat();\n        if (value === \"\" || value === undefined) {\n          newConfigEntities.splice(index, 1);\n        } else {\n          newConfigEntities[index] = {\n            ...newConfigEntities[index],\n            entity: value\n          };\n        }\n        fireEvent(this, \"entities-changed\", {\n          entities: newConfigEntities\n        });\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return css`\n      ha-entity-picker {\n        margin-top: 8px;\n      }\n      .add-entity {\n        display: block;\n        margin-left: 31px;\n        margin-inline-start: 31px;\n        margin-inline-end: initial;\n        direction: var(--direction);\n      }\n      .entity {\n        display: flex;\n        align-items: center;\n      }\n      .entity .handle {\n        padding-right: 8px;\n        cursor: move; /* fallback if grab cursor is unsupported */\n        cursor: grab;\n        padding-inline-end: 8px;\n        padding-inline-start: initial;\n        direction: var(--direction);\n      }\n      .entity .handle > * {\n        pointer-events: none;\n      }\n      .entity ha-entity-picker {\n        flex-grow: 1;\n      }\n    `;\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["css","html","LitElement","nothing","customElement","property","repeat","fireEvent","HuiEntityEditor","_decorate","_initialize","_LitElement","constructor","args","F","d","kind","decorators","attribute","key","value","WeakMap","_getKey","action","_entityKeys","has","set","Math","random","toString","get","render","entities","label","hass","localize","_entityMoved","entityConf","index","entity","mdiDrag","entityFilter","_valueChanged","_addEntity","ev","detail","newConfigEntities","concat","target","stopPropagation","oldIndex","newIndex","newEntities","splice","undefined","static","styles"],"sources":["/workspaces/frontend/src/panels/lovelace/components/hui-entity-editor.ts"],"sourcesContent":["import { mdiDrag } from \"@mdi/js\";\nimport { css, CSSResultGroup, html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { repeat } from \"lit/directives/repeat\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport \"../../../components/entity/ha-entity-picker\";\nimport type {\n  HaEntityPicker,\n  HaEntityPickerEntityFilterFunc,\n} from \"../../../components/entity/ha-entity-picker\";\nimport \"../../../components/ha-icon-button\";\nimport \"../../../components/ha-sortable\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityConfig } from \"../entity-rows/types\";\n\n@customElement(\"hui-entity-editor\")\nexport class HuiEntityEditor extends LitElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property({ attribute: false }) public entities?: EntityConfig[];\n\n  @property({ attribute: false })\n  public entityFilter?: HaEntityPickerEntityFilterFunc;\n\n  @property() public label?: string;\n\n  private _entityKeys = new WeakMap<EntityConfig, string>();\n\n  private _getKey(action: EntityConfig) {\n    if (!this._entityKeys.has(action)) {\n      this._entityKeys.set(action, Math.random().toString());\n    }\n\n    return this._entityKeys.get(action)!;\n  }\n\n  protected render() {\n    if (!this.entities) {\n      return nothing;\n    }\n\n    return html`\n      <h3>\n        ${this.label ||\n        this.hass!.localize(\"ui.panel.lovelace.editor.card.generic.entities\") +\n          \" (\" +\n          this.hass!.localize(\"ui.panel.lovelace.editor.card.config.required\") +\n          \")\"}\n      </h3>\n      <ha-sortable handle-selector=\".handle\" @item-moved=${this._entityMoved}>\n        <div class=\"entities\">\n          ${repeat(\n            this.entities,\n            (entityConf) => this._getKey(entityConf),\n            (entityConf, index) => html`\n              <div class=\"entity\" data-entity-id=${entityConf.entity}>\n                <div class=\"handle\">\n                  <ha-svg-icon .path=${mdiDrag}></ha-svg-icon>\n                </div>\n                <ha-entity-picker\n                  .hass=${this.hass}\n                  .value=${entityConf.entity}\n                  .index=${index}\n                  .entityFilter=${this.entityFilter}\n                  @value-changed=${this._valueChanged}\n                  allow-custom-entity\n                ></ha-entity-picker>\n              </div>\n            `\n          )}\n        </div>\n      </ha-sortable>\n      <ha-entity-picker\n        class=\"add-entity\"\n        .hass=${this.hass}\n        .entityFilter=${this.entityFilter}\n        @value-changed=${this._addEntity}\n      ></ha-entity-picker>\n    `;\n  }\n\n  private async _addEntity(ev: CustomEvent): Promise<void> {\n    const value = ev.detail.value;\n    if (value === \"\") {\n      return;\n    }\n    const newConfigEntities = this.entities!.concat({\n      entity: value as string,\n    });\n    (ev.target as HaEntityPicker).value = \"\";\n    fireEvent(this, \"entities-changed\", { entities: newConfigEntities });\n  }\n\n  private _entityMoved(ev: CustomEvent): void {\n    ev.stopPropagation();\n    const { oldIndex, newIndex } = ev.detail;\n\n    const newEntities = this.entities!.concat();\n\n    newEntities.splice(newIndex, 0, newEntities.splice(oldIndex, 1)[0]);\n\n    fireEvent(this, \"entities-changed\", { entities: newEntities });\n  }\n\n  private _valueChanged(ev: CustomEvent): void {\n    const value = ev.detail.value;\n    const index = (ev.target as any).index;\n    const newConfigEntities = this.entities!.concat();\n\n    if (value === \"\" || value === undefined) {\n      newConfigEntities.splice(index, 1);\n    } else {\n      newConfigEntities[index] = {\n        ...newConfigEntities[index],\n        entity: value!,\n      };\n    }\n\n    fireEvent(this, \"entities-changed\", { entities: newConfigEntities });\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ha-entity-picker {\n        margin-top: 8px;\n      }\n      .add-entity {\n        display: block;\n        margin-left: 31px;\n        margin-inline-start: 31px;\n        margin-inline-end: initial;\n        direction: var(--direction);\n      }\n      .entity {\n        display: flex;\n        align-items: center;\n      }\n      .entity .handle {\n        padding-right: 8px;\n        cursor: move; /* fallback if grab cursor is unsupported */\n        cursor: grab;\n        padding-inline-end: 8px;\n        padding-inline-start: initial;\n        direction: var(--direction);\n      }\n      .entity .handle > * {\n        pointer-events: none;\n      }\n      .entity ha-entity-picker {\n        flex-grow: 1;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entity-editor\": HuiEntityEditor;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}