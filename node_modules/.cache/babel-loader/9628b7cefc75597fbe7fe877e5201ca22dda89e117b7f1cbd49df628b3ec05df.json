{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.weak-map.js\";\nimport \"core-js/modules/es.weak-set.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.every.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport { nothing } from 'lit/html.js';\nimport { directive, PartType } from 'lit/directive.js';\nimport { AsyncDirective } from 'lit/async-directive.js';\nimport { controllerMap } from './animate-controller.js';\nexport { AnimateController } from './animate-controller.js';\n// zIndex for \"in\" animations\nvar z = 0;\nvar disconnectedProps = new Map();\nvar renderedHosts = new WeakSet();\nexport var animationFrame = function animationFrame() {\n  return new Promise(function (resolve) {\n    return requestAnimationFrame(resolve);\n  });\n};\n// Presets for animating \"in\" and \"out\" of the DOM.\nexport var flyBelow = [{\n  transform: 'translateY(100%) scale(0)',\n  opacity: 0\n}];\nexport var flyAbove = [{\n  transform: 'translateY(-100%) scale(0)',\n  opacity: 0\n}];\nexport var flyLeft = [{\n  transform: 'translateX(-100%) scale(0)',\n  opacity: 0\n}];\nexport var flyRight = [{\n  transform: 'translateX(100%) scale(0)',\n  opacity: 0\n}];\nexport var none = [{}];\nexport var fadeOut = [{\n  opacity: 0\n}];\nexport var fade = fadeOut;\nexport var fadeIn = [{\n  opacity: 0\n}, {\n  opacity: 1\n}];\nexport var fadeInSlow = [{\n  opacity: 0\n}, {\n  opacity: 0.25,\n  offset: 0.75\n}, {\n  opacity: 1\n}];\nvar diffOp = function diffOp(a, b) {\n  var v = a - b;\n  return v === 0 ? undefined : v;\n};\nvar quotientOp = function quotientOp(a, b) {\n  var v = a / b;\n  return v === 1 ? undefined : v;\n};\n// Computes a transform given a before and after input for given properties.\nexport var transformProps = {\n  left: function left(a, b) {\n    var value = diffOp(a, b);\n    var transform = value == null || isNaN(value) ? undefined : \"translateX(\".concat(value, \"px)\");\n    return {\n      value: value,\n      transform: transform\n    };\n  },\n  top: function top(a, b) {\n    var value = diffOp(a, b);\n    var transform = value == null || isNaN(value) ? undefined : \"translateY(\".concat(value, \"px)\");\n    return {\n      value: value,\n      transform: transform\n    };\n  },\n  width: function width(a, b) {\n    var override = undefined;\n    // 'To' values of 0 would cause `value` to be Infinity. Instead we override\n    // `b` to be 1 and add 1px as an override of width.\n    if (b === 0) {\n      b = 1;\n      override = {\n        width: '1px'\n      };\n    }\n    var value = quotientOp(a, b);\n    var transform = value == null || isNaN(value) ? undefined : \"scaleX(\".concat(value, \")\");\n    return {\n      value: value,\n      overrideFrom: override,\n      transform: transform\n    };\n  },\n  height: function height(a, b) {\n    var override = undefined;\n    // 'To' values of 0 would cause `value` to be Infinity. Instead we override\n    // `b` to be 1 and add 1px as an override of height.\n    if (b === 0) {\n      b = 1;\n      override = {\n        height: '1px'\n      };\n    }\n    var value = quotientOp(a, b);\n    var transform = value == null || isNaN(value) ? undefined : \"scaleY(\".concat(value, \")\");\n    return {\n      value: value,\n      overrideFrom: override,\n      transform: transform\n    };\n  }\n};\nexport var defaultKeyframeOptions = {\n  duration: 333,\n  easing: \"ease-in-out\"\n};\nexport var defaultCssProperties = ['left', 'top', 'width', 'height', 'opacity', 'color', 'background'];\n// Dirty checks the value received from the `guard` option.\nvar isDirty = function isDirty(value, previous) {\n  if (Array.isArray(value)) {\n    // Dirty-check arrays by item\n    if (Array.isArray(previous) && previous.length === value.length && value.every(function (v, i) {\n      return v === previous[i];\n    })) {\n      return false;\n    }\n  } else if (previous === value) {\n    // Dirty-check non-arrays by identity\n    return false;\n  }\n  return true;\n};\n// Mapping of node on which the `animate` directive is used to the `animate` directive.\n// Used to get the ancestor `animate` animations (which are used to modify\n// `animate` transforms), done by ascending the DOM.\nvar nodeToAnimateMap = new WeakMap();\n/**\n * `animate` directive class. Animates a node's position between renders.\n */\nexport var Animate = /*#__PURE__*/function (_AsyncDirective) {\n  _inherits(Animate, _AsyncDirective);\n  function Animate(part) {\n    var _this;\n    _classCallCheck(this, Animate);\n    _this = _callSuper(this, Animate, [part]);\n    _this._parentNode = null;\n    _this._nextSibling = null;\n    _this._shouldAnimate = true;\n    _this.shouldLog = false;\n    if (part.type === PartType.CHILD) {\n      throw new Error('The `animate` directive must be used in attribute position.');\n    }\n    _this.createFinished();\n    return _this;\n  }\n  _createClass(Animate, [{\n    key: \"createFinished\",\n    value: function createFinished() {\n      var _this$resolveFinished,\n        _this2 = this;\n      (_this$resolveFinished = this.resolveFinished) === null || _this$resolveFinished === void 0 || _this$resolveFinished.call(this);\n      this.finished = new Promise(function (r) {\n        _this2._resolveFinished = r;\n      });\n    }\n  }, {\n    key: \"resolveFinished\",\n    value: function () {\n      var _resolveFinished = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var _this$_resolveFinishe;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              (_this$_resolveFinishe = this._resolveFinished) === null || _this$_resolveFinishe === void 0 || _this$_resolveFinishe.call(this);\n              this._resolveFinished = undefined;\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function resolveFinished() {\n        return _resolveFinished.apply(this, arguments);\n      }\n      return resolveFinished;\n    }()\n  }, {\n    key: \"render\",\n    value: function render(_options) {\n      return nothing;\n    }\n  }, {\n    key: \"getController\",\n    value: function getController() {\n      return controllerMap.get(this._host);\n    }\n  }, {\n    key: \"isDisabled\",\n    value: function isDisabled() {\n      var _this$getController;\n      return this.options.disabled || ((_this$getController = this.getController()) === null || _this$getController === void 0 ? void 0 : _this$getController.disabled);\n    }\n  }, {\n    key: \"update\",\n    value: function update(part, _ref) {\n      var _ref2 = _slicedToArray(_ref, 1),\n        options = _ref2[0];\n      var firstUpdate = this._host === undefined;\n      if (firstUpdate) {\n        var _part$options;\n        this._host = (_part$options = part.options) === null || _part$options === void 0 ? void 0 : _part$options.host;\n        this._host.addController(this);\n        this.element = part.element;\n        nodeToAnimateMap.set(this.element, this);\n      }\n      this.optionsOrCallback = options;\n      if (firstUpdate || typeof options !== 'function') {\n        this._setOptions(options);\n      }\n      return this.render(options);\n    }\n    // TODO(sorvell): instead of a function/object, just use an object that the\n    // user can mutate and create accessors for the data that do lookups as needed.\n    // We're doing this every hostUpdate anyway and these lookups are fast.\n  }, {\n    key: \"_setOptions\",\n    value: function _setOptions(options) {\n      var _options2, _options3, _options3$properties;\n      options = (_options2 = options) !== null && _options2 !== void 0 ? _options2 : {};\n      // Mixin controller options.\n      var controller = this.getController();\n      if (controller !== undefined) {\n        options = Object.assign(Object.assign({}, controller.defaultOptions), options);\n        options.keyframeOptions = Object.assign(Object.assign({}, controller.defaultOptions.keyframeOptions), options.keyframeOptions);\n      }\n      // Ensure there are some properties to animation and some animation options.\n      (_options3$properties = (_options3 = options).properties) !== null && _options3$properties !== void 0 ? _options3$properties : _options3.properties = defaultCssProperties;\n      this.options = options;\n    }\n    // Measures and returns metrics for the element's bounding box and styling\n  }, {\n    key: \"_measure\",\n    value: function _measure() {\n      var props = {};\n      var bounds = this.element.getBoundingClientRect();\n      var computedStyle = getComputedStyle(this.element);\n      this.options.properties.forEach(function (p) {\n        var _bounds$p;\n        var v = (_bounds$p = bounds[p]) !== null && _bounds$p !== void 0 ? _bounds$p : !transformProps[p] ? computedStyle[p] : undefined;\n        var asNum = Number(v);\n        props[p] = isNaN(asNum) ? String(v) : asNum;\n      });\n      return props;\n    }\n    // Returns true if a `animate` should be started.\n  }, {\n    key: \"_canStart\",\n    value: function _canStart() {\n      var dirty = true,\n        value = undefined;\n      if (this.options.guard) {\n        value = this.options.guard();\n        dirty = isDirty(value, this._previousValue);\n      }\n      this._shouldAnimate = this._host.hasUpdated && !this.isDisabled() && !this.isAnimating() && dirty && this.element.isConnected;\n      if (this._shouldAnimate) {\n        // Copy the value if it's an array so that if it's mutated we don't forget\n        // what the previous values were.\n        this._previousValue = Array.isArray(value) ? Array.from(value) : value;\n      }\n      return this._shouldAnimate;\n    }\n  }, {\n    key: \"hostUpdate\",\n    value: function hostUpdate() {\n      // TODO(sorvell): If options will change that will affect measuring,\n      // then the user must pass a callback which can be called at update time.\n      if (typeof this.optionsOrCallback === 'function') {\n        this._setOptions(this.optionsOrCallback());\n      }\n      if (this._canStart()) {\n        var _this$_parentNode;\n        this._fromValues = this._measure();\n        // Record parent and nextSibling used to re-attach node when animating \"out\"\n        this._parentNode = (_this$_parentNode = this._parentNode) !== null && _this$_parentNode !== void 0 ? _this$_parentNode : this.element.parentNode;\n        this._nextSibling = this.element.nextSibling;\n      }\n    }\n  }, {\n    key: \"hostUpdated\",\n    value: function () {\n      var _hostUpdated = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var frames, ancestors, animationOptions, toValues, _this$_applyAncestorA, from, to, disconnected, _this$_applyAncestorA2, _from, _to;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(!this._shouldAnimate || !this.element.isConnected || this.options.skipInitial && !this.isHostRendered)) {\n                _context2.next = 2;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 2:\n              this.prepare();\n              // Wait for rendering so any sub-elements have a chance to render.\n              _context2.next = 5;\n              return animationFrame;\n            case 5:\n              ancestors = this._getAncestors(); // These inherit from ancestors. This allows easier synchronization of\n              // child `animate`s within ancestor `animate`s.\n              animationOptions = this._calculateKeyframeOptions(this.options.keyframeOptions, ancestors);\n              toValues = this._measure(); // Normal or inverse scale\n              if (this._fromValues !== undefined) {\n                _this$_applyAncestorA = this._applyAncestorAdjustments(this._fromValues, toValues, ancestors), from = _this$_applyAncestorA.from, to = _this$_applyAncestorA.to;\n                this.log('measured', [this._fromValues, toValues, from, to]);\n                frames = this.calculateKeyframes(from, to);\n                // \"In\" `animate`.\n              } else {\n                disconnected = disconnectedProps.get(this.options.inId);\n                if (disconnected) {\n                  // use disconnected data only once.\n                  disconnectedProps.delete(this.options.inId);\n                  _this$_applyAncestorA2 = this._applyAncestorAdjustments(disconnected, toValues, ancestors), _from = _this$_applyAncestorA2.from, _to = _this$_applyAncestorA2.to;\n                  frames = this.calculateKeyframes(_from, _to);\n                  // \"merge\" with \"in\" frames\n                  frames = this.options.in ? [Object.assign(Object.assign({}, this.options.in[0]), frames[0])].concat(_toConsumableArray(this.options.in.slice(1)), [frames[1]]) : frames;\n                  // adjust z so always on top...\n                  z++;\n                  frames.forEach(function (f) {\n                    return f['zIndex'] = z;\n                  });\n                } else if (this.options.in) {\n                  frames = [].concat(_toConsumableArray(this.options.in), [{}]);\n                }\n              }\n              noAwait(this.animate(frames, animationOptions));\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function hostUpdated() {\n        return _hostUpdated.apply(this, arguments);\n      }\n      return hostUpdated;\n    }()\n  }, {\n    key: \"resetStyles\",\n    value: function resetStyles() {\n      if (this._styles !== undefined) {\n        var _this$_styles;\n        this.element.setAttribute('style', (_this$_styles = this._styles) !== null && _this$_styles !== void 0 ? _this$_styles : '');\n        this._styles = undefined;\n      }\n    }\n  }, {\n    key: \"commitStyles\",\n    value: function commitStyles() {\n      var _this$webAnimation, _this$webAnimation2;\n      this._styles = this.element.getAttribute('style');\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (_this$webAnimation = this.webAnimation) === null || _this$webAnimation === void 0 || _this$webAnimation.commitStyles();\n      (_this$webAnimation2 = this.webAnimation) === null || _this$webAnimation2 === void 0 || _this$webAnimation2.cancel();\n    }\n  }, {\n    key: \"reconnected\",\n    value: function reconnected() {}\n    // Experimental animate out functionality.\n  }, {\n    key: \"disconnected\",\n    value: function () {\n      var _disconnected = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var _this$_parentNode2;\n        var ref, shifted, left, top, isStatic, keyframeOptions;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              if (this._shouldAnimate) {\n                _context3.next = 2;\n                break;\n              }\n              return _context3.abrupt(\"return\");\n            case 2:\n              if (this.options.id !== undefined) {\n                disconnectedProps.set(this.options.id, this._fromValues);\n              }\n              if (!(this.options.out === undefined)) {\n                _context3.next = 5;\n                break;\n              }\n              return _context3.abrupt(\"return\");\n            case 5:\n              this.prepare();\n              _context3.next = 8;\n              return animationFrame();\n            case 8:\n              if ((_this$_parentNode2 = this._parentNode) !== null && _this$_parentNode2 !== void 0 && _this$_parentNode2.isConnected) {\n                // put element back in DOM\n                ref = this._nextSibling && this._nextSibling.parentNode === this._parentNode ? this._nextSibling : null;\n                this._parentNode.insertBefore(this.element, ref);\n                // Optionally move element back to its position before it was detached.\n                if (this.options.stabilizeOut) {\n                  // Measure current position after re-attaching.\n                  shifted = this._measure();\n                  this.log('stabilizing out');\n                  // TODO(sorvell): these nudges could conflict with existing styling\n                  // or animation but setting left/top should be rare, especially via\n                  // animation.\n                  left = this._fromValues['left'] - shifted['left'];\n                  top = this._fromValues['top'] - shifted['top'];\n                  isStatic = getComputedStyle(this.element).position === 'static';\n                  if (isStatic && (left !== 0 || top !== 0)) {\n                    this.element.style.position = 'relative';\n                  }\n                  if (left !== 0) {\n                    this.element.style.left = left + 'px';\n                  }\n                  if (top !== 0) {\n                    this.element.style.top = top + 'px';\n                  }\n                }\n              }\n              // These inherit from ancestors. This allows easier synchronization of\n              // child `animate`s within ancestor `animate`s.\n              keyframeOptions = this._calculateKeyframeOptions(this.options.keyframeOptions);\n              _context3.next = 12;\n              return this.animate(this.options.out, keyframeOptions);\n            case 12:\n              this.element.remove();\n            case 13:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function disconnected() {\n        return _disconnected.apply(this, arguments);\n      }\n      return disconnected;\n    }()\n  }, {\n    key: \"prepare\",\n    value: function prepare() {\n      this.createFinished();\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this$options$onStart, _this$options;\n      (_this$options$onStart = (_this$options = this.options).onStart) === null || _this$options$onStart === void 0 || _this$options$onStart.call(_this$options, this);\n    }\n  }, {\n    key: \"didFinish\",\n    value: function didFinish(didAnimate) {\n      if (didAnimate) {\n        var _this$options$onCompl, _this$options2;\n        (_this$options$onCompl = (_this$options2 = this.options).onComplete) === null || _this$options$onCompl === void 0 || _this$options$onCompl.call(_this$options2, this);\n      }\n      this._fromValues = undefined;\n      this.animatingProperties = undefined;\n      this.frames = undefined;\n      this.resolveFinished();\n    }\n  }, {\n    key: \"_getAncestors\",\n    value: function _getAncestors() {\n      var ancestors = [];\n      for (var p = this.element.parentNode; p; p = (_p2 = p) === null || _p2 === void 0 ? void 0 : _p2.parentNode) {\n        var _p2;\n        var a = nodeToAnimateMap.get(p);\n        if (a && !a.isDisabled() && a) {\n          ancestors.push(a);\n        }\n      }\n      return ancestors;\n    }\n  }, {\n    key: \"isHostRendered\",\n    get: function get() {\n      var _this3 = this;\n      var hostRendered = renderedHosts.has(this._host);\n      if (!hostRendered) {\n        this._host.updateComplete.then(function () {\n          renderedHosts.add(_this3._host);\n        });\n      }\n      return hostRendered;\n    }\n  }, {\n    key: \"_calculateKeyframeOptions\",\n    value: function _calculateKeyframeOptions(options) {\n      var ancestors = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._getAncestors();\n      // merges this `animate`'s options over ancestor options over defaults\n      var keyframeOptions = Object.assign({}, defaultKeyframeOptions);\n      ancestors.forEach(function (a) {\n        return Object.assign(keyframeOptions, a.options.keyframeOptions);\n      });\n      Object.assign(keyframeOptions, options);\n      return keyframeOptions;\n    }\n    // Adjust position based on ancestor scaling.\n  }, {\n    key: \"_applyAncestorAdjustments\",\n    value: function _applyAncestorAdjustments(from, to, ancestors) {\n      from = Object.assign({}, from);\n      to = Object.assign({}, to);\n      var ancestorProps = ancestors.map(function (a) {\n        return a.animatingProperties;\n      }).filter(function (a) {\n        return a !== undefined;\n      });\n      var dScaleX = 1;\n      var dScaleY = 1;\n      if (ancestorProps !== undefined) {\n        // gather scaling data for ancestors\n        ancestorProps.forEach(function (a) {\n          if (a['width']) {\n            dScaleX = dScaleX / a['width'];\n          }\n          if (a['height']) {\n            dScaleY = dScaleY / a['height'];\n          }\n        });\n        // Move position by ancestor scaling amount.\n        if (from['left'] !== undefined && to['left'] !== undefined) {\n          from['left'] = dScaleX * from['left'];\n          to['left'] = dScaleX * to['left'];\n        }\n        if (from['top'] !== undefined && to['top'] !== undefined) {\n          from['top'] = dScaleY * from['top'];\n          to['top'] = dScaleY * to['top'];\n        }\n      }\n      return {\n        from: from,\n        to: to\n      };\n    }\n  }, {\n    key: \"calculateKeyframes\",\n    value: function calculateKeyframes(from, to) {\n      var center = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var fromFrame = {};\n      var toFrame = {};\n      var hasFrames = false;\n      var props = {};\n      for (var p in to) {\n        var f = from[p],\n          t = to[p];\n        if (p in transformProps) {\n          var tp = transformProps[p];\n          if (f === undefined || t === undefined) {\n            continue;\n          }\n          var op = tp(f, t);\n          if (op.transform !== undefined) {\n            var _fromFrame$transform;\n            props[p] = op.value;\n            hasFrames = true;\n            fromFrame['transform'] = \"\".concat((_fromFrame$transform = fromFrame['transform']) !== null && _fromFrame$transform !== void 0 ? _fromFrame$transform : '', \" \").concat(op['transform']);\n            if (op.overrideFrom !== undefined) {\n              Object.assign(fromFrame, op.overrideFrom);\n            }\n          }\n        } else if (f !== t && f !== undefined && t !== undefined) {\n          hasFrames = true;\n          fromFrame[p] = f;\n          toFrame[p] = t;\n        }\n      }\n      fromFrame['transformOrigin'] = toFrame['transformOrigin'] = center ? 'center center' : 'top left';\n      this.animatingProperties = props;\n      return hasFrames ? [fromFrame, toFrame] : undefined;\n    }\n  }, {\n    key: \"animate\",\n    value: function () {\n      var _animate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(frames) {\n        var options,\n          didAnimate,\n          controller,\n          _args4 = arguments;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              options = _args4.length > 1 && _args4[1] !== undefined ? _args4[1] : this.options.keyframeOptions;\n              this.start();\n              this.frames = frames;\n              didAnimate = false;\n              if (!(!this.isAnimating() && !this.isDisabled())) {\n                _context4.next = 20;\n                break;\n              }\n              if (this.options.onFrames) {\n                this.frames = frames = this.options.onFrames(this);\n                this.log('modified frames', frames);\n              }\n              if (!(frames !== undefined)) {\n                _context4.next = 20;\n                break;\n              }\n              this.log('animate', [frames, options]);\n              didAnimate = true;\n              this.webAnimation = this.element.animate(frames, options);\n              controller = this.getController();\n              noAwait(controller === null || controller === void 0 ? void 0 : controller.add(this));\n              _context4.prev = 12;\n              _context4.next = 15;\n              return this.webAnimation.finished;\n            case 15:\n              _context4.next = 19;\n              break;\n            case 17:\n              _context4.prev = 17;\n              _context4.t0 = _context4[\"catch\"](12);\n            case 19:\n              controller === null || controller === void 0 || controller.remove(this);\n            case 20:\n              this.didFinish(didAnimate);\n              return _context4.abrupt(\"return\", didAnimate);\n            case 22:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this, [[12, 17]]);\n      }));\n      function animate(_x) {\n        return _animate.apply(this, arguments);\n      }\n      return animate;\n    }()\n  }, {\n    key: \"isAnimating\",\n    value: function isAnimating() {\n      var _this$webAnimation3, _this$webAnimation4;\n      return ((_this$webAnimation3 = this.webAnimation) === null || _this$webAnimation3 === void 0 ? void 0 : _this$webAnimation3.playState) === 'running' || ((_this$webAnimation4 = this.webAnimation) === null || _this$webAnimation4 === void 0 ? void 0 : _this$webAnimation4.pending);\n    }\n  }, {\n    key: \"log\",\n    value: function log(message, data) {\n      if (this.shouldLog && !this.isDisabled()) {\n        console.log(message, this.options.id, data);\n      }\n    }\n  }]);\n  return Animate;\n}(AsyncDirective);\n/**\n * Used in an async function to mark a promise that we're deliberately not\n * awaiting.\n */\nfunction noAwait(_p) {}\n/**\n * The `animate` directive animates a node's layout between renders.\n * It will perform a \"tweening\" animation between the two states based on\n * the options given. In addition, elements can animate when they initially\n * render to DOM and when they are removed.\n *\n * Options include:\n * * animationOptions:  configure animation via standard KeyframeAnimationOptions\n * * properties: list of properties to animate, defaults to\n * ['left', 'top','width', 'height', 'opacity', 'color', 'background']\n * * disabled: disables animation\n * * guard: function producing values that must change for the `animate` to run\n * * in: keyframes to use when animating in\n * * out: keyframes to use when animating out\n * * skipInitial: skip animating in the first time\n * * id: used to link to other `animate`s via `inId`\n * * inId: id of the `animate` to render from when animating in\n * * onStart: run when the `animate` starts\n * * onComplete: run when the `animate` completes\n * * onFrames: run when the frames are produces, use to modify frames\n */\nexport var animate = directive(Animate);","map":{"version":3,"names":["nothing","directive","PartType","AsyncDirective","controllerMap","AnimateController","z","disconnectedProps","Map","renderedHosts","WeakSet","animationFrame","Promise","resolve","requestAnimationFrame","flyBelow","transform","opacity","flyAbove","flyLeft","flyRight","none","fadeOut","fade","fadeIn","fadeInSlow","offset","diffOp","a","b","v","undefined","quotientOp","transformProps","left","value","isNaN","concat","top","width","override","overrideFrom","height","defaultKeyframeOptions","duration","easing","defaultCssProperties","isDirty","previous","Array","isArray","length","every","i","nodeToAnimateMap","WeakMap","Animate","_AsyncDirective","_inherits","part","_this","_classCallCheck","_callSuper","_parentNode","_nextSibling","_shouldAnimate","shouldLog","type","CHILD","Error","createFinished","_createClass","key","_this$resolveFinished","_this2","resolveFinished","call","finished","r","_resolveFinished","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this$_resolveFinishe","wrap","_callee$","_context","prev","next","stop","apply","arguments","render","_options","getController","get","_host","isDisabled","_this$getController","options","disabled","update","_ref","_ref2","_slicedToArray","firstUpdate","_part$options","host","addController","element","set","optionsOrCallback","_setOptions","_options2","_options3","_options3$properties","controller","Object","assign","defaultOptions","keyframeOptions","properties","_measure","props","bounds","getBoundingClientRect","computedStyle","getComputedStyle","forEach","p","_bounds$p","asNum","Number","String","_canStart","dirty","guard","_previousValue","hasUpdated","isAnimating","isConnected","from","hostUpdate","_this$_parentNode","_fromValues","parentNode","nextSibling","_hostUpdated","_callee2","frames","ancestors","animationOptions","toValues","_this$_applyAncestorA","to","disconnected","_this$_applyAncestorA2","_from","_to","_callee2$","_context2","skipInitial","isHostRendered","abrupt","prepare","_getAncestors","_calculateKeyframeOptions","_applyAncestorAdjustments","log","calculateKeyframes","inId","delete","in","_toConsumableArray","slice","f","noAwait","animate","hostUpdated","resetStyles","_styles","_this$_styles","setAttribute","commitStyles","_this$webAnimation","_this$webAnimation2","getAttribute","webAnimation","cancel","reconnected","_disconnected","_callee3","_this$_parentNode2","ref","shifted","isStatic","_callee3$","_context3","id","out","insertBefore","stabilizeOut","position","style","remove","start","_this$options$onStart","_this$options","onStart","didFinish","didAnimate","_this$options$onCompl","_this$options2","onComplete","animatingProperties","_p2","push","_this3","hostRendered","has","updateComplete","then","add","ancestorProps","map","filter","dScaleX","dScaleY","center","fromFrame","toFrame","hasFrames","t","tp","op","_fromFrame$transform","_animate","_callee4","_args4","_callee4$","_context4","onFrames","t0","_x","_this$webAnimation3","_this$webAnimation4","playState","pending","message","data","console","_p"],"sources":["../src/animate.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nimport {LitElement, ReactiveControllerHost} from 'lit';\nimport {nothing, AttributePart} from 'lit/html.js';\nimport {directive, PartInfo, PartType} from 'lit/directive.js';\nimport {AsyncDirective} from 'lit/async-directive.js';\nimport {controllerMap} from './animate-controller.js';\nexport {AnimateController} from './animate-controller.js';\n\nexport type CSSValues = {\n  [index: string]: string | number;\n};\n\nexport type CSSPropertiesList = string[];\n\n// zIndex for \"in\" animations\nlet z = 0;\n\nconst disconnectedProps = new Map<unknown, CSSValues>();\nconst renderedHosts = new WeakSet<ReactiveControllerHost>();\n\nexport type Options = {\n  // Options used for the animation\n  keyframeOptions?: KeyframeAnimationOptions;\n  // List of css properties to animate\n  properties?: CSSPropertiesList;\n  // if `true`, the `animate` is disabled\n  disabled?: boolean;\n  // Callback run to produce a value which is dirty checked to determine if animation should run.\n  guard?: () => unknown;\n  // Id for this `animate`; used to link to other `animate`s via e.g. `inId`\n  id?: unknown;\n  // Set to the `animate` id to map to when rendering \"in\"\n  inId?: unknown;\n  // Keyframes to use when animating \"in\"\n  in?: Keyframe[];\n  // Keyframes to use when animating \"out\"\n  out?: Keyframe[];\n  // Set to true to match DOM position when animating \"out\"\n  stabilizeOut?: boolean;\n  // Skips animation when initially rendering\n  skipInitial?: boolean;\n  // Callback run when the `animate` animation starts\n  onStart?: (animate: Animate) => void;\n  // Callback run when the animation is complete\n  onComplete?: (animate: Animate) => void;\n  // Callback run to modify frames used to animate\n  onFrames?: (animate: Animate) => Keyframe[] | undefined;\n};\n\nexport const animationFrame = () =>\n  new Promise((resolve) => requestAnimationFrame(resolve));\n\n// Presets for animating \"in\" and \"out\" of the DOM.\nexport const flyBelow = [{transform: 'translateY(100%) scale(0)', opacity: 0}];\nexport const flyAbove = [{transform: 'translateY(-100%) scale(0)', opacity: 0}];\nexport const flyLeft = [{transform: 'translateX(-100%) scale(0)', opacity: 0}];\nexport const flyRight = [{transform: 'translateX(100%) scale(0)', opacity: 0}];\nexport const none = [{}];\nexport const fadeOut = [{opacity: 0}];\nexport const fade = fadeOut;\nexport const fadeIn = [{opacity: 0}, {opacity: 1}];\nexport const fadeInSlow = [\n  {opacity: 0},\n  {opacity: 0.25, offset: 0.75},\n  {opacity: 1},\n];\n\nconst diffOp = (a: number, b: number) => {\n  const v = a - b;\n  return v === 0 ? undefined : v;\n};\nconst quotientOp = (a: number, b: number) => {\n  const v = a / b;\n  return v === 1 ? undefined : v;\n};\n\n// Computes a transform given a before and after input for given properties.\nexport const transformProps: {\n  [p: string]: (\n    a: number,\n    b: number\n  ) => {\n    value?: number;\n    transform?: string;\n    overrideFrom?: {[k: string]: string};\n  };\n} = {\n  left: (a: number, b: number) => {\n    const value = diffOp(a, b);\n    const transform =\n      value == null || isNaN(value) ? undefined : `translateX(${value}px)`;\n    return {value, transform};\n  },\n  top: (a: number, b: number) => {\n    const value = diffOp(a, b);\n    const transform =\n      value == null || isNaN(value) ? undefined : `translateY(${value}px)`;\n    return {value, transform};\n  },\n  width: (a: number, b: number) => {\n    let override: {} | undefined = undefined;\n    // 'To' values of 0 would cause `value` to be Infinity. Instead we override\n    // `b` to be 1 and add 1px as an override of width.\n    if (b === 0) {\n      b = 1;\n      override = {width: '1px'};\n    }\n    const value = quotientOp(a, b);\n    const transform =\n      value == null || isNaN(value) ? undefined : `scaleX(${value})`;\n    return {value, overrideFrom: override, transform};\n  },\n  height: (a: number, b: number) => {\n    let override: {} | undefined = undefined;\n    // 'To' values of 0 would cause `value` to be Infinity. Instead we override\n    // `b` to be 1 and add 1px as an override of height.\n    if (b === 0) {\n      b = 1;\n      override = {height: '1px'};\n    }\n    const value = quotientOp(a, b);\n    const transform =\n      value == null || isNaN(value) ? undefined : `scaleY(${value})`;\n    return {value, overrideFrom: override, transform};\n  },\n};\n\nexport const defaultKeyframeOptions: KeyframeAnimationOptions = {\n  duration: 333,\n  easing: `ease-in-out`,\n};\n\nexport const defaultCssProperties: CSSPropertiesList = [\n  'left',\n  'top',\n  'width',\n  'height',\n  'opacity',\n  'color',\n  'background',\n];\n\n// Dirty checks the value received from the `guard` option.\nconst isDirty = (value: unknown, previous: unknown) => {\n  if (Array.isArray(value)) {\n    // Dirty-check arrays by item\n    if (\n      Array.isArray(previous) &&\n      previous.length === value.length &&\n      value.every((v, i) => v === (previous as Array<unknown>)[i])\n    ) {\n      return false;\n    }\n  } else if (previous === value) {\n    // Dirty-check non-arrays by identity\n    return false;\n  }\n  return true;\n};\n\n// Mapping of node on which the `animate` directive is used to the `animate` directive.\n// Used to get the ancestor `animate` animations (which are used to modify\n// `animate` transforms), done by ascending the DOM.\nconst nodeToAnimateMap = new WeakMap<Node, Animate>();\n\n/**\n * `animate` directive class. Animates a node's position between renders.\n */\nexport class Animate extends AsyncDirective {\n  private _host?: LitElement;\n  private _fromValues?: CSSValues;\n  private _parentNode: Element | null = null;\n  private _nextSibling: Node | null = null;\n  private _shouldAnimate = true;\n  private _previousValue: unknown;\n  private _styles?: string | undefined | null;\n  element!: HTMLElement;\n\n  shouldLog = false;\n  animatingProperties?: CSSValues;\n  frames?: Keyframe[];\n  webAnimation?: Animation;\n  options!: Options;\n  optionsOrCallback?: (() => Options) | Options;\n\n  finished!: Promise<void>;\n  private _resolveFinished?: () => void;\n\n  constructor(part: PartInfo) {\n    super(part);\n    if (part.type === PartType.CHILD) {\n      throw new Error(\n        'The `animate` directive must be used in attribute position.'\n      );\n    }\n    this.createFinished();\n  }\n\n  createFinished() {\n    this.resolveFinished?.();\n    this.finished = new Promise((r) => {\n      this._resolveFinished = r;\n    });\n  }\n\n  async resolveFinished() {\n    this._resolveFinished?.();\n    this._resolveFinished = undefined;\n  }\n\n  render(_options?: (() => Options) | Options) {\n    return nothing;\n  }\n\n  getController() {\n    return controllerMap.get(this._host!);\n  }\n\n  isDisabled() {\n    return this.options.disabled || this.getController()?.disabled;\n  }\n\n  override update(part: AttributePart, [options]: Parameters<this['render']>) {\n    const firstUpdate = this._host === undefined;\n    if (firstUpdate) {\n      this._host = part.options?.host as LitElement;\n      this._host.addController(this);\n      this.element = part.element;\n      nodeToAnimateMap.set(this.element, this);\n    }\n    this.optionsOrCallback = options;\n    if (firstUpdate || typeof options !== 'function') {\n      this._setOptions(options as Options);\n    }\n    return this.render(options);\n  }\n\n  // TODO(sorvell): instead of a function/object, just use an object that the\n  // user can mutate and create accessors for the data that do lookups as needed.\n  // We're doing this every hostUpdate anyway and these lookups are fast.\n  private _setOptions(options?: Options) {\n    options = options ?? {};\n    // Mixin controller options.\n    const controller = this.getController();\n    if (controller !== undefined) {\n      options = {\n        ...controller.defaultOptions,\n        ...options,\n      };\n      options.keyframeOptions = {\n        ...controller.defaultOptions.keyframeOptions,\n        ...options.keyframeOptions,\n      };\n    }\n    // Ensure there are some properties to animation and some animation options.\n    options!.properties ??= defaultCssProperties;\n    this.options = options;\n  }\n\n  // Measures and returns metrics for the element's bounding box and styling\n  private _measure() {\n    const props: CSSValues = {};\n    const bounds = this.element.getBoundingClientRect();\n    const computedStyle = getComputedStyle(this.element);\n    this.options.properties!.forEach((p) => {\n      const v =\n        bounds[p as keyof typeof bounds] ??\n        (!transformProps[p as keyof typeof transformProps]\n          ? computedStyle[p as keyof CSSStyleDeclaration]\n          : undefined);\n      const asNum = Number(v);\n      props[p] = isNaN(asNum) ? String(v) : asNum;\n    });\n    return props;\n  }\n\n  // Returns true if a `animate` should be started.\n  private _canStart() {\n    let dirty = true,\n      value = undefined;\n    if (this.options.guard) {\n      value = this.options.guard();\n      dirty = isDirty(value, this._previousValue);\n    }\n    this._shouldAnimate =\n      this._host!.hasUpdated &&\n      !this.isDisabled() &&\n      !this.isAnimating() &&\n      dirty &&\n      this.element.isConnected;\n    if (this._shouldAnimate) {\n      // Copy the value if it's an array so that if it's mutated we don't forget\n      // what the previous values were.\n      this._previousValue = Array.isArray(value) ? Array.from(value) : value;\n    }\n    return this._shouldAnimate;\n  }\n\n  hostUpdate() {\n    // TODO(sorvell): If options will change that will affect measuring,\n    // then the user must pass a callback which can be called at update time.\n    if (typeof this.optionsOrCallback === 'function') {\n      this._setOptions(this.optionsOrCallback());\n    }\n    if (this._canStart()) {\n      this._fromValues = this._measure();\n      // Record parent and nextSibling used to re-attach node when animating \"out\"\n      this._parentNode =\n        this._parentNode ?? (this.element.parentNode as Element);\n      this._nextSibling = this.element.nextSibling;\n    }\n  }\n\n  async hostUpdated() {\n    if (\n      !this._shouldAnimate ||\n      !this.element.isConnected ||\n      (this.options.skipInitial && !this.isHostRendered)\n    ) {\n      return;\n    }\n    this.prepare();\n    // Wait for rendering so any sub-elements have a chance to render.\n    await animationFrame;\n    let frames: Keyframe[] | undefined;\n    const ancestors = this._getAncestors();\n    // These inherit from ancestors. This allows easier synchronization of\n    // child `animate`s within ancestor `animate`s.\n    const animationOptions = this._calculateKeyframeOptions(\n      this.options.keyframeOptions,\n      ancestors\n    );\n    const toValues = this._measure();\n    // Normal or inverse scale\n    if (this._fromValues !== undefined) {\n      const {from, to} = this._applyAncestorAdjustments(\n        this._fromValues,\n        toValues,\n        ancestors\n      );\n      this.log('measured', [this._fromValues, toValues, from, to]);\n      frames = this.calculateKeyframes(from, to);\n      // \"In\" `animate`.\n    } else {\n      const disconnected = disconnectedProps.get(this.options.inId);\n      if (disconnected) {\n        // use disconnected data only once.\n        disconnectedProps.delete(this.options.inId);\n        const {from, to} = this._applyAncestorAdjustments(\n          disconnected!,\n          toValues,\n          ancestors\n        );\n        frames = this.calculateKeyframes(from, to);\n        // \"merge\" with \"in\" frames\n        frames = this.options.in\n          ? [\n              {...this.options.in[0], ...frames![0]},\n              ...this.options.in.slice(1),\n              frames![1],\n            ]\n          : frames;\n        // adjust z so always on top...\n        z++;\n        frames!.forEach((f) => (f['zIndex'] = z));\n      } else if (this.options.in) {\n        frames = [...this.options.in, {}];\n      }\n    }\n    noAwait(this.animate(frames, animationOptions));\n  }\n\n  resetStyles() {\n    if (this._styles !== undefined) {\n      this.element.setAttribute('style', this._styles ?? '');\n      this._styles = undefined;\n    }\n  }\n\n  commitStyles() {\n    this._styles = this.element.getAttribute('style');\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (this.webAnimation as any)?.commitStyles();\n    this.webAnimation?.cancel();\n  }\n\n  override reconnected() {}\n\n  // Experimental animate out functionality.\n  override async disconnected() {\n    if (!this._shouldAnimate) {\n      return;\n    }\n    if (this.options.id !== undefined) {\n      disconnectedProps.set(this.options.id, this._fromValues!);\n    }\n    if (this.options.out === undefined) {\n      return;\n    }\n    this.prepare();\n    await animationFrame();\n    if (this._parentNode?.isConnected) {\n      // put element back in DOM\n      const ref =\n        this._nextSibling && this._nextSibling.parentNode === this._parentNode\n          ? this._nextSibling\n          : null;\n      this._parentNode.insertBefore(this.element, ref);\n      // Optionally move element back to its position before it was detached.\n      if (this.options.stabilizeOut) {\n        // Measure current position after re-attaching.\n        const shifted = this._measure();\n        this.log('stabilizing out');\n        // TODO(sorvell): these nudges could conflict with existing styling\n        // or animation but setting left/top should be rare, especially via\n        // animation.\n        const left =\n          (this._fromValues!['left'] as number) - (shifted['left'] as number);\n        const top =\n          (this._fromValues!['top'] as number) - (shifted['top'] as number);\n        const isStatic = getComputedStyle(this.element).position === 'static';\n        if (isStatic && (left !== 0 || top !== 0)) {\n          this.element.style.position = 'relative';\n        }\n        if (left !== 0) {\n          this.element.style.left = left + 'px';\n        }\n        if (top !== 0) {\n          this.element.style.top = top + 'px';\n        }\n      }\n    }\n    // These inherit from ancestors. This allows easier synchronization of\n    // child `animate`s within ancestor `animate`s.\n    const keyframeOptions = this._calculateKeyframeOptions(\n      this.options.keyframeOptions\n    );\n    await this.animate(this.options.out, keyframeOptions);\n    this.element.remove();\n  }\n\n  prepare() {\n    this.createFinished();\n  }\n\n  start() {\n    this.options.onStart?.(this);\n  }\n\n  didFinish(didAnimate: boolean) {\n    if (didAnimate) {\n      this.options.onComplete?.(this);\n    }\n    this._fromValues = undefined;\n    this.animatingProperties = undefined;\n    this.frames = undefined;\n    this.resolveFinished();\n  }\n\n  private _getAncestors() {\n    const ancestors = [];\n    for (\n      let p: Node | null | undefined = this.element.parentNode;\n      p;\n      p = p?.parentNode\n    ) {\n      const a = nodeToAnimateMap.get(p!);\n      if (a && !a.isDisabled() && a) {\n        ancestors.push(a);\n      }\n    }\n    return ancestors;\n  }\n\n  protected get isHostRendered() {\n    const hostRendered = renderedHosts.has(this._host!);\n    if (!hostRendered) {\n      this._host!.updateComplete.then(() => {\n        renderedHosts.add(this._host!);\n      });\n    }\n    return hostRendered;\n  }\n\n  private _calculateKeyframeOptions(\n    options: KeyframeAnimationOptions | undefined,\n    ancestors: Animate[] = this._getAncestors()\n  ) {\n    // merges this `animate`'s options over ancestor options over defaults\n    const keyframeOptions = {...defaultKeyframeOptions};\n    ancestors.forEach((a) =>\n      Object.assign(keyframeOptions, a.options.keyframeOptions)\n    );\n    Object.assign(keyframeOptions, options);\n    return keyframeOptions;\n  }\n\n  // Adjust position based on ancestor scaling.\n  private _applyAncestorAdjustments(\n    from: CSSValues,\n    to: CSSValues,\n    ancestors: Animate[]\n  ) {\n    from = {...from};\n    to = {...to};\n    const ancestorProps = ancestors\n      .map((a) => a.animatingProperties)\n      .filter((a) => a !== undefined) as CSSValues[];\n    let dScaleX = 1;\n    let dScaleY = 1;\n    if (ancestorProps !== undefined) {\n      // gather scaling data for ancestors\n      ancestorProps.forEach((a) => {\n        if (a['width']) {\n          dScaleX = dScaleX / (a['width'] as number);\n        }\n        if (a['height']) {\n          dScaleY = dScaleY / (a['height'] as number);\n        }\n      });\n      // Move position by ancestor scaling amount.\n      if (from['left'] !== undefined && to['left'] !== undefined) {\n        from['left'] = dScaleX * (from['left'] as number);\n        to['left'] = dScaleX * (to['left'] as number);\n      }\n      if (from['top'] !== undefined && to['top'] !== undefined) {\n        from['top'] = dScaleY * (from['top'] as number);\n        to['top'] = dScaleY * (to['top'] as number);\n      }\n    }\n    return {from, to};\n  }\n\n  protected calculateKeyframes(from: CSSValues, to: CSSValues, center = false) {\n    const fromFrame: Keyframe = {};\n    const toFrame: Keyframe = {};\n    let hasFrames = false;\n    const props: CSSValues = {};\n    for (const p in to) {\n      const f = from[p],\n        t = to[p];\n      if (p in transformProps) {\n        const tp = transformProps[p as keyof typeof transformProps];\n        if (f === undefined || t === undefined) {\n          continue;\n        }\n        const op = tp(f as number, t as number);\n        if (op.transform !== undefined) {\n          props[p] = op.value!;\n          hasFrames = true;\n          fromFrame['transform'] = `${fromFrame['transform'] ?? ''} ${\n            op['transform']\n          }`;\n          if (op.overrideFrom !== undefined) {\n            Object.assign(fromFrame, op.overrideFrom);\n          }\n        }\n      } else if (f !== t && f !== undefined && t !== undefined) {\n        hasFrames = true;\n        fromFrame[p] = f;\n        toFrame[p] = t;\n      }\n    }\n    fromFrame['transformOrigin'] = toFrame['transformOrigin'] = center\n      ? 'center center'\n      : 'top left';\n    this.animatingProperties = props;\n    return hasFrames ? [fromFrame, toFrame] : undefined;\n  }\n\n  protected async animate(\n    frames: Keyframe[] | undefined,\n    options = this.options.keyframeOptions\n  ) {\n    this.start();\n    this.frames = frames;\n    let didAnimate = false;\n    if (!this.isAnimating() && !this.isDisabled()) {\n      if (this.options.onFrames) {\n        this.frames = frames = this.options.onFrames(this);\n        this.log('modified frames', frames);\n      }\n      if (frames !== undefined) {\n        this.log('animate', [frames, options]);\n        didAnimate = true;\n        this.webAnimation = this.element.animate(frames, options);\n        const controller = this.getController();\n        noAwait(controller?.add(this));\n        try {\n          await this.webAnimation.finished;\n        } catch (e) {\n          // cancelled.\n        }\n        controller?.remove(this);\n      }\n    }\n    this.didFinish(didAnimate);\n    return didAnimate;\n  }\n\n  protected isAnimating() {\n    return (\n      this.webAnimation?.playState === 'running' || this.webAnimation?.pending\n    );\n  }\n\n  log(message: string, data?: unknown) {\n    if (this.shouldLog && !this.isDisabled()) {\n      console.log(message, this.options.id, data);\n    }\n  }\n}\n\n/**\n * Used in an async function to mark a promise that we're deliberately not\n * awaiting.\n */\nfunction noAwait(_p: null | undefined | Promise<unknown>) {}\n\n/**\n * The `animate` directive animates a node's layout between renders.\n * It will perform a \"tweening\" animation between the two states based on\n * the options given. In addition, elements can animate when they initially\n * render to DOM and when they are removed.\n *\n * Options include:\n * * animationOptions:  configure animation via standard KeyframeAnimationOptions\n * * properties: list of properties to animate, defaults to\n * ['left', 'top','width', 'height', 'opacity', 'color', 'background']\n * * disabled: disables animation\n * * guard: function producing values that must change for the `animate` to run\n * * in: keyframes to use when animating in\n * * out: keyframes to use when animating out\n * * skipInitial: skip animating in the first time\n * * id: used to link to other `animate`s via `inId`\n * * inId: id of the `animate` to render from when animating in\n * * onStart: run when the `animate` starts\n * * onComplete: run when the `animate` completes\n * * onFrames: run when the frames are produces, use to modify frames\n */\nexport const animate = directive(Animate);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}