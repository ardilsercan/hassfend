{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport { html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport \"../../../../../components/data-table/ha-data-table\";\nimport \"../../../../../components/ha-circular-progress\";\nimport \"../../../../../components/ha-code-editor\";\nimport { fetchDevices } from \"../../../../../data/zha\";\nlet ZHADeviceNeighbors = _decorate([customElement(\"zha-device-neighbors\")], function (_initialize, _LitElement) {\n  class ZHADeviceNeighbors extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: ZHADeviceNeighbors,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"narrow\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"device\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_devices\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"updated\",\n      value: function updated(changedProperties) {\n        _get(_getPrototypeOf(ZHADeviceNeighbors.prototype), \"updated\", this).call(this, changedProperties);\n        if (this.hass && changedProperties.has(\"device\")) {\n          this._fetchData();\n        }\n      }\n    }, {\n      kind: \"field\",\n      key: \"_deviceNeighbors\",\n      value() {\n        return memoizeOne((device, devices) => {\n          const outputDevices = [];\n          if (device && devices) {\n            device.neighbors.forEach(neighbor => {\n              const zhaDevice = devices.get(neighbor.ieee);\n              if (zhaDevice) {\n                outputDevices.push({\n                  name: zhaDevice.user_given_name || zhaDevice.name,\n                  id: zhaDevice.device_reg_id,\n                  lqi: parseInt(neighbor.lqi),\n                  depth: parseInt(neighbor.depth),\n                  relationship: neighbor.relationship\n                });\n              }\n            });\n          }\n          return outputDevices;\n        });\n      }\n    }, {\n      kind: \"field\",\n      key: \"_columns\",\n      value() {\n        return memoizeOne(narrow => narrow ? {\n          name: {\n            title: this.hass.localize(\"ui.panel.config.zha.neighbors.name\"),\n            sortable: true,\n            filterable: true,\n            direction: \"asc\",\n            grows: true\n          },\n          lqi: {\n            title: this.hass.localize(\"ui.panel.config.zha.neighbors.lqi\"),\n            sortable: true,\n            filterable: true,\n            type: \"numeric\",\n            width: \"75px\"\n          }\n        } : {\n          name: {\n            title: this.hass.localize(\"ui.panel.config.zha.neighbors.name\"),\n            sortable: true,\n            filterable: true,\n            direction: \"asc\",\n            grows: true\n          },\n          lqi: {\n            title: this.hass.localize(\"ui.panel.config.zha.neighbors.lqi\"),\n            sortable: true,\n            filterable: true,\n            type: \"numeric\",\n            width: \"75px\"\n          },\n          relationship: {\n            title: this.hass.localize(\"ui.panel.config.zha.neighbors.relationship\"),\n            sortable: true,\n            filterable: true,\n            width: \"150px\"\n          },\n          depth: {\n            title: this.hass.localize(\"ui.panel.config.zha.neighbors.depth\"),\n            sortable: true,\n            filterable: true,\n            type: \"numeric\",\n            width: \"75px\"\n          }\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this.device) {\n          return nothing;\n        }\n        return html`\n      ${!this._devices ? html`<ha-circular-progress\n            size=\"large\"\n            indeterminate\n          ></ha-circular-progress>` : html`<ha-data-table\n            .hass=${this.hass}\n            .columns=${this._columns(this.narrow)}\n            .data=${this._deviceNeighbors(this.device, this._devices)}\n            auto-height\n            .searchLabel=${this.hass.localize(\"ui.components.data-table.search\")}\n            .noDataText=${this.hass.localize(\"ui.components.data-table.no-data\")}\n          ></ha-data-table>`}\n    `;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_fetchData\",\n      value: async function _fetchData() {\n        if (this.device && this.hass) {\n          const devices = await fetchDevices(this.hass);\n          this._devices = new Map(devices.map(device => [device.ieee, device]));\n        }\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["html","LitElement","nothing","customElement","property","state","memoizeOne","fetchDevices","ZHADeviceNeighbors","_decorate","_initialize","_LitElement","constructor","args","F","d","kind","decorators","attribute","key","value","type","Boolean","updated","changedProperties","_get","_getPrototypeOf","prototype","call","hass","has","_fetchData","device","devices","outputDevices","neighbors","forEach","neighbor","zhaDevice","get","ieee","push","name","user_given_name","id","device_reg_id","lqi","parseInt","depth","relationship","narrow","title","localize","sortable","filterable","direction","grows","width","render","_devices","_columns","_deviceNeighbors","Map","map"],"sources":["/workspaces/frontend/src/panels/config/integrations/integration-panels/zha/zha-device-neighbors.ts"],"sourcesContent":["import { html, LitElement, PropertyValues, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport \"../../../../../components/data-table/ha-data-table\";\nimport type {\n  DataTableColumnContainer,\n  DataTableRowData,\n} from \"../../../../../components/data-table/ha-data-table\";\nimport \"../../../../../components/ha-circular-progress\";\nimport \"../../../../../components/ha-code-editor\";\nimport { fetchDevices, ZHADevice } from \"../../../../../data/zha\";\nimport { HomeAssistant } from \"../../../../../types\";\n\nexport interface DeviceRowData extends DataTableRowData {\n  id: string;\n  name: string;\n  lqi: number;\n  depth: number;\n  relationship: string;\n}\n\n@customElement(\"zha-device-neighbors\")\nclass ZHADeviceNeighbors extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ type: Boolean }) public narrow = false;\n\n  @property({ attribute: false }) public device?: ZHADevice;\n\n  @state() private _devices: Map<string, ZHADevice> | undefined;\n\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n    if (this.hass && changedProperties.has(\"device\")) {\n      this._fetchData();\n    }\n  }\n\n  private _deviceNeighbors = memoizeOne(\n    (\n      device: ZHADevice | undefined,\n      devices: Map<string, ZHADevice> | undefined\n    ) => {\n      const outputDevices: DeviceRowData[] = [];\n      if (device && devices) {\n        device.neighbors.forEach((neighbor) => {\n          const zhaDevice: ZHADevice | undefined = devices.get(neighbor.ieee);\n          if (zhaDevice) {\n            outputDevices.push({\n              name: zhaDevice.user_given_name || zhaDevice.name,\n              id: zhaDevice.device_reg_id,\n              lqi: parseInt(neighbor.lqi),\n              depth: parseInt(neighbor.depth),\n              relationship: neighbor.relationship,\n            });\n          }\n        });\n      }\n      return outputDevices;\n    }\n  );\n\n  private _columns = memoizeOne(\n    (narrow: boolean): DataTableColumnContainer =>\n      narrow\n        ? {\n            name: {\n              title: this.hass.localize(\"ui.panel.config.zha.neighbors.name\"),\n              sortable: true,\n              filterable: true,\n              direction: \"asc\",\n              grows: true,\n            },\n            lqi: {\n              title: this.hass.localize(\"ui.panel.config.zha.neighbors.lqi\"),\n              sortable: true,\n              filterable: true,\n              type: \"numeric\",\n              width: \"75px\",\n            },\n          }\n        : {\n            name: {\n              title: this.hass.localize(\"ui.panel.config.zha.neighbors.name\"),\n              sortable: true,\n              filterable: true,\n              direction: \"asc\",\n              grows: true,\n            },\n            lqi: {\n              title: this.hass.localize(\"ui.panel.config.zha.neighbors.lqi\"),\n              sortable: true,\n              filterable: true,\n              type: \"numeric\",\n              width: \"75px\",\n            },\n            relationship: {\n              title: this.hass.localize(\n                \"ui.panel.config.zha.neighbors.relationship\"\n              ),\n              sortable: true,\n              filterable: true,\n              width: \"150px\",\n            },\n            depth: {\n              title: this.hass.localize(\"ui.panel.config.zha.neighbors.depth\"),\n              sortable: true,\n              filterable: true,\n              type: \"numeric\",\n              width: \"75px\",\n            },\n          }\n  );\n\n  protected render() {\n    if (!this.device) {\n      return nothing;\n    }\n    return html`\n      ${!this._devices\n        ? html`<ha-circular-progress\n            size=\"large\"\n            indeterminate\n          ></ha-circular-progress>`\n        : html`<ha-data-table\n            .hass=${this.hass}\n            .columns=${this._columns(this.narrow)}\n            .data=${this._deviceNeighbors(this.device, this._devices)}\n            auto-height\n            .searchLabel=${this.hass.localize(\n              \"ui.components.data-table.search\"\n            )}\n            .noDataText=${this.hass.localize(\n              \"ui.components.data-table.no-data\"\n            )}\n          ></ha-data-table>`}\n    `;\n  }\n\n  private async _fetchData(): Promise<void> {\n    if (this.device && this.hass) {\n      const devices = await fetchDevices(this.hass!);\n      this._devices = new Map(\n        devices.map((device: ZHADevice) => [device.ieee, device])\n      );\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"zha-device-neighbors\": ZHADeviceNeighbors;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}