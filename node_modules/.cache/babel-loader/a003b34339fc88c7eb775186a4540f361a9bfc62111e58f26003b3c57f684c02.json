{"ast":null,"code":"import { nothing } from 'lit/html.js';\nimport { directive, PartType } from 'lit/directive.js';\nimport { AsyncDirective } from 'lit/async-directive.js';\nconst positionedPoints = ['top', 'right', 'bottom', 'left'];\nexport class Position extends AsyncDirective {\n  constructor(part) {\n    super(part);\n    if (part.type !== PartType.ELEMENT) {\n      throw new Error('The `position` directive must be used in attribute position.');\n    }\n  }\n  render(_targetCallbackOrRef, _positions) {\n    return nothing;\n  }\n  update(part, [target, positions]) {\n    if (this._host === undefined) {\n      var _part$options;\n      this._host = (_part$options = part.options) === null || _part$options === void 0 ? void 0 : _part$options.host;\n      this._host.addController(this);\n    }\n    this._element = part.element;\n    this._targetCallbackOrRef = target;\n    this._positions = positions !== null && positions !== void 0 ? positions : ['left', 'top', 'width', 'height'];\n    return this.render(target, positions);\n  }\n  hostUpdated() {\n    this._position();\n  }\n  _position() {\n    var _this$_targetCallback, _this$_positions;\n    const target = typeof this._targetCallbackOrRef === 'function' ? this._targetCallbackOrRef() : (_this$_targetCallback = this._targetCallbackOrRef) === null || _this$_targetCallback === void 0 ? void 0 : _this$_targetCallback.value;\n    const parent = target.offsetParent;\n    if (target === undefined || !parent) {\n      return;\n    }\n    const tr = target.getBoundingClientRect();\n    const pr = parent.getBoundingClientRect();\n    (_this$_positions = this._positions) === null || _this$_positions === void 0 || _this$_positions.forEach(p => {\n      const x = positionedPoints.includes(p) ? tr[p] - pr[p] : tr[p];\n      this._element.style[p] = `${x}px`;\n    });\n  }\n}\n/**\n * Positions and sizes the element on which the `position()` directive is used\n * relative to the given target element.\n */\nexport const position = directive(Position);","map":{"version":3,"names":["nothing","directive","PartType","AsyncDirective","positionedPoints","Position","constructor","part","type","ELEMENT","Error","render","_targetCallbackOrRef","_positions","update","target","positions","_host","undefined","_part$options","options","host","addController","_element","element","hostUpdated","_position","_this$_targetCallback","_this$_positions","value","parent","offsetParent","tr","getBoundingClientRect","pr","forEach","p","x","includes","style","position"],"sources":["../src/position.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nimport {LitElement} from 'lit';\nimport {nothing, AttributePart} from 'lit/html.js';\nimport {directive, PartInfo, PartType} from 'lit/directive.js';\nimport {AsyncDirective} from 'lit/async-directive.js';\n\ninterface Positionables {\n  readonly bottom: number;\n  readonly height: number;\n  readonly left: number;\n  readonly right: number;\n  readonly top: number;\n  readonly width: number;\n}\n\ntype Ref = {value: HTMLElement};\nexport type TargetCallbackOrRef = (() => HTMLElement) | Ref;\n\nexport type Positions = Array<keyof Positionables>;\n\nconst positionedPoints = ['top', 'right', 'bottom', 'left'];\n\nexport class Position extends AsyncDirective {\n  private _host?: LitElement;\n  private _element?: Element;\n  private _targetCallbackOrRef!: TargetCallbackOrRef;\n  private _positions?: Positions;\n\n  constructor(part: PartInfo) {\n    super(part);\n    if (part.type !== PartType.ELEMENT) {\n      throw new Error(\n        'The `position` directive must be used in attribute position.'\n      );\n    }\n  }\n\n  render(_targetCallbackOrRef: TargetCallbackOrRef, _positions: Positions) {\n    return nothing;\n  }\n\n  override update(\n    part: AttributePart,\n    [target, positions]: Parameters<this['render']>\n  ) {\n    if (this._host === undefined) {\n      this._host = part.options?.host as LitElement;\n      this._host.addController(this);\n    }\n    this._element = part.element;\n    this._targetCallbackOrRef = target;\n    this._positions = positions ?? ['left', 'top', 'width', 'height'];\n    return this.render(target, positions);\n  }\n\n  hostUpdated() {\n    this._position();\n  }\n\n  private _position() {\n    const target =\n      typeof this._targetCallbackOrRef === 'function'\n        ? this._targetCallbackOrRef()\n        : this._targetCallbackOrRef?.value;\n    const parent = target.offsetParent;\n    if (target === undefined || !parent) {\n      return;\n    }\n    const tr = target.getBoundingClientRect();\n    const pr = parent.getBoundingClientRect();\n    this._positions?.forEach((p) => {\n      const x = positionedPoints.includes(p) ? tr[p] - pr[p] : tr[p];\n      (this._element as HTMLElement).style[p] = `${x}px`;\n    });\n  }\n}\n\n/**\n * Positions and sizes the element on which the `position()` directive is used\n * relative to the given target element.\n */\nexport const position = directive(Position);\n"],"mappings":"AAMA,SAAQA,OAAO,QAAsB,aAAa;AAClD,SAAQC,SAAS,EAAYC,QAAQ,QAAO,kBAAkB;AAC9D,SAAQC,cAAc,QAAO,wBAAwB;AAgBrD,MAAMC,gBAAgB,GAAG,CAAC,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC;AAE3D,OAAM,MAAOC,QAAS,SAAQF,cAAc;EAM1CG,YAAYC,IAAc;IACxB,KAAK,CAACA,IAAI,CAAC;IACX,IAAIA,IAAI,CAACC,IAAI,KAAKN,QAAQ,CAACO,OAAO,EAAE;MAClC,MAAM,IAAIC,KAAK,CACb,8DAA8D,CAC/D;;EAEL;EAEAC,MAAMA,CAACC,oBAAyC,EAAEC,UAAqB;IACrE,OAAOb,OAAO;EAChB;EAESc,MAAMA,CACbP,IAAmB,EACnB,CAACQ,MAAM,EAAEC,SAAS,CAA6B;IAE/C,IAAI,IAAI,CAACC,KAAK,KAAKC,SAAS,EAAE;MAAA,IAAAC,aAAA;MAC5B,IAAI,CAACF,KAAK,IAAAE,aAAA,GAAGZ,IAAI,CAACa,OAAO,cAAAD,aAAA,uBAAZA,aAAA,CAAcE,IAAkB;MAC7C,IAAI,CAACJ,KAAK,CAACK,aAAa,CAAC,IAAI,CAAC;;IAEhC,IAAI,CAACC,QAAQ,GAAGhB,IAAI,CAACiB,OAAO;IAC5B,IAAI,CAACZ,oBAAoB,GAAGG,MAAM;IAClC,IAAI,CAACF,UAAU,GAAGG,SAAS,aAATA,SAAS,cAATA,SAAS,GAAI,CAAC,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,QAAQ,CAAC;IACjE,OAAO,IAAI,CAACL,MAAM,CAACI,MAAM,EAAEC,SAAS,CAAC;EACvC;EAEAS,WAAWA,CAAA;IACT,IAAI,CAACC,SAAS,EAAE;EAClB;EAEQA,SAASA,CAAA;IAAA,IAAAC,qBAAA,EAAAC,gBAAA;IACf,MAAMb,MAAM,GACV,OAAO,IAAI,CAACH,oBAAoB,KAAK,UAAU,GAC3C,IAAI,CAACA,oBAAoB,EAAE,IAAAe,qBAAA,GAC3B,IAAI,CAACf,oBAAoB,cAAAe,qBAAA,uBAAzBA,qBAAA,CAA2BE,KAAK;IACtC,MAAMC,MAAM,GAAGf,MAAM,CAACgB,YAAY;IAClC,IAAIhB,MAAM,KAAKG,SAAS,IAAI,CAACY,MAAM,EAAE;MACnC;;IAEF,MAAME,EAAE,GAAGjB,MAAM,CAACkB,qBAAqB,EAAE;IACzC,MAAMC,EAAE,GAAGJ,MAAM,CAACG,qBAAqB,EAAE;IACzC,CAAAL,gBAAA,OAAI,CAACf,UAAU,cAAAe,gBAAA,eAAfA,gBAAA,CAAiBO,OAAO,CAAEC,CAAC,IAAI;MAC7B,MAAMC,CAAC,GAAGjC,gBAAgB,CAACkC,QAAQ,CAACF,CAAC,CAAC,GAAGJ,EAAE,CAACI,CAAC,CAAC,GAAGF,EAAE,CAACE,CAAC,CAAC,GAAGJ,EAAE,CAACI,CAAC,CAAC;MAC7D,IAAI,CAACb,QAAwB,CAACgB,KAAK,CAACH,CAAC,CAAC,GAAG,GAAGC,CAAC,IAAI;IACpD,CAAC,CAAC;EACJ;;AAGF;;;;AAIA,OAAO,MAAMG,QAAQ,GAAGvC,SAAS,CAACI,QAAQ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}