{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _templateObject, _templateObject2, _templateObject3;\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"@material/mwc-list/mwc-list-item\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { stopPropagation } from \"../common/dom/stop_propagation\";\nimport { stringCompare } from \"../common/string/compare\";\nimport { fetchBlueprints } from \"../data/blueprint\";\nimport \"./ha-select\";\nvar HaBluePrintPicker = _decorate([customElement(\"ha-blueprint-picker\")], function (_initialize, _LitElement) {\n  var HaBluePrintPicker = /*#__PURE__*/function (_LitElement2) {\n    _inherits(HaBluePrintPicker, _LitElement2);\n    function HaBluePrintPicker() {\n      var _this;\n      _classCallCheck(this, HaBluePrintPicker);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, HaBluePrintPicker, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(HaBluePrintPicker);\n  }(_LitElement);\n  return {\n    F: HaBluePrintPicker,\n    d: [{\n      kind: \"field\",\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"label\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"value\",\n      value: function value() {\n        return \"\";\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"domain\",\n      value: function value() {\n        return \"automation\";\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"blueprints\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"disabled\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"method\",\n      key: \"open\",\n      value: function open() {\n        var _this$shadowRoot;\n        var select = (_this$shadowRoot = this.shadowRoot) === null || _this$shadowRoot === void 0 ? void 0 : _this$shadowRoot.querySelector(\"ha-select\");\n        if (select) {\n          // @ts-expect-error\n          select.menuOpen = true;\n        }\n      }\n    }, {\n      kind: \"field\",\n      key: \"_processedBlueprints\",\n      value: function value() {\n        var _this2 = this;\n        return memoizeOne(function (blueprints) {\n          if (!blueprints) {\n            return [];\n          }\n          var result = Object.entries(blueprints).filter(function (entry) {\n            return !(\"error\" in entry[1]);\n          }).map(function (_ref) {\n            var _ref2 = _slicedToArray(_ref, 2),\n              path = _ref2[0],\n              blueprint = _ref2[1];\n            return Object.assign(Object.assign({}, blueprint.metadata), {}, {\n              path: path\n            });\n          });\n          return result.sort(function (a, b) {\n            return stringCompare(a.name, b.name, _this2.hass.locale.language);\n          });\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this.hass) {\n          return nothing;\n        }\n        return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n      <ha-select\\n        .label=\", \"\\n        fixedMenuPosition\\n        naturalMenuWidth\\n        .value=\", \"\\n        .disabled=\", \"\\n        @selected=\", \"\\n        @closed=\", \"\\n      >\\n        \", \"\\n      </ha-select>\\n    \"])), this.label || this.hass.localize(\"ui.components.blueprint-picker.select_blueprint\"), this.value, this.disabled, this._blueprintChanged, stopPropagation, this._processedBlueprints(this.blueprints).map(function (blueprint) {\n          return html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n            <mwc-list-item .value=\", \">\\n              \", \"\\n            </mwc-list-item>\\n          \"])), blueprint.path, blueprint.name);\n        }));\n      }\n    }, {\n      kind: \"method\",\n      key: \"firstUpdated\",\n      value: function firstUpdated(changedProps) {\n        var _this3 = this;\n        _get(_getPrototypeOf(HaBluePrintPicker.prototype), \"firstUpdated\", this).call(this, changedProps);\n        if (this.blueprints === undefined) {\n          fetchBlueprints(this.hass, this.domain).then(function (blueprints) {\n            _this3.blueprints = blueprints;\n          });\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_blueprintChanged\",\n      value: function _blueprintChanged(ev) {\n        var _this4 = this;\n        var newValue = ev.target.value;\n        if (newValue !== this.value) {\n          this.value = newValue;\n          setTimeout(function () {\n            fireEvent(_this4, \"value-changed\", {\n              value: newValue\n            });\n            fireEvent(_this4, \"change\");\n          }, 0);\n        }\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return css(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n      :host {\\n        display: inline-block;\\n      }\\n      ha-select {\\n        width: 100%;\\n        min-width: 200px;\\n        display: block;\\n      }\\n    \"])));\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["css","html","LitElement","nothing","customElement","property","memoizeOne","fireEvent","stopPropagation","stringCompare","fetchBlueprints","HaBluePrintPicker","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","key","value","decorators","attribute","type","Boolean","open","_this$shadowRoot","select","shadowRoot","querySelector","menuOpen","_this2","blueprints","result","Object","entries","filter","entry","map","_ref","_ref2","_slicedToArray","path","blueprint","assign","metadata","sort","a","b","name","hass","locale","language","render","_templateObject","_taggedTemplateLiteral","label","localize","disabled","_blueprintChanged","_processedBlueprints","_templateObject2","firstUpdated","changedProps","_this3","_get","_getPrototypeOf","prototype","call","undefined","domain","then","ev","_this4","newValue","target","setTimeout","static","styles","_templateObject3"],"sources":["/workspaces/frontend/src/components/ha-blueprint-picker.ts"],"sourcesContent":["import \"@material/mwc-list/mwc-list-item\";\nimport { css, CSSResultGroup, html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { stopPropagation } from \"../common/dom/stop_propagation\";\nimport { stringCompare } from \"../common/string/compare\";\nimport {\n  Blueprint,\n  BlueprintDomain,\n  Blueprints,\n  fetchBlueprints,\n} from \"../data/blueprint\";\nimport { HomeAssistant } from \"../types\";\nimport \"./ha-select\";\n\n@customElement(\"ha-blueprint-picker\")\nclass HaBluePrintPicker extends LitElement {\n  public hass?: HomeAssistant;\n\n  @property() public label?: string;\n\n  @property() public value = \"\";\n\n  @property() public domain: BlueprintDomain = \"automation\";\n\n  @property({ attribute: false }) public blueprints?: Blueprints;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  public open() {\n    const select = this.shadowRoot?.querySelector(\"ha-select\");\n    if (select) {\n      // @ts-expect-error\n      select.menuOpen = true;\n    }\n  }\n\n  private _processedBlueprints = memoizeOne((blueprints?: Blueprints) => {\n    if (!blueprints) {\n      return [];\n    }\n    const result = Object.entries(blueprints)\n      .filter((entry): entry is [string, Blueprint] => !(\"error\" in entry[1]))\n      .map(([path, blueprint]) => ({\n        ...blueprint.metadata,\n        path,\n      }));\n    return result.sort((a, b) =>\n      stringCompare(a.name, b.name, this.hass!.locale.language)\n    );\n  });\n\n  protected render() {\n    if (!this.hass) {\n      return nothing;\n    }\n    return html`\n      <ha-select\n        .label=${this.label ||\n        this.hass.localize(\"ui.components.blueprint-picker.select_blueprint\")}\n        fixedMenuPosition\n        naturalMenuWidth\n        .value=${this.value}\n        .disabled=${this.disabled}\n        @selected=${this._blueprintChanged}\n        @closed=${stopPropagation}\n      >\n        ${this._processedBlueprints(this.blueprints).map(\n          (blueprint) => html`\n            <mwc-list-item .value=${blueprint.path}>\n              ${blueprint.name}\n            </mwc-list-item>\n          `\n        )}\n      </ha-select>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    if (this.blueprints === undefined) {\n      fetchBlueprints(this.hass!, this.domain).then((blueprints) => {\n        this.blueprints = blueprints;\n      });\n    }\n  }\n\n  private _blueprintChanged(ev) {\n    const newValue = ev.target.value;\n\n    if (newValue !== this.value) {\n      this.value = newValue;\n      setTimeout(() => {\n        fireEvent(this, \"value-changed\", { value: newValue });\n        fireEvent(this, \"change\");\n      }, 0);\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        display: inline-block;\n      }\n      ha-select {\n        width: 100%;\n        min-width: 200px;\n        display: block;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-blueprint-picker\": HaBluePrintPicker;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}