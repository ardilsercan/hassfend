{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _templateObject, _templateObject2;\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport { sanitizeUrl } from \"@braintree/sanitize-url\";\nimport { html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { navigate } from \"../../src/common/navigate\";\nimport { createSearchParam, extractSearchParamsObject } from \"../../src/common/url/search-params\";\nimport \"../../src/layouts/hass-error-screen\";\nexport var REDIRECTS = {\n  supervisor: {\n    redirect: \"/hassio/dashboard\"\n  },\n  supervisor_logs: {\n    redirect: \"/hassio/system\"\n  },\n  supervisor_info: {\n    redirect: \"/hassio/system\"\n  },\n  supervisor_snapshots: {\n    redirect: \"/hassio/backups\"\n  },\n  supervisor_backups: {\n    redirect: \"/hassio/backups\"\n  },\n  supervisor_store: {\n    redirect: \"/hassio/store\"\n  },\n  supervisor_addons: {\n    redirect: \"/hassio/dashboard\"\n  },\n  supervisor_addon: {\n    redirect: \"/hassio/addon\",\n    params: {\n      addon: \"string\"\n    },\n    optional_params: {\n      repository_url: \"url\"\n    }\n  },\n  supervisor_ingress: {\n    redirect: \"/hassio/ingress\",\n    params: {\n      addon: \"string\"\n    }\n  },\n  supervisor_add_addon_repository: {\n    redirect: \"/hassio/store\",\n    params: {\n      repository_url: \"url\"\n    }\n  }\n};\nvar HassioMyRedirect = _decorate([customElement(\"hassio-my-redirect\")], function (_initialize, _LitElement) {\n  var HassioMyRedirect = /*#__PURE__*/function (_LitElement2) {\n    _inherits(HassioMyRedirect, _LitElement2);\n    function HassioMyRedirect() {\n      var _this;\n      _classCallCheck(this, HassioMyRedirect);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, HassioMyRedirect, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(HassioMyRedirect);\n  }(_LitElement);\n  return {\n    F: HassioMyRedirect,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"supervisor\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"route\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_error\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"connectedCallback\",\n      value: function connectedCallback() {\n        _get(_getPrototypeOf(HassioMyRedirect.prototype), \"connectedCallback\", this).call(this);\n        var path = this.route.path.substr(1);\n        var redirect = REDIRECTS[path];\n        if (!redirect) {\n          this._error = this.supervisor.localize(\"my.not_supported\", {\n            link: html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"<a\\n          target=\\\"_blank\\\"\\n          rel=\\\"noreferrer noopener\\\"\\n          href=\\\"https://my.home-assistant.io/faq.html#supported-pages\\\"\\n        >\\n          \", \"\\n        </a>\"])), this.supervisor.localize(\"my.faq_link\"))\n          });\n          return;\n        }\n        var url;\n        try {\n          url = this._createRedirectUrl(redirect);\n        } catch (err) {\n          this._error = this.supervisor.localize(\"my.error\");\n          return;\n        }\n        navigate(url, {\n          replace: true\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (this._error) {\n          return html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"<hass-error-screen\\n        .error=\", \"\\n      ></hass-error-screen>\"])), this._error);\n        }\n        return nothing;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_createRedirectUrl\",\n      value: function _createRedirectUrl(redirect) {\n        var params = this._createRedirectParams(redirect);\n        return \"\".concat(redirect.redirect).concat(params);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_createRedirectParams\",\n      value: function _createRedirectParams(redirect) {\n        var _this2 = this;\n        var params = extractSearchParamsObject();\n        if (!redirect.params && !Object.keys(params).length) {\n          return \"\";\n        }\n        var resultParams = {};\n        Object.entries(redirect.params || {}).forEach(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n            key = _ref2[0],\n            type = _ref2[1];\n          if (!params[key] || !_this2._checkParamType(type, params[key])) {\n            throw Error();\n          }\n          resultParams[key] = params[key];\n        });\n        Object.entries(redirect.optional_params || {}).forEach(function (_ref3) {\n          var _ref4 = _slicedToArray(_ref3, 2),\n            key = _ref4[0],\n            type = _ref4[1];\n          if (params[key]) {\n            if (!_this2._checkParamType(type, params[key])) {\n              throw Error();\n            }\n            resultParams[key] = params[key];\n          }\n        });\n        return \"?\".concat(createSearchParam(resultParams));\n      }\n    }, {\n      kind: \"method\",\n      key: \"_checkParamType\",\n      value: function _checkParamType(type, value) {\n        if (type === \"string\") {\n          return true;\n        }\n        if (type === \"url\") {\n          return value && value === sanitizeUrl(value);\n        }\n        return false;\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["sanitizeUrl","html","LitElement","nothing","customElement","property","state","navigate","createSearchParam","extractSearchParamsObject","REDIRECTS","supervisor","redirect","supervisor_logs","supervisor_info","supervisor_snapshots","supervisor_backups","supervisor_store","supervisor_addons","supervisor_addon","params","addon","optional_params","repository_url","supervisor_ingress","supervisor_add_addon_repository","HassioMyRedirect","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","decorators","attribute","key","value","connectedCallback","_get","_getPrototypeOf","prototype","call","path","route","substr","_error","localize","link","_templateObject","_taggedTemplateLiteral","url","_createRedirectUrl","err","replace","render","_templateObject2","_createRedirectParams","_this2","Object","keys","resultParams","entries","forEach","_ref","_ref2","_slicedToArray","type","_checkParamType","Error","_ref3","_ref4"],"sources":["/Users/sercanardil/Desktop/frontend/hassio/src/hassio-my-redirect.ts"],"sourcesContent":["import { sanitizeUrl } from \"@braintree/sanitize-url\";\nimport { html, LitElement, TemplateResult, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { navigate } from \"../../src/common/navigate\";\nimport {\n  createSearchParam,\n  extractSearchParamsObject,\n} from \"../../src/common/url/search-params\";\nimport { Supervisor } from \"../../src/data/supervisor/supervisor\";\nimport \"../../src/layouts/hass-error-screen\";\nimport {\n  ParamType,\n  Redirect,\n  Redirects,\n} from \"../../src/panels/my/ha-panel-my\";\nimport { HomeAssistant, Route } from \"../../src/types\";\n\nexport const REDIRECTS: Redirects = {\n  supervisor: {\n    redirect: \"/hassio/dashboard\",\n  },\n  supervisor_logs: {\n    redirect: \"/hassio/system\",\n  },\n  supervisor_info: {\n    redirect: \"/hassio/system\",\n  },\n  supervisor_snapshots: {\n    redirect: \"/hassio/backups\",\n  },\n  supervisor_backups: {\n    redirect: \"/hassio/backups\",\n  },\n  supervisor_store: {\n    redirect: \"/hassio/store\",\n  },\n  supervisor_addons: {\n    redirect: \"/hassio/dashboard\",\n  },\n  supervisor_addon: {\n    redirect: \"/hassio/addon\",\n    params: {\n      addon: \"string\",\n    },\n    optional_params: {\n      repository_url: \"url\",\n    },\n  },\n  supervisor_ingress: {\n    redirect: \"/hassio/ingress\",\n    params: {\n      addon: \"string\",\n    },\n  },\n  supervisor_add_addon_repository: {\n    redirect: \"/hassio/store\",\n    params: {\n      repository_url: \"url\",\n    },\n  },\n};\n\n@customElement(\"hassio-my-redirect\")\nclass HassioMyRedirect extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public supervisor!: Supervisor;\n\n  @property({ attribute: false }) public route!: Route;\n\n  @state() public _error?: TemplateResult | string;\n\n  connectedCallback() {\n    super.connectedCallback();\n    const path = this.route.path.substr(1);\n    const redirect = REDIRECTS[path];\n\n    if (!redirect) {\n      this._error = this.supervisor.localize(\"my.not_supported\", {\n        link: html`<a\n          target=\"_blank\"\n          rel=\"noreferrer noopener\"\n          href=\"https://my.home-assistant.io/faq.html#supported-pages\"\n        >\n          ${this.supervisor.localize(\"my.faq_link\")}\n        </a>`,\n      });\n      return;\n    }\n\n    let url: string;\n    try {\n      url = this._createRedirectUrl(redirect);\n    } catch (err: any) {\n      this._error = this.supervisor.localize(\"my.error\");\n      return;\n    }\n\n    navigate(url, { replace: true });\n  }\n\n  protected render() {\n    if (this._error) {\n      return html`<hass-error-screen\n        .error=${this._error}\n      ></hass-error-screen>`;\n    }\n    return nothing;\n  }\n\n  private _createRedirectUrl(redirect: Redirect): string {\n    const params = this._createRedirectParams(redirect);\n    return `${redirect.redirect}${params}`;\n  }\n\n  private _createRedirectParams(redirect: Redirect): string {\n    const params = extractSearchParamsObject();\n    if (!redirect.params && !Object.keys(params).length) {\n      return \"\";\n    }\n    const resultParams = {};\n    Object.entries(redirect.params || {}).forEach(([key, type]) => {\n      if (!params[key] || !this._checkParamType(type, params[key])) {\n        throw Error();\n      }\n      resultParams[key] = params[key];\n    });\n    Object.entries(redirect.optional_params || {}).forEach(([key, type]) => {\n      if (params[key]) {\n        if (!this._checkParamType(type, params[key])) {\n          throw Error();\n        }\n        resultParams[key] = params[key];\n      }\n    });\n    return `?${createSearchParam(resultParams)}`;\n  }\n\n  private _checkParamType(type: ParamType, value: string) {\n    if (type === \"string\") {\n      return true;\n    }\n    if (type === \"url\") {\n      return value && value === sanitizeUrl(value);\n    }\n    return false;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hassio-my-redirect\": HassioMyRedirect;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}