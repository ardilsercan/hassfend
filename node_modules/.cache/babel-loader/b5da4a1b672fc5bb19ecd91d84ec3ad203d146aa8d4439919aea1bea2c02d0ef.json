{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9;\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.set.difference.v2.js\";\nimport \"core-js/modules/esnext.set.intersection.v2.js\";\nimport \"core-js/modules/esnext.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/esnext.set.is-subset-of.v2.js\";\nimport \"core-js/modules/esnext.set.is-superset-of.v2.js\";\nimport \"core-js/modules/esnext.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/esnext.set.union.v2.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport { css, html, LitElement } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport { clamp } from \"../../common/number/clamp\";\nimport { debounce } from \"../../common/util/debounce\";\nexport var MIN_TIME_BETWEEN_UPDATES = 60 * 5 * 1000;\nexport var HaChartBase = _decorate([customElement(\"ha-chart-base\")], function (_initialize, _LitElement) {\n  var HaChartBase = /*#__PURE__*/function (_LitElement2) {\n    _inherits(HaChartBase, _LitElement2);\n    function HaChartBase() {\n      var _this;\n      _classCallCheck(this, HaChartBase);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, HaChartBase, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(HaChartBase);\n  }(_LitElement);\n  return {\n    F: HaChartBase,\n    d: [{\n      kind: \"field\",\n      key: \"chart\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: \"chart-type\",\n        reflect: true\n      })],\n      key: \"chartType\",\n      value: function value() {\n        return \"line\";\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"data\",\n      value: function value() {\n        return {\n          datasets: []\n        };\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"options\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"plugins\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Number\n      })],\n      key: \"height\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Number\n      })],\n      key: \"paddingYAxis\",\n      value: function value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_chartHeight\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_tooltip\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_hiddenDatasets\",\n      value: function value() {\n        return new Set();\n      }\n    }, {\n      kind: \"field\",\n      key: \"_paddingUpdateCount\",\n      value: function value() {\n        return 0;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_paddingUpdateLock\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_paddingYAxisInternal\",\n      value: function value() {\n        return 0;\n      }\n    }, {\n      kind: \"method\",\n      key: \"disconnectedCallback\",\n      value: function disconnectedCallback() {\n        _get(_getPrototypeOf(HaChartBase.prototype), \"disconnectedCallback\", this).call(this);\n        this._releaseCanvas();\n      }\n    }, {\n      kind: \"method\",\n      key: \"connectedCallback\",\n      value: function connectedCallback() {\n        _get(_getPrototypeOf(HaChartBase.prototype), \"connectedCallback\", this).call(this);\n        if (this.hasUpdated) {\n          this._releaseCanvas();\n          this._setupChart();\n        }\n      }\n    }, {\n      kind: \"field\",\n      key: \"updateChart\",\n      value: function value() {\n        var _this2 = this;\n        return function (mode) {\n          var _this2$chart;\n          (_this2$chart = _this2.chart) === null || _this2$chart === void 0 || _this2$chart.update(mode);\n        };\n      }\n    }, {\n      kind: \"field\",\n      key: \"resize\",\n      value: function value() {\n        var _this3 = this;\n        return function (options) {\n          var _this3$chart, _options$width2, _options$height2;\n          if (options !== null && options !== void 0 && options.aspectRatio && !options.height) {\n            var _options$width;\n            options.height = Math.round(((_options$width = options.width) !== null && _options$width !== void 0 ? _options$width : _this3.clientWidth) / options.aspectRatio);\n          } else if (options !== null && options !== void 0 && options.aspectRatio && !options.width) {\n            var _options$height;\n            options.width = Math.round(((_options$height = options.height) !== null && _options$height !== void 0 ? _options$height : _this3.clientHeight) * options.aspectRatio);\n          }\n          (_this3$chart = _this3.chart) === null || _this3$chart === void 0 || _this3$chart.resize((_options$width2 = options === null || options === void 0 ? void 0 : options.width) !== null && _options$width2 !== void 0 ? _options$width2 : _this3.clientWidth, (_options$height2 = options === null || options === void 0 ? void 0 : options.height) !== null && _options$height2 !== void 0 ? _options$height2 : _this3.clientHeight);\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"firstUpdated\",\n      value: function firstUpdated() {\n        var _this4 = this;\n        this._setupChart();\n        this.data.datasets.forEach(function (dataset, index) {\n          if (dataset.hidden) {\n            _this4._hiddenDatasets.add(index);\n          }\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"shouldUpdate\",\n      value: function shouldUpdate(changedProps) {\n        if (this._paddingUpdateLock && changedProps.size === 1 && changedProps.has(\"paddingYAxis\")) {\n          return false;\n        }\n        return true;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_debouncedClearUpdates\",\n      value: function value() {\n        var _this5 = this;\n        return debounce(function () {\n          _this5._paddingUpdateCount = 0;\n        }, 2000, false);\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        var _this6 = this;\n        _get(_getPrototypeOf(HaChartBase.prototype), \"willUpdate\", this).call(this, changedProps);\n        if (!this._paddingUpdateLock) {\n          this._paddingYAxisInternal = this.paddingYAxis;\n          if (changedProps.size === 1 && changedProps.has(\"paddingYAxis\")) {\n            this._paddingUpdateCount++;\n            if (this._paddingUpdateCount > 300) {\n              this._paddingUpdateLock = true;\n              // eslint-disable-next-line\n              console.error(\"Detected excessive chart padding updates, possibly an infinite loop. Disabling axis padding.\");\n            } else {\n              this._debouncedClearUpdates();\n            }\n          }\n        }\n        if (!this.hasUpdated || !this.chart) {\n          return;\n        }\n        if (changedProps.has(\"plugins\") || changedProps.has(\"chartType\")) {\n          this._releaseCanvas();\n          this._setupChart();\n          return;\n        }\n        if (changedProps.has(\"data\")) {\n          if (this._hiddenDatasets.size) {\n            this.data.datasets.forEach(function (dataset, index) {\n              dataset.hidden = _this6._hiddenDatasets.has(index);\n            });\n          }\n          this.chart.data = this.data;\n        }\n        if (changedProps.has(\"options\")) {\n          this.chart.options = this._createOptions();\n        }\n        this.chart.update(\"none\");\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        var _this$options,\n          _this7 = this,\n          _ref,\n          _this$height;\n        return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n      \", \"\\n      <div\\n        class=\\\"animationContainer\\\"\\n        style=\", \"\\n      >\\n        <div\\n          class=\\\"chartContainer\\\"\\n          style=\", \"\\n        >\\n          <canvas></canvas>\\n          \", \"\\n        </div>\\n      </div>\\n    \"])), ((_this$options = this.options) === null || _this$options === void 0 || (_this$options = _this$options.plugins) === null || _this$options === void 0 || (_this$options = _this$options.legend) === null || _this$options === void 0 ? void 0 : _this$options.display) === true ? html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"<div class=\\\"chartLegend\\\">\\n            <ul>\\n              \", \"\\n            </ul>\\n          </div>\"])), this.data.datasets.map(function (dataset, index) {\n          return html(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"<li\\n                    .datasetIndex=\", \"\\n                    @click=\", \"\\n                    class=\", \"\\n                    .title=\", \"\\n                  >\\n                    <div\\n                      class=\\\"bullet\\\"\\n                      style=\", \"\\n                    ></div>\\n                    <div class=\\\"label\\\">\", \"</div>\\n                  </li>\"])), index, _this7._legendClick, classMap({\n            hidden: _this7._hiddenDatasets.has(index)\n          }), dataset.label, styleMap({\n            backgroundColor: dataset.backgroundColor,\n            borderColor: dataset.borderColor\n          }), dataset.label);\n        })) : \"\", styleMap({\n          height: \"\".concat(this.height || this._chartHeight || 0, \"px\"),\n          overflow: this._chartHeight ? \"initial\" : \"hidden\"\n        }), styleMap({\n          height: \"\".concat((_ref = (_this$height = this.height) !== null && _this$height !== void 0 ? _this$height : this._chartHeight) !== null && _ref !== void 0 ? _ref : this.clientWidth / 2, \"px\"),\n          \"padding-left\": \"\".concat(this._paddingYAxisInternal),\n          \"padding-right\": 0,\n          \"padding-inline-start\": \"\".concat(this._paddingYAxisInternal),\n          \"padding-inline-end\": 0\n        }), this._tooltip ? html(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"<div\\n                class=\\\"chartTooltip \", \"\\\"\\n                style=\", \"\\n              >\\n                <div class=\\\"title\\\">\", \"</div>\\n                \", \"\\n                <div>\\n                  <ul>\\n                    \", \"\\n                  </ul>\\n                </div>\\n                \", \"\\n              </div>\"])), classMap(_defineProperty({}, this._tooltip.yAlign, true)), styleMap({\n          top: this._tooltip.top,\n          left: this._tooltip.left\n        }), this._tooltip.title, this._tooltip.beforeBody ? html(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"<div class=\\\"beforeBody\\\">\\n                      \", \"\\n                    </div>\"])), this._tooltip.beforeBody) : \"\", this._tooltip.body.map(function (item, i) {\n          return html(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"<li>\\n                          <div\\n                            class=\\\"bullet\\\"\\n                            style=\", \"\\n                          ></div>\\n                          \", \"\\n                        </li>\"])), styleMap({\n            backgroundColor: _this7._tooltip.labelColors[i].backgroundColor,\n            borderColor: _this7._tooltip.labelColors[i].borderColor\n          }), item.lines.join(\"\\n\"));\n        }), this._tooltip.footer.length ? html(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"<div class=\\\"footer\\\">\\n                      \", \"\\n                    </div>\"])), this._tooltip.footer.map(function (item) {\n          return html(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\", \"<br />\"])), item);\n        })) : \"\") : \"\");\n      }\n    }, {\n      kind: \"method\",\n      key: \"_setupChart\",\n      value: function () {\n        var _setupChart2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          var ctx, ChartConstructor, computedStyles;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                ctx = this.renderRoot.querySelector(\"canvas\").getContext(\"2d\");\n                _context.next = 3;\n                return import(\"../../resources/chartjs\");\n              case 3:\n                ChartConstructor = _context.sent.Chart;\n                computedStyles = getComputedStyle(this);\n                ChartConstructor.defaults.borderColor = computedStyles.getPropertyValue(\"--divider-color\");\n                ChartConstructor.defaults.color = computedStyles.getPropertyValue(\"--secondary-text-color\");\n                ChartConstructor.defaults.font.family = computedStyles.getPropertyValue(\"--mdc-typography-body1-font-family\") || computedStyles.getPropertyValue(\"--mdc-typography-font-family\") || \"Roboto, Noto, sans-serif\";\n                this.chart = new ChartConstructor(ctx, {\n                  type: this.chartType,\n                  data: this.data,\n                  options: this._createOptions(),\n                  plugins: this._createPlugins()\n                });\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this);\n        }));\n        function _setupChart() {\n          return _setupChart2.apply(this, arguments);\n        }\n        return _setupChart;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_createOptions\",\n      value: function _createOptions() {\n        var _this$options2,\n          _this$options3,\n          _this8 = this,\n          _this$options4;\n        return Object.assign(Object.assign({\n          maintainAspectRatio: false\n        }, this.options), {}, {\n          plugins: Object.assign(Object.assign({}, (_this$options2 = this.options) === null || _this$options2 === void 0 ? void 0 : _this$options2.plugins), {}, {\n            tooltip: Object.assign(Object.assign({}, (_this$options3 = this.options) === null || _this$options3 === void 0 || (_this$options3 = _this$options3.plugins) === null || _this$options3 === void 0 ? void 0 : _this$options3.tooltip), {}, {\n              enabled: false,\n              external: function external(context) {\n                return _this8._handleTooltip(context);\n              }\n            }),\n            legend: Object.assign(Object.assign({}, (_this$options4 = this.options) === null || _this$options4 === void 0 || (_this$options4 = _this$options4.plugins) === null || _this$options4 === void 0 ? void 0 : _this$options4.legend), {}, {\n              display: false\n            })\n          })\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_createPlugins\",\n      value: function _createPlugins() {\n        var _this9 = this,\n          _this$options5;\n        return [].concat(_toConsumableArray(this.plugins || []), [{\n          id: \"resizeHook\",\n          resize: function resize(chart) {\n            var _this9$_chartHeight;\n            var change = chart.height - ((_this9$_chartHeight = _this9._chartHeight) !== null && _this9$_chartHeight !== void 0 ? _this9$_chartHeight : 0);\n            if (!_this9._chartHeight || change > 12 || change < -12) {\n              // hysteresis to prevent infinite render loops\n              _this9._chartHeight = chart.height;\n            }\n          },\n          legend: Object.assign(Object.assign({}, (_this$options5 = this.options) === null || _this$options5 === void 0 || (_this$options5 = _this$options5.plugins) === null || _this$options5 === void 0 ? void 0 : _this$options5.legend), {}, {\n            display: false\n          })\n        }]);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_legendClick\",\n      value: function _legendClick(ev) {\n        if (!this.chart) {\n          return;\n        }\n        var index = ev.currentTarget.datasetIndex;\n        if (this.chart.isDatasetVisible(index)) {\n          this.chart.setDatasetVisibility(index, false);\n          this._hiddenDatasets.add(index);\n        } else {\n          this.chart.setDatasetVisibility(index, true);\n          this._hiddenDatasets.delete(index);\n        }\n        this.chart.update(\"none\");\n        this.requestUpdate(\"_hiddenDatasets\");\n      }\n    }, {\n      kind: \"method\",\n      key: \"_handleTooltip\",\n      value: function _handleTooltip(context) {\n        if (context.tooltip.opacity === 0) {\n          this._tooltip = undefined;\n          return;\n        }\n        this._tooltip = Object.assign(Object.assign({}, context.tooltip), {}, {\n          top: this.chart.canvas.offsetTop + context.tooltip.caretY + 12 + \"px\",\n          left: this.chart.canvas.offsetLeft + clamp(context.tooltip.caretX, 100, this.clientWidth - 100 - this._paddingYAxisInternal) - 100 + \"px\"\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_releaseCanvas\",\n      value: function _releaseCanvas() {\n        // release the canvas memory to prevent\n        // safari from running out of memory.\n        if (this.chart) {\n          this.chart.destroy();\n        }\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return css(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\\n      :host {\\n        display: block;\\n        position: var(--chart-base-position, relative);\\n      }\\n      .animationContainer {\\n        overflow: hidden;\\n        height: 0;\\n        transition: height 300ms cubic-bezier(0.4, 0, 0.2, 1);\\n      }\\n      canvas {\\n        max-height: var(--chart-max-height, 400px);\\n      }\\n      .chartLegend {\\n        text-align: center;\\n      }\\n      .chartLegend li {\\n        cursor: pointer;\\n        display: inline-grid;\\n        grid-auto-flow: column;\\n        padding: 0 8px;\\n        box-sizing: border-box;\\n        align-items: center;\\n        color: var(--secondary-text-color);\\n      }\\n      .chartLegend .hidden {\\n        text-decoration: line-through;\\n      }\\n      .chartLegend .label {\\n        text-overflow: ellipsis;\\n        white-space: nowrap;\\n        overflow: hidden;\\n      }\\n      .chartLegend .bullet,\\n      .chartTooltip .bullet {\\n        border-width: 1px;\\n        border-style: solid;\\n        border-radius: 50%;\\n        display: inline-block;\\n        height: 16px;\\n        margin-right: 6px;\\n        width: 16px;\\n        flex-shrink: 0;\\n        box-sizing: border-box;\\n        margin-inline-end: 6px;\\n        margin-inline-start: initial;\\n        direction: var(--direction);\\n      }\\n      .chartTooltip .bullet {\\n        align-self: baseline;\\n      }\\n      .chartTooltip {\\n        padding: 8px;\\n        font-size: 90%;\\n        position: absolute;\\n        background: rgba(80, 80, 80, 0.9);\\n        color: white;\\n        border-radius: 4px;\\n        pointer-events: none;\\n        z-index: 1;\\n        -ms-user-select: none;\\n        -webkit-user-select: none;\\n        -moz-user-select: none;\\n        width: 200px;\\n        box-sizing: border-box;\\n        direction: var(--direction);\\n      }\\n      .chartLegend ul,\\n      .chartTooltip ul {\\n        display: inline-block;\\n        padding: 0 0px;\\n        margin: 8px 0 0 0;\\n        width: 100%;\\n      }\\n      .chartTooltip ul {\\n        margin: 0 4px;\\n      }\\n      .chartTooltip li {\\n        display: flex;\\n        white-space: pre-line;\\n        word-break: break-word;\\n        align-items: center;\\n        line-height: 16px;\\n        padding: 4px 0;\\n      }\\n      .chartTooltip .title {\\n        text-align: center;\\n        font-weight: 500;\\n        word-break: break-word;\\n        direction: ltr;\\n      }\\n      .chartTooltip .footer {\\n        font-weight: 500;\\n      }\\n      .chartTooltip .beforeBody {\\n        text-align: center;\\n        font-weight: 300;\\n        word-break: break-all;\\n      }\\n    \"])));\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["css","html","LitElement","customElement","property","state","classMap","styleMap","clamp","debounce","MIN_TIME_BETWEEN_UPDATES","HaChartBase","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","key","value","decorators","attribute","reflect","datasets","type","Number","Set","disconnectedCallback","_get","_getPrototypeOf","prototype","call","_releaseCanvas","connectedCallback","hasUpdated","_setupChart","_this2","mode","_this2$chart","chart","update","_this3","options","_this3$chart","_options$width2","_options$height2","aspectRatio","height","_options$width","Math","round","width","clientWidth","_options$height","clientHeight","resize","firstUpdated","_this4","data","forEach","dataset","index","hidden","_hiddenDatasets","add","shouldUpdate","changedProps","_paddingUpdateLock","size","has","_this5","_paddingUpdateCount","willUpdate","_this6","_paddingYAxisInternal","paddingYAxis","console","error","_debouncedClearUpdates","_createOptions","render","_this$options","_this7","_ref","_this$height","_templateObject","_taggedTemplateLiteral","plugins","legend","display","_templateObject2","map","_templateObject3","_legendClick","label","backgroundColor","borderColor","_chartHeight","overflow","_tooltip","_templateObject4","_defineProperty","yAlign","top","left","title","beforeBody","_templateObject5","body","item","i","_templateObject6","labelColors","lines","join","footer","_templateObject7","_templateObject8","_setupChart2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","ctx","ChartConstructor","computedStyles","wrap","_callee$","_context","prev","next","renderRoot","querySelector","getContext","sent","Chart","getComputedStyle","defaults","getPropertyValue","color","font","family","chartType","_createPlugins","stop","apply","_this$options2","_this$options3","_this8","_this$options4","Object","assign","maintainAspectRatio","tooltip","enabled","external","context","_handleTooltip","_this9","_this$options5","_toConsumableArray","id","_this9$_chartHeight","change","ev","currentTarget","datasetIndex","isDatasetVisible","setDatasetVisibility","delete","requestUpdate","opacity","undefined","canvas","offsetTop","caretY","offsetLeft","caretX","destroy","static","styles","_templateObject9"],"sources":["/workspaces/frontend/src/components/chart/ha-chart-base.ts"],"sourcesContent":["import type {\n  Chart,\n  ChartType,\n  ChartData,\n  ChartOptions,\n  TooltipModel,\n} from \"chart.js\";\nimport { css, CSSResultGroup, html, LitElement, PropertyValues } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport { clamp } from \"../../common/number/clamp\";\nimport { HomeAssistant } from \"../../types\";\nimport { debounce } from \"../../common/util/debounce\";\n\nexport const MIN_TIME_BETWEEN_UPDATES = 60 * 5 * 1000;\n\nexport interface ChartResizeOptions {\n  aspectRatio?: number;\n  height?: number;\n  width?: number;\n}\n\ninterface Tooltip\n  extends Omit<TooltipModel<any>, \"tooltipPosition\" | \"hasValue\" | \"getProps\"> {\n  top: string;\n  left: string;\n}\n\n@customElement(\"ha-chart-base\")\nexport class HaChartBase extends LitElement {\n  public chart?: Chart;\n\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: \"chart-type\", reflect: true })\n  public chartType: ChartType = \"line\";\n\n  @property({ attribute: false }) public data: ChartData = { datasets: [] };\n\n  @property({ attribute: false }) public options?: ChartOptions;\n\n  @property({ attribute: false }) public plugins?: any[];\n\n  @property({ type: Number }) public height?: number;\n\n  @property({ type: Number }) public paddingYAxis = 0;\n\n  @state() private _chartHeight?: number;\n\n  @state() private _tooltip?: Tooltip;\n\n  @state() private _hiddenDatasets: Set<number> = new Set();\n\n  private _paddingUpdateCount = 0;\n\n  private _paddingUpdateLock = false;\n\n  private _paddingYAxisInternal = 0;\n\n  public disconnectedCallback() {\n    super.disconnectedCallback();\n    this._releaseCanvas();\n  }\n\n  public connectedCallback() {\n    super.connectedCallback();\n    if (this.hasUpdated) {\n      this._releaseCanvas();\n      this._setupChart();\n    }\n  }\n\n  public updateChart = (\n    mode:\n      | \"resize\"\n      | \"reset\"\n      | \"none\"\n      | \"hide\"\n      | \"show\"\n      | \"default\"\n      | \"active\"\n      | undefined\n  ): void => {\n    this.chart?.update(mode);\n  };\n\n  public resize = (options?: ChartResizeOptions): void => {\n    if (options?.aspectRatio && !options.height) {\n      options.height = Math.round(\n        (options.width ?? this.clientWidth) / options.aspectRatio\n      );\n    } else if (options?.aspectRatio && !options.width) {\n      options.width = Math.round(\n        (options.height ?? this.clientHeight) * options.aspectRatio\n      );\n    }\n    this.chart?.resize(\n      options?.width ?? this.clientWidth,\n      options?.height ?? this.clientHeight\n    );\n  };\n\n  protected firstUpdated() {\n    this._setupChart();\n    this.data.datasets.forEach((dataset, index) => {\n      if (dataset.hidden) {\n        this._hiddenDatasets.add(index);\n      }\n    });\n  }\n\n  public shouldUpdate(changedProps: PropertyValues): boolean {\n    if (\n      this._paddingUpdateLock &&\n      changedProps.size === 1 &&\n      changedProps.has(\"paddingYAxis\")\n    ) {\n      return false;\n    }\n    return true;\n  }\n\n  private _debouncedClearUpdates = debounce(\n    () => {\n      this._paddingUpdateCount = 0;\n    },\n    2000,\n    false\n  );\n\n  public willUpdate(changedProps: PropertyValues): void {\n    super.willUpdate(changedProps);\n\n    if (!this._paddingUpdateLock) {\n      this._paddingYAxisInternal = this.paddingYAxis;\n      if (changedProps.size === 1 && changedProps.has(\"paddingYAxis\")) {\n        this._paddingUpdateCount++;\n        if (this._paddingUpdateCount > 300) {\n          this._paddingUpdateLock = true;\n          // eslint-disable-next-line\n          console.error(\n            \"Detected excessive chart padding updates, possibly an infinite loop. Disabling axis padding.\"\n          );\n        } else {\n          this._debouncedClearUpdates();\n        }\n      }\n    }\n\n    if (!this.hasUpdated || !this.chart) {\n      return;\n    }\n    if (changedProps.has(\"plugins\") || changedProps.has(\"chartType\")) {\n      this._releaseCanvas();\n      this._setupChart();\n      return;\n    }\n    if (changedProps.has(\"data\")) {\n      if (this._hiddenDatasets.size) {\n        this.data.datasets.forEach((dataset, index) => {\n          dataset.hidden = this._hiddenDatasets.has(index);\n        });\n      }\n      this.chart.data = this.data;\n    }\n    if (changedProps.has(\"options\")) {\n      this.chart.options = this._createOptions();\n    }\n    this.chart.update(\"none\");\n  }\n\n  protected render() {\n    return html`\n      ${this.options?.plugins?.legend?.display === true\n        ? html`<div class=\"chartLegend\">\n            <ul>\n              ${this.data.datasets.map(\n                (dataset, index) =>\n                  html`<li\n                    .datasetIndex=${index}\n                    @click=${this._legendClick}\n                    class=${classMap({\n                      hidden: this._hiddenDatasets.has(index),\n                    })}\n                    .title=${dataset.label}\n                  >\n                    <div\n                      class=\"bullet\"\n                      style=${styleMap({\n                        backgroundColor: dataset.backgroundColor as string,\n                        borderColor: dataset.borderColor as string,\n                      })}\n                    ></div>\n                    <div class=\"label\">${dataset.label}</div>\n                  </li>`\n              )}\n            </ul>\n          </div>`\n        : \"\"}\n      <div\n        class=\"animationContainer\"\n        style=${styleMap({\n          height: `${this.height || this._chartHeight || 0}px`,\n          overflow: this._chartHeight ? \"initial\" : \"hidden\",\n        })}\n      >\n        <div\n          class=\"chartContainer\"\n          style=${styleMap({\n            height: `${\n              this.height ?? this._chartHeight ?? this.clientWidth / 2\n            }px`,\n            \"padding-left\": `${this._paddingYAxisInternal}`,\n            \"padding-right\": 0,\n            \"padding-inline-start\": `${this._paddingYAxisInternal}`,\n            \"padding-inline-end\": 0,\n          })}\n        >\n          <canvas></canvas>\n          ${this._tooltip\n            ? html`<div\n                class=\"chartTooltip ${classMap({\n                  [this._tooltip.yAlign]: true,\n                })}\"\n                style=${styleMap({\n                  top: this._tooltip.top,\n                  left: this._tooltip.left,\n                })}\n              >\n                <div class=\"title\">${this._tooltip.title}</div>\n                ${this._tooltip.beforeBody\n                  ? html`<div class=\"beforeBody\">\n                      ${this._tooltip.beforeBody}\n                    </div>`\n                  : \"\"}\n                <div>\n                  <ul>\n                    ${this._tooltip.body.map(\n                      (item, i) =>\n                        html`<li>\n                          <div\n                            class=\"bullet\"\n                            style=${styleMap({\n                              backgroundColor: this._tooltip!.labelColors[i]\n                                .backgroundColor as string,\n                              borderColor: this._tooltip!.labelColors[i]\n                                .borderColor as string,\n                            })}\n                          ></div>\n                          ${item.lines.join(\"\\n\")}\n                        </li>`\n                    )}\n                  </ul>\n                </div>\n                ${this._tooltip.footer.length\n                  ? html`<div class=\"footer\">\n                      ${this._tooltip.footer.map((item) => html`${item}<br />`)}\n                    </div>`\n                  : \"\"}\n              </div>`\n            : \"\"}\n        </div>\n      </div>\n    `;\n  }\n\n  private async _setupChart() {\n    const ctx: CanvasRenderingContext2D = this.renderRoot\n      .querySelector(\"canvas\")!\n      .getContext(\"2d\")!;\n\n    const ChartConstructor = (await import(\"../../resources/chartjs\")).Chart;\n\n    const computedStyles = getComputedStyle(this);\n\n    ChartConstructor.defaults.borderColor =\n      computedStyles.getPropertyValue(\"--divider-color\");\n    ChartConstructor.defaults.color = computedStyles.getPropertyValue(\n      \"--secondary-text-color\"\n    );\n    ChartConstructor.defaults.font.family =\n      computedStyles.getPropertyValue(\"--mdc-typography-body1-font-family\") ||\n      computedStyles.getPropertyValue(\"--mdc-typography-font-family\") ||\n      \"Roboto, Noto, sans-serif\";\n\n    this.chart = new ChartConstructor(ctx, {\n      type: this.chartType,\n      data: this.data,\n      options: this._createOptions(),\n      plugins: this._createPlugins(),\n    });\n  }\n\n  private _createOptions() {\n    return {\n      maintainAspectRatio: false,\n      ...this.options,\n      plugins: {\n        ...this.options?.plugins,\n        tooltip: {\n          ...this.options?.plugins?.tooltip,\n          enabled: false,\n          external: (context) => this._handleTooltip(context),\n        },\n        legend: {\n          ...this.options?.plugins?.legend,\n          display: false,\n        },\n      },\n    };\n  }\n\n  private _createPlugins() {\n    return [\n      ...(this.plugins || []),\n      {\n        id: \"resizeHook\",\n        resize: (chart) => {\n          const change = chart.height - (this._chartHeight ?? 0);\n          if (!this._chartHeight || change > 12 || change < -12) {\n            // hysteresis to prevent infinite render loops\n            this._chartHeight = chart.height;\n          }\n        },\n        legend: {\n          ...this.options?.plugins?.legend,\n          display: false,\n        },\n      },\n    ];\n  }\n\n  private _legendClick(ev) {\n    if (!this.chart) {\n      return;\n    }\n    const index = ev.currentTarget.datasetIndex;\n    if (this.chart.isDatasetVisible(index)) {\n      this.chart.setDatasetVisibility(index, false);\n      this._hiddenDatasets.add(index);\n    } else {\n      this.chart.setDatasetVisibility(index, true);\n      this._hiddenDatasets.delete(index);\n    }\n    this.chart.update(\"none\");\n    this.requestUpdate(\"_hiddenDatasets\");\n  }\n\n  private _handleTooltip(context: {\n    chart: Chart;\n    tooltip: TooltipModel<any>;\n  }) {\n    if (context.tooltip.opacity === 0) {\n      this._tooltip = undefined;\n      return;\n    }\n    this._tooltip = {\n      ...context.tooltip,\n      top: this.chart!.canvas.offsetTop + context.tooltip.caretY + 12 + \"px\",\n      left:\n        this.chart!.canvas.offsetLeft +\n        clamp(\n          context.tooltip.caretX,\n          100,\n          this.clientWidth - 100 - this._paddingYAxisInternal\n        ) -\n        100 +\n        \"px\",\n    };\n  }\n\n  private _releaseCanvas() {\n    // release the canvas memory to prevent\n    // safari from running out of memory.\n    if (this.chart) {\n      this.chart.destroy();\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        display: block;\n        position: var(--chart-base-position, relative);\n      }\n      .animationContainer {\n        overflow: hidden;\n        height: 0;\n        transition: height 300ms cubic-bezier(0.4, 0, 0.2, 1);\n      }\n      canvas {\n        max-height: var(--chart-max-height, 400px);\n      }\n      .chartLegend {\n        text-align: center;\n      }\n      .chartLegend li {\n        cursor: pointer;\n        display: inline-grid;\n        grid-auto-flow: column;\n        padding: 0 8px;\n        box-sizing: border-box;\n        align-items: center;\n        color: var(--secondary-text-color);\n      }\n      .chartLegend .hidden {\n        text-decoration: line-through;\n      }\n      .chartLegend .label {\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        overflow: hidden;\n      }\n      .chartLegend .bullet,\n      .chartTooltip .bullet {\n        border-width: 1px;\n        border-style: solid;\n        border-radius: 50%;\n        display: inline-block;\n        height: 16px;\n        margin-right: 6px;\n        width: 16px;\n        flex-shrink: 0;\n        box-sizing: border-box;\n        margin-inline-end: 6px;\n        margin-inline-start: initial;\n        direction: var(--direction);\n      }\n      .chartTooltip .bullet {\n        align-self: baseline;\n      }\n      .chartTooltip {\n        padding: 8px;\n        font-size: 90%;\n        position: absolute;\n        background: rgba(80, 80, 80, 0.9);\n        color: white;\n        border-radius: 4px;\n        pointer-events: none;\n        z-index: 1;\n        -ms-user-select: none;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        width: 200px;\n        box-sizing: border-box;\n        direction: var(--direction);\n      }\n      .chartLegend ul,\n      .chartTooltip ul {\n        display: inline-block;\n        padding: 0 0px;\n        margin: 8px 0 0 0;\n        width: 100%;\n      }\n      .chartTooltip ul {\n        margin: 0 4px;\n      }\n      .chartTooltip li {\n        display: flex;\n        white-space: pre-line;\n        word-break: break-word;\n        align-items: center;\n        line-height: 16px;\n        padding: 4px 0;\n      }\n      .chartTooltip .title {\n        text-align: center;\n        font-weight: 500;\n        word-break: break-word;\n        direction: ltr;\n      }\n      .chartTooltip .footer {\n        font-weight: 500;\n      }\n      .chartTooltip .beforeBody {\n        text-align: center;\n        font-weight: 300;\n        word-break: break-all;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-chart-base\": HaChartBase;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}