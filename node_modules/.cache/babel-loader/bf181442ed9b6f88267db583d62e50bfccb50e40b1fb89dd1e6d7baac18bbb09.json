{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport \"@material/mwc-button/mwc-button\";\nconst mdiDotsVertical = \"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z\";\nimport { addDays, addMonths, differenceInDays, differenceInMonths, endOfDay, endOfMonth, endOfQuarter, endOfToday, endOfWeek, endOfYear, isFirstDayOfMonth, isLastDayOfMonth, startOfDay, startOfMonth, startOfQuarter, startOfWeek, startOfYear, subDays } from \"date-fns/esm\";\nimport { LitElement, css, html, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { calcDate, calcDateProperty } from \"../../../common/datetime/calc_date\";\nimport { firstWeekdayIndex } from \"../../../common/datetime/first_weekday\";\nimport { formatDate, formatDateMonthYear, formatDateShort, formatDateVeryShort, formatDateYear } from \"../../../common/datetime/format_date\";\nimport { debounce } from \"../../../common/util/debounce\";\nimport \"../../../components/ha-button-menu\";\nimport \"../../../components/ha-check-list-item\";\nimport \"../../../components/ha-date-range-picker\";\nimport \"../../../components/ha-icon-button-next\";\nimport \"../../../components/ha-icon-button-prev\";\nimport { getEnergyDataCollection } from \"../../../data/energy\";\nimport { SubscribeMixin } from \"../../../mixins/subscribe-mixin\";\nimport { loadPolyfillIfNeeded } from \"../../../resources/resize-observer.polyfill\";\nexport let HuiEnergyPeriodSelector = _decorate([customElement(\"hui-energy-period-selector\")], function (_initialize, _SubscribeMixin) {\n  class HuiEnergyPeriodSelector extends _SubscribeMixin {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: HuiEnergyPeriodSelector,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"collectionKey\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean,\n        reflect: true\n      })],\n      key: \"narrow\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_startDate\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_endDate\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_ranges\",\n      value() {\n        return {};\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_compare\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_resizeObserver\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"hassSubscribe\",\n      value: function hassSubscribe() {\n        return [getEnergyDataCollection(this.hass, {\n          key: this.collectionKey\n        }).subscribe(data => this._updateDates(data))];\n      }\n    }, {\n      kind: \"method\",\n      key: \"_measure\",\n      value: function _measure() {\n        this.narrow = this.offsetWidth < 450;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_attachObserver\",\n      value: async function _attachObserver() {\n        if (!this._resizeObserver) {\n          await loadPolyfillIfNeeded();\n          this._resizeObserver = new ResizeObserver(debounce(() => this._measure(), 250, false));\n        }\n        this._resizeObserver.observe(this);\n      }\n    }, {\n      kind: \"method\",\n      key: \"firstUpdated\",\n      value: function firstUpdated() {\n        this._attachObserver();\n      }\n    }, {\n      kind: \"method\",\n      key: \"connectedCallback\",\n      value: function connectedCallback() {\n        _get(_getPrototypeOf(HuiEnergyPeriodSelector.prototype), \"connectedCallback\", this).call(this);\n        this.updateComplete.then(() => this._attachObserver());\n      }\n    }, {\n      kind: \"method\",\n      key: \"disconnectedCallback\",\n      value: function disconnectedCallback() {\n        _get(_getPrototypeOf(HuiEnergyPeriodSelector.prototype), \"disconnectedCallback\", this).call(this);\n        if (this._resizeObserver) {\n          this._resizeObserver.disconnect();\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        var _this$hass, _changedProps$get;\n        _get(_getPrototypeOf(HuiEnergyPeriodSelector.prototype), \"willUpdate\", this).call(this, changedProps);\n        if (!this.hasUpdated) {\n          this._measure();\n        }\n        if (!this.hasUpdated || changedProps.has(\"hass\") && ((_this$hass = this.hass) === null || _this$hass === void 0 ? void 0 : _this$hass.localize) !== ((_changedProps$get = changedProps.get(\"hass\")) === null || _changedProps$get === void 0 ? void 0 : _changedProps$get.localize)) {\n          const today = new Date();\n          const weekStartsOn = firstWeekdayIndex(this.hass.locale);\n\n          // pre defined date ranges\n          this._ranges = {\n            [this.hass.localize(\"ui.components.date-range-picker.ranges.today\")]: [calcDate(today, startOfDay, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            }), calcDate(today, endOfDay, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            })],\n            [this.hass.localize(\"ui.components.date-range-picker.ranges.yesterday\")]: [calcDate(calcDate(today, subDays, this.hass.locale, this.hass.config, 1), startOfDay, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            }), calcDate(calcDate(today, subDays, this.hass.locale, this.hass.config, 1), endOfDay, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            })],\n            [this.hass.localize(\"ui.components.date-range-picker.ranges.this_week\")]: [calcDate(today, startOfWeek, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            }), calcDate(today, endOfWeek, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            })],\n            [this.hass.localize(\"ui.components.date-range-picker.ranges.this_month\")]: [calcDate(today, startOfMonth, this.hass.locale, this.hass.config), calcDate(today, endOfMonth, this.hass.locale, this.hass.config)],\n            [this.hass.localize(\"ui.components.date-range-picker.ranges.this_quarter\")]: [calcDate(today, startOfQuarter, this.hass.locale, this.hass.config), calcDate(today, endOfQuarter, this.hass.locale, this.hass.config)],\n            [this.hass.localize(\"ui.components.date-range-picker.ranges.this_year\")]: [calcDate(today, startOfYear, this.hass.locale, this.hass.config), calcDate(today, endOfYear, this.hass.locale, this.hass.config)]\n          };\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this.hass || !this._startDate) {\n          return nothing;\n        }\n        const simpleRange = this._simpleRange(this._startDate, this._endDate, this.hass.locale, this.hass.config);\n        return html`\n      <div class=\"row\">\n        <div class=\"label\">\n          ${simpleRange === \"day\" ? this.narrow ? formatDateShort(this._startDate, this.hass.locale, this.hass.config) : formatDate(this._startDate, this.hass.locale, this.hass.config) : simpleRange === \"month\" ? formatDateMonthYear(this._startDate, this.hass.locale, this.hass.config) : simpleRange === \"year\" ? formatDateYear(this._startDate, this.hass.locale, this.hass.config) : `${formatDateVeryShort(this._startDate, this.hass.locale, this.hass.config)} – ${formatDateVeryShort(this._endDate || new Date(), this.hass.locale, this.hass.config)}`}\n        </div>\n        <div class=\"time-handle\">\n          <ha-icon-button-prev\n            .label=${this.hass.localize(\"ui.panel.lovelace.components.energy_period_selector.previous\")}\n            @click=${this._pickPrevious}\n          ></ha-icon-button-prev>\n          <ha-icon-button-next\n            .label=${this.hass.localize(\"ui.panel.lovelace.components.energy_period_selector.next\")}\n            @click=${this._pickNext}\n          ></ha-icon-button-next>\n          <ha-date-range-picker\n            .hass=${this.hass}\n            .startDate=${this._startDate}\n            .endDate=${this._endDate || new Date()}\n            .ranges=${this._ranges}\n            @change=${this._dateRangeChanged}\n            .timePicker=${false}\n            minimal\n          ></ha-date-range-picker>\n        </div>\n\n        ${!this.narrow ? html`<mwc-button dense outlined @click=${this._pickToday}>\n              ${this.hass.localize(\"ui.panel.lovelace.components.energy_period_selector.today\")}\n            </mwc-button>` : nothing}\n\n        <ha-button-menu>\n          <ha-icon-button\n            slot=\"trigger\"\n            .label=${this.hass.localize(\"ui.common.menu\")}\n            .path=${mdiDotsVertical}\n          ></ha-icon-button>\n          <ha-check-list-item\n            left\n            @request-selected=${this._toggleCompare}\n            .selected=${this._compare}\n          >\n            ${this.hass.localize(\"ui.panel.lovelace.components.energy_period_selector.compare\")}\n          </ha-check-list-item>\n          <slot name=\"overflow-menu\"></slot>\n        </ha-button-menu>\n      </div>\n    `;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_simpleRange\",\n      value() {\n        return memoizeOne((startDate, endDate, locale, config) => {\n          if (differenceInDays(endDate, startDate) === 0) {\n            return \"day\";\n          }\n          if (calcDateProperty(startDate, isFirstDayOfMonth, locale, config) && calcDateProperty(endDate, isLastDayOfMonth, locale, config)) {\n            if (calcDateProperty(endDate, differenceInMonths, locale, config, startDate) === 0) {\n              return \"month\";\n            }\n            if (calcDateProperty(endDate, differenceInMonths, locale, config, startDate) === 2 && startDate.getMonth() % 3 === 0) {\n              return \"quarter\";\n            }\n          }\n          if (calcDateProperty(startDate, isFirstDayOfMonth, locale, config) && calcDateProperty(endDate, isLastDayOfMonth, locale, config) && calcDateProperty(endDate, differenceInMonths, locale, config, startDate) === 11) {\n            return \"year\";\n          }\n          return \"other\";\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_updateCollectionPeriod\",\n      value: function _updateCollectionPeriod() {\n        const energyCollection = getEnergyDataCollection(this.hass, {\n          key: this.collectionKey\n        });\n        energyCollection.setPeriod(this._startDate, this._endDate);\n        energyCollection.refresh();\n      }\n    }, {\n      kind: \"method\",\n      key: \"_dateRangeChanged\",\n      value: function _dateRangeChanged(ev) {\n        const weekStartsOn = firstWeekdayIndex(this.hass.locale);\n        this._startDate = calcDate(ev.detail.startDate, startOfDay, this.hass.locale, this.hass.config, {\n          weekStartsOn\n        });\n        this._endDate = calcDate(ev.detail.endDate, endOfDay, this.hass.locale, this.hass.config, {\n          weekStartsOn\n        });\n        this._updateCollectionPeriod();\n      }\n    }, {\n      kind: \"method\",\n      key: \"_pickToday\",\n      value: function _pickToday() {\n        if (!this._startDate) return;\n        const range = this._simpleRange(this._startDate, this._endDate, this.hass.locale, this.hass.config);\n        const today = new Date();\n        if (range === \"month\") {\n          this._startDate = calcDate(today, startOfMonth, this.hass.locale, this.hass.config);\n          this._endDate = calcDate(today, endOfMonth, this.hass.locale, this.hass.config);\n        } else if (range === \"quarter\") {\n          this._startDate = calcDate(today, startOfQuarter, this.hass.locale, this.hass.config);\n          this._endDate = calcDate(today, endOfQuarter, this.hass.locale, this.hass.config);\n        } else if (range === \"year\") {\n          this._startDate = calcDate(today, startOfYear, this.hass.locale, this.hass.config);\n          this._endDate = calcDate(today, endOfYear, this.hass.locale, this.hass.config);\n        } else {\n          const weekStartsOn = firstWeekdayIndex(this.hass.locale);\n          const weekStart = calcDate(this._endDate, startOfWeek, this.hass.locale, this.hass.config, {\n            weekStartsOn\n          });\n          const weekEnd = calcDate(this._endDate, endOfWeek, this.hass.locale, this.hass.config, {\n            weekStartsOn\n          });\n\n          // Check if a single week is selected\n          if (this._startDate.getTime() === weekStart.getTime() && this._endDate.getTime() === weekEnd.getTime()) {\n            // Pick current week\n            this._startDate = calcDate(today, startOfWeek, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            });\n            this._endDate = calcDate(today, endOfWeek, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            });\n          } else {\n            // Custom date range\n            const difference = calcDateProperty(this._endDate, differenceInDays, this.hass.locale, this.hass.config, this._startDate);\n            this._startDate = calcDate(calcDate(today, subDays, this.hass.locale, this.hass.config, difference), startOfDay, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            });\n            this._endDate = calcDate(today, endOfDay, this.hass.locale, this.hass.config, {\n              weekStartsOn\n            });\n          }\n        }\n        this._updateCollectionPeriod();\n      }\n    }, {\n      kind: \"method\",\n      key: \"_pickPrevious\",\n      value: function _pickPrevious() {\n        this._shift(false);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_pickNext\",\n      value: function _pickNext() {\n        this._shift(true);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_shift\",\n      value: function _shift(forward) {\n        if (!this._startDate) return;\n        let start;\n        let end;\n        if (calcDateProperty(this._startDate, isFirstDayOfMonth, this.hass.locale, this.hass.config) && calcDateProperty(this._endDate, isLastDayOfMonth, this.hass.locale, this.hass.config)) {\n          // Shift date range with respect to month/year selection\n          const difference = (calcDateProperty(this._endDate, differenceInMonths, this.hass.locale, this.hass.config, this._startDate) + 1) * (forward ? 1 : -1);\n          start = calcDate(this._startDate, addMonths, this.hass.locale, this.hass.config, difference);\n          end = calcDate(calcDate(this._endDate, addMonths, this.hass.locale, this.hass.config, difference), endOfMonth, this.hass.locale, this.hass.config);\n        } else {\n          // Shift date range by period length\n          const difference = (calcDateProperty(this._endDate, differenceInDays, this.hass.locale, this.hass.config, this._startDate) + 1) * (forward ? 1 : -1);\n          start = calcDate(this._startDate, addDays, this.hass.locale, this.hass.config, difference);\n          end = calcDate(this._endDate, addDays, this.hass.locale, this.hass.config, difference);\n        }\n        this._startDate = start;\n        this._endDate = end;\n        this._updateCollectionPeriod();\n      }\n    }, {\n      kind: \"method\",\n      key: \"_updateDates\",\n      value: function _updateDates(energyData) {\n        this._compare = energyData.startCompare !== undefined;\n        this._startDate = energyData.start;\n        this._endDate = energyData.end || endOfToday();\n      }\n    }, {\n      kind: \"method\",\n      key: \"_toggleCompare\",\n      value: function _toggleCompare(ev) {\n        if (ev.detail.source !== \"interaction\") {\n          return;\n        }\n        this._compare = ev.detail.selected;\n        const energyCollection = getEnergyDataCollection(this.hass, {\n          key: this.collectionKey\n        });\n        energyCollection.setCompare(this._compare);\n        energyCollection.refresh();\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return css`\n      .row {\n        display: flex;\n        align-items: center;\n      }\n      :host .time-handle {\n        display: flex;\n        justify-content: flex-end;\n        align-items: center;\n      }\n      :host([narrow]) .time-handle {\n        margin-left: auto;\n        margin-inline-start: auto;\n        margin-inline-end: initial;\n      }\n      .label {\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        font-size: 20px;\n        margin-left: auto;\n        margin-inline-start: auto;\n        margin-inline-end: initial;\n      }\n      :host([narrow]) .label {\n        margin-left: unset;\n        margin-inline-start: unset;\n        margin-inline-end: initial;\n      }\n      mwc-button {\n        margin-left: 8px;\n        margin-inline-start: 8px;\n        margin-inline-end: initial;\n        flex-shrink: 0;\n        --mdc-button-outline-color: currentColor;\n        --primary-color: currentColor;\n        --mdc-theme-primary: currentColor;\n        --mdc-theme-on-primary: currentColor;\n        --mdc-button-disabled-outline-color: var(--disabled-text-color);\n        --mdc-button-disabled-ink-color: var(--disabled-text-color);\n      }\n    `;\n      }\n    }]\n  };\n}, SubscribeMixin(LitElement));","map":{"version":3,"names":["mdiDotsVertical","addDays","addMonths","differenceInDays","differenceInMonths","endOfDay","endOfMonth","endOfQuarter","endOfToday","endOfWeek","endOfYear","isFirstDayOfMonth","isLastDayOfMonth","startOfDay","startOfMonth","startOfQuarter","startOfWeek","startOfYear","subDays","LitElement","css","html","nothing","customElement","property","state","memoizeOne","calcDate","calcDateProperty","firstWeekdayIndex","formatDate","formatDateMonthYear","formatDateShort","formatDateVeryShort","formatDateYear","debounce","getEnergyDataCollection","SubscribeMixin","loadPolyfillIfNeeded","HuiEnergyPeriodSelector","_decorate","_initialize","_SubscribeMixin","constructor","args","F","d","kind","decorators","attribute","key","value","type","Boolean","reflect","hassSubscribe","hass","collectionKey","subscribe","data","_updateDates","_measure","narrow","offsetWidth","_attachObserver","_resizeObserver","ResizeObserver","observe","firstUpdated","connectedCallback","_get","_getPrototypeOf","prototype","call","updateComplete","then","disconnectedCallback","disconnect","willUpdate","changedProps","_this$hass","_changedProps$get","hasUpdated","has","localize","get","today","Date","weekStartsOn","locale","_ranges","config","render","_startDate","simpleRange","_simpleRange","_endDate","_pickPrevious","_pickNext","_dateRangeChanged","_pickToday","_toggleCompare","_compare","startDate","endDate","getMonth","_updateCollectionPeriod","energyCollection","setPeriod","refresh","ev","detail","range","weekStart","weekEnd","getTime","difference","_shift","forward","start","end","energyData","startCompare","undefined","source","selected","setCompare","static","styles"],"sources":["/workspaces/frontend/src/panels/lovelace/components/hui-energy-period-selector.ts"],"sourcesContent":["import \"@material/mwc-button/mwc-button\";\nimport type { RequestSelectedDetail } from \"@material/mwc-list/mwc-list-item\";\nimport { mdiDotsVertical } from \"@mdi/js\";\nimport {\n  addDays,\n  addMonths,\n  differenceInDays,\n  differenceInMonths,\n  endOfDay,\n  endOfMonth,\n  endOfQuarter,\n  endOfToday,\n  endOfWeek,\n  endOfYear,\n  isFirstDayOfMonth,\n  isLastDayOfMonth,\n  startOfDay,\n  startOfMonth,\n  startOfQuarter,\n  startOfWeek,\n  startOfYear,\n  subDays,\n} from \"date-fns/esm\";\nimport { UnsubscribeFunc } from \"home-assistant-js-websocket\";\nimport {\n  CSSResultGroup,\n  LitElement,\n  PropertyValues,\n  css,\n  html,\n  nothing,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { calcDate, calcDateProperty } from \"../../../common/datetime/calc_date\";\nimport { firstWeekdayIndex } from \"../../../common/datetime/first_weekday\";\nimport {\n  formatDate,\n  formatDateMonthYear,\n  formatDateShort,\n  formatDateVeryShort,\n  formatDateYear,\n} from \"../../../common/datetime/format_date\";\nimport { debounce } from \"../../../common/util/debounce\";\nimport \"../../../components/ha-button-menu\";\nimport \"../../../components/ha-check-list-item\";\nimport \"../../../components/ha-date-range-picker\";\nimport type { DateRangePickerRanges } from \"../../../components/ha-date-range-picker\";\nimport \"../../../components/ha-icon-button-next\";\nimport \"../../../components/ha-icon-button-prev\";\nimport { EnergyData, getEnergyDataCollection } from \"../../../data/energy\";\nimport { SubscribeMixin } from \"../../../mixins/subscribe-mixin\";\nimport { loadPolyfillIfNeeded } from \"../../../resources/resize-observer.polyfill\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-energy-period-selector\")\nexport class HuiEnergyPeriodSelector extends SubscribeMixin(LitElement) {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public collectionKey?: string;\n\n  @property({ type: Boolean, reflect: true }) public narrow?;\n\n  @state() _startDate?: Date;\n\n  @state() _endDate?: Date;\n\n  @state() private _ranges: DateRangePickerRanges = {};\n\n  @state() private _compare = false;\n\n  private _resizeObserver?: ResizeObserver;\n\n  public hassSubscribe(): UnsubscribeFunc[] {\n    return [\n      getEnergyDataCollection(this.hass, {\n        key: this.collectionKey,\n      }).subscribe((data) => this._updateDates(data)),\n    ];\n  }\n\n  private _measure() {\n    this.narrow = this.offsetWidth < 450;\n  }\n\n  private async _attachObserver(): Promise<void> {\n    if (!this._resizeObserver) {\n      await loadPolyfillIfNeeded();\n      this._resizeObserver = new ResizeObserver(\n        debounce(() => this._measure(), 250, false)\n      );\n    }\n    this._resizeObserver.observe(this);\n  }\n\n  protected firstUpdated(): void {\n    this._attachObserver();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this.updateComplete.then(() => this._attachObserver());\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    if (this._resizeObserver) {\n      this._resizeObserver.disconnect();\n    }\n  }\n\n  public willUpdate(changedProps: PropertyValues) {\n    super.willUpdate(changedProps);\n    if (!this.hasUpdated) {\n      this._measure();\n    }\n\n    if (\n      !this.hasUpdated ||\n      (changedProps.has(\"hass\") &&\n        this.hass?.localize !== changedProps.get(\"hass\")?.localize)\n    ) {\n      const today = new Date();\n      const weekStartsOn = firstWeekdayIndex(this.hass.locale);\n\n      // pre defined date ranges\n      this._ranges = {\n        [this.hass.localize(\"ui.components.date-range-picker.ranges.today\")]: [\n          calcDate(today, startOfDay, this.hass.locale, this.hass.config, {\n            weekStartsOn,\n          }),\n          calcDate(today, endOfDay, this.hass.locale, this.hass.config, {\n            weekStartsOn,\n          }),\n        ],\n        [this.hass.localize(\n          \"ui.components.date-range-picker.ranges.yesterday\"\n        )]: [\n          calcDate(\n            calcDate(today, subDays, this.hass.locale, this.hass.config, 1),\n            startOfDay,\n            this.hass.locale,\n            this.hass.config,\n            {\n              weekStartsOn,\n            }\n          ),\n          calcDate(\n            calcDate(today, subDays, this.hass.locale, this.hass.config, 1),\n            endOfDay,\n            this.hass.locale,\n            this.hass.config,\n            {\n              weekStartsOn,\n            }\n          ),\n        ],\n        [this.hass.localize(\n          \"ui.components.date-range-picker.ranges.this_week\"\n        )]: [\n          calcDate(today, startOfWeek, this.hass.locale, this.hass.config, {\n            weekStartsOn,\n          }),\n          calcDate(today, endOfWeek, this.hass.locale, this.hass.config, {\n            weekStartsOn,\n          }),\n        ],\n        [this.hass.localize(\n          \"ui.components.date-range-picker.ranges.this_month\"\n        )]: [\n          calcDate(today, startOfMonth, this.hass.locale, this.hass.config),\n          calcDate(today, endOfMonth, this.hass.locale, this.hass.config),\n        ],\n        [this.hass.localize(\n          \"ui.components.date-range-picker.ranges.this_quarter\"\n        )]: [\n          calcDate(today, startOfQuarter, this.hass.locale, this.hass.config),\n          calcDate(today, endOfQuarter, this.hass.locale, this.hass.config),\n        ],\n        [this.hass.localize(\n          \"ui.components.date-range-picker.ranges.this_year\"\n        )]: [\n          calcDate(today, startOfYear, this.hass.locale, this.hass.config),\n          calcDate(today, endOfYear, this.hass.locale, this.hass.config),\n        ],\n      };\n    }\n  }\n\n  protected render() {\n    if (!this.hass || !this._startDate) {\n      return nothing;\n    }\n\n    const simpleRange = this._simpleRange(\n      this._startDate,\n      this._endDate,\n      this.hass.locale,\n      this.hass.config\n    );\n\n    return html`\n      <div class=\"row\">\n        <div class=\"label\">\n          ${simpleRange === \"day\"\n            ? this.narrow\n              ? formatDateShort(\n                  this._startDate,\n                  this.hass.locale,\n                  this.hass.config\n                )\n              : formatDate(this._startDate, this.hass.locale, this.hass.config)\n            : simpleRange === \"month\"\n              ? formatDateMonthYear(\n                  this._startDate,\n                  this.hass.locale,\n                  this.hass.config\n                )\n              : simpleRange === \"year\"\n                ? formatDateYear(\n                    this._startDate,\n                    this.hass.locale,\n                    this.hass.config\n                  )\n                : `${formatDateVeryShort(\n                    this._startDate,\n                    this.hass.locale,\n                    this.hass.config\n                  )} – ${formatDateVeryShort(\n                    this._endDate || new Date(),\n                    this.hass.locale,\n                    this.hass.config\n                  )}`}\n        </div>\n        <div class=\"time-handle\">\n          <ha-icon-button-prev\n            .label=${this.hass.localize(\n              \"ui.panel.lovelace.components.energy_period_selector.previous\"\n            )}\n            @click=${this._pickPrevious}\n          ></ha-icon-button-prev>\n          <ha-icon-button-next\n            .label=${this.hass.localize(\n              \"ui.panel.lovelace.components.energy_period_selector.next\"\n            )}\n            @click=${this._pickNext}\n          ></ha-icon-button-next>\n          <ha-date-range-picker\n            .hass=${this.hass}\n            .startDate=${this._startDate}\n            .endDate=${this._endDate || new Date()}\n            .ranges=${this._ranges}\n            @change=${this._dateRangeChanged}\n            .timePicker=${false}\n            minimal\n          ></ha-date-range-picker>\n        </div>\n\n        ${!this.narrow\n          ? html`<mwc-button dense outlined @click=${this._pickToday}>\n              ${this.hass.localize(\n                \"ui.panel.lovelace.components.energy_period_selector.today\"\n              )}\n            </mwc-button>`\n          : nothing}\n\n        <ha-button-menu>\n          <ha-icon-button\n            slot=\"trigger\"\n            .label=${this.hass.localize(\"ui.common.menu\")}\n            .path=${mdiDotsVertical}\n          ></ha-icon-button>\n          <ha-check-list-item\n            left\n            @request-selected=${this._toggleCompare}\n            .selected=${this._compare}\n          >\n            ${this.hass.localize(\n              \"ui.panel.lovelace.components.energy_period_selector.compare\"\n            )}\n          </ha-check-list-item>\n          <slot name=\"overflow-menu\"></slot>\n        </ha-button-menu>\n      </div>\n    `;\n  }\n\n  private _simpleRange = memoizeOne(\n    (startDate, endDate, locale, config): string => {\n      if (differenceInDays(endDate!, startDate!) === 0) {\n        return \"day\";\n      }\n      if (\n        (calcDateProperty(\n          startDate,\n          isFirstDayOfMonth,\n          locale,\n          config\n        ) as boolean) &&\n        (calcDateProperty(endDate, isLastDayOfMonth, locale, config) as boolean)\n      ) {\n        if (\n          (calcDateProperty(\n            endDate,\n            differenceInMonths,\n            locale,\n            config,\n            startDate\n          ) as number) === 0\n        ) {\n          return \"month\";\n        }\n        if (\n          (calcDateProperty(\n            endDate,\n            differenceInMonths,\n            locale,\n            config,\n            startDate\n          ) as number) === 2 &&\n          startDate.getMonth() % 3 === 0\n        ) {\n          return \"quarter\";\n        }\n      }\n      if (\n        calcDateProperty(startDate, isFirstDayOfMonth, locale, config) &&\n        calcDateProperty(endDate, isLastDayOfMonth, locale, config) &&\n        calcDateProperty(\n          endDate,\n          differenceInMonths,\n          locale,\n          config,\n          startDate\n        ) === 11\n      ) {\n        return \"year\";\n      }\n      return \"other\";\n    }\n  );\n\n  private _updateCollectionPeriod() {\n    const energyCollection = getEnergyDataCollection(this.hass, {\n      key: this.collectionKey,\n    });\n    energyCollection.setPeriod(this._startDate!, this._endDate!);\n    energyCollection.refresh();\n  }\n\n  private _dateRangeChanged(ev) {\n    const weekStartsOn = firstWeekdayIndex(this.hass.locale);\n    this._startDate = calcDate(\n      ev.detail.startDate,\n      startOfDay,\n      this.hass.locale,\n      this.hass.config,\n      {\n        weekStartsOn,\n      }\n    );\n    this._endDate = calcDate(\n      ev.detail.endDate,\n      endOfDay,\n      this.hass.locale,\n      this.hass.config,\n      {\n        weekStartsOn,\n      }\n    );\n\n    this._updateCollectionPeriod();\n  }\n\n  private _pickToday() {\n    if (!this._startDate) return;\n\n    const range = this._simpleRange(\n      this._startDate,\n      this._endDate,\n      this.hass.locale,\n      this.hass.config\n    );\n    const today = new Date();\n    if (range === \"month\") {\n      this._startDate = calcDate(\n        today,\n        startOfMonth,\n        this.hass.locale,\n        this.hass.config\n      );\n      this._endDate = calcDate(\n        today,\n        endOfMonth,\n        this.hass.locale,\n        this.hass.config\n      );\n    } else if (range === \"quarter\") {\n      this._startDate = calcDate(\n        today,\n        startOfQuarter,\n        this.hass.locale,\n        this.hass.config\n      );\n      this._endDate = calcDate(\n        today,\n        endOfQuarter,\n        this.hass.locale,\n        this.hass.config\n      );\n    } else if (range === \"year\") {\n      this._startDate = calcDate(\n        today,\n        startOfYear,\n        this.hass.locale,\n        this.hass.config\n      );\n      this._endDate = calcDate(\n        today,\n        endOfYear,\n        this.hass.locale,\n        this.hass.config\n      );\n    } else {\n      const weekStartsOn = firstWeekdayIndex(this.hass.locale);\n      const weekStart = calcDate(\n        this._endDate!,\n        startOfWeek,\n        this.hass.locale,\n        this.hass.config,\n        {\n          weekStartsOn,\n        }\n      );\n      const weekEnd = calcDate(\n        this._endDate!,\n        endOfWeek,\n        this.hass.locale,\n        this.hass.config,\n        {\n          weekStartsOn,\n        }\n      );\n\n      // Check if a single week is selected\n      if (\n        this._startDate.getTime() === weekStart.getTime() &&\n        this._endDate!.getTime() === weekEnd.getTime()\n      ) {\n        // Pick current week\n        this._startDate = calcDate(\n          today,\n          startOfWeek,\n          this.hass.locale,\n          this.hass.config,\n          {\n            weekStartsOn,\n          }\n        );\n        this._endDate = calcDate(\n          today,\n          endOfWeek,\n          this.hass.locale,\n          this.hass.config,\n          {\n            weekStartsOn,\n          }\n        );\n      } else {\n        // Custom date range\n        const difference = calcDateProperty(\n          this._endDate!,\n          differenceInDays,\n          this.hass.locale,\n          this.hass.config,\n          this._startDate\n        ) as number;\n        this._startDate = calcDate(\n          calcDate(\n            today,\n            subDays,\n            this.hass.locale,\n            this.hass.config,\n            difference\n          ),\n          startOfDay,\n          this.hass.locale,\n          this.hass.config,\n          {\n            weekStartsOn,\n          }\n        );\n        this._endDate = calcDate(\n          today,\n          endOfDay,\n          this.hass.locale,\n          this.hass.config,\n          {\n            weekStartsOn,\n          }\n        );\n      }\n    }\n\n    this._updateCollectionPeriod();\n  }\n\n  private _pickPrevious() {\n    this._shift(false);\n  }\n\n  private _pickNext() {\n    this._shift(true);\n  }\n\n  private _shift(forward: boolean) {\n    if (!this._startDate) return;\n\n    let start: Date;\n    let end: Date;\n    if (\n      (calcDateProperty(\n        this._startDate,\n        isFirstDayOfMonth,\n        this.hass.locale,\n        this.hass.config\n      ) as boolean) &&\n      (calcDateProperty(\n        this._endDate!,\n        isLastDayOfMonth,\n        this.hass.locale,\n        this.hass.config\n      ) as boolean)\n    ) {\n      // Shift date range with respect to month/year selection\n      const difference =\n        ((calcDateProperty(\n          this._endDate!,\n          differenceInMonths,\n          this.hass.locale,\n          this.hass.config,\n          this._startDate\n        ) as number) +\n          1) *\n        (forward ? 1 : -1);\n      start = calcDate(\n        this._startDate,\n        addMonths,\n        this.hass.locale,\n        this.hass.config,\n        difference\n      );\n      end = calcDate(\n        calcDate(\n          this._endDate!,\n          addMonths,\n          this.hass.locale,\n          this.hass.config,\n          difference\n        ),\n        endOfMonth,\n        this.hass.locale,\n        this.hass.config\n      );\n    } else {\n      // Shift date range by period length\n      const difference =\n        ((calcDateProperty(\n          this._endDate!,\n          differenceInDays,\n          this.hass.locale,\n          this.hass.config,\n          this._startDate\n        ) as number) +\n          1) *\n        (forward ? 1 : -1);\n      start = calcDate(\n        this._startDate,\n        addDays,\n        this.hass.locale,\n        this.hass.config,\n        difference\n      );\n      end = calcDate(\n        this._endDate!,\n        addDays,\n        this.hass.locale,\n        this.hass.config,\n        difference\n      );\n    }\n\n    this._startDate = start;\n    this._endDate = end;\n\n    this._updateCollectionPeriod();\n  }\n\n  private _updateDates(energyData: EnergyData): void {\n    this._compare = energyData.startCompare !== undefined;\n    this._startDate = energyData.start;\n    this._endDate = energyData.end || endOfToday();\n  }\n\n  private _toggleCompare(ev: CustomEvent<RequestSelectedDetail>) {\n    if (ev.detail.source !== \"interaction\") {\n      return;\n    }\n    this._compare = ev.detail.selected;\n    const energyCollection = getEnergyDataCollection(this.hass, {\n      key: this.collectionKey,\n    });\n    energyCollection.setCompare(this._compare);\n    energyCollection.refresh();\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      .row {\n        display: flex;\n        align-items: center;\n      }\n      :host .time-handle {\n        display: flex;\n        justify-content: flex-end;\n        align-items: center;\n      }\n      :host([narrow]) .time-handle {\n        margin-left: auto;\n        margin-inline-start: auto;\n        margin-inline-end: initial;\n      }\n      .label {\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        font-size: 20px;\n        margin-left: auto;\n        margin-inline-start: auto;\n        margin-inline-end: initial;\n      }\n      :host([narrow]) .label {\n        margin-left: unset;\n        margin-inline-start: unset;\n        margin-inline-end: initial;\n      }\n      mwc-button {\n        margin-left: 8px;\n        margin-inline-start: 8px;\n        margin-inline-end: initial;\n        flex-shrink: 0;\n        --mdc-button-outline-color: currentColor;\n        --primary-color: currentColor;\n        --mdc-theme-primary: currentColor;\n        --mdc-theme-on-primary: currentColor;\n        --mdc-button-disabled-outline-color: var(--disabled-text-color);\n        --mdc-button-disabled-ink-color: var(--disabled-text-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-energy-period-selector\": HuiEnergyPeriodSelector;\n  }\n}\n"],"mappings":";;;AAAA,OAAO,iCAAiC;AAAC,MAAAA,eAAA;AAGzC,SACEC,OAAO,EACPC,SAAS,EACTC,gBAAgB,EAChBC,kBAAkB,EAClBC,QAAQ,EACRC,UAAU,EACVC,YAAY,EACZC,UAAU,EACVC,SAAS,EACTC,SAAS,EACTC,iBAAiB,EACjBC,gBAAgB,EAChBC,UAAU,EACVC,YAAY,EACZC,cAAc,EACdC,WAAW,EACXC,WAAW,EACXC,OAAO,QACF,cAAc;AAErB,SAEEC,UAAU,EAEVC,GAAG,EACHC,IAAI,EACJC,OAAO,QACF,KAAK;AACZ,SAASC,aAAa,EAAEC,QAAQ,EAAEC,KAAK,QAAQ,gBAAgB;AAC/D,OAAOC,UAAU,MAAM,aAAa;AACpC,SAASC,QAAQ,EAAEC,gBAAgB,QAAQ,oCAAoC;AAC/E,SAASC,iBAAiB,QAAQ,wCAAwC;AAC1E,SACEC,UAAU,EACVC,mBAAmB,EACnBC,eAAe,EACfC,mBAAmB,EACnBC,cAAc,QACT,sCAAsC;AAC7C,SAASC,QAAQ,QAAQ,+BAA+B;AACxD,OAAO,oCAAoC;AAC3C,OAAO,wCAAwC;AAC/C,OAAO,0CAA0C;AAEjD,OAAO,yCAAyC;AAChD,OAAO,yCAAyC;AAChD,SAAqBC,uBAAuB,QAAQ,sBAAsB;AAC1E,SAASC,cAAc,QAAQ,iCAAiC;AAChE,SAASC,oBAAoB,QAAQ,6CAA6C;AAGlF,WACaC,uBAAuB,GAAAC,SAAA,EADnCjB,aAAa,CAAC,4BAA4B,CAAC,aAAAkB,WAAA,EAAAC,eAAA;EAA5C,MACaH,uBAAuB,SAAAG,eAAA,CAAoC;IAAAC,YAAA,GAAAC,IAAA;MAAA,SAAAA,IAAA;MAAAH,WAAA;IAAA;EA4lBxE;EAAC;IAAAI,CAAA,EA5lBYN,uBAAuB;IAAAO,CAAA;MAAAC,IAAA;MAAAC,UAAA,GACjCxB,QAAQ,CAAC;QAAEyB,SAAS,EAAE;MAAM,CAAC,CAAC;MAAAC,GAAA;MAAAC,KAAA;IAAA;MAAAJ,IAAA;MAAAC,UAAA,GAE9BxB,QAAQ,CAAC,CAAC;MAAA0B,GAAA;MAAAC,KAAA;IAAA;MAAAJ,IAAA;MAAAC,UAAA,GAEVxB,QAAQ,CAAC;QAAE4B,IAAI,EAAEC,OAAO;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;MAAAJ,GAAA;MAAAC,KAAA;IAAA;MAAAJ,IAAA;MAAAC,UAAA,GAE1CvB,KAAK,CAAC,CAAC;MAAAyB,GAAA;MAAAC,KAAA;IAAA;MAAAJ,IAAA;MAAAC,UAAA,GAEPvB,KAAK,CAAC,CAAC;MAAAyB,GAAA;MAAAC,KAAA;IAAA;MAAAJ,IAAA;MAAAC,UAAA,GAEPvB,KAAK,CAAC,CAAC;MAAAyB,GAAA;MAAAC,MAAA;QAAA,OAA0C,CAAC,CAAC;MAAA;IAAA;MAAAJ,IAAA;MAAAC,UAAA,GAEnDvB,KAAK,CAAC,CAAC;MAAAyB,GAAA;MAAAC,MAAA;QAAA,OAAoB,KAAK;MAAA;IAAA;MAAAJ,IAAA;MAAAG,GAAA;MAAAC,KAAA;IAAA;MAAAJ,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAIjC,SAAAI,cAAA,EAA0C;QACxC,OAAO,CACLnB,uBAAuB,CAAC,IAAI,CAACoB,IAAI,EAAE;UACjCN,GAAG,EAAE,IAAI,CAACO;QACZ,CAAC,CAAC,CAACC,SAAS,CAAEC,IAAI,IAAK,IAAI,CAACC,YAAY,CAACD,IAAI,CAAC,CAAC,CAChD;MACH;IAAC;MAAAZ,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAU,SAAA,EAAmB;QACjB,IAAI,CAACC,MAAM,GAAG,IAAI,CAACC,WAAW,GAAG,GAAG;MACtC;IAAC;MAAAhB,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,eAAAa,gBAAA,EAA+C;QAC7C,IAAI,CAAC,IAAI,CAACC,eAAe,EAAE;UACzB,MAAM3B,oBAAoB,CAAC,CAAC;UAC5B,IAAI,CAAC2B,eAAe,GAAG,IAAIC,cAAc,CACvC/B,QAAQ,CAAC,MAAM,IAAI,CAAC0B,QAAQ,CAAC,CAAC,EAAE,GAAG,EAAE,KAAK,CAC5C,CAAC;QACH;QACA,IAAI,CAACI,eAAe,CAACE,OAAO,CAAC,IAAI,CAAC;MACpC;IAAC;MAAApB,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAiB,aAAA,EAA+B;QAC7B,IAAI,CAACJ,eAAe,CAAC,CAAC;MACxB;IAAC;MAAAjB,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAkB,kBAAA,EAAiC;QAC/BC,IAAA,CAAAC,eAAA,CA5CShC,uBAAuB,CAAAiC,SAAA,8BAAAC,IAAA;QA6ChC,IAAI,CAACC,cAAc,CAACC,IAAI,CAAC,MAAM,IAAI,CAACX,eAAe,CAAC,CAAC,CAAC;MACxD;IAAC;MAAAjB,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAyB,qBAAA,EAAoC;QAClCN,IAAA,CAAAC,eAAA,CAjDShC,uBAAuB,CAAAiC,SAAA,iCAAAC,IAAA;QAkDhC,IAAI,IAAI,CAACR,eAAe,EAAE;UACxB,IAAI,CAACA,eAAe,CAACY,UAAU,CAAC,CAAC;QACnC;MACF;IAAC;MAAA9B,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAA2B,WAAkBC,YAA4B,EAAE;QAAA,IAAAC,UAAA,EAAAC,iBAAA;QAC9CX,IAAA,CAAAC,eAAA,CAxDShC,uBAAuB,CAAAiC,SAAA,uBAAAC,IAAA,OAwDfM,YAAY;QAC7B,IAAI,CAAC,IAAI,CAACG,UAAU,EAAE;UACpB,IAAI,CAACrB,QAAQ,CAAC,CAAC;QACjB;QAEA,IACE,CAAC,IAAI,CAACqB,UAAU,IACfH,YAAY,CAACI,GAAG,CAAC,MAAM,CAAC,IACvB,EAAAH,UAAA,OAAI,CAACxB,IAAI,cAAAwB,UAAA,uBAATA,UAAA,CAAWI,QAAQ,QAAAH,iBAAA,GAAKF,YAAY,CAACM,GAAG,CAAC,MAAM,CAAC,cAAAJ,iBAAA,uBAAxBA,iBAAA,CAA0BG,QAAQ,CAAC,EAC7D;UACA,MAAME,KAAK,GAAG,IAAIC,IAAI,CAAC,CAAC;UACxB,MAAMC,YAAY,GAAG3D,iBAAiB,CAAC,IAAI,CAAC2B,IAAI,CAACiC,MAAM,CAAC;;UAExD;UACA,IAAI,CAACC,OAAO,GAAG;YACb,CAAC,IAAI,CAAClC,IAAI,CAAC4B,QAAQ,CAAC,8CAA8C,CAAC,GAAG,CACpEzD,QAAQ,CAAC2D,KAAK,EAAEzE,UAAU,EAAE,IAAI,CAAC2C,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAAE;cAC9DH;YACF,CAAC,CAAC,EACF7D,QAAQ,CAAC2D,KAAK,EAAEjF,QAAQ,EAAE,IAAI,CAACmD,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAAE;cAC5DH;YACF,CAAC,CAAC,CACH;YACD,CAAC,IAAI,CAAChC,IAAI,CAAC4B,QAAQ,CACjB,kDACF,CAAC,GAAG,CACFzD,QAAQ,CACNA,QAAQ,CAAC2D,KAAK,EAAEpE,OAAO,EAAE,IAAI,CAACsC,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAAE,CAAC,CAAC,EAC/D9E,UAAU,EACV,IAAI,CAAC2C,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;cACEH;YACF,CACF,CAAC,EACD7D,QAAQ,CACNA,QAAQ,CAAC2D,KAAK,EAAEpE,OAAO,EAAE,IAAI,CAACsC,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAAE,CAAC,CAAC,EAC/DtF,QAAQ,EACR,IAAI,CAACmD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;cACEH;YACF,CACF,CAAC,CACF;YACD,CAAC,IAAI,CAAChC,IAAI,CAAC4B,QAAQ,CACjB,kDACF,CAAC,GAAG,CACFzD,QAAQ,CAAC2D,KAAK,EAAEtE,WAAW,EAAE,IAAI,CAACwC,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAAE;cAC/DH;YACF,CAAC,CAAC,EACF7D,QAAQ,CAAC2D,KAAK,EAAE7E,SAAS,EAAE,IAAI,CAAC+C,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAAE;cAC7DH;YACF,CAAC,CAAC,CACH;YACD,CAAC,IAAI,CAAChC,IAAI,CAAC4B,QAAQ,CACjB,mDACF,CAAC,GAAG,CACFzD,QAAQ,CAAC2D,KAAK,EAAExE,YAAY,EAAE,IAAI,CAAC0C,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,CAAC,EACjEhE,QAAQ,CAAC2D,KAAK,EAAEhF,UAAU,EAAE,IAAI,CAACkD,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,CAAC,CAChE;YACD,CAAC,IAAI,CAACnC,IAAI,CAAC4B,QAAQ,CACjB,qDACF,CAAC,GAAG,CACFzD,QAAQ,CAAC2D,KAAK,EAAEvE,cAAc,EAAE,IAAI,CAACyC,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,CAAC,EACnEhE,QAAQ,CAAC2D,KAAK,EAAE/E,YAAY,EAAE,IAAI,CAACiD,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,CAAC,CAClE;YACD,CAAC,IAAI,CAACnC,IAAI,CAAC4B,QAAQ,CACjB,kDACF,CAAC,GAAG,CACFzD,QAAQ,CAAC2D,KAAK,EAAErE,WAAW,EAAE,IAAI,CAACuC,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,CAAC,EAChEhE,QAAQ,CAAC2D,KAAK,EAAE5E,SAAS,EAAE,IAAI,CAAC8C,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,CAAC;UAElE,CAAC;QACH;MACF;IAAC;MAAA5C,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAyC,OAAA,EAAmB;QACjB,IAAI,CAAC,IAAI,CAACpC,IAAI,IAAI,CAAC,IAAI,CAACqC,UAAU,EAAE;UAClC,OAAOvE,OAAO;QAChB;QAEA,MAAMwE,WAAW,GAAG,IAAI,CAACC,YAAY,CACnC,IAAI,CAACF,UAAU,EACf,IAAI,CAACG,QAAQ,EACb,IAAI,CAACxC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC;QAED,OAAOtE,IAAK;AAChB;AACA;AACA,YAAYyE,WAAW,KAAK,KAAK,GACnB,IAAI,CAAChC,MAAM,GACT9B,eAAe,CACb,IAAI,CAAC6D,UAAU,EACf,IAAI,CAACrC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC,GACD7D,UAAU,CAAC,IAAI,CAAC+D,UAAU,EAAE,IAAI,CAACrC,IAAI,CAACiC,MAAM,EAAE,IAAI,CAACjC,IAAI,CAACmC,MAAM,CAAC,GACjEG,WAAW,KAAK,OAAO,GACrB/D,mBAAmB,CACjB,IAAI,CAAC8D,UAAU,EACf,IAAI,CAACrC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC,GACDG,WAAW,KAAK,MAAM,GACpB5D,cAAc,CACZ,IAAI,CAAC2D,UAAU,EACf,IAAI,CAACrC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC,GACA,GAAE1D,mBAAmB,CACpB,IAAI,CAAC4D,UAAU,EACf,IAAI,CAACrC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAE,MAAK1D,mBAAmB,CACxB,IAAI,CAAC+D,QAAQ,IAAI,IAAIT,IAAI,CAAC,CAAC,EAC3B,IAAI,CAAC/B,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAE,EAAE;AACtB;AACA;AACA;AACA,qBAAqB,IAAI,CAACnC,IAAI,CAAC4B,QAAQ,CACzB,8DACF,CAAE;AACd,qBAAqB,IAAI,CAACa,aAAc;AACxC;AACA;AACA,qBAAqB,IAAI,CAACzC,IAAI,CAAC4B,QAAQ,CACzB,0DACF,CAAE;AACd,qBAAqB,IAAI,CAACc,SAAU;AACpC;AACA;AACA,oBAAoB,IAAI,CAAC1C,IAAK;AAC9B,yBAAyB,IAAI,CAACqC,UAAW;AACzC,uBAAuB,IAAI,CAACG,QAAQ,IAAI,IAAIT,IAAI,CAAC,CAAE;AACnD,sBAAsB,IAAI,CAACG,OAAQ;AACnC,sBAAsB,IAAI,CAACS,iBAAkB;AAC7C,0BAA0B,KAAM;AAChC;AACA;AACA;AACA;AACA,UAAU,CAAC,IAAI,CAACrC,MAAM,GACVzC,IAAK,qCAAoC,IAAI,CAAC+E,UAAW;AACrE,gBAAgB,IAAI,CAAC5C,IAAI,CAAC4B,QAAQ,CAClB,2DACF,CAAE;AAChB,0BAA0B,GACd9D,OAAQ;AACpB;AACA;AACA;AACA;AACA,qBAAqB,IAAI,CAACkC,IAAI,CAAC4B,QAAQ,CAAC,gBAAgB,CAAE;AAC1D,oBAAoBpF,eAAgB;AACpC;AACA;AACA;AACA,gCAAgC,IAAI,CAACqG,cAAe;AACpD,wBAAwB,IAAI,CAACC,QAAS;AACtC;AACA,cAAc,IAAI,CAAC9C,IAAI,CAAC4B,QAAQ,CAClB,6DACF,CAAE;AACd;AACA;AACA;AACA;AACA,KAAK;MACH;IAAC;MAAArC,IAAA;MAAAG,GAAA;MAAAC,MAAA;QAAA,OAEsBzB,UAAU,CAC/B,CAAC6E,SAAS,EAAEC,OAAO,EAAEf,MAAM,EAAEE,MAAM,KAAa;UAC9C,IAAIxF,gBAAgB,CAACqG,OAAO,EAAGD,SAAU,CAAC,KAAK,CAAC,EAAE;YAChD,OAAO,KAAK;UACd;UACA,IACG3E,gBAAgB,CACf2E,SAAS,EACT5F,iBAAiB,EACjB8E,MAAM,EACNE,MACF,CAAC,IACA/D,gBAAgB,CAAC4E,OAAO,EAAE5F,gBAAgB,EAAE6E,MAAM,EAAEE,MAAM,CAAa,EACxE;YACA,IACG/D,gBAAgB,CACf4E,OAAO,EACPpG,kBAAkB,EAClBqF,MAAM,EACNE,MAAM,EACNY,SACF,CAAC,KAAgB,CAAC,EAClB;cACA,OAAO,OAAO;YAChB;YACA,IACG3E,gBAAgB,CACf4E,OAAO,EACPpG,kBAAkB,EAClBqF,MAAM,EACNE,MAAM,EACNY,SACF,CAAC,KAAgB,CAAC,IAClBA,SAAS,CAACE,QAAQ,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,EAC9B;cACA,OAAO,SAAS;YAClB;UACF;UACA,IACE7E,gBAAgB,CAAC2E,SAAS,EAAE5F,iBAAiB,EAAE8E,MAAM,EAAEE,MAAM,CAAC,IAC9D/D,gBAAgB,CAAC4E,OAAO,EAAE5F,gBAAgB,EAAE6E,MAAM,EAAEE,MAAM,CAAC,IAC3D/D,gBAAgB,CACd4E,OAAO,EACPpG,kBAAkB,EAClBqF,MAAM,EACNE,MAAM,EACNY,SACF,CAAC,KAAK,EAAE,EACR;YACA,OAAO,MAAM;UACf;UACA,OAAO,OAAO;QAChB,CACF,CAAC;MAAA;IAAA;MAAAxD,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAuD,wBAAA,EAAkC;QAChC,MAAMC,gBAAgB,GAAGvE,uBAAuB,CAAC,IAAI,CAACoB,IAAI,EAAE;UAC1DN,GAAG,EAAE,IAAI,CAACO;QACZ,CAAC,CAAC;QACFkD,gBAAgB,CAACC,SAAS,CAAC,IAAI,CAACf,UAAU,EAAG,IAAI,CAACG,QAAS,CAAC;QAC5DW,gBAAgB,CAACE,OAAO,CAAC,CAAC;MAC5B;IAAC;MAAA9D,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAgD,kBAA0BW,EAAE,EAAE;QAC5B,MAAMtB,YAAY,GAAG3D,iBAAiB,CAAC,IAAI,CAAC2B,IAAI,CAACiC,MAAM,CAAC;QACxD,IAAI,CAACI,UAAU,GAAGlE,QAAQ,CACxBmF,EAAE,CAACC,MAAM,CAACR,SAAS,EACnB1F,UAAU,EACV,IAAI,CAAC2C,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;UACEH;QACF,CACF,CAAC;QACD,IAAI,CAACQ,QAAQ,GAAGrE,QAAQ,CACtBmF,EAAE,CAACC,MAAM,CAACP,OAAO,EACjBnG,QAAQ,EACR,IAAI,CAACmD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;UACEH;QACF,CACF,CAAC;QAED,IAAI,CAACkB,uBAAuB,CAAC,CAAC;MAChC;IAAC;MAAA3D,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAiD,WAAA,EAAqB;QACnB,IAAI,CAAC,IAAI,CAACP,UAAU,EAAE;QAEtB,MAAMmB,KAAK,GAAG,IAAI,CAACjB,YAAY,CAC7B,IAAI,CAACF,UAAU,EACf,IAAI,CAACG,QAAQ,EACb,IAAI,CAACxC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC;QACD,MAAML,KAAK,GAAG,IAAIC,IAAI,CAAC,CAAC;QACxB,IAAIyB,KAAK,KAAK,OAAO,EAAE;UACrB,IAAI,CAACnB,UAAU,GAAGlE,QAAQ,CACxB2D,KAAK,EACLxE,YAAY,EACZ,IAAI,CAAC0C,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC;UACD,IAAI,CAACK,QAAQ,GAAGrE,QAAQ,CACtB2D,KAAK,EACLhF,UAAU,EACV,IAAI,CAACkD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC;QACH,CAAC,MAAM,IAAIqB,KAAK,KAAK,SAAS,EAAE;UAC9B,IAAI,CAACnB,UAAU,GAAGlE,QAAQ,CACxB2D,KAAK,EACLvE,cAAc,EACd,IAAI,CAACyC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC;UACD,IAAI,CAACK,QAAQ,GAAGrE,QAAQ,CACtB2D,KAAK,EACL/E,YAAY,EACZ,IAAI,CAACiD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC;QACH,CAAC,MAAM,IAAIqB,KAAK,KAAK,MAAM,EAAE;UAC3B,IAAI,CAACnB,UAAU,GAAGlE,QAAQ,CACxB2D,KAAK,EACLrE,WAAW,EACX,IAAI,CAACuC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC;UACD,IAAI,CAACK,QAAQ,GAAGrE,QAAQ,CACtB2D,KAAK,EACL5E,SAAS,EACT,IAAI,CAAC8C,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC;QACH,CAAC,MAAM;UACL,MAAMH,YAAY,GAAG3D,iBAAiB,CAAC,IAAI,CAAC2B,IAAI,CAACiC,MAAM,CAAC;UACxD,MAAMwB,SAAS,GAAGtF,QAAQ,CACxB,IAAI,CAACqE,QAAQ,EACbhF,WAAW,EACX,IAAI,CAACwC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;YACEH;UACF,CACF,CAAC;UACD,MAAM0B,OAAO,GAAGvF,QAAQ,CACtB,IAAI,CAACqE,QAAQ,EACbvF,SAAS,EACT,IAAI,CAAC+C,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;YACEH;UACF,CACF,CAAC;;UAED;UACA,IACE,IAAI,CAACK,UAAU,CAACsB,OAAO,CAAC,CAAC,KAAKF,SAAS,CAACE,OAAO,CAAC,CAAC,IACjD,IAAI,CAACnB,QAAQ,CAAEmB,OAAO,CAAC,CAAC,KAAKD,OAAO,CAACC,OAAO,CAAC,CAAC,EAC9C;YACA;YACA,IAAI,CAACtB,UAAU,GAAGlE,QAAQ,CACxB2D,KAAK,EACLtE,WAAW,EACX,IAAI,CAACwC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;cACEH;YACF,CACF,CAAC;YACD,IAAI,CAACQ,QAAQ,GAAGrE,QAAQ,CACtB2D,KAAK,EACL7E,SAAS,EACT,IAAI,CAAC+C,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;cACEH;YACF,CACF,CAAC;UACH,CAAC,MAAM;YACL;YACA,MAAM4B,UAAU,GAAGxF,gBAAgB,CACjC,IAAI,CAACoE,QAAQ,EACb7F,gBAAgB,EAChB,IAAI,CAACqD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB,IAAI,CAACE,UACP,CAAW;YACX,IAAI,CAACA,UAAU,GAAGlE,QAAQ,CACxBA,QAAQ,CACN2D,KAAK,EACLpE,OAAO,EACP,IAAI,CAACsC,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChByB,UACF,CAAC,EACDvG,UAAU,EACV,IAAI,CAAC2C,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;cACEH;YACF,CACF,CAAC;YACD,IAAI,CAACQ,QAAQ,GAAGrE,QAAQ,CACtB2D,KAAK,EACLjF,QAAQ,EACR,IAAI,CAACmD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB;cACEH;YACF,CACF,CAAC;UACH;QACF;QAEA,IAAI,CAACkB,uBAAuB,CAAC,CAAC;MAChC;IAAC;MAAA3D,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAA8C,cAAA,EAAwB;QACtB,IAAI,CAACoB,MAAM,CAAC,KAAK,CAAC;MACpB;IAAC;MAAAtE,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAA+C,UAAA,EAAoB;QAClB,IAAI,CAACmB,MAAM,CAAC,IAAI,CAAC;MACnB;IAAC;MAAAtE,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAkE,OAAeC,OAAgB,EAAE;QAC/B,IAAI,CAAC,IAAI,CAACzB,UAAU,EAAE;QAEtB,IAAI0B,KAAW;QACf,IAAIC,GAAS;QACb,IACG5F,gBAAgB,CACf,IAAI,CAACiE,UAAU,EACflF,iBAAiB,EACjB,IAAI,CAAC6C,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC,IACA/D,gBAAgB,CACf,IAAI,CAACoE,QAAQ,EACbpF,gBAAgB,EAChB,IAAI,CAAC4C,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAa,EACb;UACA;UACA,MAAMyB,UAAU,GACd,CAAExF,gBAAgB,CAChB,IAAI,CAACoE,QAAQ,EACb5F,kBAAkB,EAClB,IAAI,CAACoD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB,IAAI,CAACE,UACP,CAAC,GACC,CAAC,KACFyB,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;UACpBC,KAAK,GAAG5F,QAAQ,CACd,IAAI,CAACkE,UAAU,EACf3F,SAAS,EACT,IAAI,CAACsD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChByB,UACF,CAAC;UACDI,GAAG,GAAG7F,QAAQ,CACZA,QAAQ,CACN,IAAI,CAACqE,QAAQ,EACb9F,SAAS,EACT,IAAI,CAACsD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChByB,UACF,CAAC,EACD9G,UAAU,EACV,IAAI,CAACkD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MACZ,CAAC;QACH,CAAC,MAAM;UACL;UACA,MAAMyB,UAAU,GACd,CAAExF,gBAAgB,CAChB,IAAI,CAACoE,QAAQ,EACb7F,gBAAgB,EAChB,IAAI,CAACqD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChB,IAAI,CAACE,UACP,CAAC,GACC,CAAC,KACFyB,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;UACpBC,KAAK,GAAG5F,QAAQ,CACd,IAAI,CAACkE,UAAU,EACf5F,OAAO,EACP,IAAI,CAACuD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChByB,UACF,CAAC;UACDI,GAAG,GAAG7F,QAAQ,CACZ,IAAI,CAACqE,QAAQ,EACb/F,OAAO,EACP,IAAI,CAACuD,IAAI,CAACiC,MAAM,EAChB,IAAI,CAACjC,IAAI,CAACmC,MAAM,EAChByB,UACF,CAAC;QACH;QAEA,IAAI,CAACvB,UAAU,GAAG0B,KAAK;QACvB,IAAI,CAACvB,QAAQ,GAAGwB,GAAG;QAEnB,IAAI,CAACd,uBAAuB,CAAC,CAAC;MAChC;IAAC;MAAA3D,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAS,aAAqB6D,UAAsB,EAAQ;QACjD,IAAI,CAACnB,QAAQ,GAAGmB,UAAU,CAACC,YAAY,KAAKC,SAAS;QACrD,IAAI,CAAC9B,UAAU,GAAG4B,UAAU,CAACF,KAAK;QAClC,IAAI,CAACvB,QAAQ,GAAGyB,UAAU,CAACD,GAAG,IAAIhH,UAAU,CAAC,CAAC;MAChD;IAAC;MAAAuC,IAAA;MAAAG,GAAA;MAAAC,KAAA,EAED,SAAAkD,eAAuBS,EAAsC,EAAE;QAC7D,IAAIA,EAAE,CAACC,MAAM,CAACa,MAAM,KAAK,aAAa,EAAE;UACtC;QACF;QACA,IAAI,CAACtB,QAAQ,GAAGQ,EAAE,CAACC,MAAM,CAACc,QAAQ;QAClC,MAAMlB,gBAAgB,GAAGvE,uBAAuB,CAAC,IAAI,CAACoB,IAAI,EAAE;UAC1DN,GAAG,EAAE,IAAI,CAACO;QACZ,CAAC,CAAC;QACFkD,gBAAgB,CAACmB,UAAU,CAAC,IAAI,CAACxB,QAAQ,CAAC;QAC1CK,gBAAgB,CAACE,OAAO,CAAC,CAAC;MAC5B;IAAC;MAAA9D,IAAA;MAAAgF,MAAA;MAAA7E,GAAA;MAAAC,KAAA,EAED,SAAA6E,OAAA,EAAoC;QAClC,OAAO5G,GAAI;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;MACH;IAAC;EAAA;AAAA,GA3lB0CiB,cAAc,CAAClB,UAAU,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}