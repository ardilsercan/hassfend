{"ast":null,"code":"(function webpackUniversalModuleDefinition(root, factory) {\n  if (typeof exports === 'object' && typeof module === 'object') module.exports = factory();else if (typeof define === 'function' && define.amd) define([], factory);else if (typeof exports === 'object') exports[\"Vibrant\"] = factory();else root[\"Vibrant\"] = factory();\n})(window, function () {\n  return /******/function (modules) {\n    // webpackBootstrap\n    /******/ // The module cache\n    /******/\n    var installedModules = {};\n    /******/\n    /******/ // The require function\n    /******/\n    function __webpack_require__(moduleId) {\n      /******/\n      /******/ // Check if module is in cache\n      /******/if (installedModules[moduleId]) {\n        /******/return installedModules[moduleId].exports;\n        /******/\n      }\n      /******/ // Create a new module (and put it into the cache)\n      /******/\n      var module = installedModules[moduleId] = {\n        /******/i: moduleId,\n        /******/l: false,\n        /******/exports: {}\n        /******/\n      };\n      /******/\n      /******/ // Execute the module function\n      /******/\n      modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n      /******/\n      /******/ // Flag the module as loaded\n      /******/\n      module.l = true;\n      /******/\n      /******/ // Return the exports of the module\n      /******/\n      return module.exports;\n      /******/\n    }\n    /******/\n    /******/\n    /******/ // expose the modules object (__webpack_modules__)\n    /******/\n    __webpack_require__.m = modules;\n    /******/\n    /******/ // expose the module cache\n    /******/\n    __webpack_require__.c = installedModules;\n    /******/\n    /******/ // define getter function for harmony exports\n    /******/\n    __webpack_require__.d = function (exports, name, getter) {\n      /******/if (!__webpack_require__.o(exports, name)) {\n        /******/Object.defineProperty(exports, name, {\n          enumerable: true,\n          get: getter\n        });\n        /******/\n      }\n      /******/\n    };\n    /******/\n    /******/ // define __esModule on exports\n    /******/\n    __webpack_require__.r = function (exports) {\n      /******/if (typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n        /******/Object.defineProperty(exports, Symbol.toStringTag, {\n          value: 'Module'\n        });\n        /******/\n      }\n      /******/\n      Object.defineProperty(exports, '__esModule', {\n        value: true\n      });\n      /******/\n    };\n    /******/\n    /******/ // create a fake namespace object\n    /******/ // mode & 1: value is a module id, require it\n    /******/ // mode & 2: merge all properties of value into the ns\n    /******/ // mode & 4: return value when already ns object\n    /******/ // mode & 8|1: behave like require\n    /******/\n    __webpack_require__.t = function (value, mode) {\n      /******/if (mode & 1) value = __webpack_require__(value);\n      /******/\n      if (mode & 8) return value;\n      /******/\n      if (mode & 4 && typeof value === 'object' && value && value.__esModule) return value;\n      /******/\n      var ns = Object.create(null);\n      /******/\n      __webpack_require__.r(ns);\n      /******/\n      Object.defineProperty(ns, 'default', {\n        enumerable: true,\n        value: value\n      });\n      /******/\n      if (mode & 2 && typeof value != 'string') for (var key in value) __webpack_require__.d(ns, key, function (key) {\n        return value[key];\n      }.bind(null, key));\n      /******/\n      return ns;\n      /******/\n    };\n    /******/\n    /******/ // getDefaultExport function for compatibility with non-harmony modules\n    /******/\n    __webpack_require__.n = function (module) {\n      /******/var getter = module && module.__esModule ? /******/function getDefault() {\n        return module['default'];\n      } : /******/function getModuleExports() {\n        return module;\n      };\n      /******/\n      __webpack_require__.d(getter, 'a', getter);\n      /******/\n      return getter;\n      /******/\n    };\n    /******/\n    /******/ // Object.prototype.hasOwnProperty.call\n    /******/\n    __webpack_require__.o = function (object, property) {\n      return Object.prototype.hasOwnProperty.call(object, property);\n    };\n    /******/\n    /******/ // __webpack_public_path__\n    /******/\n    __webpack_require__.p = \"\";\n    /******/\n    /******/\n    /******/ // Load entry module and return exports\n    /******/\n    return __webpack_require__(__webpack_require__.s = 10);\n    /******/\n  }\n  /************************************************************************/\n  /******/([( /* 0 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    exports.assignDeep = exports.mapValues = void 0;\n    function mapValues(o, mapper) {\n      var result = {};\n      for (var key in o) {\n        if (o.hasOwnProperty(key)) {\n          var v = o[key];\n          result[key] = mapper(v);\n        }\n      }\n      return result;\n    }\n    exports.mapValues = mapValues;\n    /**\n     * Overwrite values or properties on objects and lists recursively.\n     * A shallow copy will be created for each array value.\n     */\n    function assignDeep(target) {\n      var sources = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        sources[_i - 1] = arguments[_i];\n      }\n      sources.forEach(function (s) {\n        if (!s) return;\n        for (var key in s) {\n          if (s.hasOwnProperty(key)) {\n            var v = s[key];\n            if (Array.isArray(v)) {\n              // Shallow copy\n              target[key] = v.slice(0);\n            } else if (typeof v === 'object') {\n              if (!target[key]) target[key] = {};\n              assignDeep(target[key], v);\n            } else {\n              target[key] = v;\n            }\n          }\n        }\n      });\n      return target;\n    }\n    exports.assignDeep = assignDeep;\n\n    /***/\n  }), ( /* 1 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __importDefault = this && this.__importDefault || function (mod) {\n      return mod && mod.__esModule ? mod : {\n        \"default\": mod\n      };\n    };\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var options_1 = __webpack_require__(7);\n    var builder_1 = __importDefault(__webpack_require__(8));\n    var utils_1 = __webpack_require__(0);\n    var Vibrant = /** @class */function () {\n      function Vibrant(_src, opts) {\n        this._src = _src;\n        this.opts = utils_1.assignDeep({}, Vibrant.DefaultOpts, opts);\n      }\n      Vibrant.use = function (pipeline) {\n        this._pipeline = pipeline;\n      };\n      Vibrant.from = function (src) {\n        return new builder_1.default(src);\n      };\n      Object.defineProperty(Vibrant.prototype, \"result\", {\n        get: function () {\n          return this._result;\n        },\n        enumerable: false,\n        configurable: true\n      });\n      Vibrant.prototype._process = function (image, opts) {\n        var quantizer = this.opts.quantizer;\n        image.scaleDown(this.opts);\n        var processOpts = options_1.buildProcessOptions(this.opts, opts);\n        return Vibrant._pipeline.process(image.getImageData(), processOpts);\n      };\n      Vibrant.prototype.palette = function () {\n        return this.swatches();\n      };\n      Vibrant.prototype.swatches = function () {\n        throw new Error('Method deprecated. Use `Vibrant.result.palettes[name]` instead');\n      };\n      Vibrant.prototype.getPalette = function () {\n        var _this = this;\n        var arg0 = arguments[0];\n        var arg1 = arguments[1];\n        var name = typeof arg0 === 'string' ? arg0 : 'default';\n        var cb = typeof arg0 === 'string' ? arg1 : arg0;\n        var image = new this.opts.ImageClass();\n        return image.load(this._src).then(function (image) {\n          return _this._process(image, {\n            generators: [name]\n          });\n        }).then(function (result) {\n          _this._result = result;\n          return result.palettes[name];\n        }).then(function (res) {\n          image.remove();\n          if (cb) {\n            cb(undefined, res);\n          }\n          return res;\n        }).catch(function (err) {\n          image.remove();\n          if (cb) {\n            cb(err);\n          }\n          return Promise.reject(err);\n        });\n      };\n      Vibrant.prototype.getPalettes = function () {\n        var _this = this;\n        var arg0 = arguments[0];\n        var arg1 = arguments[1];\n        var names = Array.isArray(arg0) ? arg0 : ['*'];\n        var cb = Array.isArray(arg0) ? arg1 : arg0;\n        var image = new this.opts.ImageClass();\n        return image.load(this._src).then(function (image) {\n          return _this._process(image, {\n            generators: names\n          });\n        }).then(function (result) {\n          _this._result = result;\n          return result.palettes;\n        }).then(function (res) {\n          image.remove();\n          if (cb) {\n            cb(undefined, res);\n          }\n          return res;\n        }).catch(function (err) {\n          image.remove();\n          if (cb) {\n            cb(err);\n          }\n          return Promise.reject(err);\n        });\n      };\n      Vibrant.DefaultOpts = {\n        colorCount: 64,\n        quality: 5,\n        filters: []\n      };\n      return Vibrant;\n    }();\n    exports.default = Vibrant;\n\n    /***/\n  }), ( /* 2 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    exports.applyFilters = exports.ImageBase = void 0;\n    var ImageBase = /** @class */function () {\n      function ImageBase() {}\n      ImageBase.prototype.scaleDown = function (opts) {\n        var width = this.getWidth();\n        var height = this.getHeight();\n        var ratio = 1;\n        if (opts.maxDimension > 0) {\n          var maxSide = Math.max(width, height);\n          if (maxSide > opts.maxDimension) ratio = opts.maxDimension / maxSide;\n        } else {\n          ratio = 1 / opts.quality;\n        }\n        if (ratio < 1) this.resize(width * ratio, height * ratio, ratio);\n      };\n      return ImageBase;\n    }();\n    exports.ImageBase = ImageBase;\n    function applyFilters(imageData, filters) {\n      if (filters.length > 0) {\n        var pixels = imageData.data;\n        var n = pixels.length / 4;\n        var offset = void 0;\n        var r = void 0;\n        var g = void 0;\n        var b = void 0;\n        var a = void 0;\n        for (var i = 0; i < n; i++) {\n          offset = i * 4;\n          r = pixels[offset + 0];\n          g = pixels[offset + 1];\n          b = pixels[offset + 2];\n          a = pixels[offset + 3];\n          // Mark ignored color\n          for (var j = 0; j < filters.length; j++) {\n            if (!filters[j](r, g, b, a)) {\n              pixels[offset + 3] = 0;\n              break;\n            }\n          }\n        }\n      }\n      return imageData;\n    }\n    exports.applyFilters = applyFilters;\n\n    /***/\n  }), ( /* 3 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    exports.Swatch = void 0;\n    var converter_1 = __webpack_require__(4);\n    var Swatch = /** @class */function () {\n      function Swatch(rgb, population) {\n        this._rgb = rgb;\n        this._population = population;\n      }\n      Swatch.applyFilters = function (colors, filters) {\n        return filters.length > 0 ? colors.filter(function (_a) {\n          var r = _a.r,\n            g = _a.g,\n            b = _a.b;\n          for (var j = 0; j < filters.length; j++) {\n            if (!filters[j](r, g, b, 255)) return false;\n          }\n          return true;\n        }) : colors;\n      };\n      /**\n       * Make a value copy of a swatch based on a previous one. Returns a new Swatch instance\n       * @param {Swatch} swatch\n       */\n      Swatch.clone = function (swatch) {\n        return new Swatch(swatch._rgb, swatch._population);\n      };\n      Object.defineProperty(Swatch.prototype, \"r\", {\n        /**\n         * The red value in the RGB value\n         */\n        get: function () {\n          return this._rgb[0];\n        },\n        enumerable: false,\n        configurable: true\n      });\n      Object.defineProperty(Swatch.prototype, \"g\", {\n        /**\n         * The green value in the RGB value\n         */\n        get: function () {\n          return this._rgb[1];\n        },\n        enumerable: false,\n        configurable: true\n      });\n      Object.defineProperty(Swatch.prototype, \"b\", {\n        /**\n         * The blue value in the RGB value\n         */\n        get: function () {\n          return this._rgb[2];\n        },\n        enumerable: false,\n        configurable: true\n      });\n      Object.defineProperty(Swatch.prototype, \"rgb\", {\n        /**\n         * The color value as a rgb value\n         */\n        get: function () {\n          return this._rgb;\n        },\n        enumerable: false,\n        configurable: true\n      });\n      Object.defineProperty(Swatch.prototype, \"hsl\", {\n        /**\n         * The color value as a hsl value\n         */\n        get: function () {\n          if (!this._hsl) {\n            var _a = this._rgb,\n              r = _a[0],\n              g = _a[1],\n              b = _a[2];\n            this._hsl = converter_1.rgbToHsl(r, g, b);\n          }\n          return this._hsl;\n        },\n        enumerable: false,\n        configurable: true\n      });\n      Object.defineProperty(Swatch.prototype, \"hex\", {\n        /**\n         * The color value as a hex string\n         */\n        get: function () {\n          if (!this._hex) {\n            var _a = this._rgb,\n              r = _a[0],\n              g = _a[1],\n              b = _a[2];\n            this._hex = converter_1.rgbToHex(r, g, b);\n          }\n          return this._hex;\n        },\n        enumerable: false,\n        configurable: true\n      });\n      Object.defineProperty(Swatch.prototype, \"population\", {\n        get: function () {\n          return this._population;\n        },\n        enumerable: false,\n        configurable: true\n      });\n      /**\n       * Get the JSON object for the swatch\n       */\n      Swatch.prototype.toJSON = function () {\n        return {\n          rgb: this.rgb,\n          population: this.population\n        };\n      };\n      /**\n       * Get the color value as a rgb value\n       * @deprecated Use property instead\n       */\n      // TODO: deprecate internally, use property instead\n      Swatch.prototype.getRgb = function () {\n        return this._rgb;\n      };\n      /**\n       * Get the color value as a hsl value\n       * @deprecated Use property instead\n       */\n      // TODO: deprecate internally, use property instead\n      Swatch.prototype.getHsl = function () {\n        return this.hsl;\n      };\n      /**\n       * @deprecated Use property instead\n       */\n      // TODO: deprecate internally, use property instead\n      Swatch.prototype.getPopulation = function () {\n        return this._population;\n      };\n      /**\n       * Get the color value as a hex string\n       * @deprecated Use property instead\n       */\n      // TODO: deprecate internally, use property instead\n      Swatch.prototype.getHex = function () {\n        return this.hex;\n      };\n      Swatch.prototype.getYiq = function () {\n        if (!this._yiq) {\n          var rgb = this._rgb;\n          this._yiq = (rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000;\n        }\n        return this._yiq;\n      };\n      Object.defineProperty(Swatch.prototype, \"titleTextColor\", {\n        get: function () {\n          if (this._titleTextColor) {\n            this._titleTextColor = this.getYiq() < 200 ? '#fff' : '#000';\n          }\n          return this._titleTextColor;\n        },\n        enumerable: false,\n        configurable: true\n      });\n      Object.defineProperty(Swatch.prototype, \"bodyTextColor\", {\n        get: function () {\n          if (this._bodyTextColor) {\n            this._bodyTextColor = this.getYiq() < 150 ? '#fff' : '#000';\n          }\n          return this._bodyTextColor;\n        },\n        enumerable: false,\n        configurable: true\n      });\n      Swatch.prototype.getTitleTextColor = function () {\n        return this.titleTextColor;\n      };\n      Swatch.prototype.getBodyTextColor = function () {\n        return this.bodyTextColor;\n      };\n      return Swatch;\n    }();\n    exports.Swatch = Swatch;\n\n    /***/\n  }), ( /* 4 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    exports.getColorDiffStatus = exports.hexDiff = exports.rgbDiff = exports.deltaE94 = exports.rgbToCIELab = exports.xyzToCIELab = exports.rgbToXyz = exports.hslToRgb = exports.rgbToHsl = exports.rgbToHex = exports.hexToRgb = exports.DELTAE94_DIFF_STATUS = void 0;\n    exports.DELTAE94_DIFF_STATUS = {\n      NA: 0,\n      PERFECT: 1,\n      CLOSE: 2,\n      GOOD: 10,\n      SIMILAR: 50\n    };\n    /**\n     * Converts hex string to RGB\n     * @param hex - The hex value you with to get the RGB value of\n     * @returns an array in the order of `red, green, blue` numerical values\n     */\n    function hexToRgb(hex) {\n      var m = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n      if (!m) throw new RangeError(\"'\" + hex + \"' is not a valid hex color\");\n      return [m[1], m[2], m[3]].map(function (s) {\n        return parseInt(s, 16);\n      });\n    }\n    exports.hexToRgb = hexToRgb;\n    /**\n     * Given values for an RGB color convert to and return a valid HEX string\n     * @param r - Red value in RGB\n     * @param g - Green value in RGB\n     * @param b - Blue value in RGB\n     * @returns a valid hex string with pre-pending pound sign\n     */\n    function rgbToHex(r, g, b) {\n      return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1, 7);\n    }\n    exports.rgbToHex = rgbToHex;\n    /**\n     * Given values for an RGB color convert to and return a valid HSL value\n     * @param r - Red value in RGB\n     * @param g - Green value in RGB\n     * @param b - Blue value in RGB\n     * @returns an array in the order of `hue, saturation, light` numerical values\n     */\n    function rgbToHsl(r, g, b) {\n      r /= 255;\n      g /= 255;\n      b /= 255;\n      var max = Math.max(r, g, b);\n      var min = Math.min(r, g, b);\n      var h = 0;\n      var s = 0;\n      var l = (max + min) / 2;\n      if (max !== min) {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch (max) {\n          case r:\n            h = (g - b) / d + (g < b ? 6 : 0);\n            break;\n          case g:\n            h = (b - r) / d + 2;\n            break;\n          case b:\n            h = (r - g) / d + 4;\n            break;\n        }\n        h /= 6;\n      }\n      return [h, s, l];\n    }\n    exports.rgbToHsl = rgbToHsl;\n    function hslToRgb(h, s, l) {\n      var r;\n      var g;\n      var b;\n      function hue2rgb(p, q, t) {\n        if (t < 0) t += 1;\n        if (t > 1) t -= 1;\n        if (t < 1 / 6) return p + (q - p) * 6 * t;\n        if (t < 1 / 2) return q;\n        if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n        return p;\n      }\n      if (s === 0) {\n        r = g = b = l;\n      } else {\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        var p = 2 * l - q;\n        r = hue2rgb(p, q, h + 1 / 3);\n        g = hue2rgb(p, q, h);\n        b = hue2rgb(p, q, h - 1 / 3);\n      }\n      return [r * 255, g * 255, b * 255];\n    }\n    exports.hslToRgb = hslToRgb;\n    function rgbToXyz(r, g, b) {\n      r /= 255;\n      g /= 255;\n      b /= 255;\n      r = r > 0.04045 ? Math.pow((r + 0.005) / 1.055, 2.4) : r / 12.92;\n      g = g > 0.04045 ? Math.pow((g + 0.005) / 1.055, 2.4) : g / 12.92;\n      b = b > 0.04045 ? Math.pow((b + 0.005) / 1.055, 2.4) : b / 12.92;\n      r *= 100;\n      g *= 100;\n      b *= 100;\n      var x = r * 0.4124 + g * 0.3576 + b * 0.1805;\n      var y = r * 0.2126 + g * 0.7152 + b * 0.0722;\n      var z = r * 0.0193 + g * 0.1192 + b * 0.9505;\n      return [x, y, z];\n    }\n    exports.rgbToXyz = rgbToXyz;\n    function xyzToCIELab(x, y, z) {\n      var REF_X = 95.047;\n      var REF_Y = 100;\n      var REF_Z = 108.883;\n      x /= REF_X;\n      y /= REF_Y;\n      z /= REF_Z;\n      x = x > 0.008856 ? Math.pow(x, 1 / 3) : 7.787 * x + 16 / 116;\n      y = y > 0.008856 ? Math.pow(y, 1 / 3) : 7.787 * y + 16 / 116;\n      z = z > 0.008856 ? Math.pow(z, 1 / 3) : 7.787 * z + 16 / 116;\n      var L = 116 * y - 16;\n      var a = 500 * (x - y);\n      var b = 200 * (y - z);\n      return [L, a, b];\n    }\n    exports.xyzToCIELab = xyzToCIELab;\n    function rgbToCIELab(r, g, b) {\n      var _a = rgbToXyz(r, g, b),\n        x = _a[0],\n        y = _a[1],\n        z = _a[2];\n      return xyzToCIELab(x, y, z);\n    }\n    exports.rgbToCIELab = rgbToCIELab;\n    function deltaE94(lab1, lab2) {\n      var WEIGHT_L = 1;\n      var WEIGHT_C = 1;\n      var WEIGHT_H = 1;\n      var L1 = lab1[0],\n        a1 = lab1[1],\n        b1 = lab1[2];\n      var L2 = lab2[0],\n        a2 = lab2[1],\n        b2 = lab2[2];\n      var dL = L1 - L2;\n      var da = a1 - a2;\n      var db = b1 - b2;\n      var xC1 = Math.sqrt(a1 * a1 + b1 * b1);\n      var xC2 = Math.sqrt(a2 * a2 + b2 * b2);\n      var xDL = L2 - L1;\n      var xDC = xC2 - xC1;\n      var xDE = Math.sqrt(dL * dL + da * da + db * db);\n      var xDH = Math.sqrt(xDE) > Math.sqrt(Math.abs(xDL)) + Math.sqrt(Math.abs(xDC)) ? Math.sqrt(xDE * xDE - xDL * xDL - xDC * xDC) : 0;\n      var xSC = 1 + 0.045 * xC1;\n      var xSH = 1 + 0.015 * xC1;\n      xDL /= WEIGHT_L;\n      xDC /= WEIGHT_C * xSC;\n      xDH /= WEIGHT_H * xSH;\n      return Math.sqrt(xDL * xDL + xDC * xDC + xDH * xDH);\n    }\n    exports.deltaE94 = deltaE94;\n    function rgbDiff(rgb1, rgb2) {\n      var lab1 = rgbToCIELab.apply(undefined, rgb1);\n      var lab2 = rgbToCIELab.apply(undefined, rgb2);\n      return deltaE94(lab1, lab2);\n    }\n    exports.rgbDiff = rgbDiff;\n    function hexDiff(hex1, hex2) {\n      var rgb1 = hexToRgb(hex1);\n      var rgb2 = hexToRgb(hex2);\n      return rgbDiff(rgb1, rgb2);\n    }\n    exports.hexDiff = hexDiff;\n    function getColorDiffStatus(d) {\n      if (d < exports.DELTAE94_DIFF_STATUS.NA) {\n        return 'N/A';\n      }\n      // Not perceptible by human eyes\n      if (d <= exports.DELTAE94_DIFF_STATUS.PERFECT) {\n        return 'Perfect';\n      }\n      // Perceptible through close observation\n      if (d <= exports.DELTAE94_DIFF_STATUS.CLOSE) {\n        return 'Close';\n      }\n      // Perceptible at a glance\n      if (d <= exports.DELTAE94_DIFF_STATUS.GOOD) {\n        return 'Good';\n      }\n      // Colors are more similar than opposite\n      if (d < exports.DELTAE94_DIFF_STATUS.SIMILAR) {\n        return 'Similar';\n      }\n      return 'Wrong';\n    }\n    exports.getColorDiffStatus = getColorDiffStatus;\n\n    /***/\n  }), ( /* 5 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __importDefault = this && this.__importDefault || function (mod) {\n      return mod && mod.__esModule ? mod : {\n        \"default\": mod\n      };\n    };\n    var config_1 = __importDefault(__webpack_require__(6));\n    var image_browser_1 = __importDefault(__webpack_require__(9));\n    config_1.default.DefaultOpts.ImageClass = image_browser_1.default;\n    module.exports = config_1.default;\n\n    /***/\n  }), ( /* 6 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __importDefault = this && this.__importDefault || function (mod) {\n      return mod && mod.__esModule ? mod : {\n        \"default\": mod\n      };\n    };\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var core_1 = __importDefault(__webpack_require__(1));\n    core_1.default.DefaultOpts.quantizer = 'mmcq';\n    core_1.default.DefaultOpts.generators = ['default'];\n    core_1.default.DefaultOpts.filters = ['default'];\n    exports.default = core_1.default;\n\n    /***/\n  }), ( /* 7 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    exports.buildProcessOptions = void 0;\n    var utils_1 = __webpack_require__(0);\n    function buildProcessOptions(opts, override) {\n      var colorCount = opts.colorCount,\n        quantizer = opts.quantizer,\n        generators = opts.generators,\n        filters = opts.filters;\n      // Merge with common quantizer options\n      var commonQuantizerOpts = {\n        colorCount: colorCount\n      };\n      var q = typeof quantizer === 'string' ? {\n        name: quantizer,\n        options: {}\n      } : quantizer;\n      q.options = utils_1.assignDeep({}, commonQuantizerOpts, q.options);\n      return utils_1.assignDeep({}, {\n        quantizer: q,\n        generators: generators,\n        filters: filters\n      }, override);\n    }\n    exports.buildProcessOptions = buildProcessOptions;\n\n    /***/\n  }), ( /* 8 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __importDefault = this && this.__importDefault || function (mod) {\n      return mod && mod.__esModule ? mod : {\n        \"default\": mod\n      };\n    };\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var _1 = __importDefault(__webpack_require__(1));\n    var utils_1 = __webpack_require__(0);\n    var Builder = /** @class */function () {\n      function Builder(src, opts) {\n        if (opts === void 0) {\n          opts = {};\n        }\n        this._src = src;\n        this._opts = utils_1.assignDeep({}, _1.default.DefaultOpts, opts);\n      }\n      Builder.prototype.maxColorCount = function (n) {\n        this._opts.colorCount = n;\n        return this;\n      };\n      Builder.prototype.maxDimension = function (d) {\n        this._opts.maxDimension = d;\n        return this;\n      };\n      Builder.prototype.addFilter = function (name) {\n        if (!this._opts.filters) {\n          this._opts.filters = [name];\n        } else {\n          this._opts.filters.push(name);\n        }\n        return this;\n      };\n      Builder.prototype.removeFilter = function (name) {\n        if (this._opts.filters) {\n          var i = this._opts.filters.indexOf(name);\n          if (i > 0) this._opts.filters.splice(i);\n        }\n        return this;\n      };\n      Builder.prototype.clearFilters = function () {\n        this._opts.filters = [];\n        return this;\n      };\n      Builder.prototype.quality = function (q) {\n        this._opts.quality = q;\n        return this;\n      };\n      Builder.prototype.useImageClass = function (imageClass) {\n        this._opts.ImageClass = imageClass;\n        return this;\n      };\n      Builder.prototype.useGenerator = function (generator, options) {\n        if (!this._opts.generators) this._opts.generators = [];\n        this._opts.generators.push(options ? {\n          name: generator,\n          options: options\n        } : generator);\n        return this;\n      };\n      Builder.prototype.useQuantizer = function (quantizer, options) {\n        this._opts.quantizer = options ? {\n          name: quantizer,\n          options: options\n        } : quantizer;\n        return this;\n      };\n      Builder.prototype.build = function () {\n        return new _1.default(this._src, this._opts);\n      };\n      Builder.prototype.getPalette = function (cb) {\n        return this.build().getPalette(cb);\n      };\n      Builder.prototype.getSwatches = function (cb) {\n        return this.build().getPalette(cb);\n      };\n      return Builder;\n    }();\n    exports.default = Builder;\n\n    /***/\n  }), ( /* 9 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n        return extendStatics(d, b);\n      };\n      return function (d, b) {\n        extendStatics(d, b);\n        function __() {\n          this.constructor = d;\n        }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var image_1 = __webpack_require__(2);\n    function isRelativeUrl(url) {\n      var u = new URL(url, location.href);\n      return u.protocol === location.protocol && u.host === location.host && u.port === location.port;\n    }\n    function isSameOrigin(a, b) {\n      var ua = new URL(a);\n      var ub = new URL(b);\n      // https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\n      return ua.protocol === ub.protocol && ua.hostname === ub.hostname && ua.port === ub.port;\n    }\n    var BrowserImage = /** @class */function (_super) {\n      __extends(BrowserImage, _super);\n      function BrowserImage() {\n        return _super !== null && _super.apply(this, arguments) || this;\n      }\n      BrowserImage.prototype._initCanvas = function () {\n        var img = this.image;\n        var canvas = this._canvas = document.createElement('canvas');\n        var context = canvas.getContext('2d');\n        if (!context) throw new ReferenceError('Failed to create canvas context');\n        this._context = context;\n        canvas.className = '@vibrant/canvas';\n        canvas.style.display = 'none';\n        this._width = canvas.width = img.width;\n        this._height = canvas.height = img.height;\n        context.drawImage(img, 0, 0);\n        document.body.appendChild(canvas);\n      };\n      BrowserImage.prototype.load = function (image) {\n        var _this = this;\n        var img;\n        var src;\n        if (typeof image === 'string') {\n          img = document.createElement('img');\n          src = image;\n          if (!isRelativeUrl(src) && !isSameOrigin(window.location.href, src)) {\n            img.crossOrigin = 'anonymous';\n          }\n          img.src = src;\n        } else if (image instanceof HTMLImageElement) {\n          img = image;\n          src = image.src;\n        } else {\n          return Promise.reject(new Error(\"Cannot load buffer as an image in browser\"));\n        }\n        this.image = img;\n        return new Promise(function (resolve, reject) {\n          var onImageLoad = function () {\n            _this._initCanvas();\n            resolve(_this);\n          };\n          if (img.complete) {\n            // Already loaded\n            onImageLoad();\n          } else {\n            img.onload = onImageLoad;\n            img.onerror = function (e) {\n              return reject(new Error(\"Fail to load image: \" + src));\n            };\n          }\n        });\n      };\n      BrowserImage.prototype.clear = function () {\n        this._context.clearRect(0, 0, this._width, this._height);\n      };\n      BrowserImage.prototype.update = function (imageData) {\n        this._context.putImageData(imageData, 0, 0);\n      };\n      BrowserImage.prototype.getWidth = function () {\n        return this._width;\n      };\n      BrowserImage.prototype.getHeight = function () {\n        return this._height;\n      };\n      BrowserImage.prototype.resize = function (targetWidth, targetHeight, ratio) {\n        var _a = this,\n          canvas = _a._canvas,\n          context = _a._context,\n          img = _a.image;\n        this._width = canvas.width = targetWidth;\n        this._height = canvas.height = targetHeight;\n        context.scale(ratio, ratio);\n        context.drawImage(img, 0, 0);\n      };\n      BrowserImage.prototype.getPixelCount = function () {\n        return this._width * this._height;\n      };\n      BrowserImage.prototype.getImageData = function () {\n        return this._context.getImageData(0, 0, this._width, this._height);\n      };\n      BrowserImage.prototype.remove = function () {\n        if (this._canvas && this._canvas.parentNode) {\n          this._canvas.parentNode.removeChild(this._canvas);\n        }\n      };\n      return BrowserImage;\n    }(image_1.ImageBase);\n    exports.default = BrowserImage;\n\n    /***/\n  }), ( /* 10 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __importDefault = this && this.__importDefault || function (mod) {\n      return mod && mod.__esModule ? mod : {\n        \"default\": mod\n      };\n    };\n    var Vibrant = __webpack_require__(5);\n    var pipeline_1 = __importDefault(__webpack_require__(11));\n    Vibrant.use(pipeline_1.default);\n    module.exports = Vibrant;\n\n    /***/\n  }), ( /* 11 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __importDefault = this && this.__importDefault || function (mod) {\n      return mod && mod.__esModule ? mod : {\n        \"default\": mod\n      };\n    };\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var quantizer_mmcq_1 = __importDefault(__webpack_require__(12));\n    var generator_default_1 = __importDefault(__webpack_require__(16));\n    var pipeline_1 = __webpack_require__(17);\n    var pipeline = new pipeline_1.BasicPipeline().filter.register('default', function (r, g, b, a) {\n      return a >= 125 && !(r > 250 && g > 250 && b > 250);\n    }).quantizer.register('mmcq', quantizer_mmcq_1.default).generator.register('default', generator_default_1.default);\n    exports.default = pipeline;\n\n    /***/\n  }), ( /* 12 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __importDefault = this && this.__importDefault || function (mod) {\n      return mod && mod.__esModule ? mod : {\n        \"default\": mod\n      };\n    };\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var color_1 = __webpack_require__(3);\n    var vbox_1 = __importDefault(__webpack_require__(13));\n    var pqueue_1 = __importDefault(__webpack_require__(15));\n    var fractByPopulations = 0.75;\n    function _splitBoxes(pq, target) {\n      var lastSize = pq.size();\n      while (pq.size() < target) {\n        var vbox = pq.pop();\n        if (vbox && vbox.count() > 0) {\n          var _a = vbox.split(),\n            vbox1 = _a[0],\n            vbox2 = _a[1];\n          pq.push(vbox1);\n          if (vbox2 && vbox2.count() > 0) pq.push(vbox2);\n          // No more new boxes, converged\n          if (pq.size() === lastSize) {\n            break;\n          } else {\n            lastSize = pq.size();\n          }\n        } else {\n          break;\n        }\n      }\n    }\n    var MMCQ = function (pixels, opts) {\n      if (pixels.length === 0 || opts.colorCount < 2 || opts.colorCount > 256) {\n        throw new Error('Wrong MMCQ parameters');\n      }\n      var vbox = vbox_1.default.build(pixels);\n      var colorCount = vbox.histogram.colorCount;\n      var pq = new pqueue_1.default(function (a, b) {\n        return a.count() - b.count();\n      });\n      pq.push(vbox);\n      // first set of colors, sorted by population\n      _splitBoxes(pq, fractByPopulations * opts.colorCount);\n      // Re-order\n      var pq2 = new pqueue_1.default(function (a, b) {\n        return a.count() * a.volume() - b.count() * b.volume();\n      });\n      pq2.contents = pq.contents;\n      // next set - generate the median cuts using the (npix * vol) sorting.\n      _splitBoxes(pq2, opts.colorCount - pq2.size());\n      // calculate the actual colors\n      return generateSwatches(pq2);\n    };\n    function generateSwatches(pq) {\n      var swatches = [];\n      while (pq.size()) {\n        var v = pq.pop();\n        var color = v.avg();\n        var r = color[0],\n          g = color[1],\n          b = color[2];\n        swatches.push(new color_1.Swatch(color, v.count()));\n      }\n      return swatches;\n    }\n    exports.default = MMCQ;\n\n    /***/\n  }), ( /* 13 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __importDefault = this && this.__importDefault || function (mod) {\n      return mod && mod.__esModule ? mod : {\n        \"default\": mod\n      };\n    };\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var histogram_1 = __importDefault(__webpack_require__(14));\n    var SIGBITS = 5;\n    var RSHIFT = 8 - SIGBITS;\n    var VBox = /** @class */function () {\n      function VBox(r1, r2, g1, g2, b1, b2, histogram) {\n        this.histogram = histogram;\n        this._volume = -1;\n        this._count = -1;\n        // NOTE: dimension will be mutated by split operation.\n        //       It must be specified explicitly, not from histogram\n        this.dimension = {\n          r1: r1,\n          r2: r2,\n          g1: g1,\n          g2: g2,\n          b1: b1,\n          b2: b2\n        };\n      }\n      VBox.build = function (pixels) {\n        var h = new histogram_1.default(pixels, {\n          sigBits: SIGBITS\n        });\n        var rmin = h.rmin,\n          rmax = h.rmax,\n          gmin = h.gmin,\n          gmax = h.gmax,\n          bmin = h.bmin,\n          bmax = h.bmax;\n        return new VBox(rmin, rmax, gmin, gmax, bmin, bmax, h);\n      };\n      VBox.prototype.invalidate = function () {\n        this._volume = this._count = -1;\n        this._avg = null;\n      };\n      VBox.prototype.volume = function () {\n        if (this._volume < 0) {\n          var _a = this.dimension,\n            r1 = _a.r1,\n            r2 = _a.r2,\n            g1 = _a.g1,\n            g2 = _a.g2,\n            b1 = _a.b1,\n            b2 = _a.b2;\n          this._volume = (r2 - r1 + 1) * (g2 - g1 + 1) * (b2 - b1 + 1);\n        }\n        return this._volume;\n      };\n      VBox.prototype.count = function () {\n        if (this._count < 0) {\n          var _a = this.histogram,\n            hist = _a.hist,\n            getColorIndex = _a.getColorIndex;\n          var _b = this.dimension,\n            r1 = _b.r1,\n            r2 = _b.r2,\n            g1 = _b.g1,\n            g2 = _b.g2,\n            b1 = _b.b1,\n            b2 = _b.b2;\n          var c = 0;\n          for (var r = r1; r <= r2; r++) {\n            for (var g = g1; g <= g2; g++) {\n              for (var b = b1; b <= b2; b++) {\n                var index = getColorIndex(r, g, b);\n                c += hist[index];\n              }\n            }\n          }\n          this._count = c;\n        }\n        return this._count;\n      };\n      VBox.prototype.clone = function () {\n        var histogram = this.histogram;\n        var _a = this.dimension,\n          r1 = _a.r1,\n          r2 = _a.r2,\n          g1 = _a.g1,\n          g2 = _a.g2,\n          b1 = _a.b1,\n          b2 = _a.b2;\n        return new VBox(r1, r2, g1, g2, b1, b2, histogram);\n      };\n      VBox.prototype.avg = function () {\n        if (!this._avg) {\n          var _a = this.histogram,\n            hist = _a.hist,\n            getColorIndex = _a.getColorIndex;\n          var _b = this.dimension,\n            r1 = _b.r1,\n            r2 = _b.r2,\n            g1 = _b.g1,\n            g2 = _b.g2,\n            b1 = _b.b1,\n            b2 = _b.b2;\n          var ntot = 0;\n          var mult = 1 << 8 - SIGBITS;\n          var rsum = void 0;\n          var gsum = void 0;\n          var bsum = void 0;\n          rsum = gsum = bsum = 0;\n          for (var r = r1; r <= r2; r++) {\n            for (var g = g1; g <= g2; g++) {\n              for (var b = b1; b <= b2; b++) {\n                var index = getColorIndex(r, g, b);\n                var h = hist[index];\n                ntot += h;\n                rsum += h * (r + 0.5) * mult;\n                gsum += h * (g + 0.5) * mult;\n                bsum += h * (b + 0.5) * mult;\n              }\n            }\n          }\n          if (ntot) {\n            this._avg = [~~(rsum / ntot), ~~(gsum / ntot), ~~(bsum / ntot)];\n          } else {\n            this._avg = [~~(mult * (r1 + r2 + 1) / 2), ~~(mult * (g1 + g2 + 1) / 2), ~~(mult * (b1 + b2 + 1) / 2)];\n          }\n        }\n        return this._avg;\n      };\n      VBox.prototype.contains = function (rgb) {\n        var r = rgb[0],\n          g = rgb[1],\n          b = rgb[2];\n        var _a = this.dimension,\n          r1 = _a.r1,\n          r2 = _a.r2,\n          g1 = _a.g1,\n          g2 = _a.g2,\n          b1 = _a.b1,\n          b2 = _a.b2;\n        r >>= RSHIFT;\n        g >>= RSHIFT;\n        b >>= RSHIFT;\n        return r >= r1 && r <= r2 && g >= g1 && g <= g2 && b >= b1 && b <= b2;\n      };\n      VBox.prototype.split = function () {\n        var _a = this.histogram,\n          hist = _a.hist,\n          getColorIndex = _a.getColorIndex;\n        var _b = this.dimension,\n          r1 = _b.r1,\n          r2 = _b.r2,\n          g1 = _b.g1,\n          g2 = _b.g2,\n          b1 = _b.b1,\n          b2 = _b.b2;\n        var count = this.count();\n        if (!count) return [];\n        if (count === 1) return [this.clone()];\n        var rw = r2 - r1 + 1;\n        var gw = g2 - g1 + 1;\n        var bw = b2 - b1 + 1;\n        var maxw = Math.max(rw, gw, bw);\n        var accSum = null;\n        var sum;\n        var total;\n        sum = total = 0;\n        var maxd = null;\n        if (maxw === rw) {\n          maxd = 'r';\n          accSum = new Uint32Array(r2 + 1);\n          for (var r = r1; r <= r2; r++) {\n            sum = 0;\n            for (var g = g1; g <= g2; g++) {\n              for (var b = b1; b <= b2; b++) {\n                var index = getColorIndex(r, g, b);\n                sum += hist[index];\n              }\n            }\n            total += sum;\n            accSum[r] = total;\n          }\n        } else if (maxw === gw) {\n          maxd = 'g';\n          accSum = new Uint32Array(g2 + 1);\n          for (var g = g1; g <= g2; g++) {\n            sum = 0;\n            for (var r = r1; r <= r2; r++) {\n              for (var b = b1; b <= b2; b++) {\n                var index = getColorIndex(r, g, b);\n                sum += hist[index];\n              }\n            }\n            total += sum;\n            accSum[g] = total;\n          }\n        } else {\n          maxd = 'b';\n          accSum = new Uint32Array(b2 + 1);\n          for (var b = b1; b <= b2; b++) {\n            sum = 0;\n            for (var r = r1; r <= r2; r++) {\n              for (var g = g1; g <= g2; g++) {\n                var index = getColorIndex(r, g, b);\n                sum += hist[index];\n              }\n            }\n            total += sum;\n            accSum[b] = total;\n          }\n        }\n        var splitPoint = -1;\n        var reverseSum = new Uint32Array(accSum.length);\n        for (var i = 0; i < accSum.length; i++) {\n          var d = accSum[i];\n          if (splitPoint < 0 && d > total / 2) splitPoint = i;\n          reverseSum[i] = total - d;\n        }\n        var vbox = this;\n        function doCut(d) {\n          var dim1 = d + '1';\n          var dim2 = d + '2';\n          var d1 = vbox.dimension[dim1];\n          var d2 = vbox.dimension[dim2];\n          var vbox1 = vbox.clone();\n          var vbox2 = vbox.clone();\n          var left = splitPoint - d1;\n          var right = d2 - splitPoint;\n          if (left <= right) {\n            d2 = Math.min(d2 - 1, ~~(splitPoint + right / 2));\n            d2 = Math.max(0, d2);\n          } else {\n            d2 = Math.max(d1, ~~(splitPoint - 1 - left / 2));\n            d2 = Math.min(vbox.dimension[dim2], d2);\n          }\n          while (!accSum[d2]) d2++;\n          var c2 = reverseSum[d2];\n          while (!c2 && accSum[d2 - 1]) c2 = reverseSum[--d2];\n          vbox1.dimension[dim2] = d2;\n          vbox2.dimension[dim1] = d2 + 1;\n          return [vbox1, vbox2];\n        }\n        return doCut(maxd);\n      };\n      return VBox;\n    }();\n    exports.default = VBox;\n\n    /***/\n  }), ( /* 14 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var Histogram = /** @class */function () {\n      function Histogram(pixels, opts) {\n        this.pixels = pixels;\n        this.opts = opts;\n        var sigBits = opts.sigBits;\n        var getColorIndex = function (r, g, b) {\n          return (r << 2 * sigBits) + (g << sigBits) + b;\n        };\n        this.getColorIndex = getColorIndex;\n        var rshift = 8 - sigBits;\n        var hn = 1 << 3 * sigBits;\n        var hist = new Uint32Array(hn);\n        var rmax;\n        var rmin;\n        var gmax;\n        var gmin;\n        var bmax;\n        var bmin;\n        var r;\n        var g;\n        var b;\n        var a;\n        rmax = gmax = bmax = 0;\n        rmin = gmin = bmin = Number.MAX_VALUE;\n        var n = pixels.length / 4;\n        var i = 0;\n        while (i < n) {\n          var offset = i * 4;\n          i++;\n          r = pixels[offset + 0];\n          g = pixels[offset + 1];\n          b = pixels[offset + 2];\n          a = pixels[offset + 3];\n          // Ignored pixels' alpha is marked as 0 in filtering stage\n          if (a === 0) continue;\n          r = r >> rshift;\n          g = g >> rshift;\n          b = b >> rshift;\n          var index = getColorIndex(r, g, b);\n          hist[index] += 1;\n          if (r > rmax) rmax = r;\n          if (r < rmin) rmin = r;\n          if (g > gmax) gmax = g;\n          if (g < gmin) gmin = g;\n          if (b > bmax) bmax = b;\n          if (b < bmin) bmin = b;\n        }\n        this._colorCount = hist.reduce(function (total, c) {\n          return c > 0 ? total + 1 : total;\n        }, 0);\n        this.hist = hist;\n        this.rmax = rmax;\n        this.rmin = rmin;\n        this.gmax = gmax;\n        this.gmin = gmin;\n        this.bmax = bmax;\n        this.bmin = bmin;\n      }\n      Object.defineProperty(Histogram.prototype, \"colorCount\", {\n        get: function () {\n          return this._colorCount;\n        },\n        enumerable: false,\n        configurable: true\n      });\n      return Histogram;\n    }();\n    exports.default = Histogram;\n\n    /***/\n  }), ( /* 15 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var PQueue = /** @class */function () {\n      function PQueue(comparator) {\n        this._comparator = comparator;\n        this.contents = [];\n        this._sorted = false;\n      }\n      PQueue.prototype._sort = function () {\n        if (!this._sorted) {\n          this.contents.sort(this._comparator);\n          this._sorted = true;\n        }\n      };\n      PQueue.prototype.push = function (item) {\n        this.contents.push(item);\n        this._sorted = false;\n      };\n      PQueue.prototype.peek = function (index) {\n        this._sort();\n        index = typeof index === 'number' ? index : this.contents.length - 1;\n        return this.contents[index];\n      };\n      PQueue.prototype.pop = function () {\n        this._sort();\n        return this.contents.pop();\n      };\n      PQueue.prototype.size = function () {\n        return this.contents.length;\n      };\n      PQueue.prototype.map = function (mapper) {\n        this._sort();\n        return this.contents.map(mapper);\n      };\n      return PQueue;\n    }();\n    exports.default = PQueue;\n\n    /***/\n  }), ( /* 16 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var color_1 = __webpack_require__(3);\n    var converter_1 = __webpack_require__(4);\n    var DefaultOpts = {\n      targetDarkLuma: 0.26,\n      maxDarkLuma: 0.45,\n      minLightLuma: 0.55,\n      targetLightLuma: 0.74,\n      minNormalLuma: 0.3,\n      targetNormalLuma: 0.5,\n      maxNormalLuma: 0.7,\n      targetMutesSaturation: 0.3,\n      maxMutesSaturation: 0.4,\n      targetVibrantSaturation: 1.0,\n      minVibrantSaturation: 0.35,\n      weightSaturation: 3,\n      weightLuma: 6.5,\n      weightPopulation: 0.5\n    };\n    function _findMaxPopulation(swatches) {\n      var p = 0;\n      swatches.forEach(function (s) {\n        p = Math.max(p, s.population);\n      });\n      return p;\n    }\n    function _isAlreadySelected(palette, s) {\n      return palette.Vibrant === s || palette.DarkVibrant === s || palette.LightVibrant === s || palette.Muted === s || palette.DarkMuted === s || palette.LightMuted === s;\n    }\n    function _createComparisonValue(saturation, targetSaturation, luma, targetLuma, population, maxPopulation, opts) {\n      function weightedMean() {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        var sum = 0;\n        var weightSum = 0;\n        for (var i = 0; i < values.length; i += 2) {\n          var value = values[i];\n          var weight = values[i + 1];\n          sum += value * weight;\n          weightSum += weight;\n        }\n        return sum / weightSum;\n      }\n      function invertDiff(value, targetValue) {\n        return 1 - Math.abs(value - targetValue);\n      }\n      return weightedMean(invertDiff(saturation, targetSaturation), opts.weightSaturation, invertDiff(luma, targetLuma), opts.weightLuma, population / maxPopulation, opts.weightPopulation);\n    }\n    function _findColorVariation(palette, swatches, maxPopulation, targetLuma, minLuma, maxLuma, targetSaturation, minSaturation, maxSaturation, opts) {\n      var max = null;\n      var maxValue = 0;\n      swatches.forEach(function (swatch) {\n        var _a = swatch.hsl,\n          s = _a[1],\n          l = _a[2];\n        if (s >= minSaturation && s <= maxSaturation && l >= minLuma && l <= maxLuma && !_isAlreadySelected(palette, swatch)) {\n          var value = _createComparisonValue(s, targetSaturation, l, targetLuma, swatch.population, maxPopulation, opts);\n          if (max === null || value > maxValue) {\n            max = swatch;\n            maxValue = value;\n          }\n        }\n      });\n      return max;\n    }\n    function _generateVariationColors(swatches, maxPopulation, opts) {\n      var palette = {\n        Vibrant: null,\n        DarkVibrant: null,\n        LightVibrant: null,\n        Muted: null,\n        DarkMuted: null,\n        LightMuted: null\n      };\n      // mVibrantSwatch = findColor(TARGET_NORMAL_LUMA, MIN_NORMAL_LUMA, MAX_NORMAL_LUMA,\n      //     TARGET_VIBRANT_SATURATION, MIN_VIBRANT_SATURATION, 1f)\n      palette.Vibrant = _findColorVariation(palette, swatches, maxPopulation, opts.targetNormalLuma, opts.minNormalLuma, opts.maxNormalLuma, opts.targetVibrantSaturation, opts.minVibrantSaturation, 1, opts);\n      // mLightVibrantSwatch = findColor(TARGET_LIGHT_LUMA, MIN_LIGHT_LUMA, 1f,\n      //     TARGET_VIBRANT_SATURATION, MIN_VIBRANT_SATURATION, 1f)\n      palette.LightVibrant = _findColorVariation(palette, swatches, maxPopulation, opts.targetLightLuma, opts.minLightLuma, 1, opts.targetVibrantSaturation, opts.minVibrantSaturation, 1, opts);\n      // mDarkVibrantSwatch = findColor(TARGET_DARK_LUMA, 0f, MAX_DARK_LUMA,\n      //     TARGET_VIBRANT_SATURATION, MIN_VIBRANT_SATURATION, 1f)\n      palette.DarkVibrant = _findColorVariation(palette, swatches, maxPopulation, opts.targetDarkLuma, 0, opts.maxDarkLuma, opts.targetVibrantSaturation, opts.minVibrantSaturation, 1, opts);\n      // mMutedSwatch = findColor(TARGET_NORMAL_LUMA, MIN_NORMAL_LUMA, MAX_NORMAL_LUMA,\n      //     TARGET_MUTED_SATURATION, 0f, MAX_MUTED_SATURATION)\n      palette.Muted = _findColorVariation(palette, swatches, maxPopulation, opts.targetNormalLuma, opts.minNormalLuma, opts.maxNormalLuma, opts.targetMutesSaturation, 0, opts.maxMutesSaturation, opts);\n      // mLightMutedColor = findColor(TARGET_LIGHT_LUMA, MIN_LIGHT_LUMA, 1f,\n      //     TARGET_MUTED_SATURATION, 0f, MAX_MUTED_SATURATION)\n      palette.LightMuted = _findColorVariation(palette, swatches, maxPopulation, opts.targetLightLuma, opts.minLightLuma, 1, opts.targetMutesSaturation, 0, opts.maxMutesSaturation, opts);\n      // mDarkMutedSwatch = findColor(TARGET_DARK_LUMA, 0f, MAX_DARK_LUMA,\n      //     TARGET_MUTED_SATURATION, 0f, MAX_MUTED_SATURATION)\n      palette.DarkMuted = _findColorVariation(palette, swatches, maxPopulation, opts.targetDarkLuma, 0, opts.maxDarkLuma, opts.targetMutesSaturation, 0, opts.maxMutesSaturation, opts);\n      return palette;\n    }\n    function _generateEmptySwatches(palette, maxPopulation, opts) {\n      if (!palette.Vibrant && !palette.DarkVibrant && !palette.LightVibrant) {\n        if (!palette.DarkVibrant && palette.DarkMuted) {\n          var _a = palette.DarkMuted.hsl,\n            h = _a[0],\n            s = _a[1],\n            l = _a[2];\n          l = opts.targetDarkLuma;\n          palette.DarkVibrant = new color_1.Swatch(converter_1.hslToRgb(h, s, l), 0);\n        }\n        if (!palette.LightVibrant && palette.LightMuted) {\n          var _b = palette.LightMuted.hsl,\n            h = _b[0],\n            s = _b[1],\n            l = _b[2];\n          l = opts.targetDarkLuma;\n          palette.DarkVibrant = new color_1.Swatch(converter_1.hslToRgb(h, s, l), 0);\n        }\n      }\n      if (!palette.Vibrant && palette.DarkVibrant) {\n        var _c = palette.DarkVibrant.hsl,\n          h = _c[0],\n          s = _c[1],\n          l = _c[2];\n        l = opts.targetNormalLuma;\n        palette.Vibrant = new color_1.Swatch(converter_1.hslToRgb(h, s, l), 0);\n      } else if (!palette.Vibrant && palette.LightVibrant) {\n        var _d = palette.LightVibrant.hsl,\n          h = _d[0],\n          s = _d[1],\n          l = _d[2];\n        l = opts.targetNormalLuma;\n        palette.Vibrant = new color_1.Swatch(converter_1.hslToRgb(h, s, l), 0);\n      }\n      if (!palette.DarkVibrant && palette.Vibrant) {\n        var _e = palette.Vibrant.hsl,\n          h = _e[0],\n          s = _e[1],\n          l = _e[2];\n        l = opts.targetDarkLuma;\n        palette.DarkVibrant = new color_1.Swatch(converter_1.hslToRgb(h, s, l), 0);\n      }\n      if (!palette.LightVibrant && palette.Vibrant) {\n        var _f = palette.Vibrant.hsl,\n          h = _f[0],\n          s = _f[1],\n          l = _f[2];\n        l = opts.targetLightLuma;\n        palette.LightVibrant = new color_1.Swatch(converter_1.hslToRgb(h, s, l), 0);\n      }\n      if (!palette.Muted && palette.Vibrant) {\n        var _g = palette.Vibrant.hsl,\n          h = _g[0],\n          s = _g[1],\n          l = _g[2];\n        l = opts.targetMutesSaturation;\n        palette.Muted = new color_1.Swatch(converter_1.hslToRgb(h, s, l), 0);\n      }\n      if (!palette.DarkMuted && palette.DarkVibrant) {\n        var _h = palette.DarkVibrant.hsl,\n          h = _h[0],\n          s = _h[1],\n          l = _h[2];\n        l = opts.targetMutesSaturation;\n        palette.DarkMuted = new color_1.Swatch(converter_1.hslToRgb(h, s, l), 0);\n      }\n      if (!palette.LightMuted && palette.LightVibrant) {\n        var _j = palette.LightVibrant.hsl,\n          h = _j[0],\n          s = _j[1],\n          l = _j[2];\n        l = opts.targetMutesSaturation;\n        palette.LightMuted = new color_1.Swatch(converter_1.hslToRgb(h, s, l), 0);\n      }\n    }\n    var DefaultGenerator = function (swatches, opts) {\n      opts = Object.assign({}, DefaultOpts, opts);\n      var maxPopulation = _findMaxPopulation(swatches);\n      var palette = _generateVariationColors(swatches, maxPopulation, opts);\n      _generateEmptySwatches(palette, maxPopulation, opts);\n      return palette;\n    };\n    exports.default = DefaultGenerator;\n\n    /***/\n  }), ( /* 17 */\n  /***/function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      function adopt(value) {\n        return value instanceof P ? value : new P(function (resolve) {\n          resolve(value);\n        });\n      }\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n        function step(result) {\n          result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n        }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n          label: 0,\n          sent: function () {\n            if (t[0] & 1) throw t[1];\n            return t[1];\n          },\n          trys: [],\n          ops: []\n        },\n        f,\n        y,\n        t,\n        g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n            case 7:\n              op = _.ops.pop();\n              _.trys.pop();\n              continue;\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n                _.ops.push(op);\n                break;\n              }\n              if (t[2]) _.ops.pop();\n              _.trys.pop();\n              continue;\n          }\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    exports.BasicPipeline = exports.Stage = void 0;\n    var image_1 = __webpack_require__(2);\n    var Stage = /** @class */function () {\n      function Stage(pipeline) {\n        this.pipeline = pipeline;\n        this._map = {};\n      }\n      Stage.prototype.names = function () {\n        return Object.keys(this._map);\n      };\n      Stage.prototype.has = function (name) {\n        return !!this._map[name];\n      };\n      Stage.prototype.get = function (name) {\n        return this._map[name];\n      };\n      Stage.prototype.register = function (name, stageFn) {\n        this._map[name] = stageFn;\n        return this.pipeline;\n      };\n      return Stage;\n    }();\n    exports.Stage = Stage;\n    var BasicPipeline = /** @class */function () {\n      function BasicPipeline() {\n        this.filter = new Stage(this);\n        this.quantizer = new Stage(this);\n        this.generator = new Stage(this);\n      }\n      BasicPipeline.prototype._buildProcessTasks = function (_a) {\n        var _this = this;\n        var filters = _a.filters,\n          quantizer = _a.quantizer,\n          generators = _a.generators;\n        // Support wildcard for generators\n        if (generators.length === 1 && generators[0] === '*') {\n          generators = this.generator.names();\n        }\n        return {\n          filters: filters.map(function (f) {\n            return createTask(_this.filter, f);\n          }),\n          quantizer: createTask(this.quantizer, quantizer),\n          generators: generators.map(function (g) {\n            return createTask(_this.generator, g);\n          })\n        };\n        function createTask(stage, o) {\n          var name;\n          var options;\n          if (typeof o === 'string') {\n            name = o;\n          } else {\n            name = o.name;\n            options = o.options;\n          }\n          return {\n            name: name,\n            fn: stage.get(name),\n            options: options\n          };\n        }\n      };\n      BasicPipeline.prototype.process = function (imageData, opts) {\n        return __awaiter(this, void 0, void 0, function () {\n          var _a, filters, quantizer, generators, imageFilterData, colors, palettes;\n          return __generator(this, function (_b) {\n            switch (_b.label) {\n              case 0:\n                _a = this._buildProcessTasks(opts), filters = _a.filters, quantizer = _a.quantizer, generators = _a.generators;\n                return [4 /*yield*/, this._filterColors(filters, imageData)];\n              case 1:\n                imageFilterData = _b.sent();\n                return [4 /*yield*/, this._generateColors(quantizer, imageFilterData)];\n              case 2:\n                colors = _b.sent();\n                return [4 /*yield*/, this._generatePalettes(generators, colors)];\n              case 3:\n                palettes = _b.sent();\n                return [2 /*return*/, {\n                  colors: colors,\n                  palettes: palettes\n                }];\n            }\n          });\n        });\n      };\n      BasicPipeline.prototype._filterColors = function (filters, imageData) {\n        return Promise.resolve(image_1.applyFilters(imageData, filters.map(function (_a) {\n          var fn = _a.fn;\n          return fn;\n        })));\n      };\n      BasicPipeline.prototype._generateColors = function (quantizer, imageData) {\n        return Promise.resolve(quantizer.fn(imageData.data, quantizer.options));\n      };\n      BasicPipeline.prototype._generatePalettes = function (generators, colors) {\n        return __awaiter(this, void 0, void 0, function () {\n          var promiseArr;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                return [4 /*yield*/, Promise.all(generators.map(function (_a) {\n                  var fn = _a.fn,\n                    options = _a.options;\n                  return Promise.resolve(fn(colors, options));\n                }))\n                // Map the values to the expected name\n                ];\n              case 1:\n                promiseArr = _a.sent();\n                // Map the values to the expected name\n                return [2 /*return*/, Promise.resolve(promiseArr.reduce(function (promises, promiseVal, i) {\n                  promises[generators[i].name] = promiseVal;\n                  return promises;\n                }, {}))];\n            }\n          });\n        });\n      };\n      return BasicPipeline;\n    }();\n    exports.BasicPipeline = BasicPipeline;\n\n    /***/\n  }\n  /******/)]);\n});","map":{"version":3,"names":["webpackUniversalModuleDefinition","root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","mapValues","mapper","result","v","assignDeep","target","sources","_i","arguments","length","forEach","Array","isArray","slice","options_1","builder_1","__importDefault","utils_1","Vibrant","_src","opts","DefaultOpts","use","pipeline","_pipeline","from","src","default","_result","_process","image","quantizer","scaleDown","processOpts","buildProcessOptions","process","getImageData","palette","swatches","Error","getPalette","_this","arg0","arg1","cb","ImageClass","load","then","generators","palettes","res","remove","undefined","catch","err","Promise","reject","getPalettes","names","colorCount","quality","filters","ImageBase","width","getWidth","height","getHeight","ratio","maxDimension","maxSide","Math","max","resize","applyFilters","imageData","pixels","data","offset","g","b","a","j","converter_1","Swatch","rgb","population","_rgb","_population","colors","filter","_a","clone","swatch","_hsl","rgbToHsl","_hex","rgbToHex","toJSON","getRgb","getHsl","hsl","getPopulation","getHex","hex","getYiq","_yiq","_titleTextColor","_bodyTextColor","getTitleTextColor","titleTextColor","getBodyTextColor","bodyTextColor","DELTAE94_DIFF_STATUS","NA","PERFECT","CLOSE","GOOD","SIMILAR","hexToRgb","exec","RangeError","map","parseInt","toString","min","h","hslToRgb","hue2rgb","q","rgbToXyz","pow","x","y","z","xyzToCIELab","REF_X","REF_Y","REF_Z","L","rgbToCIELab","deltaE94","lab1","lab2","WEIGHT_L","WEIGHT_C","WEIGHT_H","L1","a1","b1","L2","a2","b2","dL","da","db","xC1","sqrt","xC2","xDL","xDC","xDE","xDH","abs","xSC","xSH","rgbDiff","rgb1","rgb2","apply","hexDiff","hex1","hex2","getColorDiffStatus","config_1","image_browser_1","core_1","override","commonQuantizerOpts","options","_1","Builder","_opts","maxColorCount","addFilter","push","removeFilter","indexOf","splice","clearFilters","useImageClass","imageClass","useGenerator","generator","useQuantizer","build","getSwatches","image_1","isRelativeUrl","url","u","URL","location","href","protocol","host","port","isSameOrigin","ua","ub","hostname","BrowserImage","_super","__extends","_initCanvas","img","canvas","_canvas","document","createElement","context","getContext","ReferenceError","_context","className","style","display","_width","_height","drawImage","body","appendChild","crossOrigin","HTMLImageElement","resolve","onImageLoad","complete","onload","onerror","e","clear","clearRect","update","putImageData","targetWidth","targetHeight","scale","getPixelCount","parentNode","removeChild","pipeline_1","quantizer_mmcq_1","generator_default_1","BasicPipeline","register","color_1","vbox_1","pqueue_1","fractByPopulations","_splitBoxes","pq","lastSize","size","vbox","pop","count","split","vbox1","vbox2","MMCQ","histogram","pq2","volume","contents","generateSwatches","color","avg","histogram_1","SIGBITS","RSHIFT","VBox","r1","r2","g1","g2","_volume","_count","dimension","sigBits","rmin","rmax","gmin","gmax","bmin","bmax","invalidate","_avg","hist","getColorIndex","_b","index","ntot","mult","rsum","gsum","bsum","contains","rw","gw","bw","maxw","accSum","sum","total","maxd","Uint32Array","splitPoint","reverseSum","doCut","dim1","dim2","d1","d2","left","right","c2","Histogram","rshift","hn","Number","MAX_VALUE","_colorCount","reduce","PQueue","comparator","_comparator","_sorted","_sort","sort","item","peek","targetDarkLuma","maxDarkLuma","minLightLuma","targetLightLuma","minNormalLuma","targetNormalLuma","maxNormalLuma","targetMutesSaturation","maxMutesSaturation","targetVibrantSaturation","minVibrantSaturation","weightSaturation","weightLuma","weightPopulation","_findMaxPopulation","_isAlreadySelected","DarkVibrant","LightVibrant","Muted","DarkMuted","LightMuted","_createComparisonValue","saturation","targetSaturation","luma","targetLuma","maxPopulation","weightedMean","values","weightSum","weight","invertDiff","targetValue","_findColorVariation","minLuma","maxLuma","minSaturation","maxSaturation","maxValue","_generateVariationColors","_generateEmptySwatches","_c","_d","_e","_f","_g","_h","_j","DefaultGenerator","assign","Stage","_map","keys","has","stageFn","_buildProcessTasks","f","createTask","stage","fn","_filterColors","imageFilterData","sent","_generateColors","_generatePalettes","all","promiseArr","promises","promiseVal"],"sources":["webpack://Vibrant/webpack/universalModuleDefinition","webpack://Vibrant/webpack/bootstrap","webpack://Vibrant/vibrant-core/src/utils.ts","webpack://Vibrant/vibrant-core/src/index.ts","webpack://Vibrant/vibrant-image/src/index.ts","webpack://Vibrant/vibrant-color/src/index.ts","webpack://Vibrant/vibrant-color/src/converter.ts","webpack://Vibrant/src/browser.ts","webpack://Vibrant/src/config.ts","webpack://Vibrant/vibrant-core/src/options.ts","webpack://Vibrant/vibrant-core/src/builder.ts","webpack://Vibrant/vibrant-image-browser/src/index.ts","webpack://Vibrant/src/bundle.ts","webpack://Vibrant/src/pipeline/index.ts","webpack://Vibrant/vibrant-quantizer-mmcq/src/index.ts","webpack://Vibrant/vibrant-quantizer-mmcq/src/vbox.ts","webpack://Vibrant/vibrant-image/src/histogram.ts","webpack://Vibrant/vibrant-quantizer-mmcq/src/pqueue.ts","webpack://Vibrant/vibrant-generator-default/src/index.ts","webpack://Vibrant/vibrant-core/src/pipeline/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Vibrant\"] = factory();\n\telse\n\t\troot[\"Vibrant\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","export function mapValues<T, R> (o: { [key: string]: T }, mapper: (v: T) => R): { [key: string]: R } {\n  let result: { [key: string]: R } = {}\n\n  for (const key in o) {\n    if (o.hasOwnProperty(key)) {\n      const v = o[key]\n      result[key] = mapper(v)\n    }\n  }\n\n  return result\n}\n\n/**\n * Overwrite values or properties on objects and lists recursively.\n * A shallow copy will be created for each array value.\n */\nexport function assignDeep<T> (target: Partial<T>, ...sources: (Partial<T> | undefined)[]): T {\n  sources.forEach(s => {\n    if (!s) return\n    for (const key in s) {\n      if (s.hasOwnProperty(key)) {\n        const v = s[key] as any\n        if (Array.isArray(v)) {\n          // Shallow copy\n          target[key] = v.slice(0) as any\n        } else if (typeof v === 'object') {\n          if (!target[key]) target[key] = {} as any\n          assignDeep<any>(target[key] as any, v)\n        } else {\n          target[key] = v\n        }\n      }\n    }\n  })\n  return target as T\n}\n","import { Options, buildProcessOptions } from './options'\nimport { Callback } from '@vibrant/types'\nimport { Image, ImageSource } from '@vibrant/image'\n\nimport { Filter, Palette, Swatch } from '@vibrant/color'\n\nimport Builder from './builder'\nimport { Pipeline, ProcessOptions, ProcessResult } from './pipeline'\nimport { assignDeep } from './utils'\n\nexport interface VibrantStatic {\n  from (src: ImageSource): Builder\n}\n\nexport default class Vibrant {\n  private _result: ProcessResult\n  private static _pipeline: Pipeline\n  static use (pipeline: Pipeline) {\n    this._pipeline = pipeline\n  }\n  static DefaultOpts: Partial<Options> = {\n    colorCount: 64,\n    quality: 5,\n    filters: []\n  }\n\n  static from (src: ImageSource): Builder {\n    return new Builder(src)\n  }\n\n  get result () {\n    return this._result\n  }\n\n  opts: Options\n  constructor (private _src: ImageSource, opts?: Partial<Options>) {\n    this.opts = assignDeep({}, Vibrant.DefaultOpts, opts)\n  }\n  private _process (\n    image: Image,\n    opts?: Partial<ProcessOptions>\n  ): Promise<ProcessResult> {\n    let { quantizer } = this.opts\n\n    image.scaleDown(this.opts)\n\n    let processOpts = buildProcessOptions(this.opts, opts)\n\n    return Vibrant._pipeline.process(image.getImageData(), processOpts)\n  }\n  palette (): Palette {\n    return this.swatches()\n  }\n  swatches (): Palette {\n    throw new Error(\n      'Method deprecated. Use `Vibrant.result.palettes[name]` instead'\n    )\n  }\n\n  getPalette (name: string, cb?: Callback<Palette>): Promise<Palette>\n  getPalette (cb?: Callback<Palette>): Promise<Palette>\n  getPalette (): Promise<Palette> {\n    const arg0 = arguments[0]\n    const arg1 = arguments[1]\n    const name = typeof arg0 === 'string' ? arg0 : 'default'\n    const cb = typeof arg0 === 'string' ? arg1 : arg0\n    let image = new this.opts.ImageClass()\n    return image\n      .load(this._src)\n      .then(image => this._process(image, { generators: [name] }))\n      .then(result => {\n        this._result = result\n        return result.palettes[name]\n      })\n      .then(res => {\n        image.remove()\n        if (cb) {\n          cb(undefined, res)\n        }\n        return res\n      })\n      .catch(err => {\n        image.remove()\n        if (cb) {\n          cb(err)\n        }\n        return Promise.reject(err)\n      })\n  }\n  getPalettes (\n    names: string[],\n    cb?: Callback<Palette>\n  ): Promise<{ [name: string]: Palette }>\n  getPalettes (cb?: Callback<Palette>): Promise<{ [name: string]: Palette }>\n  getPalettes (): Promise<{ [name: string]: Palette }> {\n    const arg0 = arguments[0]\n    const arg1 = arguments[1]\n    const names = Array.isArray(arg0) ? arg0 : ['*']\n    const cb = Array.isArray(arg0) ? arg1 : arg0\n    let image = new this.opts.ImageClass()\n    return image\n      .load(this._src)\n      .then(image =>\n        this._process(image, {\n          generators: names\n        })\n      )\n      .then(result => {\n        this._result = result\n        return result.palettes\n      })\n      .then(res => {\n        image.remove()\n        if (cb) {\n          cb(undefined, res)\n        }\n        return res\n      })\n      .catch(err => {\n        image.remove()\n        if (cb) {\n          cb(err)\n        }\n        return Promise.reject(err)\n      })\n  }\n}\n","import { Callback } from '@vibrant/types'\nimport { Filter } from '@vibrant/color'\n\nexport type ImageCallback = Callback<Image>\n\nexport type ImageSource = string | HTMLImageElement | Buffer\n\nexport type Pixels = Uint8ClampedArray | Buffer\nexport interface ImageData {\n  data: Pixels,\n  width: number,\n  height: number\n}\n\nexport interface ImageOptions {\n  quality: number\n  maxDimension: number\n}\n\nexport interface Image {\n  load (image: ImageSource): Promise<Image>\n  clear (): void\n  update (imageData: ImageData): void\n  getWidth (): number\n  getHeight (): number\n  resize (targetWidth: number, targetHeight: number, ratio: number): void\n  getPixelCount (): number\n  getImageData (): ImageData\n  remove (): void\n  scaleDown (opts: ImageOptions): void\n}\n\nexport interface ImageClass {\n  new(): Image\n}\n\nexport abstract class ImageBase implements Image {\n  abstract load (image: ImageSource): Promise<ImageBase>\n  abstract clear (): void\n  abstract update (imageData: ImageData): void\n  abstract getWidth (): number\n  abstract getHeight (): number\n  abstract resize (targetWidth: number, targetHeight: number, ratio: number): void\n  abstract getPixelCount (): number\n  abstract getImageData (): ImageData\n  abstract remove (): void\n\n  scaleDown (opts: ImageOptions): void {\n    let width: number = this.getWidth()\n    let height: number = this.getHeight()\n\n    let ratio: number = 1\n\n    if (opts.maxDimension > 0) {\n      let maxSide: number = Math.max(width, height)\n      if (maxSide > opts.maxDimension) ratio = opts.maxDimension / maxSide\n    } else {\n      ratio = 1 / opts.quality\n    }\n\n    if (ratio < 1) this.resize(width * ratio, height * ratio, ratio)\n  }\n}\n\nexport function applyFilters (imageData: ImageData, filters: Filter[]) {\n  if (filters.length > 0) {\n    let pixels = imageData.data\n    let n = pixels.length / 4\n    let offset\n    let r\n    let g\n    let b\n    let a\n    for (let i = 0; i < n; i++) {\n      offset = i * 4\n      r = pixels[offset + 0]\n      g = pixels[offset + 1]\n      b = pixels[offset + 2]\n      a = pixels[offset + 3]\n      // Mark ignored color\n      for (let j = 0; j < filters.length; j++) {\n        if (!filters[j](r, g, b, a)) {\n          pixels[offset + 3] = 0\n          break\n        }\n      }\n    }\n  }\n\n  return imageData\n}\n","import { rgbToHsl, rgbToHex } from './converter'\n\nexport interface Filter {\n  (red: number, green: number, blue: number, alpha: number): boolean\n}\n\n/**\n * 3d floating pointer vector\n */\nexport type Vec3 = [number, number, number]\n\n/**\n * The layout for a node-vibrant Palette. Allows you to keep track of\n */\nexport interface Palette {\n  Vibrant: Swatch | null\n  Muted: Swatch | null\n  DarkVibrant: Swatch | null\n  DarkMuted: Swatch | null\n  LightVibrant: Swatch | null\n  LightMuted: Swatch | null\n  // ?\n  [name: string]: Swatch | null\n}\n\nexport class Swatch {\n  static applyFilters (colors: Swatch[], filters: Filter[]): Swatch[] {\n    return filters.length > 0\n      ? colors.filter(({ r, g, b }) => {\n        for (let j = 0; j < filters.length; j++) {\n          if (!filters[j](r, g, b, 255)) return false\n        }\n        return true\n      })\n      : colors\n  }\n\n  /**\n   * Make a value copy of a swatch based on a previous one. Returns a new Swatch instance\n   * @param {Swatch} swatch\n   */\n  static clone (swatch: Swatch) {\n    return new Swatch(swatch._rgb, swatch._population)\n  }\n  private _hsl: Vec3\n  private _rgb: Vec3\n  private _yiq: number\n  private _population: number\n  private _hex: string\n\n  /**\n   * The red value in the RGB value\n   */\n  get r (): number {\n    return this._rgb[0]\n  }\n  /**\n   * The green value in the RGB value\n   */\n  get g (): number {\n    return this._rgb[1]\n  }\n  /**\n   * The blue value in the RGB value\n   */\n  get b (): number {\n    return this._rgb[2]\n  }\n  /**\n   * The color value as a rgb value\n   */\n  get rgb (): Vec3 {\n    return this._rgb\n  }\n  /**\n   * The color value as a hsl value\n   */\n  get hsl (): Vec3 {\n    if (!this._hsl) {\n      let [r, g, b] = this._rgb\n      this._hsl = rgbToHsl(r, g, b)\n    }\n    return this._hsl\n  }\n\n  /**\n   * The color value as a hex string\n   */\n  get hex (): string {\n    if (!this._hex) {\n      let [r, g, b] = this._rgb\n      this._hex = rgbToHex(r, g, b)\n    }\n    return this._hex\n  }\n  get population (): number {\n    return this._population\n  }\n\n  /**\n   * Get the JSON object for the swatch\n   */\n  toJSON (): {rgb: Vec3, population: number} {\n    return {\n      rgb: this.rgb,\n      population: this.population\n    }\n  }\n\n  /**\n   * Get the color value as a rgb value\n   * @deprecated Use property instead\n   */\n  // TODO: deprecate internally, use property instead\n  getRgb (): Vec3 {\n    return this._rgb\n  }\n  /**\n   * Get the color value as a hsl value\n   * @deprecated Use property instead\n   */\n  // TODO: deprecate internally, use property instead\n  getHsl (): Vec3 {\n    return this.hsl\n  }\n  /**\n   * @deprecated Use property instead\n   */\n  // TODO: deprecate internally, use property instead\n  getPopulation (): number {\n    return this._population\n  }\n  /**\n   * Get the color value as a hex string\n   * @deprecated Use property instead\n   */\n  // TODO: deprecate internally, use property instead\n  getHex (): string {\n    return this.hex\n  }\n\n  private getYiq (): number {\n    if (!this._yiq) {\n      let rgb = this._rgb\n      this._yiq = (rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000\n    }\n    return this._yiq\n  }\n\n  private _titleTextColor: string\n  private _bodyTextColor: string\n\n  get titleTextColor () {\n    if (this._titleTextColor) {\n      this._titleTextColor = this.getYiq() < 200 ? '#fff' : '#000'\n    }\n    return this._titleTextColor\n  }\n  get bodyTextColor () {\n    if (this._bodyTextColor) {\n      this._bodyTextColor = this.getYiq() < 150 ? '#fff' : '#000'\n    }\n    return this._bodyTextColor\n  }\n  getTitleTextColor (): string {\n    return this.titleTextColor\n  }\n\n  getBodyTextColor (): string {\n    return this.bodyTextColor\n  }\n\n  constructor (rgb: Vec3, population: number) {\n    this._rgb = rgb\n    this._population = population\n  }\n}\n","import { Vec3 } from './'\n\nexport const DELTAE94_DIFF_STATUS = {\n  NA: 0,\n  PERFECT: 1,\n  CLOSE: 2,\n  GOOD: 10,\n  SIMILAR: 50\n}\n\n/**\n * Converts hex string to RGB\n * @param hex - The hex value you with to get the RGB value of\n * @returns an array in the order of `red, green, blue` numerical values\n */\nexport function hexToRgb (hex: string): Vec3 {\n  let m = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex)\n\n  if (!m) throw new RangeError(`'${hex}' is not a valid hex color`)\n\n  return [m[1], m[2], m[3]].map((s) => parseInt(s, 16)) as Vec3\n}\n\n/**\n * Given values for an RGB color convert to and return a valid HEX string\n * @param r - Red value in RGB\n * @param g - Green value in RGB\n * @param b - Blue value in RGB\n * @returns a valid hex string with pre-pending pound sign\n */\nexport function rgbToHex (r: number, g: number, b: number): string {\n  return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1, 7)\n}\n\n/**\n * Given values for an RGB color convert to and return a valid HSL value\n * @param r - Red value in RGB\n * @param g - Green value in RGB\n * @param b - Blue value in RGB\n * @returns an array in the order of `hue, saturation, light` numerical values\n */\nexport function rgbToHsl (r: number, g: number, b: number): Vec3 {\n  r /= 255\n  g /= 255\n  b /= 255\n  let max = Math.max(r, g, b)\n  let min = Math.min(r, g, b)\n  let h: number = 0\n  let s: number = 0\n  let l = (max + min) / 2\n  if (max !== min) {\n    let d = max - min\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min)\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0)\n        break\n      case g:\n        h = (b - r) / d + 2\n        break\n      case b:\n        h = (r - g) / d + 4\n        break\n    }\n\n    h /= 6\n  }\n  return [h, s, l]\n}\n\nexport function hslToRgb (h: number, s: number, l: number): Vec3 {\n  let r: number\n  let g: number\n  let b: number\n\n  function hue2rgb (p: number, q: number, t: number): number {\n    if (t < 0) t += 1\n    if (t > 1) t -= 1\n    if (t < 1 / 6) return p + (q - p) * 6 * t\n    if (t < 1 / 2) return q\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\n    return p\n  }\n\n  if (s === 0) {\n    r = g = b = l\n  } else {\n    let q = l < 0.5 ? l * (1 + s) : l + s - (l * s)\n    let p = 2 * l - q\n    r = hue2rgb(p, q, h + 1 / 3)\n    g = hue2rgb(p, q, h)\n    b = hue2rgb(p, q, h - (1 / 3))\n  }\n  return [\n    r * 255,\n    g * 255,\n    b * 255\n  ]\n}\n\nexport function rgbToXyz (r: number, g: number, b: number): Vec3 {\n  r /= 255\n  g /= 255\n  b /= 255\n  r = r > 0.04045 ? Math.pow((r + 0.005) / 1.055, 2.4) : r / 12.92\n  g = g > 0.04045 ? Math.pow((g + 0.005) / 1.055, 2.4) : g / 12.92\n  b = b > 0.04045 ? Math.pow((b + 0.005) / 1.055, 2.4) : b / 12.92\n\n  r *= 100\n  g *= 100\n  b *= 100\n\n  let x = r * 0.4124 + g * 0.3576 + b * 0.1805\n  let y = r * 0.2126 + g * 0.7152 + b * 0.0722\n  let z = r * 0.0193 + g * 0.1192 + b * 0.9505\n\n  return [x, y, z]\n}\n\nexport function xyzToCIELab (x: number, y: number, z: number): Vec3 {\n  let REF_X = 95.047\n  let REF_Y = 100\n  let REF_Z = 108.883\n\n  x /= REF_X\n  y /= REF_Y\n  z /= REF_Z\n\n  x = x > 0.008856 ? Math.pow(x, 1 / 3) : 7.787 * x + 16 / 116\n  y = y > 0.008856 ? Math.pow(y, 1 / 3) : 7.787 * y + 16 / 116\n  z = z > 0.008856 ? Math.pow(z, 1 / 3) : 7.787 * z + 16 / 116\n\n  let L = 116 * y - 16\n  let a = 500 * (x - y)\n  let b = 200 * (y - z)\n\n  return [L, a, b]\n}\n\nexport function rgbToCIELab (r: number, g: number, b: number): Vec3 {\n  let [x, y, z] = rgbToXyz(r, g, b)\n  return xyzToCIELab(x, y, z)\n}\n\nexport function deltaE94 (lab1: Vec3, lab2: Vec3): number {\n  let WEIGHT_L = 1\n  let WEIGHT_C = 1\n  let WEIGHT_H = 1\n\n  let [L1, a1, b1] = lab1\n  let [L2, a2, b2] = lab2\n  let dL = L1 - L2\n  let da = a1 - a2\n  let db = b1 - b2\n\n  let xC1 = Math.sqrt(a1 * a1 + b1 * b1)\n  let xC2 = Math.sqrt(a2 * a2 + b2 * b2)\n\n  let xDL = L2 - L1\n  let xDC = xC2 - xC1\n  let xDE = Math.sqrt(dL * dL + da * da + db * db)\n\n  let xDH = (Math.sqrt(xDE) > Math.sqrt(Math.abs(xDL)) + Math.sqrt(Math.abs(xDC)))\n    ? Math.sqrt(xDE * xDE - xDL * xDL - xDC * xDC)\n    : 0\n\n  let xSC = 1 + 0.045 * xC1\n  let xSH = 1 + 0.015 * xC1\n\n  xDL /= WEIGHT_L\n  xDC /= WEIGHT_C * xSC\n  xDH /= WEIGHT_H * xSH\n\n  return Math.sqrt(xDL * xDL + xDC * xDC + xDH * xDH)\n}\n\nexport function rgbDiff (rgb1: Vec3, rgb2: Vec3): number {\n  let lab1 = rgbToCIELab.apply(undefined, rgb1)\n  let lab2 = rgbToCIELab.apply(undefined, rgb2)\n  return deltaE94(lab1, lab2)\n}\n\nexport function hexDiff (hex1: string, hex2: string): number {\n  let rgb1 = hexToRgb(hex1)\n  let rgb2 = hexToRgb(hex2)\n\n  return rgbDiff(rgb1, rgb2)\n}\n\nexport function getColorDiffStatus (d: number): string {\n  if (d < DELTAE94_DIFF_STATUS.NA) {\n    return 'N/A'\n  }\n  // Not perceptible by human eyes\n  if (d <= DELTAE94_DIFF_STATUS.PERFECT) {\n    return 'Perfect'\n  }\n  // Perceptible through close observation\n  if (d <= DELTAE94_DIFF_STATUS.CLOSE) {\n    return 'Close'\n  }\n  // Perceptible at a glance\n  if (d <= DELTAE94_DIFF_STATUS.GOOD) {\n    return 'Good'\n  }\n  // Colors are more similar than opposite\n  if (d < DELTAE94_DIFF_STATUS.SIMILAR) {\n    return 'Similar'\n  }\n  return 'Wrong'\n\n}\n","import Vibrant from './config'\nimport BrowserImage from '@vibrant/image-browser'\n\nVibrant.DefaultOpts.ImageClass = BrowserImage\n\nexport = Vibrant\n","import Vibrant from '@vibrant/core'\n\nVibrant.DefaultOpts.quantizer = 'mmcq'\nVibrant.DefaultOpts.generators = ['default']\nVibrant.DefaultOpts.filters = ['default']\n\nexport default Vibrant\n","import { Palette, Swatch, Filter } from '@vibrant/color'\nimport { Image, ImageClass, ImageSource, ImageOptions } from '@vibrant/image'\nimport { Quantizer, QuantizerOptions } from '@vibrant/quantizer'\nimport { Generator } from '@vibrant/generator'\nimport { StageOptions, ProcessOptions } from './pipeline'\nimport { assignDeep } from './utils'\n\nexport interface Options extends ImageOptions, QuantizerOptions {\n  useWorker: boolean\n  ImageClass: ImageClass\n  quantizer: string | StageOptions\n  generators: (string | StageOptions)[]\n  filters: string[]\n}\n\nexport function buildProcessOptions (opts: Options, override?: Partial<ProcessOptions>): ProcessOptions {\n  let { colorCount, quantizer, generators, filters } = opts\n  // Merge with common quantizer options\n  let commonQuantizerOpts = { colorCount }\n  let q = typeof quantizer === 'string'\n    ? { name: quantizer, options: {} }\n    : quantizer\n  q.options = assignDeep({}, commonQuantizerOpts, q.options)\n\n  return assignDeep({}, {\n    quantizer: q,\n    generators,\n    filters\n  }, override)\n}\n","import {\n  Options\n} from './options'\nimport {\n  Callback\n} from '@vibrant/types'\nimport {\n  ImageClass,\n  ImageSource\n} from '@vibrant/image'\n\nimport {\n  Filter,\n  Palette\n} from '@vibrant/color'\nimport Vibrant from './'\nimport { assignDeep } from './utils'\n\nexport default class Builder {\n  private _src: ImageSource\n  private _opts: Partial<Options>\n  constructor (src: ImageSource, opts: Partial<Options> = {}) {\n    this._src = src\n    this._opts = assignDeep({}, Vibrant.DefaultOpts, opts)\n  }\n\n  maxColorCount (n: number): Builder {\n    this._opts.colorCount = n\n    return this\n  }\n\n  maxDimension (d: number): Builder {\n    this._opts.maxDimension = d\n    return this\n  }\n\n  addFilter (name: string): Builder {\n    if (!this._opts.filters) {\n      this._opts.filters = [name]\n    } else {\n      this._opts.filters.push(name)\n    }\n    return this\n  }\n\n  removeFilter (name: string): Builder {\n    if (this._opts.filters) {\n      let i = this._opts.filters.indexOf(name)\n      if (i > 0) this._opts.filters.splice(i)\n    }\n    return this\n  }\n\n  clearFilters (): Builder {\n    this._opts.filters = []\n    return this\n  }\n\n  quality (q: number): Builder {\n    this._opts.quality = q\n    return this\n  }\n\n  useImageClass (imageClass: ImageClass): Builder {\n    this._opts.ImageClass = imageClass\n    return this\n  }\n\n  useGenerator (generator: string, options?: any): Builder {\n    if (!this._opts.generators) this._opts.generators = []\n    this._opts.generators.push(options ? { name: generator, options } : generator)\n    return this\n  }\n\n  useQuantizer (quantizer: string, options?: any): Builder {\n    this._opts.quantizer = options ? { name: quantizer, options } : quantizer\n    return this\n  }\n\n  build (): Vibrant {\n    return new Vibrant(this._src, this._opts)\n  }\n\n  getPalette (cb?: Callback<Palette>): Promise<Palette> {\n    return this.build().getPalette(cb)\n  }\n  getSwatches (cb?: Callback<Palette>): Promise<Palette> {\n    return this.build().getPalette(cb)\n  }\n}\n","import {\n  ImageOptions,\n  ImageData as VibrantImageData,\n  ImageSource,\n  ImageCallback,\n  ImageBase\n} from '@vibrant/image'\n\nfunction isRelativeUrl (url: string): boolean {\n  let u = new URL(url, location.href)\n  return u.protocol === location.protocol &&\n    u.host === location.host &&\n    u.port === location.port\n}\n\nfunction isSameOrigin (a: string, b: string): boolean {\n  let ua = new URL(a)\n  let ub = new URL(b)\n\n  // https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\n  return (\n    ua.protocol === ub.protocol &&\n    ua.hostname === ub.hostname &&\n    ua.port === ub.port\n  )\n}\n\nexport default class BrowserImage extends ImageBase {\n  image: HTMLImageElement\n  private _canvas: HTMLCanvasElement\n  private _context: CanvasRenderingContext2D\n  private _width: number\n  private _height: number\n  private _initCanvas (): void {\n    const img = this.image\n    const canvas = (this._canvas = document.createElement('canvas'))\n    const context = (canvas.getContext('2d'))\n\n    if (!context) throw new ReferenceError('Failed to create canvas context')\n\n    this._context = context\n\n    canvas.className = '@vibrant/canvas'\n    canvas.style.display = 'none'\n\n    this._width = canvas.width = img.width\n    this._height = canvas.height = img.height\n\n    context.drawImage(img, 0, 0)\n\n    document.body.appendChild(canvas)\n  }\n  load (image: ImageSource): Promise<ImageBase> {\n    let img: HTMLImageElement\n    let src: string\n    if (typeof image === 'string') {\n      img = document.createElement('img')\n      src = image\n\n      if (!isRelativeUrl(src) && !isSameOrigin(window.location.href, src)) {\n        img.crossOrigin = 'anonymous'\n      }\n\n      img.src = src\n    } else if (image instanceof HTMLImageElement) {\n      img = image\n      src = image.src\n    } else {\n      return Promise.reject(\n        new Error(`Cannot load buffer as an image in browser`)\n      )\n    }\n    this.image = img\n\n    return new Promise<ImageBase>((resolve, reject) => {\n      let onImageLoad = () => {\n        this._initCanvas()\n        resolve(this)\n      }\n\n      if (img.complete) {\n        // Already loaded\n        onImageLoad()\n      } else {\n        img.onload = onImageLoad\n        img.onerror = e => reject(new Error(`Fail to load image: ${src}`))\n      }\n    })\n  }\n  clear (): void {\n    this._context.clearRect(0, 0, this._width, this._height)\n  }\n  update (imageData: VibrantImageData): void {\n    this._context.putImageData(imageData as ImageData, 0, 0)\n  }\n  getWidth (): number {\n    return this._width\n  }\n  getHeight (): number {\n    return this._height\n  }\n  resize (targetWidth: number, targetHeight: number, ratio: number): void {\n    let { _canvas: canvas, _context: context, image: img } = this\n\n    this._width = canvas.width = targetWidth\n    this._height = canvas.height = targetHeight\n\n    context.scale(ratio, ratio)\n    context.drawImage(img, 0, 0)\n  }\n  getPixelCount (): number {\n    return this._width * this._height\n  }\n  getImageData (): ImageData {\n    return this._context.getImageData(0, 0, this._width, this._height)\n  }\n  remove (): void {\n    if (this._canvas && this._canvas.parentNode) {\n      this._canvas.parentNode.removeChild(this._canvas)\n    }\n  }\n}\n","import Vibrant = require('./browser')\nimport pipeline from './pipeline'\n\nVibrant.use(pipeline)\n\nexport = Vibrant\n","import MMCQ from '@vibrant/quantizer-mmcq'\nimport DefaultGenerator from '@vibrant/generator-default'\n\nimport { BasicPipeline } from '@vibrant/core/lib/pipeline'\n\nconst pipeline = new BasicPipeline()\n  .filter.register('default', (r: number, g: number, b: number, a: number) =>\n    a >= 125\n    && !(r > 250 && g > 250 && b > 250)\n  )\n  .quantizer.register('mmcq', MMCQ)\n  .generator.register('default', DefaultGenerator)\n\nexport default pipeline\n","import { Quantizer, QuantizerOptions } from '@vibrant/quantizer'\nimport {\n  Pixels\n} from '@vibrant/image'\nimport { Filter, Swatch } from '@vibrant/color'\nimport VBox from './vbox'\nimport PQueue from './pqueue'\n\nconst fractByPopulations = 0.75\n\nfunction _splitBoxes (pq: PQueue<VBox>, target: number): void {\n  let lastSize = pq.size()\n  while (pq.size() < target) {\n    let vbox = pq.pop()\n\n    if (vbox && vbox.count() > 0) {\n      let [vbox1, vbox2] = vbox.split()\n\n      pq.push(vbox1)\n      if (vbox2 && vbox2.count() > 0) pq.push(vbox2)\n\n      // No more new boxes, converged\n      if (pq.size() === lastSize) {\n        break\n      } else {\n        lastSize = pq.size()\n      }\n    } else {\n      break\n    }\n  }\n}\n\nconst MMCQ = (pixels: Pixels, opts: QuantizerOptions): Array<Swatch> => {\n  if (pixels.length === 0 || opts.colorCount < 2 || opts.colorCount > 256) {\n    throw new Error('Wrong MMCQ parameters')\n  }\n\n  let vbox = VBox.build(pixels)\n  let colorCount = vbox.histogram.colorCount\n  let pq = new PQueue<VBox>((a, b) => a.count() - b.count())\n\n  pq.push(vbox)\n\n  // first set of colors, sorted by population\n  _splitBoxes(pq, fractByPopulations * opts.colorCount)\n\n  // Re-order\n  let pq2 = new PQueue<VBox>((a, b) => a.count() * a.volume() - b.count() * b.volume())\n  pq2.contents = pq.contents\n\n  // next set - generate the median cuts using the (npix * vol) sorting.\n  _splitBoxes(pq2, opts.colorCount - pq2.size())\n\n  // calculate the actual colors\n  return generateSwatches(pq2)\n}\n\nfunction generateSwatches (pq: PQueue<VBox>) {\n  let swatches: Swatch[] = []\n  while (pq.size()) {\n    let v = pq.pop()!\n    let color = v.avg()\n    let [r, g, b] = color\n    swatches.push(new Swatch(color, v.count()))\n  }\n  return swatches\n}\n\nexport default MMCQ\n","import { Vec3, Filter } from '@vibrant/color'\nimport { Pixels } from '@vibrant/image'\nimport Histogram from '@vibrant/image/lib/histogram'\nexport interface Dimension {\n  r1: number\n  r2: number\n  g1: number\n  g2: number\n  b1: number\n  b2: number\n  [d: string]: number\n}\n\nconst SIGBITS = 5\nconst RSHIFT = 8 - SIGBITS\n\nexport default class VBox {\n  static build (pixels: Pixels): VBox {\n    let h = new Histogram(pixels, { sigBits: SIGBITS })\n    let { rmin, rmax, gmin, gmax, bmin, bmax } = h\n    return new VBox(rmin, rmax, gmin, gmax, bmin, bmax, h)\n  }\n\n  dimension: Dimension\n\n  private _volume = -1\n  private _avg: Vec3 | null\n  private _count = -1\n\n  constructor (\n    r1: number, r2: number,\n    g1: number, g2: number,\n    b1: number, b2: number,\n    public histogram: Histogram\n  ) {\n    // NOTE: dimension will be mutated by split operation.\n    //       It must be specified explicitly, not from histogram\n    this.dimension = { r1, r2, g1, g2, b1, b2 }\n  }\n\n  invalidate (): void {\n    this._volume = this._count = -1\n    this._avg = null\n  }\n\n  volume (): number {\n    if (this._volume < 0) {\n      let { r1, r2, g1, g2, b1, b2 } = this.dimension\n      this._volume = (r2 - r1 + 1) * (g2 - g1 + 1) * (b2 - b1 + 1)\n    }\n    return this._volume\n  }\n\n  count (): number {\n    if (this._count < 0) {\n      let { hist, getColorIndex } = this.histogram\n      let { r1, r2, g1, g2, b1, b2 } = this.dimension\n      let c = 0\n\n      for (let r = r1; r <= r2; r++) {\n        for (let g = g1; g <= g2; g++) {\n          for (let b = b1; b <= b2; b++) {\n            let index = getColorIndex(r, g, b)\n            c += hist[index]\n          }\n        }\n      }\n      this._count = c\n    }\n    return this._count\n  }\n\n  clone (): VBox {\n    let { histogram } = this\n    let { r1, r2, g1, g2, b1, b2 } = this.dimension\n    return new VBox(r1, r2, g1, g2, b1, b2, histogram)\n  }\n\n  avg (): Vec3 {\n    if (!this._avg) {\n      let { hist, getColorIndex } = this.histogram\n      let { r1, r2, g1, g2, b1, b2 } = this.dimension\n      let ntot = 0\n      let mult = 1 << (8 - SIGBITS)\n      let rsum: number\n      let gsum: number\n      let bsum: number\n      rsum = gsum = bsum = 0\n\n      for (let r = r1; r <= r2; r++) {\n        for (let g = g1; g <= g2; g++) {\n          for (let b = b1; b <= b2; b++) {\n            let index = getColorIndex(r, g, b)\n            let h = hist[index]\n            ntot += h\n            rsum += (h * (r + 0.5) * mult)\n            gsum += (h * (g + 0.5) * mult)\n            bsum += (h * (b + 0.5) * mult)\n          }\n        }\n      }\n      if (ntot) {\n        this._avg = [\n          ~~(rsum / ntot),\n          ~~(gsum / ntot),\n          ~~(bsum / ntot)\n        ]\n      } else {\n        this._avg = [\n          ~~(mult * (r1 + r2 + 1) / 2),\n          ~~(mult * (g1 + g2 + 1) / 2),\n          ~~(mult * (b1 + b2 + 1) / 2)\n        ]\n      }\n\n    }\n    return this._avg\n  }\n\n  contains (rgb: Vec3): boolean {\n    let [r, g, b] = rgb\n    let { r1, r2, g1, g2, b1, b2 } = this.dimension\n    r >>= RSHIFT\n    g >>= RSHIFT\n    b >>= RSHIFT\n\n    return r >= r1 && r <= r2\n      && g >= g1 && g <= g2\n      && b >= b1 && b <= b2\n  }\n\n  split (): VBox[] {\n    let { hist, getColorIndex } = this.histogram\n    let { r1, r2, g1, g2, b1, b2 } = this.dimension\n    let count = this.count()\n    if (!count) return []\n    if (count === 1) return [this.clone()]\n    let rw = r2 - r1 + 1\n    let gw = g2 - g1 + 1\n    let bw = b2 - b1 + 1\n\n    let maxw = Math.max(rw, gw, bw)\n    let accSum: Uint32Array | null = null\n    let sum: number\n    let total: number\n    sum = total = 0\n\n    let maxd: 'r' | 'g' | 'b' | null = null\n\n    if (maxw === rw) {\n      maxd = 'r'\n      accSum = new Uint32Array(r2 + 1)\n      for (let r = r1; r <= r2; r++) {\n        sum = 0\n        for (let g = g1; g <= g2; g++) {\n          for (let b = b1; b <= b2; b++) {\n            let index = getColorIndex(r, g, b)\n            sum += hist[index]\n          }\n        }\n        total += sum\n        accSum[r] = total\n      }\n    } else if (maxw === gw) {\n      maxd = 'g'\n      accSum = new Uint32Array(g2 + 1)\n      for (let g = g1; g <= g2; g++) {\n        sum = 0\n        for (let r = r1; r <= r2; r++) {\n          for (let b = b1; b <= b2; b++) {\n            let index = getColorIndex(r, g, b)\n            sum += hist[index]\n          }\n        }\n        total += sum\n        accSum[g] = total\n      }\n    } else {\n      maxd = 'b'\n      accSum = new Uint32Array(b2 + 1)\n      for (let b = b1; b <= b2; b++) {\n        sum = 0\n        for (let r = r1; r <= r2; r++) {\n          for (let g = g1; g <= g2; g++) {\n            let index = getColorIndex(r, g, b)\n            sum += hist[index]\n          }\n        }\n        total += sum\n        accSum[b] = total\n      }\n    }\n\n    let splitPoint = -1\n    let reverseSum = new Uint32Array(accSum.length)\n    for (let i = 0; i < accSum.length; i++) {\n      let d = accSum[i]\n      if (splitPoint < 0 && d > total / 2) splitPoint = i\n      reverseSum[i] = total - d\n    }\n\n    let vbox = this\n\n    function doCut (d: string): VBox[] {\n      let dim1 = d + '1'\n      let dim2 = d + '2'\n      let d1 = vbox.dimension[dim1]\n      let d2 = vbox.dimension[dim2]\n      let vbox1 = vbox.clone()\n      let vbox2 = vbox.clone()\n      let left = splitPoint - d1\n      let right = d2 - splitPoint\n      if (left <= right) {\n        d2 = Math.min(d2 - 1, ~~(splitPoint + right / 2))\n        d2 = Math.max(0, d2)\n      } else {\n        d2 = Math.max(d1, ~~(splitPoint - 1 - left / 2))\n        d2 = Math.min(vbox.dimension[dim2], d2)\n      }\n\n      while (!accSum![d2]) d2++\n\n      let c2 = reverseSum[d2]\n      while (!c2 && accSum![d2 - 1]) c2 = reverseSum[--d2]\n\n      vbox1.dimension[dim2] = d2\n      vbox2.dimension[dim1] = d2 + 1\n\n      return [vbox1, vbox2]\n    }\n\n    return doCut(maxd)\n  }\n\n}\n","import { Pixels } from './index'\n\nexport interface HistogramOptions {\n  sigBits: number\n}\n\nexport default class Histogram {\n  bmin: number\n  bmax: number\n  gmin: number\n  gmax: number\n  rmin: number\n  rmax: number\n  hist: Uint32Array\n  private _colorCount: number\n  get colorCount () { return this._colorCount }\n  getColorIndex: (r: number, g: number, b: number) => number\n  constructor (public pixels: Pixels, public opts: HistogramOptions) {\n    const { sigBits } = opts\n    const getColorIndex = (r: number, g: number, b: number) =>\n      (r << (2 * sigBits)) + (g << sigBits) + b\n\n    this.getColorIndex = getColorIndex\n\n    const rshift = 8 - sigBits\n    const hn = 1 << (3 * sigBits)\n    let hist = new Uint32Array(hn)\n    let rmax: number\n    let rmin: number\n    let gmax: number\n    let gmin: number\n    let bmax: number\n    let bmin: number\n    let r: number\n    let g: number\n    let b: number\n    let a: number\n    rmax = gmax = bmax = 0\n    rmin = gmin = bmin = Number.MAX_VALUE\n    let n = pixels.length / 4\n    let i = 0\n\n    while (i < n) {\n\n      let offset = i * 4\n      i++\n      r = pixels[offset + 0]\n      g = pixels[offset + 1]\n      b = pixels[offset + 2]\n      a = pixels[offset + 3]\n\n      // Ignored pixels' alpha is marked as 0 in filtering stage\n      if (a === 0) continue\n\n      r = r >> rshift\n      g = g >> rshift\n      b = b >> rshift\n\n      let index = getColorIndex(r, g, b)\n      hist[index] += 1\n\n      if (r > rmax) rmax = r\n      if (r < rmin) rmin = r\n      if (g > gmax) gmax = g\n      if (g < gmin) gmin = g\n      if (b > bmax) bmax = b\n      if (b < bmin) bmin = b\n    }\n    this._colorCount = hist.reduce((total, c) => c > 0 ? total + 1 : total, 0)\n    this.hist = hist\n    this.rmax = rmax\n    this.rmin = rmin\n    this.gmax = gmax\n    this.gmin = gmin\n    this.bmax = bmax\n    this.bmin = bmin\n  }\n}\n","export interface PQueueComparator<T> {\n  (a: T, b: T): number\n}\n\nexport default class PQueue<T> {\n  contents: T[]\n  private _sorted: boolean\n  private _comparator: PQueueComparator<T>\n  private _sort (): void {\n    if (!this._sorted) {\n      this.contents.sort(this._comparator)\n      this._sorted = true\n    }\n  }\n\n  constructor (comparator: PQueueComparator<T>) {\n    this._comparator = comparator\n    this.contents = []\n    this._sorted = false\n  }\n\n  push (item: T): void {\n    this.contents.push(item)\n    this._sorted = false\n  }\n\n  peek (index?: number): T {\n    this._sort()\n    index = typeof index === 'number' ? index : this.contents.length - 1\n    return this.contents[index]\n  }\n\n  pop () {\n    this._sort()\n    return this.contents.pop()\n  }\n\n  size (): number {\n    return this.contents.length\n  }\n\n  map<U> (mapper: (item: T, index: number) => any): U[] {\n    this._sort()\n    return this.contents.map(mapper)\n  }\n}\n","import { Swatch, Palette } from '@vibrant/color'\nimport { Generator } from '@vibrant/generator'\nimport { hslToRgb } from '@vibrant/color/lib/converter'\n\ninterface DefaultGeneratorOptions {\n  targetDarkLuma: number,\n  maxDarkLuma: number,\n  minLightLuma: number,\n  targetLightLuma: number,\n  minNormalLuma: number,\n  targetNormalLuma: number,\n  maxNormalLuma: number,\n  targetMutesSaturation: number,\n  maxMutesSaturation: number,\n  targetVibrantSaturation: number,\n  minVibrantSaturation: number,\n  weightSaturation: number,\n  weightLuma: number,\n  weightPopulation: number\n}\n\nconst DefaultOpts: DefaultGeneratorOptions = {\n  targetDarkLuma: 0.26,\n  maxDarkLuma: 0.45,\n  minLightLuma: 0.55,\n  targetLightLuma: 0.74,\n  minNormalLuma: 0.3,\n  targetNormalLuma: 0.5,\n  maxNormalLuma: 0.7,\n  targetMutesSaturation: 0.3,\n  maxMutesSaturation: 0.4,\n  targetVibrantSaturation: 1.0,\n  minVibrantSaturation: 0.35,\n  weightSaturation: 3,\n  weightLuma: 6.5,\n  weightPopulation: 0.5\n}\n\nfunction _findMaxPopulation (swatches: Array<Swatch>): number {\n  let p = 0\n\n  swatches.forEach((s) => {\n    p = Math.max(p, s.population)\n  })\n\n  return p\n}\n\nfunction _isAlreadySelected (palette: Palette, s: Swatch): boolean {\n  return palette.Vibrant === s\n    || palette.DarkVibrant === s\n    || palette.LightVibrant === s\n    || palette.Muted === s\n    || palette.DarkMuted === s\n    || palette.LightMuted === s\n}\n\nfunction _createComparisonValue (\n  saturation: number, targetSaturation: number,\n  luma: number, targetLuma: number,\n  population: number, maxPopulation: number, opts: DefaultGeneratorOptions): number {\n\n  function weightedMean (...values: number[]) {\n    let sum = 0\n    let weightSum = 0\n    for (let i = 0; i < values.length; i += 2) {\n      let value = values[i]\n      let weight = values[i + 1]\n      sum += value * weight\n      weightSum += weight\n    }\n\n    return sum / weightSum\n  }\n\n  function invertDiff (value: number, targetValue: number): number {\n    return 1 - Math.abs(value - targetValue)\n  }\n\n  return weightedMean(\n    invertDiff(saturation, targetSaturation), opts.weightSaturation,\n    invertDiff(luma, targetLuma), opts.weightLuma,\n    population / maxPopulation, opts.weightPopulation\n  )\n\n}\n\nfunction _findColorVariation (palette: Palette, swatches: Array<Swatch>, maxPopulation: number,\n  targetLuma: number,\n  minLuma: number,\n  maxLuma: number,\n  targetSaturation: number,\n  minSaturation: number,\n  maxSaturation: number,\n  opts: DefaultGeneratorOptions): Swatch | null {\n\n  let max: Swatch | null = null\n  let maxValue = 0\n\n  swatches.forEach((swatch) => {\n    let [, s, l] = swatch.hsl\n\n    if (s >= minSaturation && s <= maxSaturation\n      && l >= minLuma && l <= maxLuma\n      && !_isAlreadySelected(palette, swatch)\n    ) {\n      let value = _createComparisonValue(s, targetSaturation, l, targetLuma, swatch.population, maxPopulation, opts)\n\n      if (max === null || value > maxValue) {\n        max = swatch\n        maxValue = value\n      }\n\n    }\n  })\n\n  return max\n}\n\nfunction _generateVariationColors (swatches: Array<Swatch>, maxPopulation: number, opts: DefaultGeneratorOptions): Palette {\n  let palette: Palette = {\n    Vibrant: null,\n    DarkVibrant: null,\n    LightVibrant: null,\n    Muted: null,\n    DarkMuted: null,\n    LightMuted: null\n  }\n  // mVibrantSwatch = findColor(TARGET_NORMAL_LUMA, MIN_NORMAL_LUMA, MAX_NORMAL_LUMA,\n  //     TARGET_VIBRANT_SATURATION, MIN_VIBRANT_SATURATION, 1f)\n  palette.Vibrant = _findColorVariation(palette, swatches, maxPopulation,\n    opts.targetNormalLuma,\n    opts.minNormalLuma,\n    opts.maxNormalLuma,\n    opts.targetVibrantSaturation,\n    opts.minVibrantSaturation,\n    1,\n    opts\n  )\n  // mLightVibrantSwatch = findColor(TARGET_LIGHT_LUMA, MIN_LIGHT_LUMA, 1f,\n  //     TARGET_VIBRANT_SATURATION, MIN_VIBRANT_SATURATION, 1f)\n  palette.LightVibrant = _findColorVariation(palette, swatches, maxPopulation,\n    opts.targetLightLuma,\n    opts.minLightLuma,\n    1,\n    opts.targetVibrantSaturation,\n    opts.minVibrantSaturation,\n    1,\n    opts\n  )\n  // mDarkVibrantSwatch = findColor(TARGET_DARK_LUMA, 0f, MAX_DARK_LUMA,\n  //     TARGET_VIBRANT_SATURATION, MIN_VIBRANT_SATURATION, 1f)\n  palette.DarkVibrant = _findColorVariation(palette, swatches, maxPopulation,\n    opts.targetDarkLuma,\n    0,\n    opts.maxDarkLuma,\n    opts.targetVibrantSaturation,\n    opts.minVibrantSaturation,\n    1,\n    opts\n  )\n  // mMutedSwatch = findColor(TARGET_NORMAL_LUMA, MIN_NORMAL_LUMA, MAX_NORMAL_LUMA,\n  //     TARGET_MUTED_SATURATION, 0f, MAX_MUTED_SATURATION)\n  palette.Muted = _findColorVariation(palette, swatches, maxPopulation,\n    opts.targetNormalLuma,\n    opts.minNormalLuma,\n    opts.maxNormalLuma,\n    opts.targetMutesSaturation,\n    0,\n    opts.maxMutesSaturation,\n    opts\n  )\n  // mLightMutedColor = findColor(TARGET_LIGHT_LUMA, MIN_LIGHT_LUMA, 1f,\n  //     TARGET_MUTED_SATURATION, 0f, MAX_MUTED_SATURATION)\n  palette.LightMuted = _findColorVariation(palette, swatches, maxPopulation,\n    opts.targetLightLuma,\n    opts.minLightLuma,\n    1,\n    opts.targetMutesSaturation,\n    0,\n    opts.maxMutesSaturation,\n    opts\n  )\n  // mDarkMutedSwatch = findColor(TARGET_DARK_LUMA, 0f, MAX_DARK_LUMA,\n  //     TARGET_MUTED_SATURATION, 0f, MAX_MUTED_SATURATION)\n  palette.DarkMuted = _findColorVariation(palette, swatches, maxPopulation,\n    opts.targetDarkLuma,\n    0,\n    opts.maxDarkLuma,\n    opts.targetMutesSaturation,\n    0,\n    opts.maxMutesSaturation,\n    opts\n  )\n  return palette\n}\n\nfunction _generateEmptySwatches (palette: Palette, maxPopulation: number, opts: DefaultGeneratorOptions): void {\n  if (!palette.Vibrant && !palette.DarkVibrant && !palette.LightVibrant) {\n    if (!palette.DarkVibrant && palette.DarkMuted) {\n      let [h, s, l] = palette.DarkMuted.hsl\n      l = opts.targetDarkLuma\n      palette.DarkVibrant = new Swatch(hslToRgb(h, s, l), 0)\n    }\n    if (!palette.LightVibrant && palette.LightMuted) {\n      let [h, s, l] = palette.LightMuted.hsl\n      l = opts.targetDarkLuma\n      palette.DarkVibrant = new Swatch(hslToRgb(h, s, l), 0)\n    }\n  }\n  if (!palette.Vibrant && palette.DarkVibrant) {\n    let [h, s, l] = palette.DarkVibrant.hsl\n    l = opts.targetNormalLuma\n    palette.Vibrant = new Swatch(hslToRgb(h, s, l), 0)\n  } else if (!palette.Vibrant && palette.LightVibrant) {\n    let [h, s, l] = palette.LightVibrant.hsl\n    l = opts.targetNormalLuma\n    palette.Vibrant = new Swatch(hslToRgb(h, s, l), 0)\n  }\n  if (!palette.DarkVibrant && palette.Vibrant) {\n    let [h, s, l] = palette.Vibrant.hsl\n    l = opts.targetDarkLuma\n    palette.DarkVibrant = new Swatch(hslToRgb(h, s, l), 0)\n  }\n  if (!palette.LightVibrant && palette.Vibrant) {\n    let [h, s, l] = palette.Vibrant.hsl\n    l = opts.targetLightLuma\n    palette.LightVibrant = new Swatch(hslToRgb(h, s, l), 0)\n  }\n  if (!palette.Muted && palette.Vibrant) {\n    let [h, s, l] = palette.Vibrant.hsl\n    l = opts.targetMutesSaturation\n    palette.Muted = new Swatch(hslToRgb(h, s, l), 0)\n  }\n  if (!palette.DarkMuted && palette.DarkVibrant) {\n    let [h, s, l] = palette.DarkVibrant.hsl\n    l = opts.targetMutesSaturation\n    palette.DarkMuted = new Swatch(hslToRgb(h, s, l), 0)\n  }\n  if (!palette.LightMuted && palette.LightVibrant) {\n    let [h, s, l] = palette.LightVibrant.hsl\n    l = opts.targetMutesSaturation\n    palette.LightMuted = new Swatch(hslToRgb(h, s, l), 0)\n  }\n}\n\nconst DefaultGenerator: Generator = (swatches: Array<Swatch>, opts?: DefaultGeneratorOptions): Palette => {\n  opts = Object.assign({}, DefaultOpts, opts)\n  let maxPopulation = _findMaxPopulation(swatches)\n\n  let palette = _generateVariationColors(swatches, maxPopulation, opts)\n  _generateEmptySwatches(palette, maxPopulation, opts)\n\n  return palette\n}\n\nexport default DefaultGenerator\n","import { ImageData, applyFilters } from '@vibrant/image'\nimport { Quantizer } from '@vibrant/quantizer'\nimport { Generator } from '@vibrant/generator'\nimport { Palette, Swatch, Filter } from '@vibrant/color'\n\nexport class Stage<T> {\n  private _map: { [name: string]: T } = {}\n  constructor (protected pipeline: BasicPipeline) { }\n  names () {\n    return Object.keys(this._map)\n  }\n  has (name: string) {\n    return !!this._map[name]\n  }\n  get (name: string) {\n    return this._map[name]\n  }\n  register (name: string, stageFn: T) {\n    this._map[name] = stageFn\n    return this.pipeline\n  }\n}\n\nexport interface ProcessResult {\n  colors: Swatch[]\n  palettes: { [name: string]: Palette }\n}\n\nexport interface StageOptions {\n  name: string\n  options?: any\n}\n\nexport interface ProcessOptions {\n  filters: string[]\n  quantizer: string | StageOptions\n  generators: (string | StageOptions)[]\n}\n\ninterface StageTask<Q> {\n  name: string\n  fn: Q\n  options?: any\n}\n\ninterface ProcessTasks {\n  filters: StageTask<Filter>[]\n  quantizer: StageTask<Quantizer>\n  generators: StageTask<Generator>[]\n}\n\nexport interface Pipeline {\n  // quantizer: Stage<Quantizer>\n  // generator: Stage<Generator>\n  process (imageData: ImageData, opts: ProcessOptions): Promise<ProcessResult>\n}\n\nexport class BasicPipeline implements Pipeline {\n  private _buildProcessTasks ({\n    filters,\n    quantizer,\n    generators\n  }: ProcessOptions): ProcessTasks {\n    // Support wildcard for generators\n    if (generators.length === 1 && generators[0] === '*') {\n      generators = this.generator.names()\n    }\n    return {\n      filters: filters.map(f => createTask(this.filter, f)),\n      quantizer: createTask(this.quantizer, quantizer),\n      generators: generators.map(g => createTask(this.generator, g))\n    }\n    function createTask<Q> (\n      stage: Stage<Q>,\n      o: string | StageOptions\n    ): StageTask<Q> {\n      let name: string\n      let options: any\n      if (typeof o === 'string') {\n        name = o\n      } else {\n        name = o.name\n        options = o.options\n      }\n\n      return {\n        name,\n        fn: stage.get(name),\n        options\n      }\n    }\n  }\n  filter: Stage<Filter> = new Stage(this)\n  quantizer: Stage<Quantizer> = new Stage(this)\n  generator: Stage<Generator> = new Stage(this)\n  async process (\n    imageData: ImageData,\n    opts: ProcessOptions\n  ): Promise<ProcessResult> {\n    let { filters, quantizer, generators } = this._buildProcessTasks(opts)\n    const imageFilterData = await this._filterColors(filters, imageData)\n    const colors = await this._generateColors(quantizer, imageFilterData)\n    const palettes = await this._generatePalettes(generators, colors)\n    return {\n      colors,\n      palettes\n    }\n  }\n  private _filterColors (filters: StageTask<Filter>[], imageData: ImageData) {\n    return Promise.resolve(\n      applyFilters(imageData, filters.map(({ fn }) => fn))\n    )\n  }\n  private _generateColors (\n    quantizer: StageTask<Quantizer>,\n    imageData: ImageData\n  ) {\n    return Promise.resolve(quantizer.fn(imageData.data, quantizer.options))\n  }\n  private async _generatePalettes (\n    generators: StageTask<Generator>[],\n    colors: Swatch[]\n  ) {\n    // Make a promise map that will run them \"concurrently\" (but return in expected result)\n    const promiseArr = await Promise.all(\n      generators.map(({ fn, options }) => Promise.resolve(fn(colors, options)))\n    )\n    // Map the values to the expected name\n    return Promise.resolve(\n      promiseArr.reduce(\n        (promises, promiseVal, i) => {\n          promises[generators[i].name] = promiseVal\n          return promises\n        },\n        {} as { [name: string]: Palette }\n      )\n    )\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}