{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8;\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"@material/mwc-button\";\nimport \"@material/mwc-list/mwc-list\";\nimport Fuse from \"fuse.js\";\nimport { LitElement, css, html, nothing } from \"lit\";\nimport { customElement, state } from \"lit/decorators\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport memoizeOne from \"memoize-one\";\nimport { isComponentLoaded } from \"../../../common/config/is_component_loaded\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { PROTOCOL_INTEGRATIONS, protocolIntegrationPicked } from \"../../../common/integrations/protocolIntegrationPicked\";\nimport { navigate } from \"../../../common/navigate\";\nimport { caseInsensitiveStringCompare } from \"../../../common/string/compare\";\nimport { createCloseHeading } from \"../../../components/ha-dialog\";\nimport \"../../../components/ha-icon-button-prev\";\nimport \"../../../components/search-input\";\nimport { fetchConfigFlowInProgress } from \"../../../data/config_flow\";\nimport { domainToName, fetchIntegrationManifest } from \"../../../data/integration\";\nimport { findIntegration, getIntegrationDescriptions } from \"../../../data/integrations\";\nimport { showConfigFlowDialog } from \"../../../dialogs/config-flow/show-dialog-config-flow\";\nimport { showAlertDialog, showConfirmationDialog } from \"../../../dialogs/generic/show-dialog-box\";\nimport { haStyleDialog, haStyleScrollbar } from \"../../../resources/styles\";\nimport { loadVirtualizer } from \"../../../resources/virtualizer\";\nimport \"./ha-domain-integrations\";\nimport \"./ha-integration-list-item\";\nimport { showYamlIntegrationDialog } from \"./show-add-integration-dialog\";\nvar AddIntegrationDialog = _decorate([customElement(\"dialog-add-integration\")], function (_initialize, _LitElement) {\n  var AddIntegrationDialog = /*#__PURE__*/function (_LitElement2) {\n    _inherits(AddIntegrationDialog, _LitElement2);\n    function AddIntegrationDialog() {\n      var _this;\n      _classCallCheck(this, AddIntegrationDialog);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, AddIntegrationDialog, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(AddIntegrationDialog);\n  }(_LitElement);\n  return {\n    F: AddIntegrationDialog,\n    d: [{\n      kind: \"field\",\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_integrations\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_helpers\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_initialFilter\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_filter\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_pickedBrand\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_prevPickedBrand\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_flowsInProgress\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_open\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_narrow\",\n      value: function value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_width\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_height\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"showDialog\",\n      value: function () {\n        var _showDialog = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(params) {\n          var loadPromise, _this$_integrations, brand;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                loadPromise = this._load();\n                this._open = true;\n                this._pickedBrand = params === null || params === void 0 ? void 0 : params.brand;\n                this._initialFilter = params === null || params === void 0 ? void 0 : params.initialFilter;\n                this._narrow = matchMedia(\"all and (max-width: 450px), all and (max-height: 500px)\").matches;\n                if (params !== null && params !== void 0 && params.domain) {\n                  this._createFlow(params.domain);\n                }\n                if (!(params !== null && params !== void 0 && params.brand)) {\n                  _context.next = 11;\n                  break;\n                }\n                _context.next = 9;\n                return loadPromise;\n              case 9:\n                brand = (_this$_integrations = this._integrations) === null || _this$_integrations === void 0 ? void 0 : _this$_integrations[params.brand];\n                if (brand && \"integrations\" in brand && brand.integrations) {\n                  this._fetchFlowsInProgress(Object.keys(brand.integrations));\n                }\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this);\n        }));\n        function showDialog(_x) {\n          return _showDialog.apply(this, arguments);\n        }\n        return showDialog;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"closeDialog\",\n      value: function closeDialog() {\n        this._open = false;\n        this._integrations = undefined;\n        this._helpers = undefined;\n        this._pickedBrand = undefined;\n        this._prevPickedBrand = undefined;\n        this._flowsInProgress = undefined;\n        this._filter = undefined;\n        this._width = undefined;\n        this._height = undefined;\n        fireEvent(this, \"dialog-closed\", {\n          dialog: this.localName\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"willUpdate\",\n      value: function willUpdate(changedProps) {\n        _get(_getPrototypeOf(AddIntegrationDialog.prototype), \"willUpdate\", this).call(this, changedProps);\n        if (!this.hasUpdated) {\n          loadVirtualizer();\n        }\n        if (this._filter === undefined && this._initialFilter !== undefined) {\n          this._filter = this._initialFilter;\n        }\n        if (this._initialFilter !== undefined && this._filter === \"\") {\n          this._initialFilter = undefined;\n          this._filter = undefined;\n          this._width = undefined;\n          this._height = undefined;\n        } else if (this.hasUpdated && changedProps.has(\"_filter\") && !changedProps.has(\"_open\") && (!this._width || !this._height)) {\n          var _querySelector;\n          // Store the width and height so that when we search, box doesn't jump\n          var boundingRect = (_querySelector = this.shadowRoot.querySelector(\"mwc-list\")) === null || _querySelector === void 0 ? void 0 : _querySelector.getBoundingClientRect();\n          this._width = boundingRect === null || boundingRect === void 0 ? void 0 : boundingRect.width;\n          this._height = boundingRect === null || boundingRect === void 0 ? void 0 : boundingRect.height;\n        }\n      }\n    }, {\n      kind: \"field\",\n      key: \"_filterIntegrations\",\n      value: function value() {\n        var _this2 = this;\n        return memoizeOne(function (i, h, components, localize, filter) {\n          var addDeviceRows = PROTOCOL_INTEGRATIONS.filter(function (domain) {\n            return components.includes(domain);\n          }).map(function (domain) {\n            return {\n              name: localize(\"ui.panel.config.integrations.add_\".concat(domain, \"_device\")),\n              domain: domain,\n              config_flow: true,\n              is_built_in: true,\n              is_add: true\n            };\n          }).sort(function (a, b) {\n            return caseInsensitiveStringCompare(a.name, b.name, _this2.hass.locale.language);\n          });\n          var integrations = [];\n          var yamlIntegrations = [];\n          Object.entries(i).forEach(function (_ref) {\n            var _ref2 = _slicedToArray(_ref, 2),\n              domain = _ref2[0],\n              integration = _ref2[1];\n            if (\"integration_type\" in integration && (integration.config_flow || integration.iot_standards || integration.supported_by)) {\n              var _supportedIntegration;\n              // Integration with a config flow, iot standard, or supported by\n              var supportedIntegration = integration.supported_by ? findIntegration(_this2._integrations, integration.supported_by) : integration;\n              if (!supportedIntegration) {\n                return;\n              }\n              integrations.push({\n                domain: domain,\n                name: integration.name || domainToName(localize, domain),\n                config_flow: supportedIntegration.config_flow,\n                iot_standards: supportedIntegration.iot_standards,\n                supported_by: integration.supported_by,\n                is_built_in: supportedIntegration.is_built_in !== false,\n                cloud: (_supportedIntegration = supportedIntegration.iot_class) === null || _supportedIntegration === void 0 ? void 0 : _supportedIntegration.startsWith(\"cloud_\")\n              });\n            } else if (!(\"integration_type\" in integration) && (\"iot_standards\" in integration || \"integrations\" in integration)) {\n              // Brand\n              integrations.push({\n                domain: domain,\n                name: integration.name || domainToName(localize, domain),\n                iot_standards: integration.iot_standards,\n                integrations: integration.integrations ? Object.entries(integration.integrations).map(function (_ref3) {\n                  var _ref4 = _slicedToArray(_ref3, 2),\n                    dom = _ref4[0],\n                    val = _ref4[1];\n                  return val.name || domainToName(localize, dom);\n                }) : undefined,\n                domains: integration.integrations ? Object.keys(integration.integrations) : undefined,\n                is_built_in: integration.is_built_in !== false\n              });\n            } else if (filter && \"integration_type\" in integration) {\n              var _integration$iot_clas;\n              // Integration without a config flow\n              yamlIntegrations.push({\n                domain: domain,\n                name: integration.name || domainToName(localize, domain),\n                config_flow: integration.config_flow,\n                is_built_in: integration.is_built_in !== false,\n                cloud: (_integration$iot_clas = integration.iot_class) === null || _integration$iot_clas === void 0 ? void 0 : _integration$iot_clas.startsWith(\"cloud_\")\n              });\n            }\n          });\n          if (filter) {\n            var options = {\n              keys: [{\n                name: \"name\",\n                weight: 5\n              }, {\n                name: \"domain\",\n                weight: 5\n              }, {\n                name: \"integrations\",\n                weight: 2\n              }, \"supported_by\", \"iot_standards\"],\n              isCaseSensitive: false,\n              minMatchCharLength: Math.min(filter.length, 2),\n              threshold: 0.2\n            };\n            var helpers = Object.entries(h).map(function (_ref5) {\n              var _integration$iot_clas2;\n              var _ref6 = _slicedToArray(_ref5, 2),\n                domain = _ref6[0],\n                integration = _ref6[1];\n              return {\n                domain: domain,\n                name: integration.name || domainToName(localize, domain),\n                config_flow: integration.config_flow,\n                is_helper: true,\n                is_built_in: integration.is_built_in !== false,\n                cloud: (_integration$iot_clas2 = integration.iot_class) === null || _integration$iot_clas2 === void 0 ? void 0 : _integration$iot_clas2.startsWith(\"cloud_\")\n              };\n            });\n            return [].concat(_toConsumableArray(new Fuse(integrations, options).search(filter).map(function (result) {\n              return result.item;\n            })), _toConsumableArray(new Fuse(yamlIntegrations, options).search(filter).map(function (result) {\n              return result.item;\n            })), _toConsumableArray(new Fuse(helpers, options).search(filter).map(function (result) {\n              return result.item;\n            })));\n          }\n          return [].concat(_toConsumableArray(addDeviceRows), _toConsumableArray(integrations.sort(function (a, b) {\n            return caseInsensitiveStringCompare(a.name || \"\", b.name || \"\", _this2.hass.locale.language);\n          })));\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_getIntegrations\",\n      value: function _getIntegrations() {\n        return this._filterIntegrations(this._integrations, this._helpers, this.hass.config.components, this.hass.localize, this._filter);\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        var _this$_integrations2;\n        if (!this._open) {\n          return nothing;\n        }\n        var integrations = this._integrations ? this._getIntegrations() : undefined;\n        var pickedIntegration = this._pickedBrand ? ((_this$_integrations2 = this._integrations) === null || _this$_integrations2 === void 0 ? void 0 : _this$_integrations2[this._pickedBrand]) || findIntegration(this._integrations, this._pickedBrand) : undefined;\n        return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"<ha-dialog\\n      open\\n      @closed=\", \"\\n      scrimClickAction\\n      escapeKeyAction\\n      hideActions\\n      .heading=\", \"\\n    >\\n      \", \"\\n    </ha-dialog>\"])), this.closeDialog, createCloseHeading(this.hass, this.hass.localize(\"ui.panel.config.integrations.new\")), this._pickedBrand && (!this._integrations || pickedIntegration) ? html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"<div slot=\\\"heading\\\">\\n              <ha-icon-button-prev\\n                @click=\", \"\\n              ></ha-icon-button-prev>\\n              <h2 class=\\\"mdc-dialog__title\\\">\\n                \", \"\\n              </h2>\\n            </div>\\n            \", \"\"])), this._prevClicked, this._calculateBrandHeading(pickedIntegration), this._renderIntegration(pickedIntegration)) : this._renderAll(integrations));\n      }\n    }, {\n      kind: \"method\",\n      key: \"_calculateBrandHeading\",\n      value: function _calculateBrandHeading(integration) {\n        var _this$_flowsInProgres, _this$_flowsInProgres2;\n        if (integration !== null && integration !== void 0 && integration.iot_standards && !(\"integrations\" in integration) && !((_this$_flowsInProgres = this._flowsInProgress) !== null && _this$_flowsInProgres !== void 0 && _this$_flowsInProgres.length)) {\n          return this.hass.localize(\"ui.panel.config.integrations.what_device_type\");\n        }\n        if (integration && !(integration !== null && integration !== void 0 && integration.iot_standards) && !(\"integrations\" in integration) && (_this$_flowsInProgres2 = this._flowsInProgress) !== null && _this$_flowsInProgres2 !== void 0 && _this$_flowsInProgres2.length) {\n          return this.hass.localize(\"ui.panel.config.integrations.confirm_add_discovered\");\n        }\n        return this.hass.localize(\"ui.panel.config.integrations.what_to_add\");\n      }\n    }, {\n      kind: \"method\",\n      key: \"_renderIntegration\",\n      value: function _renderIntegration(integration) {\n        return html(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"<ha-domain-integrations\\n      .hass=\", \"\\n      .domain=\", \"\\n      .integration=\", \"\\n      .flowsInProgress=\", \"\\n      style=\", \"\\n      @close-dialog=\", \"\\n      @supported-by=\", \"\\n      @select-brand=\", \"\\n    ></ha-domain-integrations>\"])), this.hass, this._pickedBrand, integration, this._flowsInProgress, styleMap({\n          minWidth: \"\".concat(this._width, \"px\"),\n          minHeight: \"581px\"\n        }), this.closeDialog, this._handleSupportedByEvent, this._handleSelectBrandEvent);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_handleSelectBrandEvent\",\n      value: function _handleSelectBrandEvent(ev) {\n        this._prevPickedBrand = this._pickedBrand;\n        this._pickedBrand = ev.detail.brand;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_handleSupportedByEvent\",\n      value: function _handleSupportedByEvent(ev) {\n        this._supportedBy(ev.detail.integration);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_supportedBy\",\n      value: function _supportedBy(integration) {\n        var _this3 = this;\n        var supportIntegration = findIntegration(this._integrations, integration.supported_by);\n        showConfirmationDialog(this, {\n          text: this.hass.localize(\"ui.panel.config.integrations.config_flow.supported_brand_flow\", {\n            supported_brand: integration.name || domainToName(this.hass.localize, integration.domain),\n            flow_domain_name: (supportIntegration === null || supportIntegration === void 0 ? void 0 : supportIntegration.name) || domainToName(this.hass.localize, integration.supported_by)\n          }),\n          confirm: function confirm() {\n            _this3.closeDialog();\n            if (PROTOCOL_INTEGRATIONS.includes(integration.supported_by)) {\n              protocolIntegrationPicked(_this3, _this3.hass, integration.supported_by);\n              return;\n            }\n            if (supportIntegration) {\n              _this3._handleIntegrationPicked({\n                domain: integration.supported_by,\n                name: supportIntegration.name || domainToName(_this3.hass.localize, integration.supported_by),\n                config_flow: supportIntegration.config_flow,\n                iot_standards: supportIntegration.iot_standards\n              });\n            } else {\n              showAlertDialog(_this3, {\n                text: \"Integration not found\",\n                warning: true\n              });\n            }\n          }\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_renderAll\",\n      value: function _renderAll(integrations) {\n        return html(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"<search-input\\n        .hass=\", \"\\n        dialogInitialFocus=\", \"\\n        .filter=\", \"\\n        @value-changed=\", \"\\n        .label=\", \"\\n        @keypress=\", \"\\n      ></search-input>\\n      \", \" \"])), this.hass, ifDefined(this._narrow ? undefined : \"\"), this._filter, this._filterChanged, this.hass.localize(\"ui.panel.config.integrations.search_brand\"), this._maybeSubmit, integrations ? html(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"<mwc-list\\n            dialogInitialFocus=\", \"\\n          >\\n            <lit-virtualizer\\n              scroller\\n              class=\\\"ha-scrollbar\\\"\\n              style=\", \"\\n              @click=\", \"\\n              .items=\", \"\\n              .keyFunction=\", \"\\n              .renderItem=\", \"\\n            >\\n            </lit-virtualizer>\\n          </mwc-list>\"])), ifDefined(this._narrow ? \"\" : undefined), styleMap({\n          width: \"\".concat(this._width, \"px\"),\n          height: this._narrow ? \"calc(100vh - 184px)\" : \"500px\"\n        }), this._integrationPicked, integrations, this._keyFunction, this._renderRow) : html(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"<div class=\\\"flex center\\\">\\n            <ha-circular-progress indeterminate></ha-circular-progress>\\n          </div>\"]))));\n      }\n    }, {\n      kind: \"field\",\n      key: \"_keyFunction\",\n      value: function value() {\n        return function (integration) {\n          return integration.domain;\n        };\n      }\n    }, {\n      kind: \"field\",\n      key: \"_renderRow\",\n      value: function value() {\n        var _this4 = this;\n        return function (integration) {\n          if (!integration) {\n            return nothing;\n          }\n          return html(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\\n      <ha-integration-list-item\\n        brand\\n        .hass=\", \"\\n        .integration=\", \"\\n      >\\n      </ha-integration-list-item>\\n    \"])), _this4.hass, integration);\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"_load\",\n      value: function () {\n        var _load2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n          var descriptions, integration, _integration;\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return getIntegrationDescriptions(this.hass);\n              case 2:\n                descriptions = _context2.sent;\n                _context2.t0 = _regeneratorRuntime().keys(descriptions.custom.integration);\n              case 4:\n                if ((_context2.t1 = _context2.t0()).done) {\n                  _context2.next = 11;\n                  break;\n                }\n                integration = _context2.t1.value;\n                if (Object.prototype.hasOwnProperty.call(descriptions.custom.integration, integration)) {\n                  _context2.next = 8;\n                  break;\n                }\n                return _context2.abrupt(\"continue\", 4);\n              case 8:\n                descriptions.custom.integration[integration].is_built_in = false;\n                _context2.next = 4;\n                break;\n              case 11:\n                this._integrations = Object.assign(Object.assign({}, descriptions.core.integration), descriptions.custom.integration);\n                _context2.t2 = _regeneratorRuntime().keys(descriptions.custom.helper);\n              case 13:\n                if ((_context2.t3 = _context2.t2()).done) {\n                  _context2.next = 20;\n                  break;\n                }\n                _integration = _context2.t3.value;\n                if (Object.prototype.hasOwnProperty.call(descriptions.custom.helper, _integration)) {\n                  _context2.next = 17;\n                  break;\n                }\n                return _context2.abrupt(\"continue\", 13);\n              case 17:\n                descriptions.custom.helper[_integration].is_built_in = false;\n                _context2.next = 13;\n                break;\n              case 20:\n                this._helpers = Object.assign(Object.assign({}, descriptions.core.helper), descriptions.custom.helper);\n                this.hass.loadBackendTranslation(\"title\", descriptions.core.translated_name, true);\n              case 22:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2, this);\n        }));\n        function _load() {\n          return _load2.apply(this, arguments);\n        }\n        return _load;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_filterChanged\",\n      value: function () {\n        var _filterChanged2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e) {\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                this._filter = e.detail.value;\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, this);\n        }));\n        function _filterChanged(_x2) {\n          return _filterChanged2.apply(this, arguments);\n        }\n        return _filterChanged;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_integrationPicked\",\n      value: function _integrationPicked(ev) {\n        var listItem = ev.target.closest(\"ha-integration-list-item\");\n        if (!listItem) {\n          return;\n        }\n        this._handleIntegrationPicked(listItem.integration);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_handleIntegrationPicked\",\n      value: function () {\n        var _handleIntegrationPicked2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(integration) {\n          var domains, manifest;\n          return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n            while (1) switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!integration.supported_by) {\n                  _context4.next = 3;\n                  break;\n                }\n                this._supportedBy(integration);\n                return _context4.abrupt(\"return\");\n              case 3:\n                if (!integration.is_add) {\n                  _context4.next = 7;\n                  break;\n                }\n                protocolIntegrationPicked(this, this.hass, integration.domain);\n                this.closeDialog();\n                return _context4.abrupt(\"return\");\n              case 7:\n                if (!integration.is_helper) {\n                  _context4.next = 11;\n                  break;\n                }\n                this.closeDialog();\n                navigate(\"/config/helpers/add?domain=\".concat(integration.domain));\n                return _context4.abrupt(\"return\");\n              case 11:\n                if (!integration.integrations) {\n                  _context4.next = 17;\n                  break;\n                }\n                domains = integration.domains || [];\n                if (integration.domain === \"apple\") {\n                  // we show discoverd homekit devices in their own brand section, dont show them at apple\n                  domains = domains.filter(function (domain) {\n                    return domain !== \"homekit_controller\";\n                  });\n                }\n                this._fetchFlowsInProgress(domains);\n                this._pickedBrand = integration.domain;\n                return _context4.abrupt(\"return\");\n              case 17:\n                if (!(PROTOCOL_INTEGRATIONS.includes(integration.domain) && isComponentLoaded(this.hass, integration.domain))) {\n                  _context4.next = 20;\n                  break;\n                }\n                this._pickedBrand = integration.domain;\n                return _context4.abrupt(\"return\");\n              case 20:\n                if (!integration.iot_standards) {\n                  _context4.next = 23;\n                  break;\n                }\n                this._pickedBrand = integration.domain;\n                return _context4.abrupt(\"return\");\n              case 23:\n                if (!integration.config_flow) {\n                  _context4.next = 26;\n                  break;\n                }\n                this._createFlow(integration.domain);\n                return _context4.abrupt(\"return\");\n              case 26:\n                if (!(integration.domain === \"cloud\" && isComponentLoaded(this.hass, \"cloud\"))) {\n                  _context4.next = 30;\n                  break;\n                }\n                this.closeDialog();\n                navigate(\"/config/cloud\");\n                return _context4.abrupt(\"return\");\n              case 30:\n                if (!([\"google_assistant\", \"alexa\"].includes(integration.domain) && isComponentLoaded(this.hass, \"cloud\"))) {\n                  _context4.next = 34;\n                  break;\n                }\n                this.closeDialog();\n                navigate(\"/config/voice-assistants/assistants\");\n                return _context4.abrupt(\"return\");\n              case 34:\n                _context4.next = 36;\n                return fetchIntegrationManifest(this.hass, integration.domain);\n              case 36:\n                manifest = _context4.sent;\n                showYamlIntegrationDialog(this, {\n                  manifest: manifest\n                });\n              case 38:\n              case \"end\":\n                return _context4.stop();\n            }\n          }, _callee4, this);\n        }));\n        function _handleIntegrationPicked(_x3) {\n          return _handleIntegrationPicked2.apply(this, arguments);\n        }\n        return _handleIntegrationPicked;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_createFlow\",\n      value: function () {\n        var _createFlow2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(domain) {\n          var _this$hass$userData;\n          var flowsInProgress, manifest;\n          return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n            while (1) switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return this._fetchFlowsInProgress([domain]);\n              case 2:\n                flowsInProgress = _context5.sent;\n                if (!(flowsInProgress !== null && flowsInProgress !== void 0 && flowsInProgress.length)) {\n                  _context5.next = 6;\n                  break;\n                }\n                this._pickedBrand = domain;\n                return _context5.abrupt(\"return\");\n              case 6:\n                _context5.next = 8;\n                return fetchIntegrationManifest(this.hass, domain);\n              case 8:\n                manifest = _context5.sent;\n                this.closeDialog();\n                showConfigFlowDialog(this, {\n                  startFlowHandler: domain,\n                  showAdvanced: (_this$hass$userData = this.hass.userData) === null || _this$hass$userData === void 0 ? void 0 : _this$hass$userData.showAdvanced,\n                  manifest: manifest\n                });\n              case 11:\n              case \"end\":\n                return _context5.stop();\n            }\n          }, _callee5, this);\n        }));\n        function _createFlow(_x4) {\n          return _createFlow2.apply(this, arguments);\n        }\n        return _createFlow;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_fetchFlowsInProgress\",\n      value: function () {\n        var _fetchFlowsInProgress2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(domains) {\n          var flowsInProgress;\n          return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n            while (1) switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return fetchConfigFlowInProgress(this.hass.connection);\n              case 2:\n                flowsInProgress = _context6.sent.filter(function (flow) {\n                  return (\n                    // filter config flows that are not for the integration we are looking for\n                    domains.includes(flow.handler) ||\n                    // filter config flows of other domains (like homekit) that are for the domains we are looking for\n                    \"alternative_domain\" in flow.context && domains.includes(flow.context.alternative_domain)\n                  );\n                });\n                if (flowsInProgress.length) {\n                  this._flowsInProgress = flowsInProgress;\n                }\n                return _context6.abrupt(\"return\", flowsInProgress);\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }, _callee6, this);\n        }));\n        function _fetchFlowsInProgress(_x5) {\n          return _fetchFlowsInProgress2.apply(this, arguments);\n        }\n        return _fetchFlowsInProgress;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_maybeSubmit\",\n      value: function _maybeSubmit(ev) {\n        if (ev.key !== \"Enter\") {\n          return;\n        }\n        var integrations = this._getIntegrations();\n        if (integrations.length > 0) {\n          this._handleIntegrationPicked(integrations[0]);\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_prevClicked\",\n      value: function _prevClicked() {\n        this._pickedBrand = this._prevPickedBrand;\n        if (!this._prevPickedBrand) {\n          this._flowsInProgress = undefined;\n        }\n        this._prevPickedBrand = undefined;\n      }\n    }, {\n      kind: \"field\",\n      static: true,\n      key: \"styles\",\n      value: function value() {\n        return [haStyleScrollbar, haStyleDialog, css(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\\n      @media all and (min-width: 550px) {\\n        ha-dialog {\\n          --mdc-dialog-min-width: 500px;\\n        }\\n      }\\n      ha-dialog {\\n        --dialog-content-padding: 0;\\n      }\\n      search-input {\\n        display: block;\\n        margin: 16px 16px 0;\\n      }\\n      .divider {\\n        border-bottom-color: var(--divider-color);\\n      }\\n      h2 {\\n        padding-inline-end: 66px;\\n        direction: var(--direction);\\n      }\\n      p {\\n        text-align: center;\\n        padding: 16px;\\n        margin: 0;\\n      }\\n      p > a {\\n        color: var(--primary-color);\\n      }\\n      .flex.center {\\n        display: flex;\\n        justify-content: center;\\n        align-items: center;\\n      }\\n      ha-circular-progress {\\n        margin: 24px 0;\\n      }\\n      mwc-list {\\n        position: relative;\\n      }\\n      lit-virtualizer {\\n        contain: size layout !important;\\n      }\\n      ha-integration-list-item {\\n        width: 100%;\\n      }\\n      ha-icon-button-prev {\\n        color: var(--secondary-text-color);\\n        position: absolute;\\n        left: 16px;\\n        top: 14px;\\n        inset-inline-end: initial;\\n        inset-inline-start: 16px;\\n        direction: var(--direction);\\n      }\\n      .mdc-dialog__title {\\n        margin: 0;\\n        margin-bottom: 8px;\\n        margin-left: 48px;\\n        margin-inline-start: 48px;\\n        margin-inline-end: initial;\\n        padding: 24px 24px 0 24px;\\n        color: var(--mdc-dialog-heading-ink-color, rgba(0, 0, 0, 0.87));\\n        font-size: var(--mdc-typography-headline6-font-size, 1.25rem);\\n        line-height: var(--mdc-typography-headline6-line-height, 2rem);\\n        font-weight: var(--mdc-typography-headline6-font-weight, 500);\\n        letter-spacing: var(\\n          --mdc-typography-headline6-letter-spacing,\\n          0.0125em\\n        );\\n        text-decoration: var(\\n          --mdc-typography-headline6-text-decoration,\\n          inherit\\n        );\\n        text-transform: var(--mdc-typography-headline6-text-transform, inherit);\\n      }\\n    \"])))];\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["Fuse","LitElement","css","html","nothing","customElement","state","ifDefined","styleMap","memoizeOne","isComponentLoaded","fireEvent","PROTOCOL_INTEGRATIONS","protocolIntegrationPicked","navigate","caseInsensitiveStringCompare","createCloseHeading","fetchConfigFlowInProgress","domainToName","fetchIntegrationManifest","findIntegration","getIntegrationDescriptions","showConfigFlowDialog","showAlertDialog","showConfirmationDialog","haStyleDialog","haStyleScrollbar","loadVirtualizer","showYamlIntegrationDialog","AddIntegrationDialog","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","key","value","decorators","_showDialog","_asyncToGenerator","_regeneratorRuntime","mark","_callee","params","loadPromise","_this$_integrations","brand","wrap","_callee$","_context","prev","next","_load","_open","_pickedBrand","_initialFilter","initialFilter","_narrow","matchMedia","matches","domain","_createFlow","_integrations","integrations","_fetchFlowsInProgress","Object","keys","stop","showDialog","_x","apply","closeDialog","undefined","_helpers","_prevPickedBrand","_flowsInProgress","_filter","_width","_height","dialog","localName","willUpdate","changedProps","_get","_getPrototypeOf","prototype","call","hasUpdated","has","_querySelector","boundingRect","shadowRoot","querySelector","getBoundingClientRect","width","height","_this2","i","h","components","localize","filter","addDeviceRows","includes","map","name","config_flow","is_built_in","is_add","sort","a","b","hass","locale","language","yamlIntegrations","entries","forEach","_ref","_ref2","_slicedToArray","integration","iot_standards","supported_by","_supportedIntegration","supportedIntegration","push","cloud","iot_class","startsWith","_ref3","_ref4","dom","val","domains","_integration$iot_clas","options","weight","isCaseSensitive","minMatchCharLength","Math","min","threshold","helpers","_ref5","_integration$iot_clas2","_ref6","is_helper","_toConsumableArray","search","result","item","_getIntegrations","_filterIntegrations","config","render","_this$_integrations2","pickedIntegration","_templateObject","_taggedTemplateLiteral","_templateObject2","_prevClicked","_calculateBrandHeading","_renderIntegration","_renderAll","_this$_flowsInProgres","_this$_flowsInProgres2","_templateObject3","minWidth","minHeight","_handleSupportedByEvent","_handleSelectBrandEvent","ev","detail","_supportedBy","_this3","supportIntegration","text","supported_brand","flow_domain_name","confirm","_handleIntegrationPicked","warning","_templateObject4","_filterChanged","_maybeSubmit","_templateObject5","_integrationPicked","_keyFunction","_renderRow","_templateObject6","_this4","_templateObject7","_load2","_callee2","descriptions","_integration","_callee2$","_context2","sent","t0","custom","t1","done","hasOwnProperty","abrupt","assign","core","t2","helper","t3","loadBackendTranslation","translated_name","_filterChanged2","_callee3","e","_callee3$","_context3","_x2","listItem","target","closest","_handleIntegrationPicked2","_callee4","manifest","_callee4$","_context4","_x3","_createFlow2","_callee5","_this$hass$userData","flowsInProgress","_callee5$","_context5","startFlowHandler","showAdvanced","userData","_x4","_fetchFlowsInProgress2","_callee6","_callee6$","_context6","connection","flow","handler","context","alternative_domain","_x5","static","_templateObject8"],"sources":["/Users/sercanardil/Desktop/frontend/src/panels/config/integrations/dialog-add-integration.ts"],"sourcesContent":["import \"@material/mwc-button\";\nimport \"@material/mwc-list/mwc-list\";\nimport Fuse, { IFuseOptions } from \"fuse.js\";\nimport { HassConfig } from \"home-assistant-js-websocket\";\nimport {\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  css,\n  html,\n  nothing,\n} from \"lit\";\nimport { customElement, state } from \"lit/decorators\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport memoizeOne from \"memoize-one\";\nimport { isComponentLoaded } from \"../../../common/config/is_component_loaded\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport {\n  PROTOCOL_INTEGRATIONS,\n  protocolIntegrationPicked,\n} from \"../../../common/integrations/protocolIntegrationPicked\";\nimport { navigate } from \"../../../common/navigate\";\nimport { caseInsensitiveStringCompare } from \"../../../common/string/compare\";\nimport { LocalizeFunc } from \"../../../common/translations/localize\";\nimport { createCloseHeading } from \"../../../components/ha-dialog\";\nimport \"../../../components/ha-icon-button-prev\";\nimport \"../../../components/search-input\";\nimport { fetchConfigFlowInProgress } from \"../../../data/config_flow\";\nimport { DataEntryFlowProgress } from \"../../../data/data_entry_flow\";\nimport {\n  domainToName,\n  fetchIntegrationManifest,\n} from \"../../../data/integration\";\nimport {\n  Brand,\n  Brands,\n  Integration,\n  Integrations,\n  findIntegration,\n  getIntegrationDescriptions,\n} from \"../../../data/integrations\";\nimport { showConfigFlowDialog } from \"../../../dialogs/config-flow/show-dialog-config-flow\";\nimport {\n  showAlertDialog,\n  showConfirmationDialog,\n} from \"../../../dialogs/generic/show-dialog-box\";\nimport { haStyleDialog, haStyleScrollbar } from \"../../../resources/styles\";\nimport { loadVirtualizer } from \"../../../resources/virtualizer\";\nimport type { HomeAssistant } from \"../../../types\";\nimport \"./ha-domain-integrations\";\nimport \"./ha-integration-list-item\";\nimport {\n  AddIntegrationDialogParams,\n  showYamlIntegrationDialog,\n} from \"./show-add-integration-dialog\";\n\nexport interface IntegrationListItem {\n  name: string;\n  domain: string;\n  config_flow?: boolean;\n  is_helper?: boolean;\n  integrations?: string[];\n  domains?: string[];\n  iot_standards?: string[];\n  supported_by?: string;\n  cloud?: boolean;\n  is_built_in?: boolean;\n  is_add?: boolean;\n}\n\n@customElement(\"dialog-add-integration\")\nclass AddIntegrationDialog extends LitElement {\n  public hass!: HomeAssistant;\n\n  @state() private _integrations?: Brands;\n\n  @state() private _helpers?: Integrations;\n\n  @state() private _initialFilter?: string;\n\n  @state() private _filter?: string;\n\n  @state() private _pickedBrand?: string;\n\n  @state() private _prevPickedBrand?: string;\n\n  @state() private _flowsInProgress?: DataEntryFlowProgress[];\n\n  @state() private _open = false;\n\n  @state() private _narrow = false;\n\n  private _width?: number;\n\n  private _height?: number;\n\n  public async showDialog(params?: AddIntegrationDialogParams): Promise<void> {\n    const loadPromise = this._load();\n    this._open = true;\n    this._pickedBrand = params?.brand;\n    this._initialFilter = params?.initialFilter;\n    this._narrow = matchMedia(\n      \"all and (max-width: 450px), all and (max-height: 500px)\"\n    ).matches;\n    if (params?.domain) {\n      this._createFlow(params.domain);\n    }\n    if (params?.brand) {\n      await loadPromise;\n      const brand = this._integrations?.[params.brand];\n      if (brand && \"integrations\" in brand && brand.integrations) {\n        this._fetchFlowsInProgress(Object.keys(brand.integrations));\n      }\n    }\n  }\n\n  public closeDialog() {\n    this._open = false;\n    this._integrations = undefined;\n    this._helpers = undefined;\n    this._pickedBrand = undefined;\n    this._prevPickedBrand = undefined;\n    this._flowsInProgress = undefined;\n    this._filter = undefined;\n    this._width = undefined;\n    this._height = undefined;\n    fireEvent(this, \"dialog-closed\", { dialog: this.localName });\n  }\n\n  public willUpdate(changedProps: PropertyValues): void {\n    super.willUpdate(changedProps);\n\n    if (!this.hasUpdated) {\n      loadVirtualizer();\n    }\n\n    if (this._filter === undefined && this._initialFilter !== undefined) {\n      this._filter = this._initialFilter;\n    }\n    if (this._initialFilter !== undefined && this._filter === \"\") {\n      this._initialFilter = undefined;\n      this._filter = undefined;\n      this._width = undefined;\n      this._height = undefined;\n    } else if (\n      this.hasUpdated &&\n      changedProps.has(\"_filter\") &&\n      !changedProps.has(\"_open\") &&\n      (!this._width || !this._height)\n    ) {\n      // Store the width and height so that when we search, box doesn't jump\n      const boundingRect =\n        this.shadowRoot!.querySelector(\"mwc-list\")?.getBoundingClientRect();\n      this._width = boundingRect?.width;\n      this._height = boundingRect?.height;\n    }\n  }\n\n  private _filterIntegrations = memoizeOne(\n    (\n      i: Brands,\n      h: Integrations,\n      components: HassConfig[\"components\"],\n      localize: LocalizeFunc,\n      filter?: string\n    ): IntegrationListItem[] => {\n      const addDeviceRows: IntegrationListItem[] = PROTOCOL_INTEGRATIONS.filter(\n        (domain) => components.includes(domain)\n      )\n        .map((domain) => ({\n          name: localize(`ui.panel.config.integrations.add_${domain}_device`),\n          domain,\n          config_flow: true,\n          is_built_in: true,\n          is_add: true,\n        }))\n        .sort((a, b) =>\n          caseInsensitiveStringCompare(\n            a.name,\n            b.name,\n            this.hass.locale.language\n          )\n        );\n\n      const integrations: IntegrationListItem[] = [];\n      const yamlIntegrations: IntegrationListItem[] = [];\n\n      Object.entries(i).forEach(([domain, integration]) => {\n        if (\n          \"integration_type\" in integration &&\n          (integration.config_flow ||\n            integration.iot_standards ||\n            integration.supported_by)\n        ) {\n          // Integration with a config flow, iot standard, or supported by\n          const supportedIntegration = integration.supported_by\n            ? findIntegration(this._integrations, integration.supported_by)\n            : integration;\n          if (!supportedIntegration) {\n            return;\n          }\n          integrations.push({\n            domain,\n            name: integration.name || domainToName(localize, domain),\n            config_flow: supportedIntegration.config_flow,\n            iot_standards: supportedIntegration.iot_standards,\n            supported_by: integration.supported_by,\n            is_built_in: supportedIntegration.is_built_in !== false,\n            cloud: supportedIntegration.iot_class?.startsWith(\"cloud_\"),\n          });\n        } else if (\n          !(\"integration_type\" in integration) &&\n          (\"iot_standards\" in integration || \"integrations\" in integration)\n        ) {\n          // Brand\n          integrations.push({\n            domain,\n            name: integration.name || domainToName(localize, domain),\n            iot_standards: integration.iot_standards,\n            integrations: integration.integrations\n              ? Object.entries(integration.integrations).map(\n                  ([dom, val]) => val.name || domainToName(localize, dom)\n                )\n              : undefined,\n            domains: integration.integrations\n              ? Object.keys(integration.integrations)\n              : undefined,\n            is_built_in: integration.is_built_in !== false,\n          });\n        } else if (filter && \"integration_type\" in integration) {\n          // Integration without a config flow\n          yamlIntegrations.push({\n            domain,\n            name: integration.name || domainToName(localize, domain),\n            config_flow: integration.config_flow,\n            is_built_in: integration.is_built_in !== false,\n            cloud: integration.iot_class?.startsWith(\"cloud_\"),\n          });\n        }\n      });\n\n      if (filter) {\n        const options: IFuseOptions<IntegrationListItem> = {\n          keys: [\n            { name: \"name\", weight: 5 },\n            { name: \"domain\", weight: 5 },\n            { name: \"integrations\", weight: 2 },\n            \"supported_by\",\n            \"iot_standards\",\n          ],\n          isCaseSensitive: false,\n          minMatchCharLength: Math.min(filter.length, 2),\n          threshold: 0.2,\n        };\n        const helpers = Object.entries(h).map(([domain, integration]) => ({\n          domain,\n          name: integration.name || domainToName(localize, domain),\n          config_flow: integration.config_flow,\n          is_helper: true,\n          is_built_in: integration.is_built_in !== false,\n          cloud: integration.iot_class?.startsWith(\"cloud_\"),\n        }));\n        return [\n          ...new Fuse(integrations, options)\n            .search(filter)\n            .map((result) => result.item),\n          ...new Fuse(yamlIntegrations, options)\n            .search(filter)\n            .map((result) => result.item),\n          ...new Fuse(helpers, options)\n            .search(filter)\n            .map((result) => result.item),\n        ];\n      }\n      return [\n        ...addDeviceRows,\n        ...integrations.sort((a, b) =>\n          caseInsensitiveStringCompare(\n            a.name || \"\",\n            b.name || \"\",\n            this.hass.locale.language\n          )\n        ),\n      ];\n    }\n  );\n\n  private _getIntegrations() {\n    return this._filterIntegrations(\n      this._integrations!,\n      this._helpers!,\n      this.hass.config.components,\n      this.hass.localize,\n      this._filter\n    );\n  }\n\n  protected render() {\n    if (!this._open) {\n      return nothing;\n    }\n    const integrations = this._integrations\n      ? this._getIntegrations()\n      : undefined;\n\n    const pickedIntegration = this._pickedBrand\n      ? this._integrations?.[this._pickedBrand] ||\n        findIntegration(this._integrations, this._pickedBrand)\n      : undefined;\n\n    return html`<ha-dialog\n      open\n      @closed=${this.closeDialog}\n      scrimClickAction\n      escapeKeyAction\n      hideActions\n      .heading=${createCloseHeading(\n        this.hass,\n        this.hass.localize(\"ui.panel.config.integrations.new\")\n      )}\n    >\n      ${this._pickedBrand && (!this._integrations || pickedIntegration)\n        ? html`<div slot=\"heading\">\n              <ha-icon-button-prev\n                @click=${this._prevClicked}\n              ></ha-icon-button-prev>\n              <h2 class=\"mdc-dialog__title\">\n                ${this._calculateBrandHeading(pickedIntegration)}\n              </h2>\n            </div>\n            ${this._renderIntegration(pickedIntegration)}`\n        : this._renderAll(integrations)}\n    </ha-dialog>`;\n  }\n\n  private _calculateBrandHeading(integration: Brand | Integration | undefined) {\n    if (\n      integration?.iot_standards &&\n      !(\"integrations\" in integration) &&\n      !this._flowsInProgress?.length\n    ) {\n      return this.hass.localize(\n        \"ui.panel.config.integrations.what_device_type\"\n      );\n    }\n    if (\n      integration &&\n      !integration?.iot_standards &&\n      !(\"integrations\" in integration) &&\n      this._flowsInProgress?.length\n    ) {\n      return this.hass.localize(\n        \"ui.panel.config.integrations.confirm_add_discovered\"\n      );\n    }\n    return this.hass.localize(\"ui.panel.config.integrations.what_to_add\");\n  }\n\n  private _renderIntegration(\n    integration: Brand | Integration | undefined\n  ): TemplateResult {\n    return html`<ha-domain-integrations\n      .hass=${this.hass}\n      .domain=${this._pickedBrand}\n      .integration=${integration}\n      .flowsInProgress=${this._flowsInProgress}\n      style=${styleMap({\n        minWidth: `${this._width}px`,\n        minHeight: `581px`,\n      })}\n      @close-dialog=${this.closeDialog}\n      @supported-by=${this._handleSupportedByEvent}\n      @select-brand=${this._handleSelectBrandEvent}\n    ></ha-domain-integrations>`;\n  }\n\n  private _handleSelectBrandEvent(ev: CustomEvent) {\n    this._prevPickedBrand = this._pickedBrand;\n    this._pickedBrand = ev.detail.brand;\n  }\n\n  private _handleSupportedByEvent(ev: CustomEvent) {\n    this._supportedBy(ev.detail.integration);\n  }\n\n  private _supportedBy(integration) {\n    const supportIntegration = findIntegration(\n      this._integrations,\n      integration.supported_by\n    );\n    showConfirmationDialog(this, {\n      text: this.hass.localize(\n        \"ui.panel.config.integrations.config_flow.supported_brand_flow\",\n        {\n          supported_brand:\n            integration.name ||\n            domainToName(this.hass.localize, integration.domain),\n          flow_domain_name:\n            supportIntegration?.name ||\n            domainToName(this.hass.localize, integration.supported_by),\n        }\n      ),\n      confirm: () => {\n        this.closeDialog();\n        if (PROTOCOL_INTEGRATIONS.includes(integration.supported_by)) {\n          protocolIntegrationPicked(this, this.hass, integration.supported_by);\n          return;\n        }\n        if (supportIntegration) {\n          this._handleIntegrationPicked({\n            domain: integration.supported_by,\n            name:\n              supportIntegration.name ||\n              domainToName(this.hass.localize, integration.supported_by),\n            config_flow: supportIntegration.config_flow,\n            iot_standards: supportIntegration.iot_standards,\n          });\n        } else {\n          showAlertDialog(this, {\n            text: \"Integration not found\",\n            warning: true,\n          });\n        }\n      },\n    });\n  }\n\n  private _renderAll(integrations?: IntegrationListItem[]): TemplateResult {\n    return html`<search-input\n        .hass=${this.hass}\n        dialogInitialFocus=${ifDefined(this._narrow ? undefined : \"\")}\n        .filter=${this._filter}\n        @value-changed=${this._filterChanged}\n        .label=${this.hass.localize(\n          \"ui.panel.config.integrations.search_brand\"\n        )}\n        @keypress=${this._maybeSubmit}\n      ></search-input>\n      ${integrations\n        ? html`<mwc-list\n            dialogInitialFocus=${ifDefined(this._narrow ? \"\" : undefined)}\n          >\n            <lit-virtualizer\n              scroller\n              class=\"ha-scrollbar\"\n              style=${styleMap({\n                width: `${this._width}px`,\n                height: this._narrow ? \"calc(100vh - 184px)\" : \"500px\",\n              })}\n              @click=${this._integrationPicked}\n              .items=${integrations}\n              .keyFunction=${this._keyFunction}\n              .renderItem=${this._renderRow}\n            >\n            </lit-virtualizer>\n          </mwc-list>`\n        : html`<div class=\"flex center\">\n            <ha-circular-progress indeterminate></ha-circular-progress>\n          </div>`} `;\n  }\n\n  private _keyFunction = (integration: IntegrationListItem) =>\n    integration.domain;\n\n  private _renderRow = (integration: IntegrationListItem) => {\n    if (!integration) {\n      return nothing;\n    }\n    return html`\n      <ha-integration-list-item\n        brand\n        .hass=${this.hass}\n        .integration=${integration}\n      >\n      </ha-integration-list-item>\n    `;\n  };\n\n  private async _load() {\n    const descriptions = await getIntegrationDescriptions(this.hass);\n    for (const integration in descriptions.custom.integration) {\n      if (\n        !Object.prototype.hasOwnProperty.call(\n          descriptions.custom.integration,\n          integration\n        )\n      ) {\n        continue;\n      }\n      descriptions.custom.integration[integration].is_built_in = false;\n    }\n    this._integrations = {\n      ...descriptions.core.integration,\n      ...descriptions.custom.integration,\n    };\n    for (const integration in descriptions.custom.helper) {\n      if (\n        !Object.prototype.hasOwnProperty.call(\n          descriptions.custom.helper,\n          integration\n        )\n      ) {\n        continue;\n      }\n      descriptions.custom.helper[integration].is_built_in = false;\n    }\n    this._helpers = {\n      ...descriptions.core.helper,\n      ...descriptions.custom.helper,\n    };\n    this.hass.loadBackendTranslation(\n      \"title\",\n      descriptions.core.translated_name,\n      true\n    );\n  }\n\n  private async _filterChanged(e) {\n    this._filter = e.detail.value;\n  }\n\n  private _integrationPicked(ev) {\n    const listItem = ev.target.closest(\"ha-integration-list-item\");\n    if (!listItem) {\n      return;\n    }\n    this._handleIntegrationPicked(listItem.integration);\n  }\n\n  private async _handleIntegrationPicked(integration: IntegrationListItem) {\n    if (integration.supported_by) {\n      this._supportedBy(integration);\n      return;\n    }\n\n    if (integration.is_add) {\n      protocolIntegrationPicked(this, this.hass, integration.domain);\n      this.closeDialog();\n      return;\n    }\n\n    if (integration.is_helper) {\n      this.closeDialog();\n      navigate(`/config/helpers/add?domain=${integration.domain}`);\n      return;\n    }\n\n    if (integration.integrations) {\n      let domains = integration.domains || [];\n      if (integration.domain === \"apple\") {\n        // we show discoverd homekit devices in their own brand section, dont show them at apple\n        domains = domains.filter((domain) => domain !== \"homekit_controller\");\n      }\n      this._fetchFlowsInProgress(domains);\n      this._pickedBrand = integration.domain;\n      return;\n    }\n\n    if (\n      (PROTOCOL_INTEGRATIONS as ReadonlyArray<string>).includes(\n        integration.domain\n      ) &&\n      isComponentLoaded(this.hass, integration.domain)\n    ) {\n      this._pickedBrand = integration.domain;\n      return;\n    }\n\n    if (integration.iot_standards) {\n      this._pickedBrand = integration.domain;\n      return;\n    }\n\n    if (integration.config_flow) {\n      this._createFlow(integration.domain);\n      return;\n    }\n\n    if (\n      integration.domain === \"cloud\" &&\n      isComponentLoaded(this.hass, \"cloud\")\n    ) {\n      this.closeDialog();\n      navigate(\"/config/cloud\");\n      return;\n    }\n\n    if (\n      [\"google_assistant\", \"alexa\"].includes(integration.domain) &&\n      isComponentLoaded(this.hass, \"cloud\")\n    ) {\n      this.closeDialog();\n      navigate(\"/config/voice-assistants/assistants\");\n      return;\n    }\n\n    const manifest = await fetchIntegrationManifest(\n      this.hass,\n      integration.domain\n    );\n    showYamlIntegrationDialog(this, { manifest });\n  }\n\n  private async _createFlow(domain: string) {\n    const flowsInProgress = await this._fetchFlowsInProgress([domain]);\n\n    if (flowsInProgress?.length) {\n      this._pickedBrand = domain;\n      return;\n    }\n\n    const manifest = await fetchIntegrationManifest(this.hass, domain);\n\n    this.closeDialog();\n\n    showConfigFlowDialog(this, {\n      startFlowHandler: domain,\n      showAdvanced: this.hass.userData?.showAdvanced,\n      manifest,\n    });\n  }\n\n  private async _fetchFlowsInProgress(domains: string[]) {\n    const flowsInProgress = (\n      await fetchConfigFlowInProgress(this.hass.connection)\n    ).filter(\n      (flow) =>\n        // filter config flows that are not for the integration we are looking for\n        domains.includes(flow.handler) ||\n        // filter config flows of other domains (like homekit) that are for the domains we are looking for\n        (\"alternative_domain\" in flow.context &&\n          domains.includes(flow.context.alternative_domain))\n    );\n\n    if (flowsInProgress.length) {\n      this._flowsInProgress = flowsInProgress;\n    }\n    return flowsInProgress;\n  }\n\n  private _maybeSubmit(ev: KeyboardEvent) {\n    if (ev.key !== \"Enter\") {\n      return;\n    }\n\n    const integrations = this._getIntegrations();\n\n    if (integrations.length > 0) {\n      this._handleIntegrationPicked(integrations[0]);\n    }\n  }\n\n  private _prevClicked() {\n    this._pickedBrand = this._prevPickedBrand;\n    if (!this._prevPickedBrand) {\n      this._flowsInProgress = undefined;\n    }\n    this._prevPickedBrand = undefined;\n  }\n\n  static styles = [\n    haStyleScrollbar,\n    haStyleDialog,\n    css`\n      @media all and (min-width: 550px) {\n        ha-dialog {\n          --mdc-dialog-min-width: 500px;\n        }\n      }\n      ha-dialog {\n        --dialog-content-padding: 0;\n      }\n      search-input {\n        display: block;\n        margin: 16px 16px 0;\n      }\n      .divider {\n        border-bottom-color: var(--divider-color);\n      }\n      h2 {\n        padding-inline-end: 66px;\n        direction: var(--direction);\n      }\n      p {\n        text-align: center;\n        padding: 16px;\n        margin: 0;\n      }\n      p > a {\n        color: var(--primary-color);\n      }\n      .flex.center {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n      ha-circular-progress {\n        margin: 24px 0;\n      }\n      mwc-list {\n        position: relative;\n      }\n      lit-virtualizer {\n        contain: size layout !important;\n      }\n      ha-integration-list-item {\n        width: 100%;\n      }\n      ha-icon-button-prev {\n        color: var(--secondary-text-color);\n        position: absolute;\n        left: 16px;\n        top: 14px;\n        inset-inline-end: initial;\n        inset-inline-start: 16px;\n        direction: var(--direction);\n      }\n      .mdc-dialog__title {\n        margin: 0;\n        margin-bottom: 8px;\n        margin-left: 48px;\n        margin-inline-start: 48px;\n        margin-inline-end: initial;\n        padding: 24px 24px 0 24px;\n        color: var(--mdc-dialog-heading-ink-color, rgba(0, 0, 0, 0.87));\n        font-size: var(--mdc-typography-headline6-font-size, 1.25rem);\n        line-height: var(--mdc-typography-headline6-line-height, 2rem);\n        font-weight: var(--mdc-typography-headline6-font-weight, 500);\n        letter-spacing: var(\n          --mdc-typography-headline6-letter-spacing,\n          0.0125em\n        );\n        text-decoration: var(\n          --mdc-typography-headline6-text-decoration,\n          inherit\n        );\n        text-transform: var(--mdc-typography-headline6-text-transform, inherit);\n      }\n    `,\n  ];\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-add-integration\": AddIntegrationDialog;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}