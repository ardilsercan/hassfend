{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport \"core-js/modules/es.object.assign.js\";\nexport var subscribeSystemHealthInfo = function subscribeSystemHealthInfo(hass, callback) {\n  var data = {};\n  var unsubProm = hass.connection.subscribeMessage(function (updateEvent) {\n    if (updateEvent.type === \"initial\") {\n      data = updateEvent.data;\n      callback(data);\n      return;\n    }\n    if (updateEvent.type === \"finish\") {\n      unsubProm.then(function (unsub) {\n        return unsub();\n      });\n      callback(undefined);\n      return;\n    }\n    data = Object.assign(Object.assign({}, data), {}, _defineProperty({}, updateEvent.domain, Object.assign(Object.assign({}, data[updateEvent.domain]), {}, {\n      info: Object.assign(Object.assign({}, data[updateEvent.domain].info), {}, _defineProperty({}, updateEvent.key, updateEvent.success ? updateEvent.data : {\n        error: true,\n        value: updateEvent.error.msg\n      }))\n    })));\n    callback(data);\n  }, {\n    type: \"system_health/info\"\n  });\n  return unsubProm;\n};","map":{"version":3,"names":["subscribeSystemHealthInfo","hass","callback","data","unsubProm","connection","subscribeMessage","updateEvent","type","then","unsub","undefined","Object","assign","_defineProperty","domain","info","key","success","error","value","msg"],"sources":["/Users/sercanardil/Desktop/frontend/src/data/system_health.ts"],"sourcesContent":["import { HomeAssistant } from \"../types\";\n\ninterface SystemCheckValueDateObject {\n  type: \"date\";\n  value: string;\n}\n\ninterface SystemCheckValueErrorObject {\n  type: \"failed\";\n  error: string;\n  more_info?: string;\n}\n\ninterface SystemCheckValuePendingObject {\n  type: \"pending\";\n}\n\nexport type SystemCheckValueObject =\n  | SystemCheckValueDateObject\n  | SystemCheckValueErrorObject\n  | SystemCheckValuePendingObject;\n\nexport type SystemCheckValue =\n  | string\n  | number\n  | boolean\n  | SystemCheckValueObject;\n\nexport interface SystemHealthInfo {\n  [domain: string]: {\n    manage_url?: string;\n    info: {\n      [key: string]: SystemCheckValue;\n    };\n  };\n}\n\ninterface SystemHealthEventInitial {\n  type: \"initial\";\n  data: SystemHealthInfo;\n}\ninterface SystemHealthEventUpdateSuccess {\n  type: \"update\";\n  success: true;\n  domain: string;\n  key: string;\n  data: SystemCheckValue;\n}\n\ninterface SystemHealthEventUpdateError {\n  type: \"update\";\n  success: false;\n  domain: string;\n  key: string;\n  error: {\n    msg: string;\n  };\n}\n\ninterface SystemHealthEventFinish {\n  type: \"finish\";\n}\n\ntype SystemHealthEvent =\n  | SystemHealthEventInitial\n  | SystemHealthEventUpdateSuccess\n  | SystemHealthEventUpdateError\n  | SystemHealthEventFinish;\n\nexport const subscribeSystemHealthInfo = (\n  hass: HomeAssistant,\n  callback: (info: SystemHealthInfo | undefined) => void\n) => {\n  let data = {};\n\n  const unsubProm = hass.connection.subscribeMessage<SystemHealthEvent>(\n    (updateEvent) => {\n      if (updateEvent.type === \"initial\") {\n        data = updateEvent.data;\n        callback(data);\n        return;\n      }\n      if (updateEvent.type === \"finish\") {\n        unsubProm.then((unsub) => unsub());\n        callback(undefined);\n        return;\n      }\n\n      data = {\n        ...data,\n        [updateEvent.domain]: {\n          ...data[updateEvent.domain],\n          info: {\n            ...data[updateEvent.domain].info,\n            [updateEvent.key]: updateEvent.success\n              ? updateEvent.data\n              : {\n                  error: true,\n                  value: updateEvent.error.msg,\n                },\n          },\n        },\n      };\n      callback(data);\n    },\n    {\n      type: \"system_health/info\",\n    }\n  );\n\n  return unsubProm;\n};\n"],"mappings":";;AAqEA,OAAO,IAAMA,yBAAyB,GAAG,SAA5BA,yBAAyBA,CACpCC,IAAmB,EACnBC,QAAsD,EACnD;EACH,IAAIC,IAAI,GAAG,CAAC,CAAC;EAEb,IAAMC,SAAS,GAAGH,IAAI,CAACI,UAAU,CAACC,gBAAgB,CAChD,UAACC,WAAW,EAAK;IACf,IAAIA,WAAW,CAACC,IAAI,KAAK,SAAS,EAAE;MAClCL,IAAI,GAAGI,WAAW,CAACJ,IAAI;MACvBD,QAAQ,CAACC,IAAI,CAAC;MACd;IACF;IACA,IAAII,WAAW,CAACC,IAAI,KAAK,QAAQ,EAAE;MACjCJ,SAAS,CAACK,IAAI,CAAC,UAACC,KAAK;QAAA,OAAKA,KAAK,CAAC,CAAC;MAAA,EAAC;MAClCR,QAAQ,CAACS,SAAS,CAAC;MACnB;IACF;IAEAR,IAAI,GAAAS,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACCV,IAAI,OAAAW,eAAA,KACNP,WAAW,CAACQ,MAAM,EAAAH,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACdV,IAAI,CAACI,WAAW,CAACQ,MAAM,CAAC;MAC3BC,IAAI,EAAAJ,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACCV,IAAI,CAACI,WAAW,CAACQ,MAAM,CAAC,CAACC,IAAI,OAAAF,eAAA,KAC/BP,WAAW,CAACU,GAAG,EAAGV,WAAW,CAACW,OAAO,GAClCX,WAAW,CAACJ,IAAI,GAChB;QACEgB,KAAK,EAAE,IAAI;QACXC,KAAK,EAAEb,WAAW,CAACY,KAAK,CAACE;MAC3B,CAAC;IACN,IAEJ;IACDnB,QAAQ,CAACC,IAAI,CAAC;EAChB,CAAC,EACD;IACEK,IAAI,EAAE;EACR,CACF,CAAC;EAED,OAAOJ,SAAS;AAClB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}