{"ast":null,"code":"import \"core-js/modules/es.array.index-of.js\";\nvar mdiFan = \"M12,11A1,1 0 0,0 11,12A1,1 0 0,0 12,13A1,1 0 0,0 13,12A1,1 0 0,0 12,11M12.5,2C17,2 17.11,5.57 14.75,6.75C13.76,7.24 13.32,8.29 13.13,9.22C13.61,9.42 14.03,9.73 14.35,10.13C18.05,8.13 22.03,8.92 22.03,12.5C22.03,17 18.46,17.1 17.28,14.73C16.78,13.74 15.72,13.3 14.79,13.11C14.59,13.59 14.28,14 13.88,14.34C15.87,18.03 15.08,22 11.5,22C7,22 6.91,18.42 9.27,17.24C10.25,16.75 10.69,15.71 10.89,14.79C10.4,14.59 9.97,14.27 9.65,13.87C5.96,15.85 2,15.07 2,11.5C2,7 5.56,6.89 6.74,9.26C7.24,10.25 8.29,10.68 9.22,10.87C9.41,10.39 9.73,9.97 10.14,9.65C8.15,5.96 8.94,2 12.5,2Z\";\nvar mdiFanOff = \"M12.5,2C9.64,2 8.57,4.55 9.29,7.47L15,13.16C15.87,13.37 16.81,13.81 17.28,14.73C18.46,17.1 22.03,17 22.03,12.5C22.03,8.92 18.05,8.13 14.35,10.13C14.03,9.73 13.61,9.42 13.13,9.22C13.32,8.29 13.76,7.24 14.75,6.75C17.11,5.57 17,2 12.5,2M3.28,4L2,5.27L4.47,7.73C3.22,7.74 2,8.87 2,11.5C2,15.07 5.96,15.85 9.65,13.87C9.97,14.27 10.4,14.59 10.89,14.79C10.69,15.71 10.25,16.75 9.27,17.24C6.91,18.42 7,22 11.5,22C13.8,22 14.94,20.36 14.94,18.21L18.73,22L20,20.72L3.28,4Z\";\nvar mdiFanSpeed1 = \"M13 19C13 17.59 13.5 16.3 14.3 15.28C14.17 14.97 14.03 14.65 13.86 14.34C14.26 14 14.57 13.59 14.77 13.11C15.26 13.21 15.78 13.39 16.25 13.67C17.07 13.25 18 13 19 13C20.05 13 21.03 13.27 21.89 13.74C21.95 13.37 22 12.96 22 12.5C22 8.92 18.03 8.13 14.33 10.13C14 9.73 13.59 9.42 13.11 9.22C13.3 8.29 13.74 7.24 14.73 6.75C17.09 5.57 17 2 12.5 2C8.93 2 8.14 5.96 10.13 9.65C9.72 9.97 9.4 10.39 9.21 10.87C8.28 10.68 7.23 10.25 6.73 9.26C5.56 6.89 2 7 2 11.5C2 15.07 5.95 15.85 9.64 13.87C9.96 14.27 10.39 14.59 10.88 14.79C10.68 15.71 10.24 16.75 9.26 17.24C6.9 18.42 7 22 11.5 22C12.31 22 13 21.78 13.5 21.41C13.19 20.67 13 19.86 13 19M12 13C11.43 13 11 12.55 11 12S11.43 11 12 11C12.54 11 13 11.45 13 12S12.54 13 12 13M17 15V17H18V23H20V15H17Z\";\nvar mdiFanSpeed2 = \"M13 19C13 17.59 13.5 16.3 14.3 15.28C14.17 14.97 14.03 14.65 13.86 14.34C14.26 14 14.57 13.59 14.77 13.11C15.26 13.21 15.78 13.39 16.25 13.67C17.07 13.25 18 13 19 13C20.05 13 21.03 13.27 21.89 13.74C21.95 13.37 22 12.96 22 12.5C22 8.92 18.03 8.13 14.33 10.13C14 9.73 13.59 9.42 13.11 9.22C13.3 8.29 13.74 7.24 14.73 6.75C17.09 5.57 17 2 12.5 2C8.93 2 8.14 5.96 10.13 9.65C9.72 9.97 9.4 10.39 9.21 10.87C8.28 10.68 7.23 10.25 6.73 9.26C5.56 6.89 2 7 2 11.5C2 15.07 5.95 15.85 9.64 13.87C9.96 14.27 10.39 14.59 10.88 14.79C10.68 15.71 10.24 16.75 9.26 17.24C6.9 18.42 7 22 11.5 22C12.31 22 13 21.78 13.5 21.41C13.19 20.67 13 19.86 13 19M12 13C11.43 13 11 12.55 11 12S11.43 11 12 11C12.54 11 13 11.45 13 12S12.54 13 12 13M16 15V17H19V18H18C16.9 18 16 18.9 16 20V23H21V21H18V20H19C20.11 20 21 19.11 21 18V17C21 15.9 20.11 15 19 15H16Z\";\nvar mdiFanSpeed3 = \"M13 19C13 17.59 13.5 16.3 14.3 15.28C14.17 14.97 14.03 14.65 13.86 14.34C14.26 14 14.57 13.59 14.77 13.11C15.26 13.21 15.78 13.39 16.25 13.67C17.07 13.25 18 13 19 13C20.05 13 21.03 13.27 21.89 13.74C21.95 13.37 22 12.96 22 12.5C22 8.92 18.03 8.13 14.33 10.13C14 9.73 13.59 9.42 13.11 9.22C13.3 8.29 13.74 7.24 14.73 6.75C17.09 5.57 17 2 12.5 2C8.93 2 8.14 5.96 10.13 9.65C9.72 9.97 9.4 10.39 9.21 10.87C8.28 10.68 7.23 10.25 6.73 9.26C5.56 6.89 2 7 2 11.5C2 15.07 5.95 15.85 9.64 13.87C9.96 14.27 10.39 14.59 10.88 14.79C10.68 15.71 10.24 16.75 9.26 17.24C6.9 18.42 7 22 11.5 22C12.31 22 13 21.78 13.5 21.41C13.19 20.67 13 19.86 13 19M12 13C11.43 13 11 12.55 11 12S11.43 11 12 11C12.54 11 13 11.45 13 12S12.54 13 12 13M21 21V20.5C21 19.67 20.33 19 19.5 19C20.33 19 21 18.33 21 17.5V17C21 15.89 20.1 15 19 15H16V17H19V18H17V20H19V21H16V23H19C20.11 23 21 22.11 21 21\";\nimport { stateActive } from \"../common/entity/state_active\";\nexport var FanEntityFeature = /*#__PURE__*/function (FanEntityFeature) {\n  FanEntityFeature[FanEntityFeature[\"SET_SPEED\"] = 1] = \"SET_SPEED\";\n  FanEntityFeature[FanEntityFeature[\"OSCILLATE\"] = 2] = \"OSCILLATE\";\n  FanEntityFeature[FanEntityFeature[\"DIRECTION\"] = 4] = \"DIRECTION\";\n  FanEntityFeature[FanEntityFeature[\"PRESET_MODE\"] = 8] = \"PRESET_MODE\";\n  return FanEntityFeature;\n}({});\nexport var FAN_SPEEDS = {\n  2: [\"off\", \"on\"],\n  3: [\"off\", \"low\", \"high\"],\n  4: [\"off\", \"low\", \"medium\", \"high\"]\n};\nexport function fanPercentageToSpeed(stateObj, value) {\n  var _stateObj$attributes$, _speeds$speedValue;\n  var step = (_stateObj$attributes$ = stateObj.attributes.percentage_step) !== null && _stateObj$attributes$ !== void 0 ? _stateObj$attributes$ : 1;\n  var speedValue = Math.round(value / step);\n  var speedCount = Math.round(100 / step) + 1;\n  var speeds = FAN_SPEEDS[speedCount];\n  return (_speeds$speedValue = speeds === null || speeds === void 0 ? void 0 : speeds[speedValue]) !== null && _speeds$speedValue !== void 0 ? _speeds$speedValue : \"off\";\n}\nexport function fanSpeedToPercentage(stateObj, speed) {\n  var _stateObj$attributes$2;\n  var step = (_stateObj$attributes$2 = stateObj.attributes.percentage_step) !== null && _stateObj$attributes$2 !== void 0 ? _stateObj$attributes$2 : 1;\n  var speedCount = Math.round(100 / step) + 1;\n  var speeds = FAN_SPEEDS[speedCount];\n  if (!speeds) {\n    return 0;\n  }\n  var speedValue = speeds.indexOf(speed);\n  if (speedValue === -1) {\n    return 0;\n  }\n  return Math.floor(speedValue * step);\n}\nexport function computeFanSpeedCount(stateObj) {\n  var _stateObj$attributes$3;\n  var step = (_stateObj$attributes$3 = stateObj.attributes.percentage_step) !== null && _stateObj$attributes$3 !== void 0 ? _stateObj$attributes$3 : 1;\n  var speedCount = Math.round(100 / step) + 1;\n  return speedCount;\n}\nexport function computeFanSpeedIcon(stateObj, speed) {\n  var _speeds$indexOf;\n  var speedCount = computeFanSpeedCount(stateObj);\n  var speeds = FAN_SPEEDS[speedCount];\n  var index = (_speeds$indexOf = speeds === null || speeds === void 0 ? void 0 : speeds.indexOf(speed)) !== null && _speeds$indexOf !== void 0 ? _speeds$indexOf : 1;\n  return speed === \"on\" ? mdiFan : speed === \"off\" ? mdiFanOff : [mdiFanSpeed1, mdiFanSpeed2, mdiFanSpeed3][index - 1];\n}\nexport var FAN_SPEED_COUNT_MAX_FOR_BUTTONS = 4;\nexport function computeFanSpeedStateDisplay(stateObj, hass, speed) {\n  var percentage = stateActive(stateObj) ? stateObj.attributes.percentage : undefined;\n  var currentSpeed = speed !== null && speed !== void 0 ? speed : percentage;\n  return currentSpeed ? hass.formatEntityAttributeValue(stateObj, \"percentage\", Math.round(currentSpeed)) : \"\";\n}","map":{"version":3,"names":["stateActive","FanEntityFeature","FAN_SPEEDS","fanPercentageToSpeed","stateObj","value","_stateObj$attributes$","_speeds$speedValue","step","attributes","percentage_step","speedValue","Math","round","speedCount","speeds","fanSpeedToPercentage","speed","_stateObj$attributes$2","indexOf","floor","computeFanSpeedCount","_stateObj$attributes$3","computeFanSpeedIcon","_speeds$indexOf","index","mdiFan","mdiFanOff","mdiFanSpeed1","mdiFanSpeed2","mdiFanSpeed3","FAN_SPEED_COUNT_MAX_FOR_BUTTONS","computeFanSpeedStateDisplay","hass","percentage","undefined","currentSpeed","formatEntityAttributeValue"],"sources":["/workspaces/frontend/src/data/fan.ts"],"sourcesContent":["import {\n  mdiFan,\n  mdiFanOff,\n  mdiFanSpeed1,\n  mdiFanSpeed2,\n  mdiFanSpeed3,\n} from \"@mdi/js\";\nimport {\n  HassEntityAttributeBase,\n  HassEntityBase,\n} from \"home-assistant-js-websocket\";\nimport { stateActive } from \"../common/entity/state_active\";\nimport type { HomeAssistant } from \"../types\";\n\nexport const enum FanEntityFeature {\n  SET_SPEED = 1,\n  OSCILLATE = 2,\n  DIRECTION = 4,\n  PRESET_MODE = 8,\n}\n\ninterface FanEntityAttributes extends HassEntityAttributeBase {\n  direction?: string;\n  oscillating?: boolean;\n  percentage?: number;\n  percentage_step?: number;\n  preset_mode?: string;\n  preset_modes?: string[];\n}\n\nexport interface FanEntity extends HassEntityBase {\n  attributes: FanEntityAttributes;\n}\n\nexport type FanSpeed = \"off\" | \"low\" | \"medium\" | \"high\" | \"on\";\n\nexport const FAN_SPEEDS: Partial<Record<number, FanSpeed[]>> = {\n  2: [\"off\", \"on\"],\n  3: [\"off\", \"low\", \"high\"],\n  4: [\"off\", \"low\", \"medium\", \"high\"],\n};\n\nexport function fanPercentageToSpeed(\n  stateObj: FanEntity,\n  value: number\n): FanSpeed {\n  const step = stateObj.attributes.percentage_step ?? 1;\n  const speedValue = Math.round(value / step);\n  const speedCount = Math.round(100 / step) + 1;\n\n  const speeds = FAN_SPEEDS[speedCount];\n  return speeds?.[speedValue] ?? \"off\";\n}\n\nexport function fanSpeedToPercentage(\n  stateObj: FanEntity,\n  speed: FanSpeed\n): number {\n  const step = stateObj.attributes.percentage_step ?? 1;\n  const speedCount = Math.round(100 / step) + 1;\n\n  const speeds = FAN_SPEEDS[speedCount];\n\n  if (!speeds) {\n    return 0;\n  }\n\n  const speedValue = speeds.indexOf(speed);\n  if (speedValue === -1) {\n    return 0;\n  }\n  return Math.floor(speedValue * step);\n}\n\nexport function computeFanSpeedCount(stateObj: FanEntity): number {\n  const step = stateObj.attributes.percentage_step ?? 1;\n  const speedCount = Math.round(100 / step) + 1;\n  return speedCount;\n}\n\nexport function computeFanSpeedIcon(\n  stateObj: FanEntity,\n  speed: FanSpeed\n): string {\n  const speedCount = computeFanSpeedCount(stateObj);\n  const speeds = FAN_SPEEDS[speedCount];\n  const index = speeds?.indexOf(speed) ?? 1;\n\n  return speed === \"on\"\n    ? mdiFan\n    : speed === \"off\"\n      ? mdiFanOff\n      : [mdiFanSpeed1, mdiFanSpeed2, mdiFanSpeed3][index - 1];\n}\nexport const FAN_SPEED_COUNT_MAX_FOR_BUTTONS = 4;\n\nexport function computeFanSpeedStateDisplay(\n  stateObj: FanEntity,\n  hass: HomeAssistant,\n  speed?: number\n) {\n  const percentage = stateActive(stateObj)\n    ? stateObj.attributes.percentage\n    : undefined;\n  const currentSpeed = speed ?? percentage;\n\n  return currentSpeed\n    ? hass.formatEntityAttributeValue(\n        stateObj,\n        \"percentage\",\n        Math.round(currentSpeed)\n      )\n    : \"\";\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}