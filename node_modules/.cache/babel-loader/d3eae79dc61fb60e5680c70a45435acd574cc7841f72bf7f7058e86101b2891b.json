{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _construct from \"@babel/runtime/helpers/construct\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _createForOfIteratorHelper from \"@babel/runtime/helpers/createForOfIteratorHelper\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\nimport \"proxy-polyfill\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.fill.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.global-this.js\";\nimport \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.number.max-safe-integer.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.regexp.constructor.js\";\nimport \"core-js/modules/es.regexp.dot-all.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.sticky.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.weak-map.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.reduce.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\n/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\nvar proxyMarker = Symbol(\"Comlink.proxy\");\nvar createEndpoint = Symbol(\"Comlink.endpoint\");\nvar releaseProxy = Symbol(\"Comlink.releaseProxy\");\nvar finalizer = Symbol(\"Comlink.finalizer\");\nvar throwMarker = Symbol(\"Comlink.thrown\");\nvar isObject = function isObject(val) {\n  return _typeof(val) === \"object\" && val !== null || typeof val === \"function\";\n};\n/**\n * Internal transfer handle to handle objects marked to proxy.\n */\nvar proxyTransferHandler = {\n  canHandle: function canHandle(val) {\n    return isObject(val) && val[proxyMarker];\n  },\n  serialize: function serialize(obj) {\n    var _MessageChannel = new MessageChannel(),\n      port1 = _MessageChannel.port1,\n      port2 = _MessageChannel.port2;\n    expose(obj, port1);\n    return [port2, [port2]];\n  },\n  deserialize: function deserialize(port) {\n    port.start();\n    return wrap(port);\n  }\n};\n/**\n * Internal transfer handler to handle thrown exceptions.\n */\nvar throwTransferHandler = {\n  canHandle: function canHandle(value) {\n    return isObject(value) && throwMarker in value;\n  },\n  serialize: function serialize(_ref) {\n    var value = _ref.value;\n    var serialized;\n    if (value instanceof Error) {\n      serialized = {\n        isError: true,\n        value: {\n          message: value.message,\n          name: value.name,\n          stack: value.stack\n        }\n      };\n    } else {\n      serialized = {\n        isError: false,\n        value: value\n      };\n    }\n    return [serialized, []];\n  },\n  deserialize: function deserialize(serialized) {\n    if (serialized.isError) {\n      throw Object.assign(new Error(serialized.value.message), serialized.value);\n    }\n    throw serialized.value;\n  }\n};\n/**\n * Allows customizing the serialization of certain values.\n */\nvar transferHandlers = new Map([[\"proxy\", proxyTransferHandler], [\"throw\", throwTransferHandler]]);\nfunction isAllowedOrigin(allowedOrigins, origin) {\n  var _iterator = _createForOfIteratorHelper(allowedOrigins),\n    _step;\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var allowedOrigin = _step.value;\n      if (origin === allowedOrigin || allowedOrigin === \"*\") {\n        return true;\n      }\n      if (allowedOrigin instanceof RegExp && allowedOrigin.test(origin)) {\n        return true;\n      }\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n  return false;\n}\nfunction expose(obj) {\n  var ep = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : globalThis;\n  var allowedOrigins = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [\"*\"];\n  ep.addEventListener(\"message\", function callback(ev) {\n    if (!ev || !ev.data) {\n      return;\n    }\n    if (!isAllowedOrigin(allowedOrigins, ev.origin)) {\n      console.warn(\"Invalid origin '\".concat(ev.origin, \"' for comlink proxy\"));\n      return;\n    }\n    var _Object$assign = Object.assign({\n        path: []\n      }, ev.data),\n      id = _Object$assign.id,\n      type = _Object$assign.type,\n      path = _Object$assign.path;\n    var argumentList = (ev.data.argumentList || []).map(fromWireValue);\n    var returnValue;\n    try {\n      var parent = path.slice(0, -1).reduce(function (obj, prop) {\n        return obj[prop];\n      }, obj);\n      var rawValue = path.reduce(function (obj, prop) {\n        return obj[prop];\n      }, obj);\n      switch (type) {\n        case \"GET\" /* MessageType.GET */:\n          {\n            returnValue = rawValue;\n          }\n          break;\n        case \"SET\" /* MessageType.SET */:\n          {\n            parent[path.slice(-1)[0]] = fromWireValue(ev.data.value);\n            returnValue = true;\n          }\n          break;\n        case \"APPLY\" /* MessageType.APPLY */:\n          {\n            returnValue = rawValue.apply(parent, argumentList);\n          }\n          break;\n        case \"CONSTRUCT\" /* MessageType.CONSTRUCT */:\n          {\n            var value = _construct(rawValue, _toConsumableArray(argumentList));\n            returnValue = proxy(value);\n          }\n          break;\n        case \"ENDPOINT\" /* MessageType.ENDPOINT */:\n          {\n            var _MessageChannel2 = new MessageChannel(),\n              port1 = _MessageChannel2.port1,\n              port2 = _MessageChannel2.port2;\n            expose(obj, port2);\n            returnValue = transfer(port1, [port1]);\n          }\n          break;\n        case \"RELEASE\" /* MessageType.RELEASE */:\n          {\n            returnValue = undefined;\n          }\n          break;\n        default:\n          return;\n      }\n    } catch (value) {\n      returnValue = _defineProperty({\n        value: value\n      }, throwMarker, 0);\n    }\n    Promise.resolve(returnValue).catch(function (value) {\n      return _defineProperty({\n        value: value\n      }, throwMarker, 0);\n    }).then(function (returnValue) {\n      var _toWireValue = toWireValue(returnValue),\n        _toWireValue2 = _slicedToArray(_toWireValue, 2),\n        wireValue = _toWireValue2[0],\n        transferables = _toWireValue2[1];\n      ep.postMessage(Object.assign(Object.assign({}, wireValue), {\n        id: id\n      }), transferables);\n      if (type === \"RELEASE\" /* MessageType.RELEASE */) {\n        // detach and deactive after sending release response above.\n        ep.removeEventListener(\"message\", callback);\n        closeEndPoint(ep);\n        if (finalizer in obj && typeof obj[finalizer] === \"function\") {\n          obj[finalizer]();\n        }\n      }\n    }).catch(function (error) {\n      // Send Serialization Error To Caller\n      var _toWireValue3 = toWireValue(_defineProperty({\n          value: new TypeError(\"Unserializable return value\")\n        }, throwMarker, 0)),\n        _toWireValue4 = _slicedToArray(_toWireValue3, 2),\n        wireValue = _toWireValue4[0],\n        transferables = _toWireValue4[1];\n      ep.postMessage(Object.assign(Object.assign({}, wireValue), {\n        id: id\n      }), transferables);\n    });\n  });\n  if (ep.start) {\n    ep.start();\n  }\n}\nfunction isMessagePort(endpoint) {\n  return endpoint.constructor.name === \"MessagePort\";\n}\nfunction closeEndPoint(endpoint) {\n  if (isMessagePort(endpoint)) endpoint.close();\n}\nfunction wrap(ep, target) {\n  return createProxy(ep, [], target);\n}\nfunction throwIfProxyReleased(isReleased) {\n  if (isReleased) {\n    throw new Error(\"Proxy has been released and is not useable\");\n  }\n}\nfunction releaseEndpoint(ep) {\n  return requestResponseMessage(ep, {\n    type: \"RELEASE\" /* MessageType.RELEASE */\n  }).then(function () {\n    closeEndPoint(ep);\n  });\n}\nvar proxyCounter = new WeakMap();\nvar proxyFinalizers = \"FinalizationRegistry\" in globalThis && new FinalizationRegistry(function (ep) {\n  var newCount = (proxyCounter.get(ep) || 0) - 1;\n  proxyCounter.set(ep, newCount);\n  if (newCount === 0) {\n    releaseEndpoint(ep);\n  }\n});\nfunction registerProxy(proxy, ep) {\n  var newCount = (proxyCounter.get(ep) || 0) + 1;\n  proxyCounter.set(ep, newCount);\n  if (proxyFinalizers) {\n    proxyFinalizers.register(proxy, ep, proxy);\n  }\n}\nfunction unregisterProxy(proxy) {\n  if (proxyFinalizers) {\n    proxyFinalizers.unregister(proxy);\n  }\n}\nfunction createProxy(ep) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var target = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};\n  var isProxyReleased = false;\n  var proxy = new Proxy(target, {\n    get: function get(_target, prop) {\n      throwIfProxyReleased(isProxyReleased);\n      if (prop === releaseProxy) {\n        return function () {\n          unregisterProxy(proxy);\n          releaseEndpoint(ep);\n          isProxyReleased = true;\n        };\n      }\n      if (prop === \"then\") {\n        if (path.length === 0) {\n          return {\n            then: function then() {\n              return proxy;\n            }\n          };\n        }\n        var r = requestResponseMessage(ep, {\n          type: \"GET\" /* MessageType.GET */,\n          path: path.map(function (p) {\n            return p.toString();\n          })\n        }).then(fromWireValue);\n        return r.then.bind(r);\n      }\n      return createProxy(ep, [].concat(_toConsumableArray(path), [prop]));\n    },\n    set: function set(_target, prop, rawValue) {\n      throwIfProxyReleased(isProxyReleased);\n      // FIXME: ES6 Proxy Handler `set` methods are supposed to return a\n      // boolean. To show good will, we return true asynchronously ¯\\_(ツ)_/¯\n      var _toWireValue6 = toWireValue(rawValue),\n        _toWireValue7 = _slicedToArray(_toWireValue6, 2),\n        value = _toWireValue7[0],\n        transferables = _toWireValue7[1];\n      return requestResponseMessage(ep, {\n        type: \"SET\" /* MessageType.SET */,\n        path: [].concat(_toConsumableArray(path), [prop]).map(function (p) {\n          return p.toString();\n        }),\n        value: value\n      }, transferables).then(fromWireValue);\n    },\n    apply: function apply(_target, _thisArg, rawArgumentList) {\n      throwIfProxyReleased(isProxyReleased);\n      var last = path[path.length - 1];\n      if (last === createEndpoint) {\n        return requestResponseMessage(ep, {\n          type: \"ENDPOINT\" /* MessageType.ENDPOINT */\n        }).then(fromWireValue);\n      }\n      // We just pretend that `bind()` didn’t happen.\n      if (last === \"bind\") {\n        return createProxy(ep, path.slice(0, -1));\n      }\n      var _processArguments = processArguments(rawArgumentList),\n        _processArguments2 = _slicedToArray(_processArguments, 2),\n        argumentList = _processArguments2[0],\n        transferables = _processArguments2[1];\n      return requestResponseMessage(ep, {\n        type: \"APPLY\" /* MessageType.APPLY */,\n        path: path.map(function (p) {\n          return p.toString();\n        }),\n        argumentList: argumentList\n      }, transferables).then(fromWireValue);\n    },\n    construct: function construct(_target, rawArgumentList) {\n      throwIfProxyReleased(isProxyReleased);\n      var _processArguments3 = processArguments(rawArgumentList),\n        _processArguments4 = _slicedToArray(_processArguments3, 2),\n        argumentList = _processArguments4[0],\n        transferables = _processArguments4[1];\n      return requestResponseMessage(ep, {\n        type: \"CONSTRUCT\" /* MessageType.CONSTRUCT */,\n        path: path.map(function (p) {\n          return p.toString();\n        }),\n        argumentList: argumentList\n      }, transferables).then(fromWireValue);\n    }\n  });\n  registerProxy(proxy, ep);\n  return proxy;\n}\nfunction myFlat(arr) {\n  return Array.prototype.concat.apply([], arr);\n}\nfunction processArguments(argumentList) {\n  var processed = argumentList.map(toWireValue);\n  return [processed.map(function (v) {\n    return v[0];\n  }), myFlat(processed.map(function (v) {\n    return v[1];\n  }))];\n}\nvar transferCache = new WeakMap();\nfunction transfer(obj, transfers) {\n  transferCache.set(obj, transfers);\n  return obj;\n}\nfunction proxy(obj) {\n  return Object.assign(obj, _defineProperty({}, proxyMarker, true));\n}\nfunction windowEndpoint(w) {\n  var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : globalThis;\n  var targetOrigin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"*\";\n  return {\n    postMessage: function postMessage(msg, transferables) {\n      return w.postMessage(msg, targetOrigin, transferables);\n    },\n    addEventListener: context.addEventListener.bind(context),\n    removeEventListener: context.removeEventListener.bind(context)\n  };\n}\nfunction toWireValue(value) {\n  var _iterator2 = _createForOfIteratorHelper(transferHandlers),\n    _step2;\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var _step2$value = _slicedToArray(_step2.value, 2),\n        name = _step2$value[0],\n        handler = _step2$value[1];\n      if (handler.canHandle(value)) {\n        var _handler$serialize = handler.serialize(value),\n          _handler$serialize2 = _slicedToArray(_handler$serialize, 2),\n          serializedValue = _handler$serialize2[0],\n          transferables = _handler$serialize2[1];\n        return [{\n          type: \"HANDLER\" /* WireValueType.HANDLER */,\n          name: name,\n          value: serializedValue\n        }, transferables];\n      }\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n  return [{\n    type: \"RAW\" /* WireValueType.RAW */,\n    value: value\n  }, transferCache.get(value) || []];\n}\nfunction fromWireValue(value) {\n  switch (value.type) {\n    case \"HANDLER\" /* WireValueType.HANDLER */:\n      return transferHandlers.get(value.name).deserialize(value.value);\n    case \"RAW\" /* WireValueType.RAW */:\n      return value.value;\n  }\n}\nfunction requestResponseMessage(ep, msg, transfers) {\n  return new Promise(function (resolve) {\n    var id = generateUUID();\n    ep.addEventListener(\"message\", function l(ev) {\n      if (!ev.data || !ev.data.id || ev.data.id !== id) {\n        return;\n      }\n      ep.removeEventListener(\"message\", l);\n      resolve(ev.data);\n    });\n    if (ep.start) {\n      ep.start();\n    }\n    ep.postMessage(Object.assign({\n      id: id\n    }, msg), transfers);\n  });\n}\nfunction generateUUID() {\n  return new Array(4).fill(0).map(function () {\n    return Math.floor(Math.random() * Number.MAX_SAFE_INTEGER).toString(16);\n  }).join(\"-\");\n}\nexport { createEndpoint, expose, finalizer, proxy, proxyMarker, releaseProxy, transfer, transferHandlers, windowEndpoint, wrap };","map":{"version":3,"names":["proxyMarker","Symbol","createEndpoint","releaseProxy","finalizer","throwMarker","isObject","val","_typeof","proxyTransferHandler","canHandle","serialize","obj","_MessageChannel","MessageChannel","port1","port2","expose","deserialize","port","start","wrap","throwTransferHandler","value","_ref","serialized","Error","isError","message","name","stack","Object","assign","transferHandlers","Map","isAllowedOrigin","allowedOrigins","origin","_iterator","_createForOfIteratorHelper","_step","s","n","done","allowedOrigin","RegExp","test","err","e","f","ep","arguments","length","undefined","globalThis","addEventListener","callback","ev","data","console","warn","concat","_Object$assign","path","id","type","argumentList","map","fromWireValue","returnValue","parent","slice","reduce","prop","rawValue","apply","_construct","_toConsumableArray","proxy","_MessageChannel2","transfer","_defineProperty","Promise","resolve","catch","then","_toWireValue","toWireValue","_toWireValue2","_slicedToArray","wireValue","transferables","postMessage","removeEventListener","closeEndPoint","error","_toWireValue3","TypeError","_toWireValue4","isMessagePort","endpoint","constructor","close","target","createProxy","throwIfProxyReleased","isReleased","releaseEndpoint","requestResponseMessage","proxyCounter","WeakMap","proxyFinalizers","FinalizationRegistry","newCount","get","set","registerProxy","register","unregisterProxy","unregister","isProxyReleased","Proxy","_target","r","p","toString","bind","_toWireValue6","_toWireValue7","_thisArg","rawArgumentList","last","_processArguments","processArguments","_processArguments2","construct","_processArguments3","_processArguments4","myFlat","arr","Array","prototype","processed","v","transferCache","transfers","windowEndpoint","w","context","targetOrigin","msg","_iterator2","_step2","_step2$value","handler","_handler$serialize","_handler$serialize2","serializedValue","generateUUID","l","fill","Math","floor","random","Number","MAX_SAFE_INTEGER","join"],"sources":["../../src/comlink.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AAIG;IAaUA,WAAW,GAAGC,MAAM,CAAC,eAAe;IACpCC,cAAc,GAAGD,MAAM,CAAC,kBAAkB;IAC1CE,YAAY,GAAGF,MAAM,CAAC,sBAAsB;IAC5CG,SAAS,GAAGH,MAAM,CAAC,mBAAmB;AAEnD,IAAMI,WAAW,GAAGJ,MAAM,CAAC,gBAAgB,CAAC;AAuJ5C,IAAMK,QAAQ,GAAG,SAAXA,QAAQA,CAAIC,GAAY;EAAA,OAC3BC,OAAA,CAAOD,GAAG,MAAK,QAAQ,IAAIA,GAAG,KAAK,IAAI,IAAK,OAAOA,GAAG,KAAK,UAAU;AAAA;AA+BxE;;AAEG;AACH,IAAME,oBAAoB,GAAyC;EACjEC,SAAS,EAAE,SAAAA,UAACH,GAAG;IAAA,OACbD,QAAQ,CAACC,GAAG,CAAC,IAAKA,GAAmB,CAACP,WAAW,CAAC;EAAA;EACpDW,SAAS,WAAAA,UAACC,GAAG;IACX,IAAAC,eAAA,GAAyB,IAAIC,cAAc,EAAE;MAArCC,KAAK,GAAAF,eAAA,CAALE,KAAK;MAAEC,KAAK,GAAAH,eAAA,CAALG,KAAK;IACpBC,MAAM,CAACL,GAAG,EAAEG,KAAK,CAAC;IAClB,OAAO,CAACC,KAAK,EAAE,CAACA,KAAK,CAAC,CAAC;GACxB;EACDE,WAAW,WAAAA,YAACC,IAAI;IACdA,IAAI,CAACC,KAAK,EAAE;IACZ,OAAOC,IAAI,CAACF,IAAI,CAAC;;CAEpB;AAUD;;AAEG;AACH,IAAMG,oBAAoB,GAGtB;EACFZ,SAAS,EAAE,SAAAA,UAACa,KAAK;IAAA,OACfjB,QAAQ,CAACiB,KAAK,CAAC,IAAIlB,WAAW,IAAIkB,KAAK;EAAA;EACzCZ,SAAS,WAAAA,UAAAa,IAAA,EAAU;IAAA,IAAPD,KAAK,GAAAC,IAAA,CAALD,KAAK;IACf,IAAIE,UAAiC;IACrC,IAAIF,KAAK,YAAYG,KAAK,EAAE;MAC1BD,UAAU,GAAG;QACXE,OAAO,EAAE,IAAI;QACbJ,KAAK,EAAE;UACLK,OAAO,EAAEL,KAAK,CAACK,OAAO;UACtBC,IAAI,EAAEN,KAAK,CAACM,IAAI;UAChBC,KAAK,EAAEP,KAAK,CAACO;QACd;OACF;IACF,OAAM;MACLL,UAAU,GAAG;QAAEE,OAAO,EAAE,KAAK;QAAEJ,KAAK,EAALA;MAAK,CAAE;IACvC;IACD,OAAO,CAACE,UAAU,EAAE,EAAE,CAAC;GACxB;EACDP,WAAW,WAAAA,YAACO,UAAU;IACpB,IAAIA,UAAU,CAACE,OAAO,EAAE;MACtB,MAAMI,MAAM,CAACC,MAAM,CACjB,IAAIN,KAAK,CAACD,UAAU,CAACF,KAAK,CAACK,OAAO,CAAC,EACnCH,UAAU,CAACF,KAAK,CACjB;IACF;IACD,MAAME,UAAU,CAACF,KAAK;;CAEzB;AAED;;AAEG;AACU,IAAAU,gBAAgB,GAAG,IAAIC,GAAG,CAGrC,CACA,CAAC,OAAO,EAAEzB,oBAAoB,CAAC,EAC/B,CAAC,OAAO,EAAEa,oBAAoB,CAAC,CAChC;AAED,SAASa,eAAeA,CACtBC,cAAmC,EACnCC,MAAc;EAAA,IAAAC,SAAA,GAAAC,0BAAA,CAEcH,cAAc;IAAAI,KAAA;EAAA;IAA1C,KAAAF,SAAA,CAAAG,CAAA,MAAAD,KAAA,GAAAF,SAAA,CAAAI,CAAA,IAAAC,IAAA,GAA4C;MAAA,IAAjCC,aAAa,GAAAJ,KAAA,CAAAjB,KAAA;MACtB,IAAIc,MAAM,KAAKO,aAAa,IAAIA,aAAa,KAAK,GAAG,EAAE;QACrD,OAAO,IAAI;MACZ;MACD,IAAIA,aAAa,YAAYC,MAAM,IAAID,aAAa,CAACE,IAAI,CAACT,MAAM,CAAC,EAAE;QACjE,OAAO,IAAI;MACZ;IACF;EAAA,SAAAU,GAAA;IAAAT,SAAA,CAAAU,CAAA,CAAAD,GAAA;EAAA;IAAAT,SAAA,CAAAW,CAAA;EAAA;EACD,OAAO,KAAK;AACd;AAEM,SAAUhC,MAAMA,CACpBL,GAAQ,EAEmC;EAAA,IAD3CsC,EAAe,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAAG,UAAiB;EAAA,IAChClB,cAAA,GAAAe,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAsC,CAAC,GAAG,CAAC;EAE3CD,EAAE,CAACK,gBAAgB,CAAC,SAAS,EAAE,SAASC,QAAQA,CAACC,EAAgB;IAC/D,IAAI,CAACA,EAAE,IAAI,CAACA,EAAE,CAACC,IAAI,EAAE;MACnB;IACD;IACD,IAAI,CAACvB,eAAe,CAACC,cAAc,EAAEqB,EAAE,CAACpB,MAAM,CAAC,EAAE;MAC/CsB,OAAO,CAACC,IAAI,oBAAAC,MAAA,CAAoBJ,EAAE,CAACpB,MAAM,wBAAqB,CAAC;MAC/D;IACD;IACD,IAAAyB,cAAA,GAAwB/B,MAAA,CAAAC,MAAA;QACtB+B,IAAI,EAAE;MAAc,CAChB,EAAAN,EAAE,CAACC,IAAgB,CACxB;MAHOM,EAAE,GAAAF,cAAA,CAAFE,EAAE;MAAEC,IAAI,GAAAH,cAAA,CAAJG,IAAI;MAAEF,IAAI,GAAAD,cAAA,CAAJC,IAAI;IAItB,IAAMG,YAAY,GAAG,CAACT,EAAE,CAACC,IAAI,CAACQ,YAAY,IAAI,EAAE,EAAEC,GAAG,CAACC,aAAa,CAAC;IACpE,IAAIC,WAAW;IACf,IAAI;MACF,IAAMC,MAAM,GAAGP,IAAI,CAACQ,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACC,MAAM,CAAC,UAAC5D,GAAG,EAAE6D,IAAI;QAAA,OAAK7D,GAAG,CAAC6D,IAAI,CAAC;MAAA,GAAE7D,GAAG,CAAC;MACtE,IAAM8D,QAAQ,GAAGX,IAAI,CAACS,MAAM,CAAC,UAAC5D,GAAG,EAAE6D,IAAI;QAAA,OAAK7D,GAAG,CAAC6D,IAAI,CAAC;MAAA,GAAE7D,GAAG,CAAC;MAC3D,QAAQqD,IAAI;QACV;UACE;YACEI,WAAW,GAAGK,QAAQ;UACvB;UACD;QACF;UACE;YACEJ,MAAM,CAACP,IAAI,CAACQ,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGH,aAAa,CAACX,EAAE,CAACC,IAAI,CAACnC,KAAK,CAAC;YACxD8C,WAAW,GAAG,IAAI;UACnB;UACD;QACF;UACE;YACEA,WAAW,GAAGK,QAAQ,CAACC,KAAK,CAACL,MAAM,EAAEJ,YAAY,CAAC;UACnD;UACD;QACF;UACE;YACE,IAAM3C,KAAK,GAAAqD,UAAA,CAAOF,QAAQ,EAAAG,kBAAA,CAAIX,YAAY,EAAC;YAC3CG,WAAW,GAAGS,KAAK,CAACvD,KAAK,CAAC;UAC3B;UACD;QACF;UACE;YACE,IAAAwD,gBAAA,GAAyB,IAAIjE,cAAc,EAAE;cAArCC,KAAK,GAAAgE,gBAAA,CAALhE,KAAK;cAAEC,KAAK,GAAA+D,gBAAA,CAAL/D,KAAK;YACpBC,MAAM,CAACL,GAAG,EAAEI,KAAK,CAAC;YAClBqD,WAAW,GAAGW,QAAQ,CAACjE,KAAK,EAAE,CAACA,KAAK,CAAC,CAAC;UACvC;UACD;QACF;UACE;YACEsD,WAAW,GAAGhB,SAAS;UACxB;UACD;QACF;UACE;MACH;IACF,EAAC,OAAO9B,KAAK,EAAE;MACd8C,WAAW,GAAAY,eAAA;QAAK1D,KAAK,EAALA;MAAK,GAAGlB,WAAW,EAAG,CAAC,CAAE;IAC1C;IACD6E,OAAO,CAACC,OAAO,CAACd,WAAW,CAAC,CACzBe,KAAK,CAAC,UAAC7D,KAAK,EAAI;MACf,OAAA0D,eAAA;QAAS1D,KAAK,EAALA;MAAK,GAAGlB,WAAW,EAAG,CAAC;IAClC,CAAC,CAAC,CACDgF,IAAI,CAAC,UAAChB,WAAW,EAAI;MACpB,IAAAiB,YAAA,GAAmCC,WAAW,CAAClB,WAAW,CAAC;QAAAmB,aAAA,GAAAC,cAAA,CAAAH,YAAA;QAApDI,SAAS,GAAAF,aAAA;QAAEG,aAAa,GAAAH,aAAA;MAC/BtC,EAAE,CAAC0C,WAAW,CAAM7D,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KAAA0D,SAAS;QAAE1B,EAAE,EAAFA;MAAE,IAAI2B,aAAa,CAAC;MACnD,IAAI1B,IAAI,0CAA0B;;QAEhCf,EAAE,CAAC2C,mBAAmB,CAAC,SAAS,EAAErC,QAAe,CAAC;QAClDsC,aAAa,CAAC5C,EAAE,CAAC;QACjB,IAAI9C,SAAS,IAAIQ,GAAG,IAAI,OAAOA,GAAG,CAACR,SAAS,CAAC,KAAK,UAAU,EAAE;UAC5DQ,GAAG,CAACR,SAAS,CAAC,EAAE;QACjB;MACF;IACH,CAAC,CAAC,CACDgF,KAAK,CAAC,UAACW,KAAK,EAAI;;MAEf,IAAAC,aAAA,GAAmCT,WAAW,CAAAN,eAAA;UAC5C1D,KAAK,EAAE,IAAI0E,SAAS,CAAC,6BAA6B;QAAC,GAClD5F,WAAW,EAAG,CAAC,CACjB,CAAC;QAAA6F,aAAA,GAAAT,cAAA,CAAAO,aAAA;QAHKN,SAAS,GAAAQ,aAAA;QAAEP,aAAa,GAAAO,aAAA;MAI/BhD,EAAE,CAAC0C,WAAW,CAAM7D,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KAAA0D,SAAS;QAAE1B,EAAE,EAAFA;MAAE,IAAI2B,aAAa,CAAC;IACrD,CAAC,CAAC;EACN,CAAQ,CAAC;EACT,IAAIzC,EAAE,CAAC9B,KAAK,EAAE;IACZ8B,EAAE,CAAC9B,KAAK,EAAE;EACX;AACH;AAEA,SAAS+E,aAAaA,CAACC,QAAkB;EACvC,OAAOA,QAAQ,CAACC,WAAW,CAACxE,IAAI,KAAK,aAAa;AACpD;AAEA,SAASiE,aAAaA,CAACM,QAAkB;EACvC,IAAID,aAAa,CAACC,QAAQ,CAAC,EAAEA,QAAQ,CAACE,KAAK,EAAE;AAC/C;AAEgB,SAAAjF,IAAIA,CAAI6B,EAAY,EAAEqD,MAAY;EAChD,OAAOC,WAAW,CAAItD,EAAE,EAAE,EAAE,EAAEqD,MAAM,CAAQ;AAC9C;AAEA,SAASE,oBAAoBA,CAACC,UAAmB;EAC/C,IAAIA,UAAU,EAAE;IACd,MAAM,IAAIhF,KAAK,CAAC,4CAA4C,CAAC;EAC9D;AACH;AAEA,SAASiF,eAAeA,CAACzD,EAAY;EACnC,OAAO0D,sBAAsB,CAAC1D,EAAE,EAAE;IAChCe,IAAI,EAAqB;EAC1B,EAAC,CAACoB,IAAI,CAAC,YAAK;IACXS,aAAa,CAAC5C,EAAE,CAAC;EACnB,CAAC,CAAC;AACJ;AAaA,IAAM2D,YAAY,GAAG,IAAIC,OAAO,EAAoB;AACpD,IAAMC,eAAe,GACnB,sBAAsB,IAAIzD,UAAU,IACpC,IAAI0D,oBAAoB,CAAC,UAAC9D,EAAY,EAAI;EACxC,IAAM+D,QAAQ,GAAG,CAACJ,YAAY,CAACK,GAAG,CAAChE,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC;EAChD2D,YAAY,CAACM,GAAG,CAACjE,EAAE,EAAE+D,QAAQ,CAAC;EAC9B,IAAIA,QAAQ,KAAK,CAAC,EAAE;IAClBN,eAAe,CAACzD,EAAE,CAAC;EACpB;AACH,CAAC,CAAC;AAEJ,SAASkE,aAAaA,CAACtC,KAAa,EAAE5B,EAAY;EAChD,IAAM+D,QAAQ,GAAG,CAACJ,YAAY,CAACK,GAAG,CAAChE,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC;EAChD2D,YAAY,CAACM,GAAG,CAACjE,EAAE,EAAE+D,QAAQ,CAAC;EAC9B,IAAIF,eAAe,EAAE;IACnBA,eAAe,CAACM,QAAQ,CAACvC,KAAK,EAAE5B,EAAE,EAAE4B,KAAK,CAAC;EAC3C;AACH;AAEA,SAASwC,eAAeA,CAACxC,KAAa;EACpC,IAAIiC,eAAe,EAAE;IACnBA,eAAe,CAACQ,UAAU,CAACzC,KAAK,CAAC;EAClC;AACH;AAEA,SAAS0B,WAAWA,CAClBtD,EAAY,EAEmB;EAAA,IAD/Ba,IAAA,GAAAZ,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAqC,EAAE;EAAA,IACvCoD,MAAiB,GAAApD,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,oBAAc;EAE/B,IAAIqE,eAAe,GAAG,KAAK;EAC3B,IAAM1C,KAAK,GAAG,IAAI2C,KAAK,CAAClB,MAAM,EAAE;IAC9BW,GAAG,WAAAA,IAACQ,OAAO,EAAEjD,IAAI;MACfgC,oBAAoB,CAACe,eAAe,CAAC;MACrC,IAAI/C,IAAI,KAAKtE,YAAY,EAAE;QACzB,OAAO,YAAK;UACVmH,eAAe,CAACxC,KAAK,CAAC;UACtB6B,eAAe,CAACzD,EAAE,CAAC;UACnBsE,eAAe,GAAG,IAAI;QACxB,CAAC;MACF;MACD,IAAI/C,IAAI,KAAK,MAAM,EAAE;QACnB,IAAIV,IAAI,CAACX,MAAM,KAAK,CAAC,EAAE;UACrB,OAAO;YAAEiC,IAAI,EAAE,SAAAA,KAAA;cAAA,OAAMP,KAAK;YAAA;UAAA,CAAE;QAC7B;QACD,IAAM6C,CAAC,GAAGf,sBAAsB,CAAC1D,EAAE,EAAE;UACnCe,IAAI,EAAiB;UACrBF,IAAI,EAAEA,IAAI,CAACI,GAAG,CAAC,UAACyD,CAAC;YAAA,OAAKA,CAAC,CAACC,QAAQ,EAAE;UAAA;QACnC,EAAC,CAACxC,IAAI,CAACjB,aAAa,CAAC;QACtB,OAAOuD,CAAC,CAACtC,IAAI,CAACyC,IAAI,CAACH,CAAC,CAAC;MACtB;MACD,OAAOnB,WAAW,CAACtD,EAAE,KAAAW,MAAA,CAAAgB,kBAAA,CAAMd,IAAI,IAAEU,IAAI,EAAC,CAAC;KACxC;IACD0C,GAAG,WAAAA,IAACO,OAAO,EAAEjD,IAAI,EAAEC,QAAQ;MACzB+B,oBAAoB,CAACe,eAAe,CAAC;;;MAGrC,IAAAO,aAAA,GAA+BxC,WAAW,CAACb,QAAQ,CAAC;QAAAsD,aAAA,GAAAvC,cAAA,CAAAsC,aAAA;QAA7CxG,KAAK,GAAAyG,aAAA;QAAErC,aAAa,GAAAqC,aAAA;MAC3B,OAAOpB,sBAAsB,CAC3B1D,EAAE,EACF;QACEe,IAAI,EAAiB;QACrBF,IAAI,EAAE,GAAAF,MAAA,CAAAgB,kBAAA,CAAId,IAAI,IAAEU,IAAI,GAAEN,GAAG,CAAC,UAACyD,CAAC;UAAA,OAAKA,CAAC,CAACC,QAAQ,EAAE;QAAA,EAAC;QAC9CtG,KAAK,EAALA;MACD,GACDoE,aAAa,CACd,CAACN,IAAI,CAACjB,aAAa,CAAQ;KAC7B;IACDO,KAAK,WAAAA,MAAC+C,OAAO,EAAEO,QAAQ,EAAEC,eAAe;MACtCzB,oBAAoB,CAACe,eAAe,CAAC;MACrC,IAAMW,IAAI,GAAGpE,IAAI,CAACA,IAAI,CAACX,MAAM,GAAG,CAAC,CAAC;MAClC,IAAK+E,IAAY,KAAKjI,cAAc,EAAE;QACpC,OAAO0G,sBAAsB,CAAC1D,EAAE,EAAE;UAChCe,IAAI,EAAsB;QAC3B,EAAC,CAACoB,IAAI,CAACjB,aAAa,CAAC;MACvB;;MAED,IAAI+D,IAAI,KAAK,MAAM,EAAE;QACnB,OAAO3B,WAAW,CAACtD,EAAE,EAAEa,IAAI,CAACQ,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;MAC1C;MACD,IAAA6D,iBAAA,GAAsCC,gBAAgB,CAACH,eAAe,CAAC;QAAAI,kBAAA,GAAA7C,cAAA,CAAA2C,iBAAA;QAAhElE,YAAY,GAAAoE,kBAAA;QAAE3C,aAAa,GAAA2C,kBAAA;MAClC,OAAO1B,sBAAsB,CAC3B1D,EAAE,EACF;QACEe,IAAI,EAAmB;QACvBF,IAAI,EAAEA,IAAI,CAACI,GAAG,CAAC,UAACyD,CAAC;UAAA,OAAKA,CAAC,CAACC,QAAQ,EAAE;QAAA,EAAC;QACnC3D,YAAY,EAAZA;MACD,GACDyB,aAAa,CACd,CAACN,IAAI,CAACjB,aAAa,CAAC;KACtB;IACDmE,SAAS,WAAAA,UAACb,OAAO,EAAEQ,eAAe;MAChCzB,oBAAoB,CAACe,eAAe,CAAC;MACrC,IAAAgB,kBAAA,GAAsCH,gBAAgB,CAACH,eAAe,CAAC;QAAAO,kBAAA,GAAAhD,cAAA,CAAA+C,kBAAA;QAAhEtE,YAAY,GAAAuE,kBAAA;QAAE9C,aAAa,GAAA8C,kBAAA;MAClC,OAAO7B,sBAAsB,CAC3B1D,EAAE,EACF;QACEe,IAAI,EAAuB;QAC3BF,IAAI,EAAEA,IAAI,CAACI,GAAG,CAAC,UAACyD,CAAC;UAAA,OAAKA,CAAC,CAACC,QAAQ,EAAE;QAAA,EAAC;QACnC3D,YAAY,EAAZA;MACD,GACDyB,aAAa,CACd,CAACN,IAAI,CAACjB,aAAa,CAAC;;EAExB,EAAC;EACFgD,aAAa,CAACtC,KAAK,EAAE5B,EAAE,CAAC;EACxB,OAAO4B,KAAY;AACrB;AAEA,SAAS4D,MAAMA,CAAIC,GAAgB;EACjC,OAAOC,KAAK,CAACC,SAAS,CAAChF,MAAM,CAACc,KAAK,CAAC,EAAE,EAAEgE,GAAG,CAAC;AAC9C;AAEA,SAASN,gBAAgBA,CAACnE,YAAmB;EAC3C,IAAM4E,SAAS,GAAG5E,YAAY,CAACC,GAAG,CAACoB,WAAW,CAAC;EAC/C,OAAO,CAACuD,SAAS,CAAC3E,GAAG,CAAC,UAAC4E,CAAC;IAAA,OAAKA,CAAC,CAAC,CAAC,CAAC;EAAA,EAAC,EAAEL,MAAM,CAACI,SAAS,CAAC3E,GAAG,CAAC,UAAC4E,CAAC;IAAA,OAAKA,CAAC,CAAC,CAAC,CAAC;EAAA,EAAC,CAAC,CAAC;AACzE;AAEA,IAAMC,aAAa,GAAG,IAAIlC,OAAO,EAAuB;AACxC,SAAA9B,QAAQA,CAAIpE,GAAM,EAAEqI,SAAyB;EAC3DD,aAAa,CAAC7B,GAAG,CAACvG,GAAG,EAAEqI,SAAS,CAAC;EACjC,OAAOrI,GAAG;AACZ;AAEM,SAAUkE,KAAKA,CAAelE,GAAM;EACxC,OAAOmB,MAAM,CAACC,MAAM,CAACpB,GAAG,EAAAqE,eAAA,KAAKjF,WAAW,EAAG,IAAI,CAAE,CAAQ;AAC3D;AAEM,SAAUkJ,cAAcA,CAC5BC,CAAwB,EAEN;EAAA,IADlBC,OAAA,GAAAjG,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAuBG,UAAU;EAAA,IACjC+F,YAAY,GAAAlG,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,GAAG;EAElB,OAAO;IACLyC,WAAW,EAAE,SAAAA,YAAC0D,GAAQ,EAAE3D,aAA6B;MAAA,OACnDwD,CAAC,CAACvD,WAAW,CAAC0D,GAAG,EAAED,YAAY,EAAE1D,aAAa,CAAC;IAAA;IACjDpC,gBAAgB,EAAE6F,OAAO,CAAC7F,gBAAgB,CAACuE,IAAI,CAACsB,OAAO,CAAC;IACxDvD,mBAAmB,EAAEuD,OAAO,CAACvD,mBAAmB,CAACiC,IAAI,CAACsB,OAAO;GAC9D;AACH;AAEA,SAAS7D,WAAWA,CAAChE,KAAU;EAAA,IAAAgI,UAAA,GAAAhH,0BAAA,CACCN,gBAAgB;IAAAuH,MAAA;EAAA;IAA9C,KAAAD,UAAA,CAAA9G,CAAA,MAAA+G,MAAA,GAAAD,UAAA,CAAA7G,CAAA,IAAAC,IAAA,GAAgD;MAAA,IAAA8G,YAAA,GAAAhE,cAAA,CAAA+D,MAAA,CAAAjI,KAAA;QAApCM,IAAI,GAAA4H,YAAA;QAAEC,OAAO,GAAAD,YAAA;MACvB,IAAIC,OAAO,CAAChJ,SAAS,CAACa,KAAK,CAAC,EAAE;QAC5B,IAAAoI,kBAAA,GAAyCD,OAAO,CAAC/I,SAAS,CAACY,KAAK,CAAC;UAAAqI,mBAAA,GAAAnE,cAAA,CAAAkE,kBAAA;UAA1DE,eAAe,GAAAD,mBAAA;UAAEjE,aAAa,GAAAiE,mBAAA;QACrC,OAAO,CACL;UACE3F,IAAI,EAAuB;UAC3BpC,IAAI,EAAJA,IAAI;UACJN,KAAK,EAAEsI;QACR,GACDlE,aAAa,CACd;MACF;IACF;EAAA,SAAA5C,GAAA;IAAAwG,UAAA,CAAAvG,CAAA,CAAAD,GAAA;EAAA;IAAAwG,UAAA,CAAAtG,CAAA;EAAA;EACD,OAAO,CACL;IACEgB,IAAI,EAAmB;IACvB1C,KAAK,EAALA;EACD,GACDyH,aAAa,CAAC9B,GAAG,CAAC3F,KAAK,CAAC,IAAI,EAAE,CAC/B;AACH;AAEA,SAAS6C,aAAaA,CAAC7C,KAAgB;EACrC,QAAQA,KAAK,CAAC0C,IAAI;IAChB;MACE,OAAOhC,gBAAgB,CAACiF,GAAG,CAAC3F,KAAK,CAACM,IAAI,CAAE,CAACX,WAAW,CAACK,KAAK,CAACA,KAAK,CAAC;IACnE;MACE,OAAOA,KAAK,CAACA,KAAK;EACrB;AACH;AAEA,SAASqF,sBAAsBA,CAC7B1D,EAAY,EACZoG,GAAY,EACZL,SAA0B;EAE1B,OAAO,IAAI/D,OAAO,CAAC,UAACC,OAAO,EAAI;IAC7B,IAAMnB,EAAE,GAAG8F,YAAY,EAAE;IACzB5G,EAAE,CAACK,gBAAgB,CAAC,SAAS,EAAE,SAASwG,CAACA,CAACtG,EAAgB;MACxD,IAAI,CAACA,EAAE,CAACC,IAAI,IAAI,CAACD,EAAE,CAACC,IAAI,CAACM,EAAE,IAAIP,EAAE,CAACC,IAAI,CAACM,EAAE,KAAKA,EAAE,EAAE;QAChD;MACD;MACDd,EAAE,CAAC2C,mBAAmB,CAAC,SAAS,EAAEkE,CAAQ,CAAC;MAC3C5E,OAAO,CAAC1B,EAAE,CAACC,IAAI,CAAC;IAClB,CAAQ,CAAC;IACT,IAAIR,EAAE,CAAC9B,KAAK,EAAE;MACZ8B,EAAE,CAAC9B,KAAK,EAAE;IACX;IACD8B,EAAE,CAAC0C,WAAW,CAAG7D,MAAA,CAAAC,MAAA;MAAAgC,EAAE,EAAFA;IAAE,GAAKsF,GAAG,GAAIL,SAAS,CAAC;EAC3C,CAAC,CAAC;AACJ;AAEA,SAASa,YAAYA,CAAA;EACnB,OAAO,IAAIlB,KAAK,CAAC,CAAC,CAAC,CAChBoB,IAAI,CAAC,CAAC,CAAC,CACP7F,GAAG,CAAC;IAAA,OAAM8F,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAGC,MAAM,CAACC,gBAAgB,CAAC,CAACxC,QAAQ,CAAC,EAAE,CAAC;EAAA,EAAC,CAC3EyC,IAAI,CAAC,GAAG,CAAC;AACd"},"metadata":{},"sourceType":"module","externalDependencies":[]}