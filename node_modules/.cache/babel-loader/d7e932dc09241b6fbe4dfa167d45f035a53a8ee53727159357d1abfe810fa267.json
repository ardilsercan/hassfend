{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\nimport \"core-js/modules/es.array.concat.js\";\nimport { differenceInDays, endOfDay } from \"date-fns\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { formatDate } from \"../../../../common/datetime/format_date\";\nimport { getEnergyDataCollection } from \"../../../../data/energy\";\nimport { SubscribeMixin } from \"../../../../mixins/subscribe-mixin\";\nimport { hasConfigChanged } from \"../../common/has-changed\";\nexport var HuiEnergyCompareCard = _decorate([customElement(\"hui-energy-compare-card\")], function (_initialize, _SubscribeMixin) {\n  var HuiEnergyCompareCard = /*#__PURE__*/function (_SubscribeMixin2) {\n    _inherits(HuiEnergyCompareCard, _SubscribeMixin2);\n    function HuiEnergyCompareCard() {\n      var _this;\n      _classCallCheck(this, HuiEnergyCompareCard);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, HuiEnergyCompareCard, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(HuiEnergyCompareCard);\n  }(_SubscribeMixin);\n  return {\n    F: HuiEnergyCompareCard,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_config\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_start\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_end\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_startCompare\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_endCompare\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean,\n        reflect: true\n      })],\n      key: \"hidden\",\n      value: function value() {\n        return true;\n      }\n    }, {\n      kind: \"method\",\n      key: \"getCardSize\",\n      value: function getCardSize() {\n        return 1;\n      }\n    }, {\n      kind: \"method\",\n      key: \"setConfig\",\n      value: function setConfig(config) {\n        this._config = config;\n      }\n    }, {\n      kind: \"field\",\n      key: \"hassSubscribeRequiredHostProps\",\n      value: function value() {\n        return [\"_config\"];\n      }\n    }, {\n      kind: \"method\",\n      key: \"hassSubscribe\",\n      value: function hassSubscribe() {\n        var _this2 = this;\n        return [getEnergyDataCollection(this.hass, {\n          key: this._config.collection_key\n        }).subscribe(function (data) {\n          return _this2._update(data);\n        })];\n      }\n    }, {\n      kind: \"method\",\n      key: \"shouldUpdate\",\n      value: function shouldUpdate(changedProps) {\n        return hasConfigChanged(this, changedProps) || changedProps.size > 1 || !changedProps.has(\"hass\");\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this._startCompare || !this._endCompare) {\n          return nothing;\n        }\n        var dayDifference = differenceInDays(this._endCompare, this._startCompare);\n        return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n      <ha-alert dismissable @alert-dismissed-clicked=\", \">\\n        \", \"\\n      </ha-alert>\\n    \"])), this._stopCompare, this.hass.localize(\"ui.panel.energy.compare.info\", {\n          start: html(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"<b\\n            >\", \"\", \"</b\\n          >\"])), formatDate(this._start, this.hass.locale, this.hass.config), dayDifference > 0 ? \" -\\n          \".concat(formatDate(this._end || endOfDay(new Date()), this.hass.locale, this.hass.config)) : \"\"),\n          end: html(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"<b\\n            >\", \"\", \"</b\\n          >\"])), formatDate(this._startCompare, this.hass.locale, this.hass.config), dayDifference > 0 ? \" -\\n          \".concat(formatDate(this._endCompare, this.hass.locale, this.hass.config)) : \"\")\n        }));\n      }\n    }, {\n      kind: \"method\",\n      key: \"_update\",\n      value: function _update(data) {\n        this._start = data.start;\n        this._end = data.end;\n        this._startCompare = data.startCompare;\n        this._endCompare = data.endCompare;\n        this.hidden = !this._startCompare;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_stopCompare\",\n      value: function _stopCompare() {\n        var energyCollection = getEnergyDataCollection(this.hass, {\n          key: this._config.collection_key\n        });\n        energyCollection.setCompare(false);\n        energyCollection.refresh();\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return css(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n      mwc-button {\\n        width: max-content;\\n      }\\n    \"])));\n      }\n    }]\n  };\n}, SubscribeMixin(LitElement));","map":{"version":3,"names":["differenceInDays","endOfDay","css","html","LitElement","nothing","customElement","property","state","formatDate","getEnergyDataCollection","SubscribeMixin","hasConfigChanged","HuiEnergyCompareCard","_decorate","_initialize","_SubscribeMixin","_SubscribeMixin2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","decorators","attribute","key","value","type","Boolean","reflect","getCardSize","setConfig","config","_config","hassSubscribe","_this2","hass","collection_key","subscribe","data","_update","shouldUpdate","changedProps","size","has","render","_startCompare","_endCompare","dayDifference","_templateObject","_taggedTemplateLiteral","_stopCompare","localize","start","_templateObject2","_start","locale","_end","Date","end","_templateObject3","startCompare","endCompare","hidden","energyCollection","setCompare","refresh","static","styles","_templateObject4"],"sources":["/workspaces/frontend/src/panels/lovelace/cards/energy/hui-energy-compare-card.ts"],"sourcesContent":["import { differenceInDays, endOfDay } from \"date-fns\";\nimport { UnsubscribeFunc } from \"home-assistant-js-websocket\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  nothing,\n  PropertyValues,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { formatDate } from \"../../../../common/datetime/format_date\";\nimport { EnergyData, getEnergyDataCollection } from \"../../../../data/energy\";\nimport { SubscribeMixin } from \"../../../../mixins/subscribe-mixin\";\nimport { HomeAssistant } from \"../../../../types\";\nimport { LovelaceCard } from \"../../types\";\nimport { EnergyCardBaseConfig } from \"../types\";\nimport { hasConfigChanged } from \"../../common/has-changed\";\n\n@customElement(\"hui-energy-compare-card\")\nexport class HuiEnergyCompareCard\n  extends SubscribeMixin(LitElement)\n  implements LovelaceCard\n{\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @state() private _config?: EnergyCardBaseConfig;\n\n  @state() private _start?: Date;\n\n  @state() private _end?: Date;\n\n  @state() private _startCompare?: Date;\n\n  @state() private _endCompare?: Date;\n\n  @property({ type: Boolean, reflect: true }) hidden = true;\n\n  public getCardSize(): Promise<number> | number {\n    return 1;\n  }\n\n  public setConfig(config: EnergyCardBaseConfig): void {\n    this._config = config;\n  }\n\n  protected hassSubscribeRequiredHostProps = [\"_config\"];\n\n  public hassSubscribe(): UnsubscribeFunc[] {\n    return [\n      getEnergyDataCollection(this.hass, {\n        key: this._config!.collection_key,\n      }).subscribe((data) => this._update(data)),\n    ];\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return (\n      hasConfigChanged(this, changedProps) ||\n      changedProps.size > 1 ||\n      !changedProps.has(\"hass\")\n    );\n  }\n\n  protected render() {\n    if (!this._startCompare || !this._endCompare) {\n      return nothing;\n    }\n\n    const dayDifference = differenceInDays(\n      this._endCompare,\n      this._startCompare\n    );\n\n    return html`\n      <ha-alert dismissable @alert-dismissed-clicked=${this._stopCompare}>\n        ${this.hass.localize(\"ui.panel.energy.compare.info\", {\n          start: html`<b\n            >${formatDate(\n              this._start!,\n              this.hass.locale,\n              this.hass.config\n            )}${dayDifference > 0\n              ? ` -\n          ${formatDate(\n            this._end || endOfDay(new Date()),\n            this.hass.locale,\n            this.hass.config\n          )}`\n              : \"\"}</b\n          >`,\n          end: html`<b\n            >${formatDate(\n              this._startCompare,\n              this.hass.locale,\n              this.hass.config\n            )}${dayDifference > 0\n              ? ` -\n          ${formatDate(this._endCompare, this.hass.locale, this.hass.config)}`\n              : \"\"}</b\n          >`,\n        })}\n      </ha-alert>\n    `;\n  }\n\n  private _update(data: EnergyData): void {\n    this._start = data.start;\n    this._end = data.end;\n    this._startCompare = data.startCompare;\n    this._endCompare = data.endCompare;\n    this.hidden = !this._startCompare;\n  }\n\n  private _stopCompare(): void {\n    const energyCollection = getEnergyDataCollection(this.hass, {\n      key: this._config!.collection_key,\n    });\n    energyCollection.setCompare(false);\n    energyCollection.refresh();\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      mwc-button {\n        width: max-content;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-energy-compare-card\": HuiEnergyCompareCard;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}