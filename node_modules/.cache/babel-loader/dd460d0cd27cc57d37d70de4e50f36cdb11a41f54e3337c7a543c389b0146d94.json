{"ast":null,"code":"import _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport { ReactiveElement } from \"lit\";\nimport { property } from \"lit/decorators\";\nimport { createCardElement } from \"../../create-element/create-card-element\";\nimport { createErrorCardConfig } from \"../../create-element/create-element-base\";\nexport var HuiCardPreview = _decorate(null, function (_initialize, _ReactiveElement) {\n  var HuiCardPreview = /*#__PURE__*/function (_ReactiveElement2) {\n    _inherits(HuiCardPreview, _ReactiveElement2);\n    function HuiCardPreview() {\n      var _this;\n      _classCallCheck(this, HuiCardPreview);\n      _this = _callSuper(this, HuiCardPreview);\n      _initialize(_assertThisInitialized(_this));\n      _this.addEventListener(\"ll-rebuild\", function () {\n        _this._cleanup();\n        if (_this.config) {\n          _this._createCard(_this.config);\n        }\n      });\n      return _this;\n    }\n    return _createClass(HuiCardPreview);\n  }(_ReactiveElement);\n  return {\n    F: HuiCardPreview,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"config\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"_element\",\n      value: void 0\n    }, {\n      kind: \"get\",\n      key: \"_error\",\n      value: function _error() {\n        var _this$_element;\n        return ((_this$_element = this._element) === null || _this$_element === void 0 ? void 0 : _this$_element.tagName) === \"HUI-ERROR-CARD\";\n      }\n    }, {\n      kind: \"method\",\n      key: \"createRenderRoot\",\n      value: function createRenderRoot() {\n        return this;\n      }\n    }, {\n      kind: \"method\",\n      key: \"update\",\n      value: function update(changedProperties) {\n        _get(_getPrototypeOf(HuiCardPreview.prototype), \"update\", this).call(this, changedProperties);\n        if (changedProperties.has(\"config\")) {\n          var oldConfig = changedProperties.get(\"config\");\n          if (!this.config) {\n            this._cleanup();\n            return;\n          }\n          if (!this.config.type) {\n            this._createCard(createErrorCardConfig(\"No card type found\", this.config));\n            return;\n          }\n          if (!this._element) {\n            this._createCard(this.config);\n            return;\n          }\n\n          // in case the element was an error element we always want to recreate it\n          if (!this._error && oldConfig && this.config.type === oldConfig.type) {\n            try {\n              this._element.setConfig(this.config);\n            } catch (err) {\n              this._createCard(createErrorCardConfig(err.message, this.config));\n            }\n          } else {\n            this._createCard(this.config);\n          }\n        }\n        if (changedProperties.has(\"hass\")) {\n          if (this._element) {\n            this._element.hass = this.hass;\n          }\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_createCard\",\n      value: function _createCard(configValue) {\n        this._cleanup();\n        this._element = createCardElement(configValue);\n        this._element.editMode = true;\n        if (this.hass) {\n          this._element.hass = this.hass;\n        }\n        this.appendChild(this._element);\n      }\n    }, {\n      kind: \"method\",\n      key: \"_cleanup\",\n      value: function _cleanup() {\n        if (!this._element) {\n          return;\n        }\n        this.removeChild(this._element);\n        this._element = undefined;\n      }\n    }]\n  };\n}, ReactiveElement);\ncustomElements.define(\"hui-card-preview\", HuiCardPreview);","map":{"version":3,"names":["ReactiveElement","property","createCardElement","createErrorCardConfig","HuiCardPreview","_decorate","_initialize","_ReactiveElement","_ReactiveElement2","_inherits","_this","_classCallCheck","_callSuper","_assertThisInitialized","addEventListener","_cleanup","config","_createCard","_createClass","F","d","kind","decorators","attribute","key","value","_error","_this$_element","_element","tagName","createRenderRoot","update","changedProperties","_get","_getPrototypeOf","prototype","call","has","oldConfig","get","type","setConfig","err","message","hass","configValue","editMode","appendChild","removeChild","undefined","customElements","define"],"sources":["/workspaces/frontend/src/panels/lovelace/editor/card-editor/hui-card-preview.ts"],"sourcesContent":["import { PropertyValues, ReactiveElement } from \"lit\";\nimport { property } from \"lit/decorators\";\nimport { LovelaceCardConfig } from \"../../../../data/lovelace/config/card\";\nimport { HomeAssistant } from \"../../../../types\";\nimport { createCardElement } from \"../../create-element/create-card-element\";\nimport { createErrorCardConfig } from \"../../create-element/create-element-base\";\nimport { LovelaceCard } from \"../../types\";\n\nexport class HuiCardPreview extends ReactiveElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property({ attribute: false }) public config?: LovelaceCardConfig;\n\n  private _element?: LovelaceCard;\n\n  private get _error() {\n    return this._element?.tagName === \"HUI-ERROR-CARD\";\n  }\n\n  constructor() {\n    super();\n    this.addEventListener(\"ll-rebuild\", () => {\n      this._cleanup();\n      if (this.config) {\n        this._createCard(this.config);\n      }\n    });\n  }\n\n  protected createRenderRoot() {\n    return this;\n  }\n\n  protected update(changedProperties: PropertyValues) {\n    super.update(changedProperties);\n\n    if (changedProperties.has(\"config\")) {\n      const oldConfig = changedProperties.get(\"config\") as\n        | undefined\n        | LovelaceCardConfig;\n\n      if (!this.config) {\n        this._cleanup();\n        return;\n      }\n\n      if (!this.config.type) {\n        this._createCard(\n          createErrorCardConfig(\"No card type found\", this.config)\n        );\n        return;\n      }\n\n      if (!this._element) {\n        this._createCard(this.config);\n        return;\n      }\n\n      // in case the element was an error element we always want to recreate it\n      if (!this._error && oldConfig && this.config.type === oldConfig.type) {\n        try {\n          this._element.setConfig(this.config);\n        } catch (err: any) {\n          this._createCard(createErrorCardConfig(err.message, this.config));\n        }\n      } else {\n        this._createCard(this.config);\n      }\n    }\n\n    if (changedProperties.has(\"hass\")) {\n      if (this._element) {\n        this._element.hass = this.hass;\n      }\n    }\n  }\n\n  private _createCard(configValue: LovelaceCardConfig): void {\n    this._cleanup();\n    this._element = createCardElement(configValue);\n\n    this._element.editMode = true;\n\n    if (this.hass) {\n      this._element!.hass = this.hass;\n    }\n\n    this.appendChild(this._element!);\n  }\n\n  private _cleanup() {\n    if (!this._element) {\n      return;\n    }\n    this.removeChild(this._element);\n    this._element = undefined;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-card-preview\": HuiCardPreview;\n  }\n}\n\ncustomElements.define(\"hui-card-preview\", HuiCardPreview);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}