{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport \"core-js/modules/es.error.cause.js\";\nimport { getExtendedEntityRegistryEntry } from \"./entity_registry\";\nimport { showEnterCodeDialogDialog } from \"../dialogs/enter-code/show-enter-code-dialog\";\nexport var FORMAT_TEXT = \"text\";\nexport var FORMAT_NUMBER = \"number\";\nexport var LockEntityFeature = /*#__PURE__*/function (LockEntityFeature) {\n  LockEntityFeature[LockEntityFeature[\"OPEN\"] = 1] = \"OPEN\";\n  return LockEntityFeature;\n}({});\nexport var callProtectedLockService = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(element, hass, stateObj, service) {\n    var _lockRegistryEntry$op;\n    var code, lockRegistryEntry, defaultCode, response;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return getExtendedEntityRegistryEntry(hass, stateObj.entity_id).catch(function () {\n            return undefined;\n          });\n        case 2:\n          lockRegistryEntry = _context.sent;\n          defaultCode = lockRegistryEntry === null || lockRegistryEntry === void 0 || (_lockRegistryEntry$op = lockRegistryEntry.options) === null || _lockRegistryEntry$op === void 0 || (_lockRegistryEntry$op = _lockRegistryEntry$op.lock) === null || _lockRegistryEntry$op === void 0 ? void 0 : _lockRegistryEntry$op.default_code;\n          if (!(stateObj.attributes.code_format && !defaultCode)) {\n            _context.next = 11;\n            break;\n          }\n          _context.next = 7;\n          return showEnterCodeDialogDialog(element, {\n            codeFormat: \"text\",\n            codePattern: stateObj.attributes.code_format,\n            title: hass.localize(\"ui.card.lock.\".concat(service)),\n            submitText: hass.localize(\"ui.card.lock.\".concat(service))\n          });\n        case 7:\n          response = _context.sent;\n          if (!(response == null)) {\n            _context.next = 10;\n            break;\n          }\n          throw new Error(\"Code dialog closed\");\n        case 10:\n          code = response;\n        case 11:\n          _context.next = 13;\n          return hass.callService(\"lock\", service, {\n            entity_id: stateObj.entity_id,\n            code: code\n          });\n        case 13:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function callProtectedLockService(_x, _x2, _x3, _x4) {\n    return _ref.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["getExtendedEntityRegistryEntry","showEnterCodeDialogDialog","FORMAT_TEXT","FORMAT_NUMBER","LockEntityFeature","callProtectedLockService","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","element","hass","stateObj","service","_lockRegistryEntry$op","code","lockRegistryEntry","defaultCode","response","wrap","_callee$","_context","prev","next","entity_id","catch","undefined","sent","options","lock","default_code","attributes","code_format","codeFormat","codePattern","title","localize","concat","submitText","Error","callService","stop","_x","_x2","_x3","_x4","apply","arguments"],"sources":["/Users/sercanardil/Desktop/frontend/src/data/lock.ts"],"sourcesContent":["import {\n  HassEntityAttributeBase,\n  HassEntityBase,\n} from \"home-assistant-js-websocket\";\nimport { getExtendedEntityRegistryEntry } from \"./entity_registry\";\nimport { showEnterCodeDialogDialog } from \"../dialogs/enter-code/show-enter-code-dialog\";\nimport { HomeAssistant } from \"../types\";\n\nexport const FORMAT_TEXT = \"text\";\nexport const FORMAT_NUMBER = \"number\";\n\nexport const enum LockEntityFeature {\n  OPEN = 1,\n}\n\ninterface LockEntityAttributes extends HassEntityAttributeBase {\n  code_format?: string;\n  changed_by?: string | null;\n}\n\nexport interface LockEntity extends HassEntityBase {\n  attributes: LockEntityAttributes;\n}\n\ntype ProtectedLockService = \"lock\" | \"unlock\" | \"open\";\n\nexport const callProtectedLockService = async (\n  element: HTMLElement,\n  hass: HomeAssistant,\n  stateObj: LockEntity,\n  service: ProtectedLockService\n) => {\n  let code: string | undefined;\n  const lockRegistryEntry = await getExtendedEntityRegistryEntry(\n    hass,\n    stateObj.entity_id\n  ).catch(() => undefined);\n  const defaultCode = lockRegistryEntry?.options?.lock?.default_code;\n\n  if (stateObj!.attributes.code_format && !defaultCode) {\n    const response = await showEnterCodeDialogDialog(element, {\n      codeFormat: \"text\",\n      codePattern: stateObj!.attributes.code_format,\n      title: hass.localize(`ui.card.lock.${service}`),\n      submitText: hass.localize(`ui.card.lock.${service}`),\n    });\n    if (response == null) {\n      throw new Error(\"Code dialog closed\");\n    }\n    code = response;\n  }\n\n  await hass.callService(\"lock\", service, {\n    entity_id: stateObj!.entity_id,\n    code,\n  });\n};\n"],"mappings":";;;AAIA,SAASA,8BAA8B,QAAQ,mBAAmB;AAClE,SAASC,yBAAyB,QAAQ,8CAA8C;AAGxF,OAAO,IAAMC,WAAW,GAAG,MAAM;AACjC,OAAO,IAAMC,aAAa,GAAG,QAAQ;AAErC,WAAkBC,iBAAiB,0BAAjBA,iBAAiB;EAAjBA,iBAAiB,CAAjBA,iBAAiB;EAAA,OAAjBA,iBAAiB;AAAA;AAenC,OAAO,IAAMC,wBAAwB;EAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QACtCC,OAAoB,EACpBC,IAAmB,EACnBC,QAAoB,EACpBC,OAA6B;IAAA,IAAAC,qBAAA;IAAA,IAAAC,IAAA,EAAAC,iBAAA,EAAAC,WAAA,EAAAC,QAAA;IAAA,OAAAX,mBAAA,GAAAY,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAAAF,QAAA,CAAAE,IAAA;UAAA,OAGGxB,8BAA8B,CAC5DY,IAAI,EACJC,QAAQ,CAACY,SACX,CAAC,CAACC,KAAK,CAAC;YAAA,OAAMC,SAAS;UAAA,EAAC;QAAA;UAHlBV,iBAAiB,GAAAK,QAAA,CAAAM,IAAA;UAIjBV,WAAW,GAAGD,iBAAiB,aAAjBA,iBAAiB,gBAAAF,qBAAA,GAAjBE,iBAAiB,CAAEY,OAAO,cAAAd,qBAAA,gBAAAA,qBAAA,GAA1BA,qBAAA,CAA4Be,IAAI,cAAAf,qBAAA,uBAAhCA,qBAAA,CAAkCgB,YAAY;UAAA,MAE9DlB,QAAQ,CAAEmB,UAAU,CAACC,WAAW,IAAI,CAACf,WAAW;YAAAI,QAAA,CAAAE,IAAA;YAAA;UAAA;UAAAF,QAAA,CAAAE,IAAA;UAAA,OAC3BvB,yBAAyB,CAACU,OAAO,EAAE;YACxDuB,UAAU,EAAE,MAAM;YAClBC,WAAW,EAAEtB,QAAQ,CAAEmB,UAAU,CAACC,WAAW;YAC7CG,KAAK,EAAExB,IAAI,CAACyB,QAAQ,iBAAAC,MAAA,CAAiBxB,OAAO,CAAE,CAAC;YAC/CyB,UAAU,EAAE3B,IAAI,CAACyB,QAAQ,iBAAAC,MAAA,CAAiBxB,OAAO,CAAE;UACrD,CAAC,CAAC;QAAA;UALIK,QAAQ,GAAAG,QAAA,CAAAM,IAAA;UAAA,MAMVT,QAAQ,IAAI,IAAI;YAAAG,QAAA,CAAAE,IAAA;YAAA;UAAA;UAAA,MACZ,IAAIgB,KAAK,CAAC,oBAAoB,CAAC;QAAA;UAEvCxB,IAAI,GAAGG,QAAQ;QAAC;UAAAG,QAAA,CAAAE,IAAA;UAAA,OAGZZ,IAAI,CAAC6B,WAAW,CAAC,MAAM,EAAE3B,OAAO,EAAE;YACtCW,SAAS,EAAEZ,QAAQ,CAAEY,SAAS;YAC9BT,IAAI,EAAJA;UACF,CAAC,CAAC;QAAA;QAAA;UAAA,OAAAM,QAAA,CAAAoB,IAAA;MAAA;IAAA,GAAAhC,OAAA;EAAA,CACH;EAAA,gBA9BYL,wBAAwBA,CAAAsC,EAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA;IAAA,OAAAxC,IAAA,CAAAyC,KAAA,OAAAC,SAAA;EAAA;AAAA,GA8BpC"},"metadata":{},"sourceType":"module","externalDependencies":[]}