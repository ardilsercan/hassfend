{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _callSuper from \"@babel/runtime/helpers/callSuper\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _decorate from \"@babel/runtime/helpers/decorate\";\nimport _get from \"@babel/runtime/helpers/get\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _templateObject, _templateObject2;\nimport \"core-js/modules/es.array.concat.js\";\nimport { undoDepth } from \"@codemirror/commands\";\nimport \"@material/mwc-button\";\nvar mdiClose = \"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\";\nimport { dump, load } from \"js-yaml\";\nimport { css, html, LitElement } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { array, assert, object, optional, string, type } from \"superstruct\";\nimport { deepEqual } from \"../../common/util/deep-equal\";\nimport \"../../components/ha-circular-progress\";\nimport \"../../components/ha-code-editor\";\nimport \"../../components/ha-icon-button\";\nimport { showAlertDialog, showConfirmationDialog } from \"../../dialogs/generic/show-dialog-box\";\nimport { haStyle } from \"../../resources/styles\";\nimport { showToast } from \"../../util/toast\";\nimport \"../../components/ha-top-app-bar-fixed\";\nimport { isStrategyDashboard } from \"../../data/lovelace/config/types\";\nvar lovelaceStruct = type({\n  title: optional(string()),\n  views: array(object())\n});\nvar strategyStruct = type({\n  strategy: type({\n    type: string()\n  })\n});\nvar LovelaceFullConfigEditor = _decorate([customElement(\"hui-editor\")], function (_initialize, _LitElement) {\n  var LovelaceFullConfigEditor = /*#__PURE__*/function (_LitElement2) {\n    _inherits(LovelaceFullConfigEditor, _LitElement2);\n    function LovelaceFullConfigEditor() {\n      var _this;\n      _classCallCheck(this, LovelaceFullConfigEditor);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _callSuper(this, LovelaceFullConfigEditor, [].concat(args));\n      _initialize(_assertThisInitialized(_this));\n      return _this;\n    }\n    return _createClass(LovelaceFullConfigEditor);\n  }(_LitElement);\n  return {\n    F: LovelaceFullConfigEditor,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"lovelace\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"closeEditor\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_saving\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_changed\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        return html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n      <ha-top-app-bar-fixed>\\n        <ha-icon-button\\n          slot=\\\"navigationIcon\\\"\\n          .path=\", \"\\n          @click=\", \"\\n          .label=\", \"\\n        ></ha-icon-button>\\n        <div slot=\\\"title\\\">\\n          \", \"\\n        </div>\\n        <div\\n          slot=\\\"actionItems\\\"\\n          class=\\\"save-button\\n              \", \"\\\"\\n        >\\n          \", \"\\n        </div>\\n        <mwc-button\\n          raised\\n          slot=\\\"actionItems\\\"\\n          @click=\", \"\\n          .disabled=\", \"\\n          >\", \"</mwc-button\\n        >\\n        <div class=\\\"content\\\">\\n          <ha-code-editor\\n            mode=\\\"yaml\\\"\\n            autofocus\\n            autocomplete-entities\\n            autocomplete-icons\\n            .hass=\", \"\\n            @value-changed=\", \"\\n            @editor-save=\", \"\\n            dir=\\\"ltr\\\"\\n          >\\n          </ha-code-editor>\\n        </div>\\n      </ha-top-app-bar-fixed>\\n    \"])), mdiClose, this._closeEditor, this.hass.localize(\"ui.common.close\"), this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.header\"), classMap({\n          saved: this._saving === false || this._changed === true\n        }), this._changed ? this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.unsaved_changes\") : this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.saved\"), this._handleSave, !this._changed, this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.save\"), this.hass, this._yamlChanged, this._handleSave);\n      }\n    }, {\n      kind: \"method\",\n      key: \"firstUpdated\",\n      value: function firstUpdated(changedProps) {\n        _get(_getPrototypeOf(LovelaceFullConfigEditor.prototype), \"firstUpdated\", this).call(this, changedProps);\n        this.yamlEditor.value = dump(this.lovelace.rawConfig);\n      }\n    }, {\n      kind: \"method\",\n      key: \"updated\",\n      value: function updated(changedProps) {\n        var _this2 = this;\n        var oldLovelace = changedProps.get(\"lovelace\");\n        if (!this._saving && oldLovelace && this.lovelace && oldLovelace.rawConfig !== this.lovelace.rawConfig && !deepEqual(oldLovelace.rawConfig, this.lovelace.rawConfig)) {\n          showToast(this, {\n            message: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.lovelace_changed\"),\n            action: {\n              action: function action() {\n                _this2.yamlEditor.value = dump(_this2.lovelace.rawConfig);\n              },\n              text: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.reload\")\n            },\n            duration: 0,\n            dismissable: false\n          });\n        }\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return [haStyle, css(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n        :host {\\n          --code-mirror-height: 100%;\\n          --app-header-background-color: var(\\n            --app-header-edit-background-color,\\n            #455a64\\n          );\\n          --app-header-text-color: var(--app-header-edit-text-color, #fff);\\n        }\\n\\n        mwc-button[disabled] {\\n          background-color: var(--mdc-theme-on-primary);\\n          border-radius: 4px;\\n        }\\n\\n        .content {\\n          height: calc(100vh - var(--header-height));\\n        }\\n\\n        .comments {\\n          font-size: 16px;\\n        }\\n\\n        .save-button {\\n          opacity: 0;\\n          font-size: 14px;\\n          padding: 0px 10px;\\n        }\\n\\n        .saved {\\n          opacity: 1;\\n        }\\n      \"])))];\n      }\n    }, {\n      kind: \"method\",\n      key: \"_yamlChanged\",\n      value: function _yamlChanged() {\n        this._changed = undoDepth(this.yamlEditor.codemirror.state) > 0;\n        if (this._changed && !window.onbeforeunload) {\n          window.onbeforeunload = function () {\n            return true;\n          };\n        } else if (!this._changed && window.onbeforeunload) {\n          window.onbeforeunload = null;\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_closeEditor\",\n      value: function () {\n        var _closeEditor2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.t0 = this._changed;\n                if (!_context.t0) {\n                  _context.next = 5;\n                  break;\n                }\n                _context.next = 4;\n                return showConfirmationDialog(this, {\n                  text: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.confirm_unsaved_changes\"),\n                  dismissText: this.hass.localize(\"ui.common.stay\"),\n                  confirmText: this.hass.localize(\"ui.common.leave\")\n                });\n              case 4:\n                _context.t0 = !_context.sent;\n              case 5:\n                if (!_context.t0) {\n                  _context.next = 7;\n                  break;\n                }\n                return _context.abrupt(\"return\");\n              case 7:\n                window.onbeforeunload = null;\n                if (this.closeEditor) {\n                  this.closeEditor();\n                }\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this);\n        }));\n        function _closeEditor() {\n          return _closeEditor2.apply(this, arguments);\n        }\n        return _closeEditor;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_removeConfig\",\n      value: function () {\n        var _removeConfig2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return this.lovelace.deleteConfig();\n              case 3:\n                _context2.next = 8;\n                break;\n              case 5:\n                _context2.prev = 5;\n                _context2.t0 = _context2[\"catch\"](0);\n                showAlertDialog(this, {\n                  text: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.error_remove\", {\n                    error: _context2.t0\n                  })\n                });\n              case 8:\n                window.onbeforeunload = null;\n                if (this.closeEditor) {\n                  this.closeEditor();\n                }\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2, this, [[0, 5]]);\n        }));\n        function _removeConfig() {\n          return _removeConfig2.apply(this, arguments);\n        }\n        return _removeConfig;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_handleSave\",\n      value: function () {\n        var _handleSave2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n          var _this3 = this;\n          var value, config;\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                this._saving = true;\n                value = this.yamlEditor.value;\n                if (value) {\n                  _context3.next = 5;\n                  break;\n                }\n                showConfirmationDialog(this, {\n                  title: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.confirm_remove_config_title\"),\n                  text: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.confirm_remove_config_text\"),\n                  confirmText: this.hass.localize(\"ui.common.remove\"),\n                  dismissText: this.hass.localize(\"ui.common.cancel\"),\n                  confirm: function confirm() {\n                    return _this3._removeConfig();\n                  }\n                });\n                return _context3.abrupt(\"return\");\n              case 5:\n                if (!this.yamlEditor.hasComments) {\n                  _context3.next = 8;\n                  break;\n                }\n                if (confirm(this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.confirm_unsaved_comments\"))) {\n                  _context3.next = 8;\n                  break;\n                }\n                return _context3.abrupt(\"return\");\n              case 8:\n                _context3.prev = 8;\n                config = load(value);\n                _context3.next = 17;\n                break;\n              case 12:\n                _context3.prev = 12;\n                _context3.t0 = _context3[\"catch\"](8);\n                showAlertDialog(this, {\n                  text: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.error_parse_yaml\", {\n                    error: _context3.t0\n                  })\n                });\n                this._saving = false;\n                return _context3.abrupt(\"return\");\n              case 17:\n                _context3.prev = 17;\n                if (isStrategyDashboard(config)) {\n                  assert(config, strategyStruct);\n                } else {\n                  assert(config, lovelaceStruct);\n                }\n                _context3.next = 25;\n                break;\n              case 21:\n                _context3.prev = 21;\n                _context3.t1 = _context3[\"catch\"](17);\n                showAlertDialog(this, {\n                  text: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.error_invalid_config\", {\n                    error: _context3.t1\n                  })\n                });\n                return _context3.abrupt(\"return\");\n              case 25:\n                // @ts-ignore\n                if (config.resources) {\n                  showAlertDialog(this, {\n                    text: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.resources_moved\")\n                  });\n                }\n                _context3.prev = 26;\n                _context3.next = 29;\n                return this.lovelace.saveConfig(config);\n              case 29:\n                _context3.next = 34;\n                break;\n              case 31:\n                _context3.prev = 31;\n                _context3.t2 = _context3[\"catch\"](26);\n                showAlertDialog(this, {\n                  text: this.hass.localize(\"ui.panel.lovelace.editor.raw_editor.error_save_yaml\", {\n                    error: _context3.t2\n                  })\n                });\n              case 34:\n                window.onbeforeunload = null;\n                this._changed = false;\n                this._saving = false;\n              case 37:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, this, [[8, 12], [17, 21], [26, 31]]);\n        }));\n        function _handleSave() {\n          return _handleSave2.apply(this, arguments);\n        }\n        return _handleSave;\n      }()\n    }, {\n      kind: \"get\",\n      key: \"yamlEditor\",\n      value: function yamlEditor() {\n        return this.shadowRoot.querySelector(\"ha-code-editor\");\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["undoDepth","mdiClose","dump","load","css","html","LitElement","customElement","property","state","classMap","array","assert","object","optional","string","type","deepEqual","showAlertDialog","showConfirmationDialog","haStyle","showToast","isStrategyDashboard","lovelaceStruct","title","views","strategyStruct","strategy","LovelaceFullConfigEditor","_decorate","_initialize","_LitElement","_LitElement2","_inherits","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_assertThisInitialized","_createClass","F","d","kind","decorators","attribute","key","value","render","_templateObject","_taggedTemplateLiteral","_closeEditor","hass","localize","saved","_saving","_changed","_handleSave","_yamlChanged","firstUpdated","changedProps","_get","_getPrototypeOf","prototype","call","yamlEditor","lovelace","rawConfig","updated","_this2","oldLovelace","get","message","action","text","duration","dismissable","static","styles","_templateObject2","codemirror","window","onbeforeunload","_closeEditor2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","t0","dismissText","confirmText","sent","abrupt","closeEditor","stop","apply","_removeConfig2","_callee2","_callee2$","_context2","deleteConfig","error","_removeConfig","_handleSave2","_callee3","_this3","config","_callee3$","_context3","confirm","hasComments","t1","resources","saveConfig","t2","shadowRoot","querySelector"],"sources":["/workspaces/frontend/src/panels/lovelace/hui-editor.ts"],"sourcesContent":["import { undoDepth } from \"@codemirror/commands\";\nimport \"@material/mwc-button\";\nimport { mdiClose } from \"@mdi/js\";\nimport { dump, load } from \"js-yaml\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { array, assert, object, optional, string, type } from \"superstruct\";\nimport { deepEqual } from \"../../common/util/deep-equal\";\nimport \"../../components/ha-circular-progress\";\nimport \"../../components/ha-code-editor\";\nimport type { HaCodeEditor } from \"../../components/ha-code-editor\";\nimport \"../../components/ha-icon-button\";\nimport {\n  showAlertDialog,\n  showConfirmationDialog,\n} from \"../../dialogs/generic/show-dialog-box\";\nimport { haStyle } from \"../../resources/styles\";\nimport type { HomeAssistant } from \"../../types\";\nimport { showToast } from \"../../util/toast\";\nimport type { Lovelace } from \"./types\";\nimport \"../../components/ha-top-app-bar-fixed\";\nimport {\n  LovelaceRawConfig,\n  isStrategyDashboard,\n} from \"../../data/lovelace/config/types\";\n\nconst lovelaceStruct = type({\n  title: optional(string()),\n  views: array(object()),\n});\n\nconst strategyStruct = type({\n  strategy: type({\n    type: string(),\n  }),\n});\n\n@customElement(\"hui-editor\")\nclass LovelaceFullConfigEditor extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public lovelace?: Lovelace;\n\n  @property({ attribute: false }) public closeEditor?: () => void;\n\n  @state() private _saving?: boolean;\n\n  @state() private _changed?: boolean;\n\n  protected render(): TemplateResult | void {\n    return html`\n      <ha-top-app-bar-fixed>\n        <ha-icon-button\n          slot=\"navigationIcon\"\n          .path=${mdiClose}\n          @click=${this._closeEditor}\n          .label=${this.hass!.localize(\"ui.common.close\")}\n        ></ha-icon-button>\n        <div slot=\"title\">\n          ${this.hass!.localize(\"ui.panel.lovelace.editor.raw_editor.header\")}\n        </div>\n        <div\n          slot=\"actionItems\"\n          class=\"save-button\n              ${classMap({\n            saved: this._saving! === false || this._changed === true,\n          })}\"\n        >\n          ${this._changed\n            ? this.hass!.localize(\n                \"ui.panel.lovelace.editor.raw_editor.unsaved_changes\"\n              )\n            : this.hass!.localize(\"ui.panel.lovelace.editor.raw_editor.saved\")}\n        </div>\n        <mwc-button\n          raised\n          slot=\"actionItems\"\n          @click=${this._handleSave}\n          .disabled=${!this._changed}\n          >${this.hass!.localize(\n            \"ui.panel.lovelace.editor.raw_editor.save\"\n          )}</mwc-button\n        >\n        <div class=\"content\">\n          <ha-code-editor\n            mode=\"yaml\"\n            autofocus\n            autocomplete-entities\n            autocomplete-icons\n            .hass=${this.hass}\n            @value-changed=${this._yamlChanged}\n            @editor-save=${this._handleSave}\n            dir=\"ltr\"\n          >\n          </ha-code-editor>\n        </div>\n      </ha-top-app-bar-fixed>\n    `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues) {\n    super.firstUpdated(changedProps);\n    this.yamlEditor.value = dump(this.lovelace!.rawConfig);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    const oldLovelace = changedProps.get(\"lovelace\") as Lovelace | undefined;\n    if (\n      !this._saving &&\n      oldLovelace &&\n      this.lovelace &&\n      oldLovelace.rawConfig !== this.lovelace.rawConfig &&\n      !deepEqual(oldLovelace.rawConfig, this.lovelace.rawConfig)\n    ) {\n      showToast(this, {\n        message: this.hass!.localize(\n          \"ui.panel.lovelace.editor.raw_editor.lovelace_changed\"\n        ),\n        action: {\n          action: () => {\n            this.yamlEditor.value = dump(this.lovelace!.rawConfig);\n          },\n          text: this.hass!.localize(\n            \"ui.panel.lovelace.editor.raw_editor.reload\"\n          ),\n        },\n        duration: 0,\n        dismissable: false,\n      });\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      haStyle,\n      css`\n        :host {\n          --code-mirror-height: 100%;\n          --app-header-background-color: var(\n            --app-header-edit-background-color,\n            #455a64\n          );\n          --app-header-text-color: var(--app-header-edit-text-color, #fff);\n        }\n\n        mwc-button[disabled] {\n          background-color: var(--mdc-theme-on-primary);\n          border-radius: 4px;\n        }\n\n        .content {\n          height: calc(100vh - var(--header-height));\n        }\n\n        .comments {\n          font-size: 16px;\n        }\n\n        .save-button {\n          opacity: 0;\n          font-size: 14px;\n          padding: 0px 10px;\n        }\n\n        .saved {\n          opacity: 1;\n        }\n      `,\n    ];\n  }\n\n  private _yamlChanged() {\n    this._changed = undoDepth(this.yamlEditor.codemirror!.state) > 0;\n    if (this._changed && !window.onbeforeunload) {\n      window.onbeforeunload = () => true;\n    } else if (!this._changed && window.onbeforeunload) {\n      window.onbeforeunload = null;\n    }\n  }\n\n  private async _closeEditor() {\n    if (\n      this._changed &&\n      !(await showConfirmationDialog(this, {\n        text: this.hass.localize(\n          \"ui.panel.lovelace.editor.raw_editor.confirm_unsaved_changes\"\n        ),\n        dismissText: this.hass!.localize(\"ui.common.stay\"),\n        confirmText: this.hass!.localize(\"ui.common.leave\"),\n      }))\n    ) {\n      return;\n    }\n\n    window.onbeforeunload = null;\n    if (this.closeEditor) {\n      this.closeEditor();\n    }\n  }\n\n  private async _removeConfig() {\n    try {\n      await this.lovelace!.deleteConfig();\n    } catch (err: any) {\n      showAlertDialog(this, {\n        text: this.hass.localize(\n          \"ui.panel.lovelace.editor.raw_editor.error_remove\",\n          { error: err }\n        ),\n      });\n    }\n    window.onbeforeunload = null;\n    if (this.closeEditor) {\n      this.closeEditor();\n    }\n  }\n\n  private async _handleSave() {\n    this._saving = true;\n\n    const value = this.yamlEditor.value;\n\n    if (!value) {\n      showConfirmationDialog(this, {\n        title: this.hass.localize(\n          \"ui.panel.lovelace.editor.raw_editor.confirm_remove_config_title\"\n        ),\n        text: this.hass.localize(\n          \"ui.panel.lovelace.editor.raw_editor.confirm_remove_config_text\"\n        ),\n        confirmText: this.hass.localize(\"ui.common.remove\"),\n        dismissText: this.hass.localize(\"ui.common.cancel\"),\n        confirm: () => this._removeConfig(),\n      });\n      return;\n    }\n\n    if (this.yamlEditor.hasComments) {\n      if (\n        !confirm(\n          this.hass.localize(\n            \"ui.panel.lovelace.editor.raw_editor.confirm_unsaved_comments\"\n          )\n        )\n      ) {\n        return;\n      }\n    }\n\n    let config: LovelaceRawConfig;\n    try {\n      config = load(value) as LovelaceRawConfig;\n    } catch (err: any) {\n      showAlertDialog(this, {\n        text: this.hass.localize(\n          \"ui.panel.lovelace.editor.raw_editor.error_parse_yaml\",\n          { error: err }\n        ),\n      });\n      this._saving = false;\n      return;\n    }\n    try {\n      if (isStrategyDashboard(config)) {\n        assert(config, strategyStruct);\n      } else {\n        assert(config, lovelaceStruct);\n      }\n    } catch (err: any) {\n      showAlertDialog(this, {\n        text: this.hass.localize(\n          \"ui.panel.lovelace.editor.raw_editor.error_invalid_config\",\n          { error: err }\n        ),\n      });\n      return;\n    }\n    // @ts-ignore\n    if (config.resources) {\n      showAlertDialog(this, {\n        text: this.hass.localize(\n          \"ui.panel.lovelace.editor.raw_editor.resources_moved\"\n        ),\n      });\n    }\n    try {\n      await this.lovelace!.saveConfig(config);\n    } catch (err: any) {\n      showAlertDialog(this, {\n        text: this.hass.localize(\n          \"ui.panel.lovelace.editor.raw_editor.error_save_yaml\",\n          { error: err }\n        ),\n      });\n    }\n    window.onbeforeunload = null;\n    this._changed = false;\n    this._saving = false;\n  }\n\n  private get yamlEditor(): HaCodeEditor {\n    return this.shadowRoot!.querySelector(\"ha-code-editor\")! as HaCodeEditor;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-editor\": LovelaceFullConfigEditor;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}