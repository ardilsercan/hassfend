{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nimport \"@material/mwc-list/mwc-list-item\";\nimport { html, LitElement, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { caseInsensitiveStringCompare } from \"../common/string/compare\";\nimport { getConfigEntries } from \"../data/config_entries\";\nimport { domainToName } from \"../data/integration\";\nimport { brandsUrl } from \"../util/brands-url\";\nimport \"./ha-combo-box\";\nlet HaConfigEntryPicker = _decorate([customElement(\"ha-config-entry-picker\")], function (_initialize, _LitElement) {\n  class HaConfigEntryPicker extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: HaConfigEntryPicker,\n    d: [{\n      kind: \"field\",\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"integration\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"label\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"value\",\n      value() {\n        return \"\";\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"helper\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_configEntries\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"disabled\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"required\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [query(\"ha-combo-box\")],\n      key: \"_comboBox\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"open\",\n      value: function open() {\n        var _this$_comboBox;\n        (_this$_comboBox = this._comboBox) === null || _this$_comboBox === void 0 || _this$_comboBox.open();\n      }\n    }, {\n      kind: \"method\",\n      key: \"focus\",\n      value: function focus() {\n        var _this$_comboBox2;\n        (_this$_comboBox2 = this._comboBox) === null || _this$_comboBox2 === void 0 || _this$_comboBox2.focus();\n      }\n    }, {\n      kind: \"method\",\n      key: \"firstUpdated\",\n      value: function firstUpdated() {\n        this._getConfigEntries();\n      }\n    }, {\n      kind: \"field\",\n      key: \"_rowRenderer\",\n      value() {\n        return item => {\n          var _this$hass$themes;\n          return html`<mwc-list-item twoline graphic=\"icon\">\n      <span\n        >${item.title || this.hass.localize(\"ui.panel.config.integrations.config_entry.unnamed_entry\")}</span\n      >\n      <span slot=\"secondary\">${item.localized_domain_name}</span>\n      <img\n        alt=\"\"\n        slot=\"graphic\"\n        src=${brandsUrl({\n            domain: item.domain,\n            type: \"icon\",\n            darkOptimized: (_this$hass$themes = this.hass.themes) === null || _this$hass$themes === void 0 ? void 0 : _this$hass$themes.darkMode\n          })}\n        crossorigin=\"anonymous\"\n        referrerpolicy=\"no-referrer\"\n        @error=${this._onImageError}\n        @load=${this._onImageLoad}\n      />\n    </mwc-list-item>`;\n        };\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this._configEntries) {\n          return nothing;\n        }\n        return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        .label=${this.label === undefined && this.hass ? this.hass.localize(\"ui.components.config-entry-picker.config_entry\") : this.label}\n        .value=${this._value}\n        .required=${this.required}\n        .disabled=${this.disabled}\n        .helper=${this.helper}\n        .renderer=${this._rowRenderer}\n        .items=${this._configEntries}\n        item-value-path=\"entry_id\"\n        item-id-path=\"entry_id\"\n        item-label-path=\"title\"\n        @value-changed=${this._valueChanged}\n      ></ha-combo-box>\n    `;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_onImageLoad\",\n      value: function _onImageLoad(ev) {\n        ev.target.style.visibility = \"initial\";\n      }\n    }, {\n      kind: \"method\",\n      key: \"_onImageError\",\n      value: function _onImageError(ev) {\n        ev.target.style.visibility = \"hidden\";\n      }\n    }, {\n      kind: \"method\",\n      key: \"_getConfigEntries\",\n      value: async function _getConfigEntries() {\n        getConfigEntries(this.hass, {\n          type: [\"device\", \"hub\", \"service\"],\n          domain: this.integration\n        }).then(configEntries => {\n          this._configEntries = configEntries.map(entry => ({\n            ...entry,\n            localized_domain_name: domainToName(this.hass.localize, entry.domain)\n          })).sort((conf1, conf2) => caseInsensitiveStringCompare(conf1.localized_domain_name + conf1.title, conf2.localized_domain_name + conf2.title, this.hass.locale.language));\n        });\n      }\n    }, {\n      kind: \"get\",\n      key: \"_value\",\n      value: function _value() {\n        return this.value || \"\";\n      }\n    }, {\n      kind: \"method\",\n      key: \"_valueChanged\",\n      value: function _valueChanged(ev) {\n        ev.stopPropagation();\n        const newValue = ev.detail.value;\n        if (newValue !== this._value) {\n          this._setValue(newValue);\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_setValue\",\n      value: function _setValue(value) {\n        this.value = value;\n        setTimeout(() => {\n          fireEvent(this, \"value-changed\", {\n            value\n          });\n          fireEvent(this, \"change\");\n        }, 0);\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["html","LitElement","nothing","customElement","property","query","state","fireEvent","caseInsensitiveStringCompare","getConfigEntries","domainToName","brandsUrl","HaConfigEntryPicker","_decorate","_initialize","_LitElement","constructor","args","F","d","kind","key","value","decorators","type","Boolean","open","_this$_comboBox","_comboBox","focus","_this$_comboBox2","firstUpdated","_getConfigEntries","item","_this$hass$themes","title","hass","localize","localized_domain_name","domain","darkOptimized","themes","darkMode","_onImageError","_onImageLoad","render","_configEntries","label","undefined","_value","required","disabled","helper","_rowRenderer","_valueChanged","ev","target","style","visibility","integration","then","configEntries","map","entry","sort","conf1","conf2","locale","language","stopPropagation","newValue","detail","_setValue","setTimeout"],"sources":["/workspaces/frontend/src/components/ha-config-entry-picker.ts"],"sourcesContent":["import \"@material/mwc-list/mwc-list-item\";\nimport { ComboBoxLitRenderer } from \"@vaadin/combo-box/lit\";\nimport { html, LitElement, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { caseInsensitiveStringCompare } from \"../common/string/compare\";\nimport { ConfigEntry, getConfigEntries } from \"../data/config_entries\";\nimport { domainToName } from \"../data/integration\";\nimport { ValueChangedEvent, HomeAssistant } from \"../types\";\nimport { brandsUrl } from \"../util/brands-url\";\nimport \"./ha-combo-box\";\nimport type { HaComboBox } from \"./ha-combo-box\";\n\nexport interface ConfigEntryExtended extends ConfigEntry {\n  localized_domain_name?: string;\n}\n\n@customElement(\"ha-config-entry-picker\")\nclass HaConfigEntryPicker extends LitElement {\n  public hass!: HomeAssistant;\n\n  @property() public integration?: string;\n\n  @property() public label?: string;\n\n  @property() public value = \"\";\n\n  @property() public helper?: string;\n\n  @state() private _configEntries?: ConfigEntryExtended[];\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @query(\"ha-combo-box\") private _comboBox!: HaComboBox;\n\n  public open() {\n    this._comboBox?.open();\n  }\n\n  public focus() {\n    this._comboBox?.focus();\n  }\n\n  protected firstUpdated() {\n    this._getConfigEntries();\n  }\n\n  private _rowRenderer: ComboBoxLitRenderer<ConfigEntryExtended> = (item) =>\n    html`<mwc-list-item twoline graphic=\"icon\">\n      <span\n        >${item.title ||\n        this.hass.localize(\n          \"ui.panel.config.integrations.config_entry.unnamed_entry\"\n        )}</span\n      >\n      <span slot=\"secondary\">${item.localized_domain_name}</span>\n      <img\n        alt=\"\"\n        slot=\"graphic\"\n        src=${brandsUrl({\n          domain: item.domain,\n          type: \"icon\",\n          darkOptimized: this.hass.themes?.darkMode,\n        })}\n        crossorigin=\"anonymous\"\n        referrerpolicy=\"no-referrer\"\n        @error=${this._onImageError}\n        @load=${this._onImageLoad}\n      />\n    </mwc-list-item>`;\n\n  protected render() {\n    if (!this._configEntries) {\n      return nothing;\n    }\n    return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        .label=${this.label === undefined && this.hass\n          ? this.hass.localize(\"ui.components.config-entry-picker.config_entry\")\n          : this.label}\n        .value=${this._value}\n        .required=${this.required}\n        .disabled=${this.disabled}\n        .helper=${this.helper}\n        .renderer=${this._rowRenderer}\n        .items=${this._configEntries}\n        item-value-path=\"entry_id\"\n        item-id-path=\"entry_id\"\n        item-label-path=\"title\"\n        @value-changed=${this._valueChanged}\n      ></ha-combo-box>\n    `;\n  }\n\n  private _onImageLoad(ev) {\n    ev.target.style.visibility = \"initial\";\n  }\n\n  private _onImageError(ev) {\n    ev.target.style.visibility = \"hidden\";\n  }\n\n  private async _getConfigEntries() {\n    getConfigEntries(this.hass, {\n      type: [\"device\", \"hub\", \"service\"],\n      domain: this.integration,\n    }).then((configEntries) => {\n      this._configEntries = configEntries\n        .map(\n          (entry: ConfigEntry): ConfigEntryExtended => ({\n            ...entry,\n            localized_domain_name: domainToName(\n              this.hass.localize,\n              entry.domain\n            ),\n          })\n        )\n        .sort((conf1, conf2) =>\n          caseInsensitiveStringCompare(\n            conf1.localized_domain_name + conf1.title,\n            conf2.localized_domain_name + conf2.title,\n            this.hass.locale.language\n          )\n        );\n    });\n  }\n\n  private get _value() {\n    return this.value || \"\";\n  }\n\n  private _valueChanged(ev: ValueChangedEvent<string>) {\n    ev.stopPropagation();\n    const newValue = ev.detail.value;\n\n    if (newValue !== this._value) {\n      this._setValue(newValue);\n    }\n  }\n\n  private _setValue(value: string) {\n    this.value = value;\n    setTimeout(() => {\n      fireEvent(this, \"value-changed\", { value });\n      fireEvent(this, \"change\");\n    }, 0);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-config-entry-picker\": HaConfigEntryPicker;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}