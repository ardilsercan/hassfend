{"ast":null,"code":"import _decorate from \"@babel/runtime/helpers/decorate\";\nimport { LitElement, html, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { getStates } from \"../../common/entity/get_states\";\nimport \"../ha-combo-box\";\nlet HaEntityStatePicker = _decorate([customElement(\"ha-entity-state-picker\")], function (_initialize, _LitElement) {\n  class HaEntityStatePicker extends _LitElement {\n    constructor(...args) {\n      super(...args);\n      _initialize(this);\n    }\n  }\n  return {\n    F: HaEntityStatePicker,\n    d: [{\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"entityId\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"attribute\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        attribute: false\n      })],\n      key: \"extraOptions\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"autofocus\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"disabled\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean\n      })],\n      key: \"required\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [property({\n        type: Boolean,\n        attribute: \"allow-custom-value\"\n      })],\n      key: \"allowCustomValue\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"label\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"value\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [property()],\n      key: \"helper\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [state()],\n      key: \"_opened\",\n      value() {\n        return false;\n      }\n    }, {\n      kind: \"field\",\n      decorators: [query(\"ha-combo-box\", true)],\n      key: \"_comboBox\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"shouldUpdate\",\n      value: function shouldUpdate(changedProps) {\n        return !(!changedProps.has(\"_opened\") && this._opened);\n      }\n    }, {\n      kind: \"method\",\n      key: \"updated\",\n      value: function updated(changedProps) {\n        if (changedProps.has(\"_opened\") && this._opened || changedProps.has(\"entityId\") || changedProps.has(\"attribute\") || changedProps.has(\"extraOptions\")) {\n          var _this$extraOptions;\n          const stateObj = this.entityId ? this.hass.states[this.entityId] : undefined;\n          this._comboBox.items = [...((_this$extraOptions = this.extraOptions) !== null && _this$extraOptions !== void 0 ? _this$extraOptions : []), ...(this.entityId && stateObj ? getStates(stateObj, this.attribute).map(key => ({\n            value: key,\n            label: !this.attribute ? this.hass.formatEntityState(stateObj, key) : this.hass.formatEntityAttributeValue(stateObj, this.attribute, key)\n          })) : [])];\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        var _this$label;\n        if (!this.hass) {\n          return nothing;\n        }\n        return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        .value=${this._value}\n        .autofocus=${this.autofocus}\n        .label=${(_this$label = this.label) !== null && _this$label !== void 0 ? _this$label : this.hass.localize(\"ui.components.entity.entity-state-picker.state\")}\n        .disabled=${this.disabled || !this.entityId}\n        .required=${this.required}\n        .helper=${this.helper}\n        .allowCustomValue=${this.allowCustomValue}\n        item-value-path=\"value\"\n        item-label-path=\"label\"\n        @opened-changed=${this._openedChanged}\n        @value-changed=${this._valueChanged}\n      >\n      </ha-combo-box>\n    `;\n      }\n    }, {\n      kind: \"get\",\n      key: \"_value\",\n      value: function _value() {\n        return this.value || \"\";\n      }\n    }, {\n      kind: \"method\",\n      key: \"_openedChanged\",\n      value: function _openedChanged(ev) {\n        this._opened = ev.detail.value;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_valueChanged\",\n      value: function _valueChanged(ev) {\n        ev.stopPropagation();\n        const newValue = ev.detail.value;\n        if (newValue !== this._value) {\n          this._setValue(newValue);\n        }\n      }\n    }, {\n      kind: \"method\",\n      key: \"_setValue\",\n      value: function _setValue(value) {\n        this.value = value;\n        setTimeout(() => {\n          fireEvent(this, \"value-changed\", {\n            value\n          });\n          fireEvent(this, \"change\");\n        }, 0);\n      }\n    }]\n  };\n}, LitElement);","map":{"version":3,"names":["LitElement","html","nothing","customElement","property","query","state","fireEvent","getStates","HaEntityStatePicker","_decorate","_initialize","_LitElement","constructor","args","F","d","kind","decorators","attribute","key","value","type","Boolean","shouldUpdate","changedProps","has","_opened","updated","_this$extraOptions","stateObj","entityId","hass","states","undefined","_comboBox","items","extraOptions","map","label","formatEntityState","formatEntityAttributeValue","render","_this$label","_value","autofocus","localize","disabled","required","helper","allowCustomValue","_openedChanged","_valueChanged","ev","detail","stopPropagation","newValue","_setValue","setTimeout"],"sources":["/workspaces/frontend/src/components/entity/ha-entity-state-picker.ts"],"sourcesContent":["import { HassEntity } from \"home-assistant-js-websocket\";\nimport { LitElement, PropertyValues, html, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { getStates } from \"../../common/entity/get_states\";\nimport { HomeAssistant, ValueChangedEvent } from \"../../types\";\nimport \"../ha-combo-box\";\nimport type { HaComboBox } from \"../ha-combo-box\";\n\nexport type HaEntityPickerEntityFilterFunc = (entityId: HassEntity) => boolean;\n\n@customElement(\"ha-entity-state-picker\")\nclass HaEntityStatePicker extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public entityId?: string;\n\n  @property() public attribute?: string;\n\n  @property({ attribute: false }) public extraOptions?: any[];\n\n  @property({ type: Boolean }) public autofocus = false;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @property({ type: Boolean, attribute: \"allow-custom-value\" })\n  public allowCustomValue;\n\n  @property() public label?: string;\n\n  @property() public value?: string;\n\n  @property() public helper?: string;\n\n  @state() private _opened = false;\n\n  @query(\"ha-combo-box\", true) private _comboBox!: HaComboBox;\n\n  protected shouldUpdate(changedProps: PropertyValues) {\n    return !(!changedProps.has(\"_opened\") && this._opened);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    if (\n      (changedProps.has(\"_opened\") && this._opened) ||\n      changedProps.has(\"entityId\") ||\n      changedProps.has(\"attribute\") ||\n      changedProps.has(\"extraOptions\")\n    ) {\n      const stateObj = this.entityId\n        ? this.hass.states[this.entityId]\n        : undefined;\n      (this._comboBox as any).items = [\n        ...(this.extraOptions ?? []),\n        ...(this.entityId && stateObj\n          ? getStates(stateObj, this.attribute).map((key) => ({\n              value: key,\n              label: !this.attribute\n                ? this.hass.formatEntityState(stateObj, key)\n                : this.hass.formatEntityAttributeValue(\n                    stateObj,\n                    this.attribute,\n                    key\n                  ),\n            }))\n          : []),\n      ];\n    }\n  }\n\n  protected render() {\n    if (!this.hass) {\n      return nothing;\n    }\n\n    return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        .value=${this._value}\n        .autofocus=${this.autofocus}\n        .label=${this.label ??\n        this.hass.localize(\"ui.components.entity.entity-state-picker.state\")}\n        .disabled=${this.disabled || !this.entityId}\n        .required=${this.required}\n        .helper=${this.helper}\n        .allowCustomValue=${this.allowCustomValue}\n        item-value-path=\"value\"\n        item-label-path=\"label\"\n        @opened-changed=${this._openedChanged}\n        @value-changed=${this._valueChanged}\n      >\n      </ha-combo-box>\n    `;\n  }\n\n  private get _value() {\n    return this.value || \"\";\n  }\n\n  private _openedChanged(ev: ValueChangedEvent<boolean>) {\n    this._opened = ev.detail.value;\n  }\n\n  private _valueChanged(ev: ValueChangedEvent<string>) {\n    ev.stopPropagation();\n    const newValue = ev.detail.value;\n    if (newValue !== this._value) {\n      this._setValue(newValue);\n    }\n  }\n\n  private _setValue(value: string) {\n    this.value = value;\n    setTimeout(() => {\n      fireEvent(this, \"value-changed\", { value });\n      fireEvent(this, \"change\");\n    }, 0);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-entity-state-picker\": HaEntityStatePicker;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}