{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/helpers/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"unfetch/polyfill\";\nexport var fetchWithAuth = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(auth, input) {\n    var init,\n      _args = arguments;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          init = _args.length > 2 && _args[2] !== undefined ? _args[2] : {};\n          if (!auth.expired) {\n            _context.next = 4;\n            break;\n          }\n          _context.next = 4;\n          return auth.refreshAccessToken();\n        case 4:\n          init.credentials = \"same-origin\";\n          if (!init.headers) {\n            init.headers = {};\n          }\n          if (!init.headers) {\n            init.headers = {};\n          }\n          // @ts-ignore\n          init.headers.authorization = \"Bearer \".concat(auth.accessToken);\n          return _context.abrupt(\"return\", fetch(input, init));\n        case 9:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function fetchWithAuth(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["fetchWithAuth","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","auth","input","init","_args","arguments","wrap","_callee$","_context","prev","next","length","undefined","expired","refreshAccessToken","credentials","headers","authorization","concat","accessToken","abrupt","fetch","stop","_x","_x2","apply"],"sources":["/Users/sercanardil/Desktop/frontend/src/util/fetch-with-auth.ts"],"sourcesContent":["import { Auth } from \"home-assistant-js-websocket\";\n\nexport const fetchWithAuth = async (\n  auth: Auth,\n  input: RequestInfo,\n  init: RequestInit = {}\n) => {\n  if (auth.expired) {\n    await auth.refreshAccessToken();\n  }\n  init.credentials = \"same-origin\";\n  if (!init.headers) {\n    init.headers = {};\n  }\n  if (!init.headers) {\n    init.headers = {};\n  }\n  // @ts-ignore\n  init.headers.authorization = `Bearer ${auth.accessToken}`;\n  return fetch(input, init);\n};\n"],"mappings":";;;;;AAEA,OAAO,IAAMA,aAAa;EAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAC3BC,IAAU,EACVC,KAAkB;IAAA,IAAAC,IAAA;MAAAC,KAAA,GAAAC,SAAA;IAAA,OAAAP,mBAAA,GAAAQ,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAClBP,IAAiB,GAAAC,KAAA,CAAAO,MAAA,QAAAP,KAAA,QAAAQ,SAAA,GAAAR,KAAA,MAAG,CAAC,CAAC;UAAA,KAElBH,IAAI,CAACY,OAAO;YAAAL,QAAA,CAAAE,IAAA;YAAA;UAAA;UAAAF,QAAA,CAAAE,IAAA;UAAA,OACRT,IAAI,CAACa,kBAAkB,CAAC,CAAC;QAAA;UAEjCX,IAAI,CAACY,WAAW,GAAG,aAAa;UAChC,IAAI,CAACZ,IAAI,CAACa,OAAO,EAAE;YACjBb,IAAI,CAACa,OAAO,GAAG,CAAC,CAAC;UACnB;UACA,IAAI,CAACb,IAAI,CAACa,OAAO,EAAE;YACjBb,IAAI,CAACa,OAAO,GAAG,CAAC,CAAC;UACnB;UACA;UACAb,IAAI,CAACa,OAAO,CAACC,aAAa,aAAAC,MAAA,CAAajB,IAAI,CAACkB,WAAW,CAAE;UAAC,OAAAX,QAAA,CAAAY,MAAA,WACnDC,KAAK,CAACnB,KAAK,EAAEC,IAAI,CAAC;QAAA;QAAA;UAAA,OAAAK,QAAA,CAAAc,IAAA;MAAA;IAAA,GAAAtB,OAAA;EAAA,CAC1B;EAAA,gBAlBYL,aAAaA,CAAA4B,EAAA,EAAAC,GAAA;IAAA,OAAA5B,IAAA,CAAA6B,KAAA,OAAApB,SAAA;EAAA;AAAA,GAkBzB"},"metadata":{},"sourceType":"module","externalDependencies":[]}